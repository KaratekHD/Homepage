{"version":3,"sources":["Stores/FileStore.js","Controllers/TdLibController.js","Constants.js","Utils/InputTypingManager.js","Stores/ChatStore.js","Utils/File.js","Utils/Common.js","Utils/ActionScheduler.js","Stores/ApplicationStore.js","Stores/PlayerStore.js","Stores/MessageStore.js","Components/InstantView/RichText/RichText.js","Stores/UserStore.js","Stores/EventEmitter.js","Utils/Player.js","Actions/Client.js","Utils/User.js","Utils/Currency.js","Utils/ServiceMessage.js","Components/Message/MessageAuthor.js","Components/Additional/MentionLink.js","Utils/Message.js","Utils/Chat.js","Utils/BasicGroup.js","Utils/Channel.js","Components/Message/Media/Call.js","Components/Message/Media/Contact.js","Components/Message/Media/Game.js","Components/Message/Media/Venue.js","Components/Player/Steaming/Utils/Common.js","Components/Player/Steaming/Utils/Token.js","Components/Player/Steaming/MP3/ID3v1/ID3v1Token.js","Components/Player/Steaming/MP3/ID3v1/ID3v1Parser.js","Components/Player/Steaming/MP3/ID3v2/ID3v2Token.js","Components/Player/Steaming/MP3/ID3v2/FrameParser.js","Components/Player/Steaming/MP3/ID3v2/ID3v2Parser.js","Components/Player/Steaming/MP3/ID3Parser.js","Utils/Media.js","Stores/SupergroupStore.js","Stores/InstantViewStore.js","Components/InstantView/Blocks/Caption.js","Components/InstantView/Blocks/Anchor.js","Components/InstantView/Blocks/Animation.js","Components/InstantView/Blocks/AuthorDate.js","Components/InstantView/Blocks/Blockquote.js","Components/InstantView/Blocks/Collage.js","Components/InstantView/Blocks/Cover.js","Components/InstantView/Blocks/Details.js","Components/InstantView/Blocks/Divider.js","Components/Additional/IframeResizer.js","Components/InstantView/Blocks/Embedded.js","Components/InstantView/Blocks/EmbeddedPost.js","Components/InstantView/Blocks/ErrorHandler.js","Components/InstantView/Blocks/Footer.js","Components/InstantView/Blocks/Header.js","Components/InstantView/Blocks/Kicker.js","Components/InstantView/Blocks/ListItem.js","Components/InstantView/Blocks/List.js","Components/InstantView/Blocks/Paragraph.js","Components/InstantView/Blocks/Photo.js","Components/InstantView/Blocks/Preformatted.js","Components/InstantView/Blocks/PullQuote.js","Components/InstantView/Blocks/RelatedArticle.js","Components/InstantView/Blocks/RelatedArticles.js","Components/InstantView/Blocks/Slideshow.js","Components/InstantView/Blocks/Subheader.js","Components/InstantView/Blocks/Subtitle.js","Components/InstantView/Blocks/Title.js","Components/InstantView/RichText/Bold.js","Components/InstantView/RichText/EmailAddress.js","Components/InstantView/RichText/Fixed.js","Components/InstantView/RichText/Icon.js","Components/InstantView/RichText/Italic.js","Components/InstantView/RichText/Marked.js","Components/InstantView/RichText/PhoneNumber.js","Components/InstantView/RichText/Plain.js","Components/InstantView/RichText/Strikethrough.js","Components/InstantView/RichText/Subscript.js","Components/InstantView/RichText/Superscript.js","Components/InstantView/RichText/Anchor.js","Components/InstantView/RichText/Texts.js","Components/InstantView/RichText/Underline.js","Components/InstantView/RichText/Url.js","Components/InstantView/Blocks/Table.js","Components/InstantView/Blocks/TableCell.js","Components/InstantView/Blocks/Map.js","Components/InstantView/Blocks/Audio.js","Components/InstantView/Blocks/ChatLink.js","Components/InstantView/Blocks/Video.js","Components/InstantView/Blocks/VoiceNote.js","Utils/InstantView.js","Utils/Date.js","Components/InstantView/IVContext.js","Utils/HOC.js","Utils/Modal.js","Stores/BasicGroupStore.js","Components/Viewer/FileProgress.js","Assets/Icons/Download.js","Assets/Icons/PlayArrow.js","Utils/Phone.js","Components/ColumnMiddle/HeaderProgress.js","Localization/Cache.js","Stores/LocalizationStore.js","Components/Additional/SafeLink.js","registerServiceWorker.js","Utils/Url.js","Stores/OptionStore.js","Components/Tile/UserTile.js","Components/Message/Media/Animation.js","Stores/StickerStore.js","Components/Message/Media/Photo.js","Assets/Icons/Pause.js","Utils/Store.js","Stores/NotificationStore.js","Components/Tile/DocumentTile.js","Components/Message/Media/Location.js","Components/Message/Media/MediaStatus.js","Assets/Icons/Close.js","Components/Additional/KeyboardManager.js","Components/Message/Media/Audio.js","Components/Message/Media/VoiceNote.js","Components/Message/Media/AudioAction.js","Components/Message/Media/Video.js","Components/Message/Media/Waveform.js","Components/Message/Media/VoiceNoteSlider.js","Workers/BlobInflator.js","Workers/Helpers.js","Components/Message/Media/Sticker.js","Stores/AnimationStore.js","Actions/Poll.js","Components/Tile/UserStatus.js","Stores/PollStore.js","Components/Message/Media/FireworksControl.js","Components/Message/Media/PollRadio.js","Components/Message/Media/PollPercentage.js","Components/Message/Media/PollOption.js","Components/Tile/UserPlaceholder.js","Components/Popup/PollOptionResult.js","Components/Popup/PollOptionResults.js","Components/Popup/PollResultsDialog.js","Components/Message/Media/Poll.js","Actions/Chat.js","Components/Tile/UserTitle.js","Components/Tile/User.js","Components/Player/Player.js","Utils/Poll.js","Language.js","Utils/Supergroup.js","Assets/Icons/Check.js","Assets/Icons/DeletedAccount.js","Utils/Punycode.js","Components/Tile/VoiceNoteTile.js","Assets/Icons/FullScreen.js","Components/Player/Hint.js","Components/Player/Progress.js","Components/Message/Media/VideoNote.js","Assets/Icons/Document.js","Components/Message/Media/DocumentAction.js","Components/Message/Media/Document.js","Workers/pako.worker.js","Utils/Color.js","Theme.js","Assets/telegram-logo.svg","Stores/AuthorizationStore.js","Components/Auth/Country.js","Components/Auth/Phone.js","Components/Auth/QRCode.js","Components/Auth/Caption.js","Components/Auth/Code.js","Components/Auth/Password.js","Components/Auth/AuthErrorDialog.js","Components/Auth/AuthForm.js","Components/Additional/AppInactive.js","Components/Footer.js","Components/InactivePage.js","Components/Additional/NativeApp.js","Components/NativeAppPage.js","TelegramApp.js","index.js"],"names":["useReadFile","store","reset","callbacks","db","urls","WeakMap","dataUrls","Map","items","blobItems","locationItems","downloads","uploads","onUpdate","update","a","onUpdateAuthorizationState","set","file","onUpdateFile","suppressUpdateFile","emit","onClientUpdate","addTdLibListener","TdLibController","on","removeTdLibListener","off","authorization_state","initDB","handleDownloads","handleUploads","arr","id","idb_key","local","has","is_downloading_completed","get","delete","getStore","forEach","item","handleAnimation","handleAudio","handleChat","handleDocument","handleGame","handleLocation","handleMessage","handlePageBlockMap","handlePhoto","handleSticker","handleVideo","handleVideoNote","handleVoiceNote","handleUser","console","error","remote","is_uploading_completed","chat","getLocalFile","updateChatPhotoBlob","getRemoteFile","FILE_PRIORITY","user","updateUserPhotoBlob","message","content","animation","audio","photo","document","game","location","sticker","web_page","video","video_note","voice_note","venue","obj","chatId","chat_id","messageId","thumbnail","source","updateAnimationThumbnailBlob","THUMBNAIL_PRIORITY","updateAnimationBlob","album_cover_thumbnail","updateAudioThumbnailBlob","updateAudioBlob","updateDocumentThumbnailBlob","updateDocumentBlob","locationId","getLocationId","getLocationFile","updateLocationBlob","pageBlockMap","IV_LOCATION_WIDTH","IV_LOCATION_HEIGHT","i","sizes","length","photoSize","updatePhotoBlob","updateStickerThumbnailBlob","updateStickerBlob","voiceNote","voice","updateVoiceNoteBlob","videoNote","updateVideoNoteThumbnailBlob","updateVideoNoteBlob","updateVideoThumbnailBlob","updateVideoBlob","deleteLocalFile","fileId","getBlob","setBlob","blob","deleteBlob","setLocationFile","getDataUrl","setDataUrl","dataUrl","deleteDataUrl","getBlobUrl","url","URL","createObjectURL","deleteBlobUrl","updateFileBlob","type","clientUpdate","callback","this","initiatingDB","push","openDB","catch","log","Promise","resolve","reject","request","window","indexedDB","open","onsuccess","result","onerror","transaction","objectStore","faultCallback","send","file_id","response","data","then","Blob","event","target","priority","some","x","filter","only_if_pending","message_ids","revoke","userId","EventEmitter","controller","init","setParameters","parameters","verbosity","jsVerbosity","useTestDC","readOnly","fastUpdating","useDatabase","mode","dbname","req","existed","close","deleteDatabase","onupgradeneeded","databaseExists","exists","options","logVerbosityLevel","jsLogVerbosityLevel","prefix","isBackground","wasmUrl","WASM_FILE_NAME","WASM_FILE_HASH","JSON","stringify","client","TdClient","disableLog","search","params","URLSearchParams","toLowerCase","stringToBoolean","parseInt","VERBOSITY_MIN","VERBOSITY_MAX","VERBOSITY_JS_MIN","VERBOSITY_JS_MAX","tag","replace","split","tagVerbosity","streaming","sendTdParameters","process","confirm","href","version","packageJson","use_test_dc","api_id","api_hash","system_language_code","navigator","language","device_model","getBrowser","system_version","getOSName","application_version","use_secret_chats","use_message_database","use_file_database","database_directory","files_directory","new_verbosity_level","setChatId","ANIMATION_DURATION_200MS","ANIMATION_DURATION_300MS","APP_NAME","CHAT_SLICE_LIMIT","EMOJI_PICKER_TIMEOUT_MS","FILTER_COUNT_MAX","FILTER_TITLE_MAX_LENGTH","IV_PHOTO_SIZE","IV_PHOTO_DISPLAY_SIZE","KEY_AUTH_STATE","KEY_SUGGESTED_LANGUAGE_PACK_ID","LOCATION_HEIGHT","LOCATION_SCALE","LOCATION_WIDTH","LOCATION_ZOOM","MAX_SNACK","MEDIA_SLICE_LIMIT","MESSAGE_SLICE_LIMIT","MESSAGE_SPLIT_MAX_TIME_S","MUTED_VALUE_MAX","MUTED_VALUE_MIN","NOTIFICATION_AUDIO_DELAY_MS","NOTIFICATION_AUTO_HIDE_DURATION_MS","NOTIFICATION_DEBOUNCE_DELAY_MS","OPTIMIZATIONS_FIRST_START","PAGE_WIDTH_SMALL","PHOTO_BIG_SIZE","PHOTO_DISPLAY_SIZE","PHOTO_DISPLAY_SMALL_SIZE","PHOTO_DISPLAY_EXTRA_SMALL_SIZE","PHOTO_SIZE","PHOTO_THUMBNAIL_SIZE","PIP_PLAYER_BORDER_PRECISION","PLAYER_AUDIO_2X_MIN_DURATION","PLAYER_LOOP_MAX_DURATION","PLAYER_VOLUME_NORMAL","PLAYER_VOLUME_MIN","PLAYER_VOLUME_MAX","PLAYER_VOLUME_STEP","PLAYER_PLAYBACKRATE_MIN","PLAYER_PLAYBACKRATE_MAX","PLAYER_PLAYBACKRATE_STEP","PLAYER_PLAYBACKRATE_NORMAL","PLAYER_PLAYBACKRATE_FAST","PLAYER_PROGRESS_TIMEOUT_MS","PLAYER_SEEK_STEP_SMALL","PLAYER_SEEK_STEP_BIG","PLAYER_STREAMING_PRIORITY","PLAYER_PRELOAD_PRIORITY","PLAYER_PRELOAD_MAX_SIZE","POLL_QUESTION_LENGTH","POLL_QUESTION_HINT_LENGTH","POLL_QUESTION_MAX_LENGTH","POLL_OPTION_LENGTH","POLL_OPTION_HINT_LENGTH","POLL_OPTION_MAX_LENGTH","POLL_OPTIONS_MAX_COUNT","POLL_RESULTS_FIRST_SLICE_LENGTH","POLL_RESULTS_LEAVE_LENGTH","POLL_RESULTS_SLICE_LENGTH","PRELOAD_AUDIO_SIZE","PRELOAD_ANIMATION_SIZE","PRELOAD_DOCUMENT_SIZE","PRELOAD_STICKER_SIZE","PRELOAD_VOICENOTE_SIZE","PRELOAD_VIDEO_SIZE","PRELOAD_VIDEONOTE_SIZE","PROFILE_PHOTO_BIG_SIZE","PROFILE_PHOTO_SMALL_SIZE","SCROLL_PRECISION","SCROLL_CHATS_PRECISION","SERVICE_NOTIFICATIONS_USER_ID","SHARED_MESSAGE_SLICE_LIMIT","STICKER_DISPLAY_SIZE","STICKER_HINT_DISPLAY_SIZE","STICKER_PREVIEW_DISPLAY_SIZE","STICKER_SMALL_DISPLAY_SIZE","THUMBNAIL_BLURRED_SIZE_90","TYPING_INPUT_INTERVAL_S","TYPING_OUTPUT_INTERVAL_S","VOICENOTE_MIN_RECORD_DURATION","USERNAME_LENGTH_MIN","InputTypingManager","timeoutCallback","actions","timerId","handleTimer","bind","addAction","clearAction","setActionsTimeout","now","Date","expiredActions","key","expire","action","setSeconds","getSeconds","clearTimeout","timeout","actionTimeout","setTimeout","typingManagers","onlineMemberCount","counters","skippedUpdates","chatList","wallpaper","loadClientData","clientData","localStorage","parse","Object","keys","Number","saveClientData","Array","from","entries","reduce","value","String","setItem","state","updating","emitUpdate","updates","action_bar","assign","emitFastUpdate","setOnlineMemberCount","online_member_count","positions","draft_message","updateChatChatLists","is_marked_as_unread","last_message","MessageStore","notification_settings","UserStore","user_id","profile_photo","pinned_message_id","position","positionListEquals","last_read_inbox_message_id","unread_count","last_read_outbox_message_id","reply_markup_message_id","title","unread_mention_count","typingManager","getTypingManager","setTypingManager","client_data","setClientData","list","filter_id","idMap","source1","source2","supportsStreaming","serviceWorker","hasServiceWorker","getArrayBuffer","fr","FileReader","onload","readAsArrayBuffer","getSizeString","size","toFixed","getFileSize","saveBlob","filename","msSaveBlob","blobURL","tempLink","createElement","style","display","setAttribute","download","body","appendChild","click","removeChild","revokeObjectURL","loadReplies","messageIds","messages","map","setItems","loadReplyContents","FileStore","loadAnimationThumbnailContent","loadAudioThumbnailContent","loadPhotoContent","loadDocumentThumbnailContent","loadGameThumbnailContent","loadStickerThumbnailContent","loadVideoThumbnailContent","loadVideoNoteThumbnailContent","loadAudioContent","useFileSize","cancelLoadAnimationContent","cancelGetRemoteFile","loadAnimationContent","cancelLoadAnimationThumbnailContent","loadContactContent","contact","loadUserContent","loadDocumentContent","loadGameContent","width","height","zoom","scale","loadLocationContent","cancelLoadBigPhotoContent","getSize","loadBigPhotoContent","displaySize","getPhotoSize","loadPhotoThumbnailContent","thumbSize","getPhotoThumbnailSize","loadStickerContent","cancelLoadVideoContent","loadVideoContent","supports_streaming","cancelLoadVideoThumbnailContent","loadVideoNoteContent","loadVoiceNoteContent","loadMessageContents","users","replies","sender_user_id","reply_to_message_id","loadPhoto","loadUsersContent","saveMedia","media","file_name","saveOrDownload","saveAnimation","saveDocument","savePhoto","saveVideo","fileName","mime","saveData","can_be_downloaded","getViewerMinithumbnail","minithumbnail","getViewerThumbnail","getViewerFile","getMediaMiniPreview","getMediaPreviewFile","getMediaFile","mime_type","cancelLoadIVMediaViewerContent","blocks","cancelLoadMediaViewerContent","loadIVMediaViewerContent","useSizeLimit","loadMediaViewerContent","cancelPreloadIVMediaViewerContent","index","preload","cancelPreloadMediaViewerContent","history","preloadMediaViewerContent","preloadIVMediaViewerContent","loadUserFileContent","loadChatFileContent","ChatStore","loadProfileMediaViewerContent","photos","small","big","getChatUserId","getProfilePhoto","preloadProfileMediaViewerContent","ids","loadChatContent","full","loadChatPhotoContent","loadChatsContent","loadDraftContent","loadRecentStickersContent","recent","loadStickersContent","stickers","loadStickerSetContent","stickerSet","loadBackgroundsContent","backgrounds","background","loadBackgroundContent","is_animated","isGifMimeType","mimeType","getSrc","getDownloadedSize","is_downloading_active","downloaded_size","getUploadedSize","is_uploading_active","uploaded_size","getExtension","parts","pop","loadInstantViewContent","instantView","page_blocks","pageBlock","loadPageBlockContent","b","caption","author","loadRichTextContent","text","credit","cover","header","poster_photo","author_photo","footer","kicker","loadPageBlockMapContent","articles","subheader","subtitle","cells","row","t","texts","compareMaps","map1","map2","testVal","val","undefined","isMobile","userAgent","indexOf","isIOS","isWindowsPhone","platform","test","MSStream","match","isAppleDevice","OSName","isEdge","documentMode","StyleMedia","string","trim","Boolean","orderCompare","order1","order2","diff","dimension","iSize","find","useWidth","Math","abs","currDiff","getFitSize","max","stretch","floor","itemsInView","scrollContainerRef","itemsContainerRef","scrollContainer","current","itemsContainer","children","child","offsetTop","offsetHeight","scrollTop","throttle","func","wait","context","args","previous","later","leading","apply","remaining","arguments","trailing","debounce","immediate","callNow","getFirstLetter","str","char","toUpperCase","getLetters","readImageSize","reader","addEventListener","image","Image","src","readAsDataURL","arrayBufferToBase64","buffer","binary","bytes","Uint8Array","len","byteLength","fromCharCode","btoa","isAuthorizationReady","between","first","last","clamp","getDurationString","secondsTotal","duration","reverse","hours","minutes","seconds","getRandomInt","min","ceil","random","historyEquals","second","insertByOrder","array","element","comparator","slice","ActionScheduler","actionCallback","cancelCallback","add","cancel","setMilliseconds","getMilliseconds","invoke","remove","expired","onWindowResize","isSmallWidth","nextIsSmallWidth","innerWidth","dialogsReady","cacheLoaded","setPhoneNumberRequest","dialogChatId","statistics","authorizationState","defaultPhone","connectionState","isChatDetailsVisible","mediaViewerContent","profileMediaViewerContent","dragParams","actionScheduler","handleScheduledAction","handleCancelScheduledAction","addScheduledAction","invokeScheduledAction","removeScheduledAction","loggingOut","subscribeNotifications","closeChat","logOut","alert","visibility","recording","extendedUpdate","nextChatId","nextMessageId","previousChatId","previousMessageId","dragging","files","phone","setPhoneNumber","name","focused","inProgress","phone_number","onUpdateStatistics","count","addStatistics","app","RepeatEnum","freeze","NONE","REPEAT","REPEAT_ONE","playbackRate","audioPlaybackRate","volume","repeat","shuffle","pipParams","left","documentElement","clientWidth","top","clientHeight","times","closeInternal","playlist","time","videoStream","block","getPlaylist","savePlayerSettings","playing","moveToNextMedia","moveToPrevMedia","moveNext","currentTime","buffered","timestamp","isCurrentSource","start","end","preloadNextMedia","videoWidth","videoHeight","stream","findIndex","playlistItemEquals","nextIndex","nextItem","expected_size","offset","limit","download_offset","downloaded_prefix_size","synchronous","openPlaylistItem","useRepeatShuffle","getCurrentTime","uniqueId","setCurrentTime","info","clearCurrentTime","currentPlaylist","totalCount","getSearchMessagesFilter","query","from_message_id","total_count","getValidBlocks","isValidAudioBlock","isValidVoiceNoteBlock","loadPlayerSettings","player","getItem","openMedia","openInstantViewMedia","selectedItems","message_id","reply_markup","edit_date","views","new_content","old_content","oldPhoto","newPhoto","oldSize","newSize","oldBlob","is_listened","is_viewed","old_message_id","sending_state","error_code","error_message","clear","selected","deletedMessage","RichText","props","getRichText","propTypes","PropTypes","object","isRequired","fullInfoItems","setFullInfo","user_full_info","status","myId","OptionStore","fullInfo","observers","events","listener","l","cloned","concat","observer","item1","item2","getMediaTitle","k","getAudioTitle","getAuthor","getMessageAudio","getBlockAudio","unique_id","PlayerStore","getMediaMimeType","getMediaSrc","openArchive","editMessage","deleteMessages","replyMessage","forward","forwardMessages","openUser","popup","openChat","openReply","highlightMessage","selectMessage","clearSelection","setInstantViewViewerContent","setMediaViewerContent","setProfileMediaViewerContent","setInstantViewContent","searchChat","getUserStatus","was_online","wasOnline","getTime","today","setHours","dateFormat","yesterday","setDate","getDate","isUserOnline","getUserFullName","first_name","last_name","getUserShortName","getUserLetters","firstName","lastName","letters","firstNameSymbol","charAt","lastNameSymbol","getUserStatusOrder","expires","getProfilePhotoDateHint","userProfilePhoto","added_date","date","isDeletedUser","currency","symbol","includes","totalAmount","amount","pow","getPow","serviceMap","isServiceMessage","ttl","getServiceMessageContent","isOutgoing","getMyId","isChannel","is_channel","MessageAuthor","members","member_user_ids","accumulator","separator","ttlString","days","getTTLString","messageGame","game_message_id","score","passportElementTypes","types","getPassportElementTypeString","messageInvoice","invoice_message_id","invoice","Currency","getString","total_amount","getMessageAuthor","pinnedMessage","pinnedContent","substring","domain_name","onUpdateUser","fullName","getFullName","setState","onUpdateChatTitle","handleSelect","stopPropagation","openUserCommand","openChatCommand","nextProps","nextState","nextContext","tileColor","isPrivateChat","className","classNames","onClick","prevChatId","prevUserId","React","Component","getChatTitle","defaultProps","withTranslation","MentionLink","handleClick","preventDefault","username","isGroupChat","handleClose","handleDialogClick","Dialog","manager","modalManager","transitionDuration","onClose","aria-labelledby","DialogTitle","DialogContent","classes","root","DialogContentText","DialogActions","Button","prevUsername","isMetaBubble","isMessageUnread","is_outgoing","isMe","isMeChat","forward_info","getTitle","searchCurrentChat","AppStore","getFormattedText","formattedText","entities","deleteLineBreakAfterPre","entity","textBefore","textBeforeLength","substr","entityKey","entityText","command","rel","SafeLink","textAfter","getText","meta","getWebPage","d","getDateHint","isForwardOriginHidden","forwardInfo","origin","getForwardTitle","sender_name","author_signature","getSenderUserId","filterDuplicateMessages","filterMessages","getContent","poll","question","emoji","isMediaContent","longitude","latitude","isVideoMessage","isAnimationMessage","isContentOpened","hasVoice","useAudioPlaybackRate","hasAudio","hasVideoNote","openAnimation","fileCancel","cancelUploadFile","openAudio","openDocument","endsWith","isLottieMessage","openPhoto","openSticker","set_id","openVideo","openVideoNote","openVoiceNote","openChatPhoto","openContact","openGame","isDeletedMessage","getReplyMinithumbnail","getReplyPhotoSize","getEmojiMatches","textContent","m","lastIndex","emojiMatches","re","emojiRegex","exec","messageComparatorDesc","right","checkInclusion","checkIntersection","startIndex","endIndex","checkEntity","removeOffsetAfter","countToRemove","e","addOffsetAfter","countToAdd","removeEntities","entityStart","entityEnd","splice","addTextNode","nodes","node","createTextNode","getNodes","sort","prevEntity","innerText","dataset","getDecodedUrl","getEntities","getBoldItalicEntities","isPre","lastChar","firstChar","getMonoPreEntities","DOMParser","parseFromString","finalText","childNodes","nodeName","getHTMLEntities","join","compareEntities","offsetA","offsetB","getUrlMentionHashtagEntities","regExp","urlRegExp","getUrlEntities","mentionHashtagRegExp","ch","getMentionHashtagEntities","twitterInstagramEntities","getTwitterInstagramEntities","patternType","foundText","c","checkString","checkChar","prevChar","canMessageBeEdited","can_be_edited","showMessageForward","isTextMessage","isMessagePinned","canMessageBeUnvoted","is_closed","is_chosen","is_being_chosen","canMessageBeClosed","canMessageBeForwarded","can_be_forwarded","canMessageBeDeleted","can_be_deleted_only_for_self","can_be_deleted_for_all_users","getMessageStyle","maxWidth","fitSize","getChatPosition","chat_filter_id","isChatPinned","is_pinned","hasChatList","getChatOrder","order","chatListEquals","list1","list2","p1","p2","canUnpinMessage","isChatArchived","archivePosition","canAddChatToList","is_sponsored","draftEquals","draft1","draft2","inputMessageText1","input_message_text","replyToMessageId1","inputMessageText2","formattedText1","formattedText2","text1","entities1","text2","entities2","every","entitiesEquals","getChatTypingString","typingString","inputTypingManager","values","next","getPrivateChatTypingString","firstUser","secondUser","second_name","getGroupChatTypingString","getMessageSenderFullName","getMessageSenderName","getLastMessageSenderName","getLastMessageContent","showChatUnreadMentionCount","showChatUnreadCount","isChatUnread","isChatMuted","use_default_mute_for","mute_for","settings","NotificationStore","isChannelChat","getScopeNotificationSettings","getChatMuteFor","getMessageDate","dayStart","day","getDay","weekStart","getLastMessageDate","showChatDraft","getChatSubtitleWithoutTyping","basicGroup","BasicGroupStore","basic_group_id","member_count","is_member","onlineCount","getOnlineMemberCount","getBasicGroupStatus","supergroup","SupergroupStore","supergroup_id","getFullInfo","getChannelStatus","getSupergroupStatus","getChatSubtitle","showSavedMessages","chatTypingString","getChatLetters","isAccentChatSubtitleWithoutTyping","isAccentChatSubtitle","getChatUsername","getChatPhoneNumber","formatPhoneNumber","getChatBio","description","bio","isChatMember","getChatType","isBotChat","is_contact","is_mutual_contact","isContactChat","isDeletedPrivateChat","getGroupChatMembers","fallbackValue","getChatFullInfo","hasBasicGroupId","basicGroupId","isSupergroup","getSupergroupId","hasSupergroupId","supergroupId","getPhotoFromChat","canSendMediaMessages","globalPermissions","permissions","can_send_media_messages","getChatShortTitle","canClearHistory","canDeleteChat","canSendPolls","can_send_polls","canSendMessages","can_send_messages","getChatDraft","getChatDraftReplyToMessageId","replyToMessageId","canPinMessages","can_pin_messages","isChatVerified","is_verified","isChatSecret","isCreator","getChatTypeId","Call","callTitle","getCallTitle","durationString","IconButton","color","aria-label","fontSize","Contact","number","UserTile","Game","Animation","fitPhotoSize","Photo","Venue","venueTitle","address","Location","strtokBITSET","buf","bit","decodeString","encoding","label","TextDecoder","decode","readUTF16String","readUTF8String","readWindows1292String","Error","UINT32SYNCSAFE","UINT8","UINT32_BE","UINT24_BE","UINT16_BE","ASCII_TEXT","Id3v1StringType","pos0","trimRightNull","ID3v1Header","artist","album","year","comment","zeroByte","track","genre","ID3v1Parser","hasID3v1Header","ID3v2Header","fileIdentifier","major","revision","flags","raw","unsynchronisation","isExtendedHeader","expIndicator","ExtendedHeader","extendedFlags","sizeOfPadding","crcDataPresent","crcData","TextEncodingToken","bom","FrameParser","output","debug","splitValue","trimArray","ID3v2Parser","tags","frameHeaderLength","getFrameHeaderLength","id3Header","frameHeaderBytes","frameHeader","readFrameHeader","frameDataBytes","readFrameData","extendedHeader","parseId3Data","dataLen","parseMetadata","parseExtendedHeader","readI","writeI","majorVer","includeCovers","warningCollector","frameParser","readData","format","removeUnsyncBytes","data_length_indicator","tag_alter_preservation","file_alter_preservation","read_only","grouping_identity","compression","encryption","v","readFrameFlags","hasID3v2Header","ID3Parser","arrayBuffer","id3Tags","artistTag","titleTag","waveformCache","getNormalizedWaveform","atob","charCodeAt","waveform","barsCount","byteIndex","barPadding","bits","discard_reason","isEditedMedia","isValidAnimatedSticker","isBlurredThumbnail","blurredSize","performer","trimmedTitle","trimmedPerformer","getAudioShortTitle","getAudioSubtitle","getStickers","sets","getNeighborStickersFromSets","stickersPerRow","setIndex","stickerIndex","prevRows","toRowColumn","column","prevPrevRow","prevRow","nextRow","nextNextRow","prevColumn","nextColumn","skipPrevRow","skipPrePrevRow","toIndex","totalRows","skipNextRow","skipNextNextRow","setRow","setColumn","getInputMediaThumbnail","getInputMediaCaption","getInputMediaContent","live_period","added_sticker_file_ids","getMedia","hasTitle","hasCaption","inlineMeta","Audio","duraton","discardReason","Document","Poll","Sticker","StickerSourceEnum","MESSAGE","Video","VideoNote","VoiceNote","getMediaTags","trunc","getMediaDocumentFromFile","album_cover_minithumbnail","getMediaPhotoFromFile","startsWith","has_stickers","prevSupergroup","supergroup_full_info","viewerContent","prevInstantView","Caption","hasText","isEmptyText","hastCredit","Anchor","need_autoplay","AuthorDate","publishDate","hasAuthor","hasDate","dateTime","toISOString","Blockquote","withIV","pageBlocks","iv","getPageBlock","Cover","isOpen","Divider","IframeResizer","updateIframe","frame","frameRef","doc","contentDocument","write","ReactDOM","render","getElementById","injectIframeResizerUrl","iframeResizerUrl","injectTarget","tagName","found","getElementsByTagName","resizerScriptElement","onLoad","resizeIframe","iframeResizerEnable","iframeResizerLib","iframeResizerOptions","createRef","iframeResizer","removeListeners","frameBorder","ref","minHeight","Embedded","setIframeSource","prevProps","prevState","snapshot","html","isFullWidth","allowScrolling","scrolling","hasWidthHeight","hasSource","srcDoc","allowFullScreen","prevUrl","prevHtml","authorPhoto","ErrorHandler","errorInfo","componentStack","Footer","Header","Kicker","data-before","List","Paragraph","Preformatted","PullQuote","RelatedArticle","hasAuthorDateSeparator","hasAuthorDate","RelatedArticles","publish_date","Subheader","Subtitle","Title","Bold","EmailAddress","emailAddress","Fixed","Icon","onClientUpdateDocumentThumbnailBlob","forceUpdate","onClientUpdateDocumentBlob","thumbnailSrc","emptyPlaceholderSrc","draggable","alt","Italic","Marked","PhoneNumber","phoneNumber","Plain","Strikethrough","Subscript","Superscript","Texts","Underline","Url","isBordered","isStriped","striped","border","rowIndex","TableCell","isHeader","colspan","rowspan","align","valign","attributes","colSpan","rowSpan","getHorizontalAlignment","getVerticalAlignment","ChatLink","needAutoplay","isLooped","is_open","posterPhoto","is_full_width","allow_scrolling","is_bordered","is_striped","is_header","is_looped","richText","email_address","getInnerBlocks","innerBlocks","getBlockMedia","getBlockCaption","getBlockUrl","isValidMediaBlock","token","timezone","timezoneClip","mask","utc","gmt","kindOf","isNaN","TypeError","maskSlice","masks","_","D","y","H","M","s","L","o","getTimezoneOffset","W","getWeek","N","getDayOfWeek","dd","pad","ddd","i18n","dayNames","dddd","mm","mmm","monthNames","mmmm","yy","yyyy","h","hh","HH","MM","ss","round","timeNames","tt","T","TT","Z","S","targetThursday","getFullYear","getMonth","firstThursday","ds","getHours","weekDiff","dow","isArray","toString","call","default","shortDate","mediumDate","longDate","fullDate","shortTime","mediumTime","longTime","isoDate","isoTime","isoDateTime","isoUtcDateTime","expiresHeaderFormat","IVContext","createContext","IVComponent","Consumer","displayName","getDisplayName","compose","funcs","arg","withSaveRef","forwardRef","forwardedRef","withRestoreRef","rest","WrappedComponent","ModalManager","basic_group","basic_group_full_info","groupId","group","basicgroup","FileProgress","currentFile","nextFile","fileEquals","prevFile","isDownloading","wasActive","isActive","isUploading","upload","getProgressParams","isCompleted","progressSize","completeAnimation","prevPropsFile","icon","nextLocal","nextIdbKey","prevLocal","prevIdbKey","isDownloadingCompleted","receiveIdbKey","mount","file1","file2","local1","remote1","local2","remote2","can_be_deleted","path","cancelButton","zIndex","completeIcon","progress","circle","variant","thickness","createSvgIcon","transform","loadData","fetch","lines","data2","code","pattern","clearPhone","getCountryFromPhone","option","isPhoneWithOptionCode","country","formatByPattern","HeaderProgress","Storage","getDefaults","expirationTime","Infinity","versions","Cache","services","storage","namespace","nowMS","i18nStamp","i18nVersion","fallbackLng","defaultNS","lng","use","initReactI18next","ns","fallbackNS","resources","en","auth","QRHint","LogInByPhone","LogInViaQR","ChatsAndContacts","SearchMessagesIn","ContactJoinedEnabled","ContactJoinedDisabled","NotificationsEnabled","NotificationsDisabled","PreviewEnabled","PreviewDisabled","BioAbout","Archived","Saved","EditProfile","GeneralSettings","FilterChooseChats","FilterCreateError","CopyMessageLink","DragToReposition","PollQuizOneRightAnswer","LeftChannel","LeftGroup","EnterPassword","YourAccountProtectedWithPassword","DeletedMessage","YourPhone","SignInToTelegram","Country","KeepMeSignedIn","StartText","Next","InvalidPhoneNumber","More","SendFileConfirmation","SendFilesConfirmation","SendMessage","ChatInfo","ChannelInfo","Stickers","Emoji","SelectChatToStartMessaging","Text","ViewChannelInfo","ViewGroupInfo","ViewProfile","GoToMessage","PhotosTitle","VideosTitle","VoiceTitle","UpdateDraftConfirmation","RecordDeniedTitle","RecordDeniedDescription","Search","NotEmojiFound","ChooseDefaultSkinTone","SearchResults","Recent","SmileysPeople","AnimalsNature","FoodDrink","Activity","TravelPlaces","Objects","Symbols","Flags","Custom","translation","AppName","Connecting","ConnectingToProxy","Loading","Updating","WaitingForNetwork","ContinueOnThisLanguage","SendAsFile","SendAsPhoto","ru","it","es","pl","interpolation","escapeValue","react","cache","LocalizationCache","enabled","defaultResources","read","err","currentResources","addResourceBundle","only_local","loadLanguage","changeLanguage","processStrings","languagePackStrings","strings","zero_value","one_value","two_value","few_value","many_value","other_value","language_pack_id","save","localization","handleDone","newWindow","opener","handleSafeClick","isTelegramLink","messageLinkInfo","lowerCaseUrl","decodedUrl","safe","displayText","mail","prevDisplayText","isUrlSafe","getHref","isLocalhost","hostname","register","swUrl","registerValidSW","checkValidServiceWorker","registration","onupdatefound","installingWorker","installing","onstatechange","ready","pushManager","getSubscription","pushSubscription","unsubscribe","subscribe","userVisibleOnly","endpoint","p256dh_base64url","getKey","auth_base64url","deviceToken","device_token","other_user_ids","enableSound","headers","unregister","reload","requests","processRequest","filePart","getFilePart","promise","onmessage","postMessage","regExpRTLO","hasRTLOSymbol","decodedHref","decodeURI","domain","punycode","ToUnicode","regExpDomainExplicit","RegExp","regExpDomain","regExpProtocol","validateUrl","trimmed","domainMatch","protocolMatch","isGoodProtocol","onClientUpdateUserBlob","loaded","onSelect","handleLoad","fistName","dialog","pointer","tileLoaded","startStopPlayer","videoRef","windowFocused","inView","openMediaViewer","openProfileMediaViewer","openIV","ivInView","openIVMedia","pickerInView","play","pause","onClientUpdateInstantViewContent","InstantViewStore","getCurrent","onClientUpdateProfileMediaViewerContent","onClientUpdateMediaViewerContent","onClientUpdateInstantViewViewerContent","onClientUpdateFocusWindow","onClientUpdateMessagesInView","onClientUpdateBlocksInView","onClientUpdateAnimationsInView","animations","onClientUpdateAnimationBlob","onClientUpdateAnimationThumbnailBlob","handlePlay","handleTimeUpdate","setPlayerParams","hasFocus","load","AnimationStore","showProgress","animationStyle","minWidth","miniSrc","isBlurred","isGif","muted","autoPlay","loop","playsInline","onPlay","onTimeUpdate","enhance","hint","animationData","sticker_set_ids","is_installed","foundStickers","onClientUpdatePhotoBlob","thumbSrc","photoStyle","hasSrc","thumbnailSize","prevPhoto","isMessageMuted","contains_unread_mention","hasMention","use_default_disable_mention_notifications","disable_mention_notifications","getChatDisableMentionNotifications","hasPinnedMessage","use_default_disable_pinned_message_notifications","disable_pinned_message_notifications","getChatDisablePinnedMessageNotifications","chatStore","messageStore","appInactive","newMessages","timerHandler","nextSoundAt","onTimer","unreadCount","getUnreadCount","chatMap","newChatMap","updateTimer","is_permanent","filterMap","scope","setInterval","clearInterval","notifications","DocumentTile","onClientUpdateLocationBlob","locationStyle","MediaStatus","onUpdateMessageContentOpened","isOpened","openedIcon","KeyboardHandler","onKeyDown","handleKeyDown","handlers","handler","onClientUpdateMediaEnd","active","onClientUpdateMediaPlay","onClientUpdateMediaPause","onClientUpdateMediaActive","playerBlock","audioTitle","audioSubtitle","opacity","AudioAction","onClientUpdateMediaSeeking","playerDuration","seekProgress","seeking","timeString","getTimeString","onClientUpdateMediaSeek","onClientUpdateMediaTime","audioDuration","isDownloadingActive","isUploadingActive","sizeString","currentTimeString","onClientUpdateVideoThumbnailBlob","videoStyle","Waveform","transition","svg","viewBox","VoiceNoteSlider","onClientUpdateMediaLoadedMetadata","onClientUpdateMediaProgress","getValue","prevCurrentTime","handleMouseDown","handleChange","handleChangeCommitted","bufferedTime","Player","getBufferedTime","bufferedValue","Slider","thumb","rail","step","onChange","onChangeCommitted","onMouseDown","prevMessageId","prevBlock","currentBlock","worker","PakoWorker","inflateBlob","msg","Lottie","lazy","HINTS","PICKER_HEADER","PICKER","PREVIEW","STICKER_SET","UNKNOWN","startStopAnimation","onClientUpdateDialogChatId","ApplicationStore","onClientUpdateStickerPreview","stickerPreview","onClientUpdateStickerSet","openedStickerSet","onClientUpdateStickerBlob","loadContent","onClientUpdateStickerThumbnailBlob","autoplay","isAnimated","handleMouseEnter","handleAnimationMouseEnter","entered","lottieRef","loopCount","handleAnimationLoopComplete","handleAnimationMouseOut","StickerStore","animationDate","hasError","blur","paused","preview","Suspense","fallback","renderer","rendererSettings","preserveAspectRatio","clearCanvas","progressiveLoad","hideOnTransparent","eventListeners","eventName","onMouseOut","stickerStyle","onMouseEnter","prevSticker","savedAnimations","animationsInView","setPollAnswer","optionIds","option_ids","cancelPollAnswer","stopPoll","UserStatus","onUpdateUserStatus","isAccent","allow_multiple_answers","is_anonymous","isAnonymous","newType","correct_option_id","isValidPoll","Particle","fireworks","colorType","side","typeSize","xFinished","finishedStart","rotation","moveX","moveY","ctx","fillStyle","beginPath","arc","PI","fill","translate","rotate","radius","stroke","tl","tr","br","bl","defaultRadius","moveTo","lineTo","quadraticCurveTo","closePath","roundRect","restore","dt","moveCoef","wasNegative","speedCoef","fallingDownCount","getMeasuredHeight","Fireworks","particlesCount","fallParticlesCount","particles","canvas","fall","particle","colors","getMeasuredWidth","xOffset","yOffset","started","startedFall","lastUpdateTime","createParticle","draw","newTime","clearRect","p","startFall","requestAnimationFrame","FireworksComponent","onResize","canvasRef","parentNode","attachToParent","detachFromParent","removeEventListener","getContext","pointerEvents","PollRadio","chosen","beingChosen","hidden","Radio","colorPrimary","disabled","TouchRippleProps","checked","checkedIcon","CircularProgress","PollPercentage","updateAnimation","stopAnimation","handle","onAnimationFrame","cancelAnimationFrame","startTime","to","timePassed","animated","prevPropsValue","closed","theme","PollOption","getTitleString","canBeSelected","onVote","maxVoterCount","isCorrect","voter_count","vote_percentage","isMultiChoosen","Close","Check","LinearProgress","bar","UserPlaceholder","showStatus","titleWidth","sin","contentWidth","cos","marginLeft","PollOptionResult","User","ListItem","button","PollOptionResults","handleShowMore","newOffset","newCount","updateVoters","handleCollapse","voters","loadMore","optionId","option_id","user_ids","offset2","isQuiz","results","voterCount","showMoreButton","showMoreCount","showMore","fullWidth","showCollapse","PollResultsDialog","onClientUpdateClosePollResults","handleContextMenu","PollStore","container","paper","onContextMenu","getTotalVoterCountString","handleSubmit","viewResults","handleVote","handleOpenResults","viewResultsPoll","handleCloseResults","fireworksRef","total_voter_count","recent_voter_user_ids","isSelected","showViewResults","showButton","buttonEnabled","recentVoters","marginRight","getOptionType","getOptionIsCorrect","textPrimary","changeChatDetailsVisibility","openPinnedChat","chat_list","offset_order","offset_chat_id","chats","pinnedIndex","chat_ids","addChatToList","toggleChatIsPinned","isPinned","toggleChatIsMarkedAsUnread","isMarkedAsUnread","toggleChatNotificationSettings","isMuted","muteFor","newNotificationSettings","getChatCounters","promises","photoCounter","return_local","videoCounter","documentCounter","audioCounter","urlCounter","voiceAndVideoNoteCounter","all","UserTitle","altKey","ctrlKey","metaKey","shiftKey","handled","handleSeek","handleVolume","handleMute","handleFullScreen","handlePictureInPicture","handleSeekProgress","handlePlaybackRate","showMediaHint","rate","onClientUpdateMediaShortcut","waiting","handlePause","onPause","handleEnded","onEnded","handleLoadedData","handleLoadedMetadata","draggingTime","isFinite","contentRef","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","exitFullscreen","requestFullscreen","handleClickRoot","mouseDownRoot","handleMouseDownRoot","handleVolumeChange","onVolumeChange","handleVolumeSliderChange","handleVolumeSliderChangeCommitted","activeElement","prevVolume","handleProgress","handleWaiting","handleCanPlay","videoInfo","pictureInPictureElement","mozPictureInPictureElement","webkitPictureInPictureElement","exitPictureInPicture","requestPictureInPicture","onpause","handleLeavePictureInPicture","handleDoubleClick","handleVideoKeyDown","handlePanelDoubleClick","handlePanelEnter","panelEnter","handlePanelLeave","handleMouseOver","mouseOverTimeout","rootRef","noPoster","method","mozRequestFullScreen","webkitRequestFullscreen","mozCancelFullScreen","webkitExitFullscreen","mozRequestPictureInPicture","webkitRequestPictureInPicture","mozExitPictureInPicture","webkitExitPictureInPicture","poster","rootStyle","fullscreenEnabled","mozFullScreenEnabled","webkitFullscreenEnabled","onDoubleClick","onMouseMove","controls","onLoadedMetadata","onLoadedData","onCanPlay","onProgress","onWaiting","onMouseLeave","getVolumeIcon","isValidQuestion","noneEmptyOptions","isValidOption","hasPollData","withLanguage","LanguageWrapper","LocalizationStore","isPublicSupergroup","strokeWidth","strokeLinejoin","cx","cy","r","utf16","input","extra","RangeError","encode","base","damp","tmin","tmax","skew","maxint","encode_digit","flag","adapt","delta","numpoints","firsttime","preserveCase","n","out","bias","basic","j","ic","oldi","w","digit","cp","case_flags","input_length","lastIndexOf","q","ijv","bcp","ToASCII","domain_array","VoiceNoteTile","Hint","onClientUpdateMediaHint","checkTimeout","handleAnimationEnd","onAnimationEnd","Progress","strokeDasharray","strokeDashoffset","strokeLinecap","circleStyle","onClientUpdateMediaCaptureStream","srcObject","updateVideoSrc","videoDuration","onClientUpdateVideoNoteBlob","onClientUpdateVideoNoteThumbnailBlob","sourceRef","getTracks","stop","progressTime","fillRule","mixBlendMode","DocumentAction","Download","data-name","data-ext","module","exports","Worker","getBadgeSelectedColor","rgb","primaryHLS","g","cmin","cmax","RGBToHSL","createTheme","primary","MuiTouchRipple","rippleVisible","hover","hoverOpacity","createMuiTheme","palette","secondary","main","typography","useNextVariants","shape","borderRadius","overrides","MuiOutlinedInput","padding","MuiAutocomplete","paddingLeft","paddingTop","paddingRight","paddingBottom","maxHeight","MuiButton","lineHeight","MuiMenuList","MuiList","MuiListItemIcon","alignItemsFlexStart","marginTop","MuiMenuItem","setProperty","modal","dark","light","grey","divider","updateDarkTheme","updateLightTheme","withTheme","ThemeWrapper","onClientUpdateThemeChanging","themeOptions","StylesProvider","injectFirst","_extends","prototype","hasOwnProperty","_objectWithoutProperties","excluded","sourceKeys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_ref","svgRef","ForwardRef","setCountryCode","removeItem","authorization","cleanProgressStatus","isConnecting","AuthStore","isWhitelistKey","Phone","onClientUpdateCountryCode","getPhoneCountry","onUpdateConnectionState","connecting","onClientUpdateSetPhoneCanceled","loading","onClientUpdateSetPhoneError","errorString","onClientUpdateSetPhoneResult","onUpdateOption","setSuggestedLanguagePackId","handleKeyPress","isBad","isValidPhoneNumber","handleChangeLanguage","suggestedLanguage","nextLanguage","handleFilterOptions","inputValue","names","handleCountryChange","nextCountry","prevPhone","nextPhone","trimStart","phoneInputRef","focus","handleKeepChange","keep","handlePhoneChange","phone1","phone2","handlePaste","plainText","clipboardData","getData","execCommand","handleQRCode","onRequestQRCode","getCountryFromCode","languagePackId","autoComplete","Typography","Autocomplete","noOptionsText","autoHighlight","getOptionLabel","renderOption","renderInput","TextField","inputProps","filterOptions","inputRef","helperText","autoFocus","onKeyPress","onPaste","Checkbox","disableElevation","Link","QRCode","showConnecting","handleBack","onChangePhone","qrCode","QRCodeStyling","link","dotsOptions","backgroundOptions","innerHTML","append","closeData","json","idleData","peekData","trackingData","lastUpdate","onClientUpdateMonkeyIdle","onClientUpdateMonkeyTracking","onClientUpdateMonkeyClose","onClientUpdateMonkeyPeek","anim","playSegments","prevCode","peek","control","Code","handleNext","isValid","finally","codeLength","codeInfo","getPhoneNumber","getCodeLength","getSubtitle","maxLength","Password","password","handleMouseDownPassword","handleClickShowPassword","showPassword","sendMonkeyPeek","passwordHint","FormControl","InputLabel","htmlFor","OutlinedInput","endAdornment","InputAdornment","edge","labelWidth","FormHelperText","AuthErrorDialog","handleAuthError","AuthForm","terms_of_service","code_info","termsOfService","password_hint","has_recovery_email_address","recovery_email_address_pattern","hasRecoveryEmailAddress","recoveryEmailAddressPattern","AppInactive","handleReload","PureComponent","InactivePage","NativeApp","handleInstall","NativeAppPage","MainPage","TelegramApp","keyCode","isComposing","keyMap","modals","editMessageId","replyMessageId","force","onClientUpdateEditMessage","onClientUpdateReply","onClientUpdateTdLibDatabaseExists","tdlibDatabaseExists","checkServiceWorker","registerServiceWorker","onUpdateFatalError","fatalError","onClientUpdateAppInactive","inactive","handleChangePhone","changePhone","handleRequestQRCode","handleDragOver","handleDrop","handleRefresh","handleDestroy","prevAuthorizationState","AuthorizationStore","nativeMobile","isSmall","keyboardHandler","KeyboardManager","page","onDragOver","onDrop","aria-describedby","onblur","onfocus","pushState","onpopstate","go","withTelegramTheme","component"],"mappings":"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","file":"static/js/main.a1e43a97.chunk.js","sourcesContent":["/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport { getLocationId } from '../Utils/Message';\nimport { FILE_PRIORITY, IV_LOCATION_HEIGHT, IV_LOCATION_WIDTH, THUMBNAIL_PRIORITY } from '../Constants';\nimport TdLibController from '../Controllers/TdLibController';\n\nconst useReadFile = true;\nconst useDownloadFile = true;\n\nclass FileStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n\n        // this.suppressUpdateFile = true;\n    }\n\n    reset = () => {\n        this.callbacks = [];\n\n        //this.transactionCount = 0;\n        this.db = null;\n        this.urls = new WeakMap();\n        this.dataUrls = new Map();\n        this.items = new Map();\n        this.blobItems = new Map();\n        this.locationItems = new Map();\n\n        this.downloads = new Map();\n        this.uploads = new Map();\n    };\n\n    onUpdate = async update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                await this.onUpdateAuthorizationState(update);\n\n                break;\n            }\n            case 'updateFile': {\n                this.set(update.file);\n\n                this.onUpdateFile(update);\n\n                if (!this.suppressUpdateFile) {\n                    this.emit(update['@type'], update);\n                }\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateAnimationBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateAnimationThumbnailBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateAudioBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateAudioThumbnailBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateChatBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateDocumentBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateDocumentThumbnailBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateLocationBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdatePhotoBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateStickerBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateStickerThumbnailBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateUserBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateVideoBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateVideoThumbnailBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateVideoNoteBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateVideoNoteThumbnailBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateVoiceNoteBlob': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateSendFiles': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    onUpdateAuthorizationState = async update => {\n        if (!update) return;\n\n        const { authorization_state } = update;\n        if (!authorization_state) return;\n\n        switch (authorization_state['@type']) {\n            case 'authorizationStateWaitTdlibParameters': {\n                await this.initDB();\n                break;\n            }\n            case 'authorizationStateClosed': {\n                this.reset();\n                break;\n            }\n        }\n    };\n\n    onUpdateFile = update => {\n        if (!update) return;\n\n        const { file } = update;\n        if (!file) return;\n\n        this.handleDownloads(file);\n        this.handleUploads(file);\n    };\n\n    handleDownloads = file => {\n        const { arr, id, idb_key, local } = file;\n        delete file.arr;\n\n        if (!this.downloads.has(id)) return;\n        if (!local.is_downloading_completed) return;\n        if (!useReadFile && !idb_key && !arr) return;\n\n        const items = this.downloads.get(id);\n        if (!items) return;\n\n        this.downloads.delete(id);\n\n        const store = this.getStore();\n\n        items.forEach(item => {\n            switch (item['@type']) {\n                case 'animation': {\n                    this.handleAnimation(store, item, file, arr, null);\n                    break;\n                }\n                case 'audio': {\n                    this.handleAudio(store, item, file, arr, null);\n                    break;\n                }\n                case 'chat': {\n                    this.handleChat(store, item, file, arr);\n                    break;\n                }\n                case 'document': {\n                    this.handleDocument(store, item, file, arr, null);\n                    break;\n                }\n                case 'game': {\n                    this.handleGame(store, item, file, arr, null);\n                    break;\n                }\n                case 'location': {\n                    this.handleLocation(store, item, file, arr, null);\n                    break;\n                }\n                case 'message': {\n                    this.handleMessage(store, item, file, arr);\n                    break;\n                }\n                case 'pageBlockMap': {\n                    this.handlePageBlockMap(store, item, file, arr, null);\n                    break;\n                }\n                case 'photo': {\n                    this.handlePhoto(store, item, file, arr, null);\n                    break;\n                }\n                case 'sticker': {\n                    this.handleSticker(store, item, file, arr, null);\n                    break;\n                }\n                case 'video': {\n                    this.handleVideo(store, item, file, arr, null);\n                    break;\n                }\n                case 'videoNote': {\n                    this.handleVideoNote(store, item, file, arr, null);\n                    break;\n                }\n                case 'voiceNote': {\n                    this.handleVoiceNote(store, item, file, arr, null);\n                    break;\n                }\n                case 'user': {\n                    this.handleUser(store, item, file, arr);\n                    break;\n                }\n                default:\n                    console.error('FileStore.onUpdateFile unhandled item', item);\n                    break;\n            }\n        });\n    };\n\n    handleUploads = file => {\n        const { id, remote } = file;\n        delete file.arr;\n\n        if (!this.uploads.has(id)) return;\n        if (remote.is_uploading_completed) return;\n\n        this.uploads.delete(id);\n    };\n\n    handleChat = (store, chat, file, arr) => {\n        if (!chat) return;\n\n        this.getLocalFile(\n            store,\n            file,\n            arr,\n            () => this.updateChatPhotoBlob(chat.id, file.id),\n            () => this.getRemoteFile(file.id, FILE_PRIORITY, chat)\n        );\n    };\n\n    handleUser = (store, user, file, arr) => {\n        if (!user) return;\n\n        this.getLocalFile(\n            store,\n            file,\n            arr,\n            () => this.updateUserPhotoBlob(user.id, file.id),\n            () => this.getRemoteFile(file.id, FILE_PRIORITY, user)\n        );\n    };\n\n    handleMessage = (store, message, file, arr) => {\n        if (!message) return;\n\n        const { content } = message;\n        if (!content) return;\n\n        switch (content['@type']) {\n            case 'messageAnimation': {\n                const { animation } = content;\n\n                this.handleAnimation(store, animation, file, arr, message);\n                break;\n            }\n            case 'messageAudio': {\n                const { audio } = content;\n\n                this.handleAudio(store, audio, file, arr, message);\n                break;\n            }\n            case 'messageChatChangePhoto': {\n                const { photo } = content;\n\n                this.handlePhoto(store, photo, file, arr, message);\n                break;\n            }\n            case 'messageDocument': {\n                const { document } = content;\n\n                this.handleDocument(store, document, file, arr, message);\n                break;\n            }\n            case 'messageGame': {\n                const { game } = content;\n\n                this.handleGame(store, game, file, arr, message);\n                break;\n            }\n            case 'messageLocation': {\n                const { location } = content;\n\n                this.handleLocation(store, location, file, arr, message);\n                break;\n            }\n            case 'messagePhoto': {\n                const { photo } = content;\n\n                this.handlePhoto(store, photo, file, arr, message);\n                break;\n            }\n            case 'messageSticker': {\n                const { sticker } = content;\n\n                this.handleSticker(store, sticker, file, arr, message);\n                break;\n            }\n            case 'messageText': {\n                const { web_page } = content;\n                if (!web_page) break;\n\n                const { animation, audio, document, photo, sticker, video, video_note, voice_note } = web_page;\n\n                if (animation) {\n                    this.handleAnimation(store, animation, file, arr, message);\n                }\n\n                if (audio) {\n                    this.handleAudio(store, audio, file, arr, message);\n                }\n\n                if (document) {\n                    this.handleDocument(store, document, file, arr, message);\n                }\n\n                if (photo) {\n                    this.handlePhoto(store, photo, file, arr, message);\n                }\n\n                if (sticker) {\n                    this.handleSticker(store, sticker, file, arr, message);\n                }\n\n                if (video) {\n                    this.handleVideo(store, video, file, arr, message);\n                }\n\n                if (voice_note) {\n                    this.handleVoiceNote(store, voice_note, file, arr, message);\n                }\n\n                if (video_note) {\n                    this.handleVideoNote(store, video_note, file, arr, message);\n                }\n\n                break;\n            }\n            case 'messageVenue': {\n                const { venue } = content;\n                const { location } = venue;\n\n                this.handleLocation(store, location, file, arr, message);\n                break;\n            }\n            case 'messageVideo': {\n                const { video } = content;\n\n                this.handleVideo(store, video, file, arr, message);\n                break;\n            }\n            case 'messageVideoNote': {\n                const { video_note } = content;\n\n                this.handleVideoNote(store, video_note, file, arr, message);\n                break;\n            }\n            case 'messageVoiceNote': {\n                const { voice_note } = content;\n\n                this.handleVoiceNote(store, voice_note, file, arr, message);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    handleAnimation = (store, animation, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        if (animation.thumbnail) {\n            const source = animation.thumbnail.file;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateAnimationThumbnailBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, THUMBNAIL_PRIORITY, obj || animation)\n                );\n            }\n        }\n\n        if (animation.animation) {\n            const source = animation.animation;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateAnimationBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, FILE_PRIORITY, obj || animation)\n                );\n            }\n        }\n    };\n\n    handleAudio = (store, audio, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        if (audio.album_cover_thumbnail) {\n            const source = audio.album_cover_thumbnail.file;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateAudioThumbnailBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, THUMBNAIL_PRIORITY, obj || audio)\n                );\n            }\n        }\n\n        if (audio.audio) {\n            const source = audio.audio;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateAudioBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, FILE_PRIORITY, obj || audio)\n                );\n            }\n        }\n    };\n\n    handleGame = (store, game, file, arr, message) => {\n        if (!game) return;\n\n        const { animation, photo } = game;\n        if (photo) {\n            this.handlePhoto(store, photo, file, arr, message);\n        }\n\n        if (animation) {\n            this.handleAnimation(store, animation, file, arr, message);\n        }\n    };\n\n    handleDocument = (store, document, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        if (document.thumbnail) {\n            const source = document.thumbnail.file;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateDocumentThumbnailBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, THUMBNAIL_PRIORITY, obj || document)\n                );\n            }\n        }\n\n        if (document.document) {\n            const { document: source } = document;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateDocumentBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, FILE_PRIORITY, obj || document)\n                );\n            }\n        }\n    };\n\n    handleLocation = (store, location, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        const locationId = getLocationId(location);\n        if (locationId) {\n            const source = this.getLocationFile(locationId);\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateLocationBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, THUMBNAIL_PRIORITY, obj || location)\n                );\n            }\n        }\n    };\n\n    handlePageBlockMap = (store, pageBlockMap, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        const { location } = pageBlockMap;\n        const locationId = getLocationId(location, IV_LOCATION_WIDTH, IV_LOCATION_HEIGHT);\n        if (locationId) {\n            const source = this.getLocationFile(locationId);\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateLocationBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, THUMBNAIL_PRIORITY, obj || pageBlockMap)\n                );\n            }\n        }\n    };\n\n    handlePhoto = (store, photo, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        if (photo) {\n            for (let i = 0; i < photo.sizes.length; i++) {\n                const photoSize = photo.sizes[i];\n                if (photoSize) {\n                    const source = photoSize.photo;\n                    if (source && source.id === file.id) {\n                        this.getLocalFile(\n                            store,\n                            source,\n                            arr,\n                            () => this.updatePhotoBlob(chatId, messageId, file.id),\n                            () => this.getRemoteFile(file.id, FILE_PRIORITY, obj || photo)\n                        );\n                        break;\n                    }\n                }\n            }\n        }\n    };\n\n    handleSticker = (store, sticker, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        if (sticker.thumbnail) {\n            const source = sticker.thumbnail.file;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateStickerThumbnailBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, THUMBNAIL_PRIORITY, obj || sticker)\n                );\n            }\n        }\n\n        if (sticker.sticker) {\n            const source = sticker.sticker;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateStickerBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, FILE_PRIORITY, obj || sticker)\n                );\n            }\n        }\n    };\n\n    handleVoiceNote = (store, voiceNote, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        if (voiceNote.voice) {\n            const source = voiceNote.voice;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateVoiceNoteBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, FILE_PRIORITY, obj || voiceNote)\n                );\n            }\n        }\n    };\n\n    handleVideoNote = (store, videoNote, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        if (videoNote.thumbnail) {\n            const source = videoNote.thumbnail.file;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateVideoNoteThumbnailBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, THUMBNAIL_PRIORITY, obj || videoNote)\n                );\n            }\n        }\n\n        if (videoNote.video) {\n            const source = videoNote.video;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateVideoNoteBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, FILE_PRIORITY, obj || videoNote)\n                );\n            }\n        }\n    };\n\n    handleVideo = (store, video, file, arr, obj) => {\n        const chatId = obj ? obj.chat_id : 0;\n        const messageId = obj ? obj.id : 0;\n\n        if (video.thumbnail) {\n            const source = video.thumbnail.file;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateVideoThumbnailBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, THUMBNAIL_PRIORITY, obj || video)\n                );\n            }\n        }\n\n        if (video.video) {\n            const source = video.video;\n            if (source && source.id === file.id) {\n                this.getLocalFile(\n                    store,\n                    source,\n                    arr,\n                    () => this.updateVideoBlob(chatId, messageId, file.id),\n                    () => this.getRemoteFile(file.id, FILE_PRIORITY, obj || video)\n                );\n            }\n        }\n    };\n\n    async initDB(callback) {\n        /*if (this.store) return;\n            if (this.initiatingDB) return;\n\n            this.initiatingDB = true;\n            this.store = localForage.createInstance({\n                name: 'tdlib'\n            });\n            this.initiatingDB = false;\n\n            return;*/\n        if (this.db) {\n            // console.log('[FileStore] db exists');\n            if (callback) callback();\n            return;\n        }\n\n        if (this.initiatingDB) {\n            // console.log('[FileStore] add callback');\n            if (callback) this.callbacks.push(callback);\n            return;\n        }\n\n        // console.log('[FileStore] start initDB');\n        if (callback) this.callbacks.push(callback);\n\n        this.initiatingDB = true;\n        this.db = await this.openDB().catch(error => console.log('[FileStore] initDB error', error));\n        this.initiatingDB = false;\n\n        // console.log('[FileStore] stop initDB');\n\n        if (this.callbacks.length) {\n            // console.log('[FileStore] invoke callbacks count=' + this.callbacks.length);\n            for (let i = 0; i < this.callbacks.length; i++) {\n                this.callbacks[i]();\n            }\n            this.callbacks = [];\n        }\n    }\n\n    openDB() {\n        return new Promise((resolve, reject) => {\n            const request = window.indexedDB.open('tdlib');\n            request.onsuccess = () => resolve(request.result);\n            request.onerror = () => reject(request.error);\n        });\n    }\n\n    getStore() {\n        if (useReadFile) {\n            return undefined;\n        }\n\n        //console.log('FileStore.getStore ' + this.transactionCount++);\n        return this.db.transaction(['keyvaluepairs'], 'readonly').objectStore('keyvaluepairs');\n    }\n\n    getReadWriteStore() {\n        if (useReadFile) {\n            return undefined;\n        }\n\n        return this.db.transaction(['keyvaluepairs'], 'readwrite').objectStore('keyvaluepairs');\n    }\n\n    deleteLocalFile = (store, file) => {};\n\n    getLocalFile(store, file, arr, callback, faultCallback) {\n        if (!useDownloadFile) {\n            return;\n        }\n\n        if (useReadFile) {\n            file = this.get(file.id) || file;\n            if (file && file.local && !file.local.is_downloading_completed) {\n                faultCallback();\n                return;\n            }\n\n            (async file => {\n                // console.log('[fs] readFile file_id=' + file.id);\n                const response = await TdLibController.send({\n                    '@type': 'readFile',\n                    file_id: file.id\n                });\n\n                // console.log(`[fs] readFile result file_id=${file.id}`, file, response);\n                this.setBlob(file.id, response.data);\n            })(file).then(callback, faultCallback);\n\n            return;\n        }\n\n        let idb_key = file.idb_key;\n        if (!idb_key) {\n            file = this.get(file.id) || file;\n            idb_key = file.idb_key;\n        }\n\n        if (!idb_key && !arr) {\n            faultCallback();\n            return;\n        }\n\n        if (arr) {\n            file.blob = new Blob([arr]);\n            this.setBlob(file.id, file.blob);\n            callback();\n            return;\n        }\n\n        if (file.blob) {\n            //callback();\n            return;\n        }\n\n        // if (this.getBlob(file.id)){\n        //     return;\n        // }\n\n        const request = store.get(idb_key);\n        request.onsuccess = event => {\n            const blob = event.target.result;\n\n            if (blob) {\n                file.blob = blob;\n                this.setBlob(file.id, file.blob);\n                callback();\n            } else {\n                faultCallback();\n            }\n        };\n        request.onerror = () => {\n            faultCallback();\n        };\n    }\n\n    getRemoteFile(fileId, priority, obj) {\n        if (!useDownloadFile) {\n            return;\n        }\n\n        const items = this.downloads.get(fileId) || [];\n        if (items.some(x => x === obj)) return;\n\n        items.push(obj);\n        this.downloads.set(fileId, items);\n\n        TdLibController.send({\n            '@type': 'downloadFile',\n            file_id: fileId,\n            priority: priority\n        });\n    }\n\n    cancelGetRemoteFile(fileId, obj) {\n        if (!this.downloads.has(fileId)) return;\n\n        if (!obj) {\n            this.downloads.delete(fileId);\n        } else {\n            const items = this.downloads.get(fileId).filter(x => x !== obj);\n            this.downloads.set(fileId, items);\n        }\n\n        TdLibController.send({\n            '@type': 'cancelDownloadFile',\n            file_id: fileId,\n            only_if_pending: false\n        });\n    }\n\n    uploadFile(fileId, obj) {\n        if (this.uploads.has(fileId)) {\n            let items = this.uploads.get(fileId);\n            items.push(obj);\n        } else {\n            this.uploads.set(fileId, [obj]);\n        }\n\n        console.log('[perf] uploadFile file_id=' + fileId);\n    }\n\n    cancelUploadFile(fileId, obj) {\n        if (this.uploads.has(fileId)) {\n            this.uploads.delete(fileId);\n            console.log('cancel_upload_message id=' + obj.id);\n            TdLibController.send({\n                '@type': 'deleteMessages',\n                chat_id: obj.chat_id,\n                message_ids: [obj.id],\n                revoke: true\n            });\n        }\n    }\n\n    get = fileId => {\n        return this.items.get(fileId);\n    };\n\n    set = file => {\n        this.items.set(file.id, file);\n    };\n\n    getBlob = fileId => {\n        return this.blobItems.get(fileId);\n    };\n\n    setBlob = (fileId, blob) => {\n        this.blobItems.set(fileId, blob);\n    };\n\n    deleteBlob = fileId => {\n        this.blobItems.delete(fileId);\n    };\n\n    getLocationFile = locationId => {\n        const fileId = this.locationItems.get(locationId);\n\n        return this.get(fileId);\n    };\n\n    setLocationFile = (locationId, file) => {\n        this.locationItems.set(locationId, file.id);\n\n        this.set(file);\n    };\n\n    getDataUrl = id => {\n        if (!id) {\n            return null;\n        }\n\n        if (this.dataUrls.has(id)) {\n            return this.dataUrls.get(id);\n        }\n\n        return null;\n    };\n\n    setDataUrl = (id, dataUrl) => {\n        this.dataUrls.set(id, dataUrl);\n    };\n\n    deleteDataUrl = id => {\n        this.dataUrls.delete(id);\n    };\n\n    getBlobUrl = blob => {\n        if (!blob) {\n            return null;\n        }\n\n        if (this.urls.has(blob)) {\n            return this.urls.get(blob);\n        }\n\n        const url = URL.createObjectURL(blob);\n        this.urls.set(blob, url);\n\n        return url;\n    };\n\n    deleteBlobUrl = blob => {\n        if (this.urls.has(blob)) {\n            this.urls.delete(blob);\n        }\n    };\n\n    updateFileBlob = (type, chatId, messageId, fileId) => {\n        TdLibController.clientUpdate({\n            '@type': type,\n            chatId,\n            messageId,\n            fileId\n        });\n    }\n\n    updateAnimationBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateAnimationBlob', chatId, messageId, fileId);\n    };\n\n    updateAnimationThumbnailBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateAnimationThumbnailBlob', chatId, messageId, fileId);\n    };\n\n    updateAudioBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateAudioBlob', chatId, messageId, fileId);\n    };\n\n    updateAudioThumbnailBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateAudioThumbnailBlob', chatId, messageId, fileId);\n    };\n\n    updateChatPhotoBlob(chatId, fileId) {\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateChatBlob',\n            chatId,\n            fileId\n        });\n    }\n\n    updateDocumentBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateDocumentBlob', chatId, messageId, fileId);\n    };\n\n    updateDocumentThumbnailBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateDocumentThumbnailBlob', chatId, messageId, fileId);\n    };\n\n    updateLocationBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateLocationBlob', chatId, messageId, fileId);\n    };\n\n    updatePhotoBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdatePhotoBlob', chatId, messageId, fileId);\n    };\n\n    updateStickerBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateStickerBlob', chatId, messageId, fileId);\n    };\n\n    updateStickerThumbnailBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateStickerThumbnailBlob', chatId, messageId, fileId);\n    };\n\n    updateUserPhotoBlob(userId, fileId) {\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateUserBlob',\n            userId,\n            fileId\n        });\n    }\n\n    updateVideoBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateVideoBlob', chatId, messageId, fileId);\n    };\n\n    updateVideoThumbnailBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateVideoThumbnailBlob', chatId, messageId, fileId);\n    };\n\n    updateVideoNoteBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateVideoNoteBlob', chatId, messageId, fileId);\n    };\n\n    updateVideoNoteThumbnailBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateVideoNoteThumbnailBlob', chatId, messageId, fileId);\n    };\n\n    updateVoiceNoteBlob = (chatId, messageId, fileId) => {\n        this.updateFileBlob('clientUpdateVoiceNoteBlob', chatId, messageId, fileId);\n    };\n}\n\nconst store = new FileStore();\nwindow.file = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from '../Stores/EventEmitter';\nimport packageJson from '../../package.json';\nimport { stringToBoolean, getBrowser, getOSName } from '../Utils/Common';\nimport {\n    VERBOSITY_JS_MAX,\n    VERBOSITY_JS_MIN,\n    VERBOSITY_MAX,\n    VERBOSITY_MIN,\n    WASM_FILE_HASH,\n    WASM_FILE_NAME\n} from '../Constants';\nimport TdClient from 'tdweb/dist/tdweb';\n// import TdClient from '@arseny30/tdweb/dist/tdweb';\n\nfunction databaseExists(dbname, callback) {\n    var req = indexedDB.open(dbname);\n    var existed = true;\n    req.onsuccess = function() {\n        req.result.close();\n        if (!existed) indexedDB.deleteDatabase(dbname);\n        callback(existed);\n    };\n    req.onupgradeneeded = function() {\n        existed = false;\n    };\n}\n\nclass TdLibController extends EventEmitter {\n    constructor() {\n        super();\n\n        this.parameters = {\n            useTestDC: false,\n            readOnly: false,\n            verbosity: 1,\n            jsVerbosity: 3,\n            fastUpdating: true,\n            useDatabase: false,\n            mode: 'wasm'\n        };\n\n        this.disableLog = true;\n        this.streaming = true;\n    }\n\n    init = location => {\n        this.setParameters(location);\n\n        const { verbosity, jsVerbosity, useTestDC, readOnly, fastUpdating, useDatabase, mode } = this.parameters;\n        const dbName = useTestDC ? 'tdlib_test' : 'tdlib';\n\n        databaseExists(dbName, exists => {\n            this.clientUpdate({ '@type': 'clientUpdateTdLibDatabaseExists', exists });\n\n            let options = {\n                logVerbosityLevel: verbosity,\n                jsLogVerbosityLevel: jsVerbosity,\n                mode: mode, // 'wasm-streaming'/'wasm'/'asmjs'\n                prefix: useTestDC ? 'tdlib_test' : 'tdlib',\n                readOnly: readOnly,\n                isBackground: false,\n                useDatabase: useDatabase,\n                wasmUrl: `${WASM_FILE_NAME}?_sw-precache=${WASM_FILE_HASH}`\n                // onUpdate: update => this.emit('update', update)\n            };\n\n            console.log(\n                `[TdLibController] (fast_updating=${fastUpdating}) Start client with params=${JSON.stringify(options)}`\n            );\n\n            this.client = new TdClient(options);\n            this.client.onUpdate = update => {\n                if (!this.disableLog) {\n                    if (update['@type'] === 'updateFile') {\n                        console.log('receive updateFile file_id=' + update.file.id, update);\n                    } else {\n                        console.log('receive update', update);\n                    }\n                }\n                this.emit('update', update);\n            };\n        });\n    };\n\n    clientUpdate = update => {\n        if (!this.disableLog) {\n            console.log('clientUpdate', update);\n        }\n        this.emit('clientUpdate', update);\n    };\n\n    setParameters = location => {\n        if (!location) return;\n\n        const { search } = location;\n        if (!search) return;\n\n        const params = new URLSearchParams(search.toLowerCase());\n\n        if (params.has('test')) {\n            this.parameters.useTestDC = stringToBoolean(params.get('test'));\n        }\n\n        if (params.has('verbosity')) {\n            const verbosity = parseInt(params.get('verbosity'), 10);\n            if (verbosity >= VERBOSITY_MIN && verbosity <= VERBOSITY_MAX) {\n                this.parameters.verbosity = verbosity;\n            }\n        }\n\n        if (params.has('jsverbosity')) {\n            const jsVerbosity = parseInt(params.get('jsverbosity'), 10);\n            if (jsVerbosity >= VERBOSITY_JS_MIN && jsVerbosity <= VERBOSITY_JS_MAX) {\n                this.parameters.jsVerbosity = jsVerbosity;\n            }\n        }\n\n        if (params.has('tag') && params.has('tagverbosity')) {\n            const tag = params\n                .get('tag')\n                .replace('[', '')\n                .replace(']', '')\n                .split(',');\n            const tagVerbosity = params\n                .get('tagverbosity')\n                .replace('[', '')\n                .replace(']', '')\n                .split(',');\n            if (tag && tagVerbosity && tag.length === tagVerbosity.length) {\n                this.parameters.tag = tag;\n                this.parameters.tagVerbosity = tagVerbosity;\n            }\n        }\n\n        if (params.has('readonly')) {\n            this.parameters.readOnly = stringToBoolean(params.get('readonly'));\n        }\n\n        if (params.has('fastupdating')) {\n            this.parameters.fastUpdating = stringToBoolean(params.get('fastupdating'));\n        }\n\n        if (params.has('db')) {\n            this.parameters.useDatabase = stringToBoolean(params.get('db'));\n        }\n        if (params.has('mode')) {\n            this.parameters.mode = params.get('mode');\n        }\n        if (params.has('clientlog')) {\n            this.disableLog = !stringToBoolean(params.get('clientlog'));\n        }\n        if (params.has('streaming')) {\n            this.streaming = stringToBoolean(params.get('streaming'));\n        }\n    };\n\n    send = request => {\n        if (!this.client) {\n            console.log('send (none init)', request);\n            return;\n        }\n\n        if (!this.disableLog) {\n            console.log('send', request);\n\n            return this.client\n                .send(request)\n                .then(result => {\n                    console.log('send result', result);\n                    return result;\n                })\n                .catch(error => {\n                    console.error('send error', error);\n\n                    throw error;\n                });\n        } else {\n            return this.client.send(request);\n        }\n    };\n\n    sendTdParameters = async () => {\n        const apiId = process.env.REACT_APP_TELEGRAM_API_ID;\n        const apiHash = process.env.REACT_APP_TELEGRAM_API_HASH;\n\n        // console.log('[td] sendTdParameters', apiHash, apiId);\n        if (!apiId || !apiHash) {\n            if (\n                window.confirm(\n                    'API id is missing!\\n' +\n                        'In order to obtain an API id and develop your own application ' +\n                        'using the Telegram API please visit https://core.telegram.org/api/obtaining_api_id'\n                )\n            ) {\n                window.location.href = 'https://core.telegram.org/api/obtaining_api_id';\n            }\n        }\n\n        const { useTestDC } = this.parameters;\n        const { version } = packageJson;\n\n        this.send({\n            '@type': 'setTdlibParameters',\n            parameters: {\n                '@type': 'tdParameters',\n                use_test_dc: useTestDC,\n                api_id: apiId,\n                api_hash: apiHash,\n                system_language_code: navigator.language || 'en',\n                device_model: getBrowser(),\n                system_version: getOSName(),\n                application_version: version,\n                use_secret_chats: false,\n                use_message_database: true,\n                use_file_database: false,\n                database_directory: '/db',\n                files_directory: '/'\n            }\n            // ,\n            // extra: {\n            //     a: ['a', 'b'],\n            //     b: 123\n            // }\n        });\n\n        if (this.parameters.tag && this.parameters.tagVerbosity) {\n            for (let i = 0; i < this.parameters.tag.length; i++) {\n                let tag = this.parameters.tag[i];\n                let tagVerbosity = this.parameters.tagVerbosity[i];\n\n                this.send({\n                    '@type': 'setLogTagVerbosityLevel',\n                    tag: tag,\n                    new_verbosity_level: tagVerbosity\n                });\n            }\n        }\n    };\n\n    logOut() {\n        this.send({ '@type': 'logOut' }).catch(error => {\n            this.emit('tdlib_auth_error', error);\n        });\n    }\n\n    setChatId = (chatId, messageId = null) => {\n        const update = {\n            '@type': 'clientUpdateChatId',\n            chatId,\n            messageId\n        };\n\n        this.clientUpdate(update);\n    };\n\n    setMediaViewerContent(content) {\n        this.clientUpdate({\n            '@type': 'clientUpdateMediaViewerContent',\n            content: content\n        });\n    }\n}\n\nconst controller = new TdLibController();\n\nexport default controller;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nexport const ANIMATION_FRAME_DURATION_MS = 40;\nexport const ANIMATION_DURATION_100MS = 100;\nexport const ANIMATION_DURATION_200MS = 200;\nexport const ANIMATION_DURATION_300MS = 300;\nexport const ANIMATION_DURATION_500MS = 500;\nexport const ANIMATION_PREVIEW_DISPLAY_SIZE = 480;\nexport const APP_NAME = 'Telegram Web';\nexport const CHAT_SLICE_LIMIT = 25;\nexport const EMOJI_PICKER_TIMEOUT_MS = 100;\nexport const FILE_PRIORITY = 1;\nexport const FILTER_COUNT_MAX = 10;\nexport const FILTER_TITLE_MAX_LENGTH = 12;\nexport const IV_LOCATION_HEIGHT = 300;\nexport const IV_LOCATION_WIDTH = 600;\nexport const IV_PHOTO_SIZE = 800;\nexport const IV_PHOTO_DISPLAY_SIZE = 600;\nexport const KEY_AUTH_STATE = 'auth';\nexport const KEY_SUGGESTED_LANGUAGE_PACK_ID = 'suggested_language_pack_id';\nexport const LOCATION_HEIGHT = 150;\nexport const LOCATION_SCALE = 2;\nexport const LOCATION_WIDTH = 300;\nexport const LOCATION_ZOOM = 16;\nexport const MAX_SNACK = 10;\nexport const MEDIA_SLICE_LIMIT = 20;\nexport const MESSAGE_SLICE_LIMIT = 30;\nexport const MESSAGE_SPLIT_MAX_TIME_S = 600;\nexport const MUTED_VALUE_MAX = 2147483647; // int32.max = 2^32 - 1\nexport const MUTED_VALUE_MIN = 0;\nexport const NOTIFICATION_AUDIO_DELAY_MS = 5000;\nexport const NOTIFICATION_AUTO_HIDE_DURATION_MS = 5000;\nexport const NOTIFICATION_DEBOUNCE_DELAY_MS = 500;\nexport const OPTIMIZATIONS_FIRST_START = true;\nexport const PAGE_WIDTH_SMALL = 960;\nexport const PHOTO_BIG_SIZE = 1280;\nexport const PHOTO_DISPLAY_SIZE = 320;\nexport const PHOTO_DISPLAY_SMALL_SIZE = 65;\nexport const PHOTO_DISPLAY_EXTRA_SMALL_SIZE = 40;\nexport const PHOTO_SIZE = 320;\nexport const PHOTO_THUMBNAIL_SIZE = 90;\nexport const PIP_PLAYER_BORDER_PRECISION = 10;\nexport const PLAYER_AUDIO_2X_MIN_DURATION = 10 * 60;\nexport const PLAYER_LOOP_MAX_DURATION = 20;\nexport const PLAYER_VOLUME_NORMAL = 0.25;\nexport const PLAYER_VOLUME_MIN = 0.0;\nexport const PLAYER_VOLUME_MAX = 1.0;\nexport const PLAYER_VOLUME_STEP = 0.05;\nexport const PLAYER_PLAYBACKRATE_MIN = 0.25;\nexport const PLAYER_PLAYBACKRATE_MAX = 2.0;\nexport const PLAYER_PLAYBACKRATE_STEP = 0.25\nexport const PLAYER_PLAYBACKRATE_NORMAL = 1.0;\nexport const PLAYER_PLAYBACKRATE_FAST = 1.75;\nexport const PLAYER_PROGRESS_TIMEOUT_MS = 250;\nexport const PLAYER_SEEK_STEP_SMALL = 5.0;\nexport const PLAYER_SEEK_STEP_BIG = 10.0;\nexport const PLAYER_STREAMING_PRIORITY = 32;\nexport const PLAYER_PRELOAD_PRIORITY = 1;\nexport const PLAYER_PRELOAD_MAX_SIZE = 4 * 1024 * 1024;\nexport const POLL_QUESTION_LENGTH = 255;\nexport const POLL_QUESTION_HINT_LENGTH = POLL_QUESTION_LENGTH - 79;\nexport const POLL_QUESTION_MAX_LENGTH = POLL_QUESTION_LENGTH + 99;\nexport const POLL_OPTION_LENGTH = 100;\nexport const POLL_OPTION_HINT_LENGTH = POLL_OPTION_LENGTH - 29;\nexport const POLL_OPTION_MAX_LENGTH = POLL_OPTION_LENGTH + 99;\nexport const POLL_OPTIONS_MAX_COUNT = 10;\nexport const POLL_RESULTS_FIRST_SLICE_LENGTH = 15;\nexport const POLL_RESULTS_LEAVE_LENGTH = 5;\nexport const POLL_RESULTS_SLICE_LENGTH = 50;\nexport const PRELOAD_AUDIO_SIZE = 200 * 1024; //10 * 1024 * 1024;\nexport const PRELOAD_ANIMATION_SIZE = 200 * 1024; //10 * 1024 * 1024;\nexport const PRELOAD_DOCUMENT_SIZE = 200 * 1024;\nexport const PRELOAD_STICKER_SIZE = 10 * 200 * 1024;\nexport const PRELOAD_VOICENOTE_SIZE = 200 * 1024; //10 * 1024 * 1024;\nexport const PRELOAD_VIDEO_SIZE = 10 * 1024 * 1024;\nexport const PRELOAD_VIDEONOTE_SIZE = 200 * 1024; //10 * 1024 * 1024;\nexport const PROFILE_PHOTO_BIG_SIZE = 640;\nexport const PROFILE_PHOTO_SMALL_SIZE = 160;\nexport const SCROLL_PRECISION = 0;\nexport const SCROLL_CHATS_PRECISION = 400;\nexport const SERVICE_NOTIFICATIONS_USER_ID = 777000;\nexport const SHARED_MESSAGE_SLICE_LIMIT = 30;\nexport const STICKER_DISPLAY_SIZE = 192;\nexport const STICKER_HINT_DISPLAY_SIZE = 76;\nexport const STICKER_PREVIEW_DISPLAY_SIZE = 256;\nexport const STICKER_SMALL_DISPLAY_SIZE = 64;\nexport const THUMBNAIL_BLURRED_SIZE = 100;\nexport const THUMBNAIL_BLURRED_SIZE_90 = 90;\nexport const THUMBNAIL_PRIORITY = 32;\nexport const TYPING_INPUT_INTERVAL_S = 8;\nexport const TYPING_OUTPUT_INTERVAL_S = 8;\nexport const VERBOSITY_JS_MAX = 20;\nexport const VERBOSITY_JS_MIN = 0;\nexport const VERBOSITY_MAX = 20;\nexport const VERBOSITY_MIN = 0;\nexport const VOICENOTE_MIN_RECORD_DURATION = 1000;\nexport const USERNAME_LENGTH_MIN = 5;\nexport const REPLACE_PREFIX = '/telegram-react';\nexport const WASM_FILE_NAME = 'a848b8b40a9281225b96b8d300a07767.wasm';\nexport const WASM_FILE_HASH = WASM_FILE_NAME.replace('.wasm', '');\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { TYPING_INPUT_INTERVAL_S } from '../Constants';\n\nclass InputTypingManager {\n    constructor(chatId, timeoutCallback) {\n        this.actions = new Map();\n        this.timerId = null;\n        this.chatId = chatId;\n        this.timeoutCallback = timeoutCallback;\n\n        this.handleTimer = this.handleTimer.bind(this);\n        this.addAction = this.addAction.bind(this);\n        this.clearAction = this.clearAction.bind(this);\n        this.setActionsTimeout = this.setActionsTimeout.bind(this);\n    }\n\n    handleTimer() {\n        let now = new Date();\n        let expiredActions = [];\n        for (let [key, value] of this.actions) {\n            let actionTimeout = value.expire - now;\n            if (actionTimeout <= 0) expiredActions.push(key);\n        }\n\n        for (let key of expiredActions) {\n            this.actions.delete(key);\n        }\n\n        let update = {\n            '@type': 'updateUserChatAction',\n            chat_id: this.chatId,\n            action: { '@type': 'chatActionTimerUpdate' }\n        };\n\n        this.timeoutCallback(update);\n        // ChatStore.emit('updateUserChatAction', update);\n\n        this.setActionsTimeout();\n    }\n\n    addAction(userId, action) {\n        let expire = new Date();\n        expire.setSeconds(expire.getSeconds() + TYPING_INPUT_INTERVAL_S);\n\n        this.actions.set(userId, { expire: expire, action: action });\n\n        if (this.timerId) {\n            clearTimeout(this.timerId);\n        }\n\n        this.setActionsTimeout();\n    }\n\n    setActionsTimeout() {\n        let now = new Date();\n        let timeout = 1000000;\n        for (let [key, value] of this.actions) {\n            let actionTimeout = value.expire - now;\n            if (actionTimeout < timeout) timeout = actionTimeout;\n            if (timeout < 0) timeout = 0;\n        }\n\n        if (timeout < 1000000) {\n            this.timerId = setTimeout(this.handleTimer, timeout);\n        }\n    }\n\n    clearAction(userId) {\n        this.actions.delete(userId);\n\n        if (this.timerId) {\n            clearTimeout(this.timerId);\n        }\n\n        this.setActionsTimeout();\n    }\n}\n\nexport default InputTypingManager;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport InputTypingManager from '../Utils/InputTypingManager';\nimport { positionListEquals } from '../Utils/Chat';\nimport UserStore from './UserStore';\nimport MessageStore from './MessageStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass ChatStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n        this.loadClientData();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.items = new Map();\n        this.typingManagers = new Map();\n        this.onlineMemberCount = new Map();\n        this.counters = new Map();\n        this.skippedUpdates = [];\n        this.chatList = new Map();\n        this.wallpaper = null;\n    };\n\n    loadClientData = () => {\n        const clientData = new Map();\n        try {\n            let data = localStorage.get('clientData');\n            if (data) {\n                data = JSON.parse(data);\n                if (data) {\n                    Object.keys(data).forEach(key => {\n                        clientData.set(Number(key), data[key]);\n                    });\n                }\n            }\n        } catch {}\n\n        this.clientData = clientData;\n    };\n\n    saveClientData = () => {\n        const arr = Array.from(this.clientData.entries());\n        const obj = arr.reduce((obj, [key, value]) => {\n            if (value) {\n                obj[String(key)] = value;\n            }\n            return obj;\n        }, {});\n\n        localStorage.setItem('clientData', JSON.stringify(obj));\n    };\n\n    updateChatChatLists(chatId) {\n        const { chat } = this.get(chatId);\n        if (!chat) return;\n\n        const { positions } = chat;\n        if (!positions) return;\n\n        for (const key of this.chatList.keys()) {\n            this.chatList.get(key).delete(chatId);\n        }\n\n        if (!positions.length) return;\n\n        for (let i = 0; i < positions.length; i++) {\n            const position = positions[i];\n\n            const { list } = position;\n\n            const key = `${list['@type']}_filter_id=${list.filter_id}`;\n            let idMap = this.chatList.get(key);\n            if (!idMap) {\n                idMap = new Map();\n                this.chatList.set(key, idMap);\n            }\n\n            idMap.set(chatId, chatId);\n        }\n    }\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'updateConnectionState': {\n                if (update.state['@type'] === 'connectionStateUpdating') {\n                    this.updating = true;\n                    this.skippedUpdates = [];\n                } else {\n                    this.updating = false;\n                    if (this.skippedUpdates.length > 0) {\n                        TdLibController.parameters.fastUpdating = false;\n                        this.emitUpdate({\n                            '@type': 'clientUpdateFastUpdatingComplete',\n                            updates: this.skippedUpdates\n                        });\n                        this.skippedUpdates = [];\n                    }\n                }\n                break;\n            }\n            case 'updateChatActionBar': {\n                const { chat_id, action_bar } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { action_bar });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatDefaultDisableNotification': {\n                //TODO: handle updateChatDefaultDisableNotification\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatOnlineMemberCount': {\n                this.setOnlineMemberCount(update.chat_id, update.online_member_count);\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatDraftMessage': {\n                const { chat_id, positions, draft_message } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, {\n                        positions: !positions.length ? chat.positions : positions,\n                        draft_message\n                    });\n                }\n\n                this.updateChatChatLists(chat_id);\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatIsMarkedAsUnread': {\n                const { chat_id, is_marked_as_unread } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { is_marked_as_unread });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatLastMessage': {\n                const { chat_id, positions, last_message } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, {\n                        positions: !positions.length ? chat.positions : positions,\n                        last_message,\n                    });\n                }\n\n                this.updateChatChatLists(chat_id);\n                MessageStore.set(last_message);\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatNotificationSettings': {\n                const { chat_id, notification_settings } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { notification_settings });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatPhoto': {\n                const { chat_id, photo } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { photo });\n\n                    switch (chat.type['@type']) {\n                        case 'chatTypeBasicGroup': {\n                            break;\n                        }\n                        case 'chatTypeSupergroup': {\n                            break;\n                        }\n                        case 'chatTypePrivate':\n                        case 'chatTypeSecret': {\n                            const user = UserStore.get(chat.type.user_id);\n                            if (user) {\n                                UserStore.assign(user, { profile_photo: update.photo });\n                            }\n                            break;\n                        }\n                    }\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatPinnedMessage': {\n                const { chat_id, pinned_message_id } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { pinned_message_id });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatPosition': {\n                const { chat_id, position } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { positions: [...chat.positions.filter(x => !positionListEquals(x, position)), position] });\n                }\n\n                this.updateChatChatLists(chat_id);\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatReadInbox': {\n                const { chat_id, last_read_inbox_message_id, unread_count } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { last_read_inbox_message_id, unread_count });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatReadOutbox': {\n                const { chat_id, last_read_outbox_message_id } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { last_read_outbox_message_id });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatReplyMarkup': {\n                const { chat_id, reply_markup_message_id } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { reply_markup_message_id });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatTitle': {\n                const { chat_id, title } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { title });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateChatUnreadMentionCount': {\n                const { chat_id, unread_mention_count } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { unread_mention_count });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateNewChat': {\n                this.set(update.chat);\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateSecretChat': {\n                //TODO: handle updateSecretChat\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateUnreadChatCount': {\n                //TODO: handle updateUnreadChatCount\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateUserChatAction': {\n                let typingManager = this.getTypingManager(update.chat_id);\n                if (!typingManager) {\n                    typingManager = new InputTypingManager(update.chat_id, update => this.emitUpdate(update));\n                    this.setTypingManager(update.chat_id, typingManager);\n                }\n\n                const key = update.user_id;\n                if (update.action['@type'] === 'chatActionCancel') {\n                    typingManager.clearAction(key);\n                } else {\n                    typingManager.addAction(key, update.action);\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            case 'updateMessageMentionRead': {\n                const { chat_id, unread_mention_count } = update;\n\n                const chat = this.get(chat_id);\n                if (chat) {\n                    this.assign(chat, { unread_mention_count });\n                }\n\n                this.emitFastUpdate(update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateChatBackground': {\n                const { wallpaper } = update;\n                this.wallpaper = wallpaper;\n\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateClearHistory': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateLeaveChat': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateArchive': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateOpenChat': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateContacts': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateSettings': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateNewGroup': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateNewChannel': {\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateSetChatClientData': {\n                const { chatId, clientData } = update;\n\n                TdLibController.send({\n                    '@type': 'setChatClientData',\n                    chat_id: chatId,\n                    client_data: JSON.stringify(clientData)\n                });\n                this.setClientData(chatId, clientData);\n                this.saveClientData();\n\n                this.emitUpdate(update);\n                break;\n            }\n            case 'clientUpdateUnpin': {\n                this.emitUpdate(update);\n                break;\n            }\n        }\n    };\n\n    emitUpdate = update => {\n        this.emit(update['@type'], update);\n    };\n\n    emitFastUpdate = update => {\n        if (this.updating && TdLibController.parameters.fastUpdating) {\n            this.skippedUpdates.push(update);\n            return;\n        }\n\n        this.emit(update['@type'], update);\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    assign(source1, source2) {\n        //Object.assign(source1, source2);\n        this.set(Object.assign({}, source1, source2));\n    }\n\n    get(chatId) {\n        return this.items.get(chatId);\n    }\n\n    set(chat) {\n        this.items.set(chat.id, chat);\n    }\n\n    getCounters(chatId) {\n        return this.counters.get(chatId);\n    }\n\n    setCounters(chatId, counters) {\n        this.counters.set(chatId, counters);\n    }\n\n    getClientData(chatId) {\n        return this.clientData.get(chatId) || {};\n    }\n\n    setClientData(chatId, data) {\n        this.clientData.set(chatId, data);\n    }\n\n    setOnlineMemberCount(chatId, onlineMemberCount) {\n        this.onlineMemberCount.set(chatId, onlineMemberCount);\n    }\n\n    getOnlineMemberCount(chatId) {\n        return this.onlineMemberCount.get(chatId) || 0;\n    }\n\n    getTypingManager(chatId) {\n        return this.typingManagers.get(chatId);\n    }\n\n    setTypingManager(chatId, typingManager) {\n        return this.typingManagers.set(chatId, typingManager);\n    }\n}\n\nconst store = new ChatStore();\nwindow.chat = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { getPhotoSize, getPhotoThumbnailSize, getSize } from './Common';\nimport { getChatUserId } from './Chat';\nimport { getProfilePhoto } from './User';\nimport { getLocationId } from './Message';\nimport {\n    FILE_PRIORITY,\n    IV_LOCATION_HEIGHT,\n    IV_LOCATION_WIDTH,\n    IV_PHOTO_SIZE,\n    LOCATION_HEIGHT,\n    LOCATION_SCALE,\n    LOCATION_WIDTH,\n    LOCATION_ZOOM,\n    PHOTO_BIG_SIZE,\n    PHOTO_SIZE,\n    PRELOAD_ANIMATION_SIZE,\n    PRELOAD_AUDIO_SIZE,\n    PRELOAD_DOCUMENT_SIZE,\n    PRELOAD_STICKER_SIZE,\n    PRELOAD_VIDEO_SIZE,\n    PRELOAD_VIDEONOTE_SIZE,\n    PRELOAD_VOICENOTE_SIZE,\n    THUMBNAIL_PRIORITY\n} from '../Constants';\nimport ChatStore from '../Stores/ChatStore';\nimport FileStore from '../Stores/FileStore';\nimport MessageStore from '../Stores/MessageStore';\nimport UserStore from '../Stores/UserStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nexport function supportsStreaming() {\n    const { streaming } = TdLibController;\n\n    return streaming && hasServiceWorker();\n}\n\nexport function hasServiceWorker() {\n    if ('serviceWorker' in navigator) {\n        const { controller } = navigator.serviceWorker;\n        if (!controller) console.log('[SW] no running SW');\n\n        return !!controller;\n    }\n\n    return false;\n}\n\nexport async function getArrayBuffer(blob) {\n    return new Promise((resolve) => {\n        let fr = new FileReader();\n        fr.onload = () => {\n            resolve(fr.result);\n        };\n        fr.readAsArrayBuffer(blob);\n    })\n}\n\nfunction getSizeString(size) {\n    if (!size) return `0 B`;\n\n    if (size < 1024) {\n        return `${size} B`;\n    }\n\n    if (size < 1024 * 1024) {\n        return `${(size / 1024).toFixed(1)} KB`;\n    }\n\n    if (size < 1024 * 1024 * 1024) {\n        return `${(size / 1024 / 1024).toFixed(1)} MB`;\n    }\n\n    return `${(size / 1024 / 1024 / 1024).toFixed(1)} GB`;\n}\n\nfunction getFileSize(file) {\n    if (!file) return '';\n\n    let size = file.size;\n    if (!size) return '';\n\n    return getSizeString(size);\n}\n\nfunction getBigPhoto(photo) {\n    if (!photo) return null;\n\n    return photo.big;\n}\n\nfunction saveData(data, filename, mime) {\n    let blob = new Blob([data], { type: mime || 'application/octet-stream' });\n    if (typeof window.navigator.msSaveBlob !== 'undefined') {\n        // IE workaround for \"HTML7007: One or more blob URLs were\n        // revoked by closing the blob for which they were created.\n        // These URLs will no longer resolve as the data backing\n        // the URL has been freed.\"\n        window.navigator.msSaveBlob(blob, filename);\n    } else {\n        let blobURL = window.URL.createObjectURL(blob);\n        let tempLink = document.createElement('a');\n        tempLink.style.display = 'none';\n        tempLink.href = blobURL;\n        tempLink.setAttribute('download', filename);\n\n        // Safari thinks _blank anchor are pop ups. We only want to set _blank\n        // target if the browser does not support the HTML5 download attribute.\n        // This allows you to download files in desktop safari if pop up blocking\n        // is enabled.\n        if (typeof tempLink.download === 'undefined') {\n            tempLink.setAttribute('target', '_blank');\n        }\n\n        document.body.appendChild(tempLink);\n        tempLink.click();\n        document.body.removeChild(tempLink);\n        window.URL.revokeObjectURL(blobURL);\n    }\n}\n\nfunction saveBlob(blob, filename) {\n    if (typeof window.navigator.msSaveBlob !== 'undefined') {\n        // IE workaround for \"HTML7007: One or more blob URLs were\n        // revoked by closing the blob for which they were created.\n        // These URLs will no longer resolve as the data backing\n        // the URL has been freed.\"\n        window.navigator.msSaveBlob(blob, filename);\n    } else {\n        let blobURL = window.URL.createObjectURL(blob);\n        let tempLink = document.createElement('a');\n        tempLink.style.display = 'none';\n        tempLink.href = blobURL;\n        tempLink.setAttribute('download', filename);\n\n        // Safari thinks _blank anchor are pop ups. We only want to set _blank\n        // target if the browser does not support the HTML5 download attribute.\n        // This allows you to download files in desktop safari if pop up blocking\n        // is enabled.\n        if (typeof tempLink.download === 'undefined') {\n            tempLink.setAttribute('target', '_blank');\n        }\n\n        document.body.appendChild(tempLink);\n        tempLink.click();\n        document.body.removeChild(tempLink);\n        window.URL.revokeObjectURL(blobURL);\n    }\n}\n\nasync function loadReplies(store, chatId, messageIds) {\n    if (!chatId) return;\n    if (!messageIds) return;\n    if (!messageIds.length) return;\n\n    const result = await TdLibController.send({\n        '@type': 'getMessages',\n        chat_id: chatId,\n        message_ids: messageIds\n    });\n\n    result.messages = result.messages.map((message, i) => {\n        return (\n            message || {\n                '@type': 'deletedMessage',\n                chat_id: chatId,\n                id: messageIds[i],\n                content: null\n            }\n        );\n    });\n\n    MessageStore.setItems(result.messages);\n\n    for (let i = messageIds.length - 1; i >= 0; i--) {\n        MessageStore.emit('getMessageResult', MessageStore.get(chatId, messageIds[i]));\n    }\n\n    store = FileStore.getStore();\n\n    loadReplyContents(store, result.messages);\n}\n\nfunction loadReplyContents(store, messages) {\n    for (let i = messages.length - 1; i >= 0; i--) {\n        const message = messages[i];\n        if (!message) {\n            continue;\n        }\n\n        const { content } = message;\n        if (content) {\n            switch (content['@type']) {\n                case 'messageAnimation': {\n                    const { animation } = content;\n\n                    loadAnimationThumbnailContent(store, animation, message);\n                    break;\n                }\n                case 'messageAudio': {\n                    const { audio } = content;\n\n                    loadAudioThumbnailContent(store, audio, message);\n                    break;\n                }\n                case 'messageChatChangePhoto': {\n                    const { photo } = content;\n\n                    loadPhotoContent(store, photo, message);\n                    break;\n                }\n                case 'messageDocument': {\n                    const { document } = content;\n\n                    loadDocumentThumbnailContent(store, document, message);\n                    break;\n                }\n                case 'messageGame': {\n                    const { game } = content;\n\n                    loadGameThumbnailContent(store, game, message);\n                    break;\n                }\n                case 'messagePhoto': {\n                    const { photo } = content;\n\n                    loadPhotoContent(store, photo, message);\n                    break;\n                }\n                case 'messageSticker': {\n                    const { sticker } = content;\n\n                    loadStickerThumbnailContent(store, sticker, message);\n                    break;\n                }\n                case 'messageText': {\n                    const { web_page } = content;\n                    if (!web_page) break;\n\n                    const { animation, audio, document, photo, sticker, video, video_note } = web_page;\n\n                    if (photo) {\n                        loadPhotoContent(store, photo, message);\n                        break;\n                    }\n\n                    if (animation) {\n                        loadAnimationThumbnailContent(store, animation, message);\n                        break;\n                    }\n\n                    if (audio) {\n                        loadAudioThumbnailContent(store, audio, message);\n                        break;\n                    }\n\n                    if (document) {\n                        loadDocumentThumbnailContent(store, document, message);\n                        break;\n                    }\n\n                    if (sticker) {\n                        loadStickerThumbnailContent(store, sticker, message);\n                        break;\n                    }\n\n                    if (video) {\n                        loadVideoThumbnailContent(store, video, message);\n                        break;\n                    }\n\n                    if (video_note) {\n                        loadVideoNoteThumbnailContent(store, video_note, message);\n                        break;\n                    }\n\n                    break;\n                }\n                case 'messageVideo': {\n                    const { video } = content;\n\n                    loadVideoThumbnailContent(store, video, message);\n                    break;\n                }\n                case 'messageVideoNote': {\n                    const { video_note } = content;\n\n                    loadVideoNoteThumbnailContent(store, video_note, message);\n                    break;\n                }\n            }\n        }\n    }\n}\n\nfunction loadAudioContent(store, audio, message, useFileSize = true) {\n    if (!audio) return;\n\n    let { audio: file } = audio;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateAudioBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_AUDIO_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || audio);\n            }\n        }\n    );\n}\n\nfunction loadAudioThumbnailContent(store, audio, message) {\n    if (!audio) return false;\n\n    const { album_cover_thumbnail: thumbnail } = audio;\n    if (!thumbnail) return false;\n\n    let { file } = thumbnail;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(file.id);\n    if (blob) return true;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateAudioThumbnailBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message || audio)\n    );\n\n    return true;\n}\n\nfunction cancelLoadAnimationContent(animation) {\n    const { animation: file } = animation;\n    if (!file) return;\n\n    const { id } = file;\n\n    const blob = file.blob || FileStore.getBlob(id);\n    if (blob) return;\n\n    FileStore.cancelGetRemoteFile(id);\n}\n\nexport function loadAnimationContent(store, animation, message, useFileSize = true) {\n    if (!animation) return;\n\n    let { animation: file } = animation;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateAnimationBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_ANIMATION_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || animation);\n            }\n        }\n    );\n}\n\nfunction cancelLoadAnimationThumbnailContent(animation){\n    if (!animation) return;\n\n    const { thumbnail } = animation;\n    if (!thumbnail) return;\n\n    let { file } = thumbnail;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    FileStore.cancelGetRemoteFile(id);\n}\n\nexport function loadAnimationThumbnailContent(store, animation, message) {\n    if (!animation) return false;\n\n    const { thumbnail } = animation;\n    if (!thumbnail) return false;\n\n    let { file } = thumbnail;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(file.id);\n    if (blob) return true;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateAnimationThumbnailBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message || animation)\n    );\n\n    return true;\n}\n\nfunction loadContactContent(store, contact, message) {\n    if (!contact) return;\n    if (!message) return;\n\n    const { user_id } = contact;\n    const user = UserStore.get(user_id);\n    if (!user) return;\n\n    loadUserContent(store, user);\n}\n\nfunction loadDocumentContent(store, document, message, useFileSize = true) {\n    if (!document) return;\n\n    let { document: file } = document;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateDocumentBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_DOCUMENT_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || document);\n            }\n        }\n    );\n}\n\nfunction loadDocumentThumbnailContent(store, document, message) {\n    if (!document) return false;\n\n    const { thumbnail } = document;\n    if (!thumbnail) return false;\n\n    let { file } = thumbnail;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(file.id);\n    if (blob) return true;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateDocumentThumbnailBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message || document)\n    );\n\n    return true;\n}\n\nfunction loadGameContent(store, game, message, useFileSize = true) {\n    if (!game) return;\n\n    const { animation } = game;\n\n    loadAnimationContent(store, animation, message, useFileSize);\n}\n\nfunction loadGameThumbnailContent(store, game, message) {\n    if (!game) return false;\n\n    const { photo, animation } = game;\n    if (loadAnimationThumbnailContent(store, animation, message)) {\n        return true;\n    }\n\n    loadPhotoContent(store, photo, message);\n    return true;\n}\n\nasync function loadPageBlockMapContent(store, pageBlockMap, message) {\n    if (!pageBlockMap) return;\n\n    const { location } = pageBlockMap;\n    const locationId = getLocationId(location, IV_LOCATION_WIDTH, IV_LOCATION_HEIGHT);\n    if (!locationId) return;\n\n    let file = FileStore.getLocationFile(locationId);\n    if (!file) {\n        file = await TdLibController.send({\n            '@type': 'getMapThumbnailFile',\n            location,\n            width: IV_LOCATION_WIDTH,\n            height: IV_LOCATION_HEIGHT,\n            zoom: LOCATION_ZOOM,\n            scale: LOCATION_SCALE,\n            chat_id: message ? message.chat_id : 0\n        });\n        FileStore.setLocationFile(locationId, file);\n\n        store = FileStore.getStore();\n    }\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(file.id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateLocationBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, FILE_PRIORITY, message || pageBlockMap)\n    );\n}\n\nasync function loadLocationContent(store, location, message) {\n    if (!location) return;\n\n    const locationId = getLocationId(location);\n    if (!locationId) return;\n\n    let file = FileStore.getLocationFile(locationId);\n    if (!file) {\n        file = await TdLibController.send({\n            '@type': 'getMapThumbnailFile',\n            location,\n            width: LOCATION_WIDTH,\n            height: LOCATION_HEIGHT,\n            zoom: LOCATION_ZOOM,\n            scale: LOCATION_SCALE,\n            chat_id: message ? message.chat_id : 0\n        });\n        FileStore.setLocationFile(locationId, file);\n\n        store = FileStore.getStore();\n    }\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(file.id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateLocationBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, FILE_PRIORITY, message || location)\n    );\n}\n\nfunction cancelLoadBigPhotoContent(photo) {\n    if (!photo) return;\n\n    const { sizes } = photo;\n    if (!sizes) return;\n\n    const photoSize = getSize(sizes, PHOTO_BIG_SIZE);\n    if (!photoSize) return;\n\n    let { photo: file } = photoSize;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    FileStore.cancelGetRemoteFile(id);\n}\n\nfunction loadBigPhotoContent(store, photo, message) {\n    if (!photo) return;\n\n    const { sizes } = photo;\n    if (!sizes) return;\n\n    const photoSize = getSize(sizes, PHOTO_BIG_SIZE);\n    if (!photoSize) return;\n\n    let { photo: file } = photoSize;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updatePhotoBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, FILE_PRIORITY, message || photo)\n    );\n}\n\nfunction loadPhotoContent(store, photo, message, displaySize = PHOTO_SIZE) {\n    if (!photo) return;\n\n    const { sizes } = photo;\n    if (!sizes) return;\n\n    const photoSize = getPhotoSize(sizes, displaySize);\n    if (!photoSize) return;\n\n    let { photo: file } = photoSize;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updatePhotoBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, FILE_PRIORITY, message || photo)\n    );\n}\n\nfunction loadPhotoThumbnailContent(store, photo, message) {\n    if (!photo) return false;\n    if (!message) return false;\n\n    const thumbSize = getPhotoThumbnailSize(photo.sizes);\n    if (!thumbSize) return false;\n\n    const photoSize = getPhotoSize(photo.sizes);\n    if (photoSize === thumbSize) return;\n\n    let { photo: file } = thumbSize;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return true;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updatePhotoBlob(message.chat_id, message.id, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message)\n    );\n\n    return true;\n}\n\nfunction loadStickerContent(store, sticker, message, useFileSize = true) {\n    // console.log('[sp] loadStickerContent')\n    if (!sticker) return;\n\n    let { sticker: file } = sticker;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateStickerBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_STICKER_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || sticker);\n            }\n        }\n    );\n}\n\nfunction loadStickerThumbnailContent(store, sticker, message) {\n    if (!sticker) return false;\n\n    const { thumbnail } = sticker;\n    if (!thumbnail) return false;\n\n    let { file } = thumbnail;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return true;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateStickerThumbnailBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message || sticker)\n    );\n\n    return true;\n}\n\nfunction cancelLoadVideoContent(video) {\n    if (!video) return;\n\n    let { video: file } = video;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    FileStore.cancelGetRemoteFile(id);\n}\n\nfunction loadVideoContent(store, video, message, useFileSize = true) {\n    if (!video) return;\n\n    let { video: file, supports_streaming } = video;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    if (supports_streaming && supportsStreaming()) {\n        return;\n    }\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateVideoBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_VIDEO_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || video);\n            }\n        }\n    );\n}\n\nfunction cancelLoadVideoThumbnailContent(video) {\n    if (!video) return;\n\n    const { thumbnail } = video;\n    if (!thumbnail) return false;\n\n    let { file } = thumbnail;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return true;\n\n    FileStore.cancelGetRemoteFile(id);\n}\n\nfunction loadVideoThumbnailContent(store, video, message) {\n    if (!video) return false;\n\n    const { thumbnail } = video;\n    if (!thumbnail) return false;\n\n    let { file } = thumbnail;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return true;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateVideoThumbnailBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message || video)\n    );\n\n    return true;\n}\n\nfunction loadVideoNoteContent(store, videoNote, message, useFileSize = true) {\n    if (!videoNote) return;\n\n    let { video: file } = videoNote;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateVideoNoteBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_VIDEONOTE_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || videoNote);\n            }\n        }\n    );\n}\n\nfunction loadVideoNoteThumbnailContent(store, videoNote, message) {\n    if (!videoNote) return false;\n\n    const { thumbnail } = videoNote;\n    if (!thumbnail) return false;\n\n    let { file } = thumbnail;\n    if (!file) return false;\n\n    file = FileStore.get(file.id) || file;\n    const { id } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return true;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateVideoNoteThumbnailBlob(chatId, messageId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, message || videoNote)\n    );\n\n    return true;\n}\n\nfunction loadVoiceNoteContent(store, voiceNote, message, useFileSize = true) {\n    if (!voiceNote) return;\n\n    let { voice: file } = voiceNote;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    const { id, size } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) return;\n\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateVoiceNoteBlob(chatId, messageId, id),\n        () => {\n            if (!useFileSize || (size && size < PRELOAD_VOICENOTE_SIZE)) {\n                FileStore.getRemoteFile(id, FILE_PRIORITY, message || voiceNote);\n            }\n        }\n    );\n}\n\nfunction loadMessageContents(store, messages) {\n    const users = new Map();\n    let chatId = 0;\n    const replies = new Map();\n\n    for (let i = messages.length - 1; i >= 0; i--) {\n        const message = messages[i];\n        if (!message) {\n            continue;\n        }\n\n        const { chat_id, content, sender_user_id, reply_to_message_id } = message;\n\n        if (sender_user_id) {\n            users.set(sender_user_id, sender_user_id);\n        }\n\n        if (reply_to_message_id) {\n            chatId = chat_id;\n            replies.set(reply_to_message_id, reply_to_message_id);\n        }\n\n        if (content) {\n            switch (content['@type']) {\n                case 'messageAnimation': {\n                    const { animation } = content;\n\n                    loadAnimationContent(store, animation, message);\n                    loadAnimationThumbnailContent(store, animation, message);\n                    break;\n                }\n                case 'messageAudio': {\n                    const { audio } = content;\n\n                    loadAudioContent(store, audio, message);\n                    loadAudioThumbnailContent(store, audio, message);\n                    break;\n                }\n                case 'messageChatChangePhoto': {\n                    const { photo } = content;\n\n                    loadPhotoContent(store, photo, message);\n                    loadBigPhotoContent(store, photo, message);\n                    break;\n                }\n                case 'messageContact': {\n                    const { contact } = content;\n\n                    loadContactContent(store, contact, message);\n                    break;\n                }\n                case 'messageDocument': {\n                    const { document } = content;\n\n                    loadDocumentContent(store, document, message);\n                    loadDocumentThumbnailContent(store, document, message);\n                    break;\n                }\n                case 'messageGame': {\n                    const { game } = content;\n\n                    loadGameContent(store, game, message);\n                    loadGameThumbnailContent(store, game, message);\n                    break;\n                }\n                case 'messageLocation': {\n                    const { location } = content;\n\n                    loadLocationContent(store, location, message);\n                    break;\n                }\n                case 'messageText': {\n                    const { web_page } = content;\n                    if (!web_page) {\n                        break;\n                    }\n\n                    const { animation, audio, document, photo, sticker, video, video_note, voice_note } = web_page;\n                    let loadPhoto = true;\n\n                    if (animation) {\n                        loadAnimationContent(store, animation, message);\n                        loadPhoto = !loadAnimationThumbnailContent(store, animation, message);\n                    }\n\n                    if (audio) {\n                        loadAudioContent(store, audio, message);\n                        loadPhoto = !loadAudioThumbnailContent(store, audio, message);\n                    }\n\n                    if (document) {\n                        loadDocumentContent(store, document, message);\n                        loadPhoto = !loadDocumentThumbnailContent(store, document, message);\n                    }\n\n                    if (sticker) {\n                        loadStickerContent(store, sticker, message);\n                        loadPhoto = !loadStickerThumbnailContent(store, sticker, message);\n                    }\n\n                    if (video) {\n                        // loadVideoContent(store, video, message); // start loading only on video click event\n                        loadPhoto = !loadVideoThumbnailContent(store, video, message);\n                    }\n\n                    if (video_note) {\n                        loadVideoNoteContent(store, video_note, message);\n                        loadPhoto = !loadVideoNoteThumbnailContent(store, video_note, message);\n                    }\n\n                    if (voice_note) {\n                        loadVoiceNoteContent(store, voice_note, message);\n                    }\n\n                    if (loadPhoto) {\n                        loadBigPhotoContent(store, photo, message);\n                        loadPhotoContent(store, photo, message);\n                        loadPhotoThumbnailContent(store, photo, message);\n                    }\n                    break;\n                }\n                case 'messagePhoto': {\n                    const { photo } = content;\n\n                    loadBigPhotoContent(store, photo, message);\n                    loadPhotoContent(store, photo, message);\n                    loadPhotoThumbnailContent(store, photo, message);\n                    break;\n                }\n                case 'messageSticker': {\n                    const { sticker } = content;\n\n                    loadStickerContent(store, sticker, message);\n                    loadStickerThumbnailContent(store, sticker, message);\n                    break;\n                }\n                case 'messageVenue': {\n                    const { venue } = content;\n                    const { location } = venue;\n\n                    loadLocationContent(store, location, message);\n                    break;\n                }\n                case 'messageVideo': {\n                    const { video } = content;\n\n                    // loadVideoContent(store, video, message); // start loading only on video click event\n                    loadVideoThumbnailContent(store, video, message);\n                    break;\n                }\n                case 'messageVideoNote': {\n                    const { video_note } = content;\n\n                    loadVideoNoteContent(store, video_note, message);\n                    loadVideoNoteThumbnailContent(store, video_note, message);\n                    break;\n                }\n                case 'messageVoiceNote': {\n                    const { voice_note } = content;\n\n                    loadVoiceNoteContent(store, voice_note, message);\n                    break;\n                }\n                default: {\n                    break;\n                }\n            }\n        }\n    }\n\n    loadUsersContent(store, [...users.keys()]);\n    loadReplies(store, chatId, [...replies.keys()]);\n}\n\nexport function saveMedia(media, message) {\n    if (!media) return;\n\n    switch (media['@type']) {\n        case 'animation': {\n            saveAnimation(media, message);\n            break;\n        }\n        case 'document': {\n            saveDocument(media, message);\n            break;\n        }\n        case 'photo': {\n            savePhoto(media, message);\n            break;\n        }\n        case 'video': {\n            saveVideo(media, message);\n            break;\n        }\n    }\n}\n\nfunction saveAnimation(animation, message) {\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    if (!animation) return;\n\n    const { animation: file, file_name } = animation;\n    if (!file) return;\n\n    const { id: fileId } = file;\n\n    saveOrDownload(file, file_name || fileId, message || animation, () =>\n        FileStore.updateAnimationBlob(chatId, messageId, fileId)\n    );\n}\n\nfunction saveDocument(document, message) {\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    if (!document) return;\n\n    const { document: file, file_name } = document;\n    if (!file) return;\n\n    const { id: fileId } = file;\n\n    saveOrDownload(file, file_name || fileId, message || document, () =>\n        FileStore.updateDocumentBlob(chatId, messageId, fileId)\n    );\n}\n\nfunction saveVideo(video, message) {\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    if (!video) return;\n\n    const { video: file, file_name } = video;\n    if (!file) return;\n\n    const { id: fileId } = file;\n\n    saveOrDownload(file, file_name || fileId, message || video, () =>\n        FileStore.updateVideoBlob(chatId, messageId, fileId)\n    );\n}\n\nfunction savePhoto(photo, message) {\n    const chatId = message ? message.chat_id : 0;\n    const messageId = message ? message.id : 0;\n\n    if (!photo) return;\n\n    const photoSize = getSize(photo.sizes, PHOTO_BIG_SIZE);\n    if (!photoSize) return;\n\n    const { photo: file } = photoSize;\n    if (!file) return;\n\n    const { id: fileId } = file;\n\n    saveOrDownload(file, fileId + '.jpg', message || photo, () => FileStore.updatePhotoBlob(chatId, messageId, fileId));\n}\n\nfunction saveOrDownload(file, fileName, obj, callback) {\n    if (!file) return;\n    if (!fileName) return;\n\n    if (file.arr) {\n        saveData(file.arr, fileName);\n        return;\n    }\n\n    let blob = FileStore.getBlob(file.id) || file.blob;\n    if (blob) {\n        saveBlob(blob, fileName);\n        return;\n    }\n\n    download(file, obj, () => {\n        if (callback) callback();\n\n        blob = FileStore.getBlob(file.id) || file.blob;\n        if (blob) {\n            saveBlob(blob, fileName);\n        }\n    });\n}\n\nfunction download(file, obj, callback) {\n    if (!file) return;\n    const { id, local } = file;\n\n    const blob = FileStore.getBlob(id);\n    if (blob) {\n        return;\n    }\n\n    if (local.is_downloading_completed) {\n        const store = FileStore.getStore();\n\n        FileStore.getLocalFile(store, file, null, callback, () => {\n            if (local.can_be_downloaded) {\n                FileStore.getRemoteFile(file.id, FILE_PRIORITY, obj);\n            }\n        });\n        return;\n    }\n\n    if (local.can_be_downloaded) {\n        FileStore.getRemoteFile(id, FILE_PRIORITY, obj);\n    }\n}\n\nexport function getViewerMinithumbnail(media) {\n    if (!media) return [0, 0, null];\n\n    switch (media['@type']) {\n        case 'animation': {\n            const { minithumbnail } = media;\n            if (minithumbnail) {\n                return [minithumbnail.width, minithumbnail.height, minithumbnail];\n            }\n            break;\n        }\n        case 'document': {\n            const { minithumbnail } = media;\n            if (minithumbnail) {\n                return [minithumbnail.width, minithumbnail.height, minithumbnail];\n            }\n            break;\n        }\n        case 'photo': {\n            const { minithumbnail } = media;\n            if (minithumbnail) {\n                return [minithumbnail.width, minithumbnail.height, minithumbnail];\n            }\n            break;\n        }\n        case 'video': {\n            const { minithumbnail } = media;\n            if (minithumbnail) {\n                return [minithumbnail.width, minithumbnail.height, minithumbnail];\n            }\n            break;\n        }\n        default: {\n            return [0, 0, null];\n        }\n    }\n\n    return [0, 0, null];\n}\n\nfunction getViewerThumbnail(media) {\n    if (!media) return [0, 0, null];\n\n    switch (media['@type']) {\n        case 'animation': {\n            const { thumbnail } = media;\n            if (thumbnail) {\n                return [thumbnail.width, thumbnail.height, thumbnail.file];\n            }\n            break;\n        }\n        case 'document': {\n            const { thumbnail } = media;\n            if (thumbnail) {\n                return [thumbnail.width, thumbnail.height, thumbnail.file];\n            }\n            break;\n        }\n        case 'photo': {\n            return getViewerFile(media, PHOTO_SIZE);\n        }\n        case 'video': {\n            const { thumbnail } = media;\n            if (thumbnail) {\n                return [thumbnail.width, thumbnail.height, thumbnail.file];\n            }\n            break;\n        }\n        default: {\n            return [0, 0, null];\n        }\n    }\n\n    return [0, 0, null];\n}\n\nexport function getMediaMiniPreview(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return [0, 0, null];\n\n    const { content } = message;\n    if (!content) return [0, 0, null];\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            const { animation } = content;\n            if (animation && animation.minithumbnail) {\n                return [animation.minithumbnail.width, animation.minithumbnail.height, animation.minithumbnail];\n            }\n            break;\n        }\n        case 'messageChatChangePhoto': {\n            const { photo } = content;\n            if (photo && photo.minithumbnail) {\n                return [photo.minithumbnail.width, photo.minithumbnail.height, photo.minithumbnail];\n            }\n            break;\n        }\n        case 'messageDocument': {\n            const { document } = content;\n            if (document && document.minithumbnail) {\n                return [document.minithumbnail.width, document.minithumbnail.height, document.minithumbnail];\n            }\n            break;\n        }\n        case 'messagePhoto': {\n            const { photo } = content;\n            if (photo && photo.minithumbnail) {\n                return [photo.minithumbnail.width, photo.minithumbnail.height, photo.minithumbnail];\n            }\n            break;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { animation, document, video, photo } = web_page;\n\n                if (animation && animation.minithumbnail) {\n                    return [animation.minithumbnail.width, animation.minithumbnail.height, animation.minithumbnail];\n                }\n\n                if (document && document.minithumbnail) {\n                    return [document.minithumbnail.width, document.minithumbnail.height, document.minithumbnail];\n                }\n\n                if (video && video.minithumbnail) {\n                    return [video.minithumbnail.width, video.minithumbnail.height, video.minithumbnail];\n                }\n\n                if (photo && photo.minithumbnail) {\n                    return [photo.minithumbnail.width, photo.minithumbnail.height, photo.minithumbnail];\n                }\n            }\n            break;\n        }\n        case 'messageVideo': {\n            const { video } = content;\n            if (video && video.minithumbnail) {\n                return [video.minithumbnail.width, video.minithumbnail.height, video.minithumbnail];\n            }\n            break;\n        }\n        default: {\n            return [0, 0, null];\n        }\n    }\n\n    return [0, 0, null];\n}\n\nfunction getMediaPreviewFile(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return [0, 0, null];\n\n    const { content } = message;\n    if (!content) return [0, 0, null];\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            const { animation } = content;\n            if (animation && animation.thumbnail) {\n                return [animation.thumbnail.width, animation.thumbnail.height, animation.thumbnail.file];\n            }\n            break;\n        }\n        case 'messageChatChangePhoto': {\n            return getMediaFile(chatId, messageId, PHOTO_SIZE);\n        }\n        case 'messageDocument': {\n            const { document } = content;\n            if (document) {\n                return [50, 50, document.document];\n            }\n            break;\n        }\n        case 'messagePhoto': {\n            return getMediaFile(chatId, messageId, PHOTO_SIZE);\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { animation, document, video, photo } = web_page;\n\n                if (animation && animation.thumbnail) {\n                    return [animation.thumbnail.width, animation.thumbnail.height, animation.thumbnail.file];\n                }\n\n                if (document) {\n                    return [50, 50, document.document];\n                }\n\n                if (video && video.thumbnail) {\n                    return [video.thumbnail.width, video.thumbnail.height, video.thumbnail.file];\n                }\n\n                if (photo) {\n                    return getMediaFile(chatId, messageId, PHOTO_SIZE);\n                }\n            }\n            break;\n        }\n        case 'messageVideo': {\n            const { video } = content;\n            if (video && video.thumbnail) {\n                return [video.thumbnail.width, video.thumbnail.height, video.thumbnail.file];\n            }\n            break;\n        }\n        default: {\n            return [0, 0, null];\n        }\n    }\n\n    return [0, 0, null];\n}\n\nfunction getViewerFile(media, size) {\n    if (!size) return [0, 0, null, '', false];\n\n    switch (media['@type']) {\n        case 'animation': {\n            return [media.width, media.height, media.animation, media.mime_type, false];\n        }\n        case 'photo': {\n            const photoSize = getSize(media.sizes, size);\n            if (photoSize) {\n                return [photoSize.width, photoSize.height, photoSize.photo, '', false];\n            }\n            break;\n        }\n        case 'document': {\n            return [50, 50, document.document, document.mime_type, false];\n        }\n        case 'video': {\n            return [media.width, media.height, media.video, media.mime_type, media.supports_streaming && supportsStreaming()];\n        }\n        default: {\n        }\n    }\n\n    return [0, 0, null, '', false];\n}\n\nfunction getMediaFile(chatId, messageId, size) {\n    if (!size) return [0, 0, null, '', false];\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return [0, 0, null, '', false];\n\n    const { content } = message;\n    if (!content) return [0, 0, null, '', false];\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            const { animation } = content;\n            if (animation) {\n                const { width, height, animation: file, mime_type } = animation;\n                return [width, height, file, mime_type, false];\n            }\n            break;\n        }\n        case 'messageChatChangePhoto': {\n            const { photo } = content;\n            if (photo) {\n                const photoSize = getSize(photo.sizes, size);\n                if (photoSize) {\n                    const { width, height, photo: file } = photoSize;\n                    return [width, height, file, '', false];\n                }\n            }\n            break;\n        }\n        case 'messageDocument': {\n            const { document } = content;\n            if (document) {\n                const { document: file, mime_type } = document;\n                return [50, 50, file, mime_type, false];\n            }\n            break;\n        }\n        case 'messagePhoto': {\n            const { photo } = content;\n            if (photo) {\n                const photoSize = getSize(photo.sizes, size);\n                if (photoSize) {\n                    const { width, height, photo: file } = photoSize;\n                    return [width, height, file, '', false];\n                }\n            }\n            break;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { animation, document, photo, video } = web_page;\n                if (animation) {\n                    const { width, height, animation: file, mime_type } = animation;\n                    return [width, height, file, mime_type, false];\n                }\n\n                if (document) {\n                    const { document: file, mime_type } = document;\n                    return [50, 50, file, mime_type, false];\n                }\n\n                if (video) {\n                    const { width, height, video: file, mime_type, supports_streaming } = video;\n                    return [width, height, file, mime_type, supports_streaming && supportsStreaming()];\n                }\n\n                if (photo) {\n                    const photoSize = getSize(photo.sizes, size);\n                    if (photoSize) {\n                        const { width, height, photo: file } = photoSize;\n                        return [width, height, file, '', false];\n                    }\n                    break;\n                }\n            }\n            break;\n        }\n        case 'messageVideo': {\n            const { video } = content;\n            if (video) {\n                const { width, height, video: file, mime_type, supports_streaming } = video;\n                return [width, height, file, mime_type, supports_streaming && supportsStreaming()];\n            }\n            break;\n        }\n        default: {\n        }\n    }\n\n    return [0, 0, null, '', false];\n}\n\nexport function cancelLoadIVMediaViewerContent(blocks) {\n    if (!blocks) return;\n    if (!blocks.length) return;\n\n    for (let i = 0; i < blocks.length; i++) {\n        const content = blocks[i];\n        if (content) {\n            switch (content['@type']) {\n                case 'pageBlockAnimation': {\n                    const { animation } = content;\n                    if (!animation) break;\n\n                    cancelLoadAnimationThumbnailContent(animation);\n                    cancelLoadAnimationContent(animation);\n                    break;\n                }\n                case 'pageBlockPhoto': {\n                    const { photo } = content;\n                    if (!photo) break;\n\n                    cancelLoadBigPhotoContent(photo);\n                    break;\n                }\n                case 'pageBlockVideo': {\n                    const { video } = content;\n                    if (!video) break;\n\n                    cancelLoadVideoThumbnailContent(video);\n                    cancelLoadVideoContent(video);\n                    break;\n                }\n            }\n        }\n    }\n}\n\nfunction cancelLoadMediaViewerContent(messages) {\n    if (!messages) return;\n    if (!messages.length) return;\n\n    for (let i = 0; i < messages.length; i++) {\n        let message = messages[i];\n        const { content } = message;\n        if (content) {\n            switch (content['@type']) {\n                case 'messageAnimation': {\n                    const { animation } = content;\n                    if (!animation) break;\n\n                    cancelLoadAnimationThumbnailContent(animation);\n                    cancelLoadAnimationContent(animation);\n                    break;\n                }\n                case 'messagePhoto': {\n                    const { photo } = content;\n                    if (!photo) break;\n\n                    cancelLoadBigPhotoContent(photo);\n                    break;\n                }\n                case 'messageVideo': {\n                    const { video } = content;\n                    if (!video) break;\n\n                    cancelLoadVideoThumbnailContent(video);\n                    cancelLoadVideoContent(video);\n                    break;\n                }\n                case 'messageText': {\n                    const { web_page } = message.content;\n                    if (web_page) {\n                        const { animation, photo, video } = web_page;\n\n                        if (animation) {\n                            cancelLoadAnimationThumbnailContent(animation);\n                            cancelLoadAnimationContent(animation);\n                        }\n\n                        if (photo) {\n                            cancelLoadBigPhotoContent(photo);\n                        }\n\n                        if (video) {\n                            cancelLoadVideoThumbnailContent(video);\n                            cancelLoadVideoContent(video);\n                        }\n                    }\n\n                    break;\n                }\n            }\n        }\n    }\n}\n\nexport function loadIVMediaViewerContent(blocks, useSizeLimit = false) {\n    if (!blocks) return;\n    if (!blocks.length) return;\n\n    const store = FileStore.getStore();\n\n    for (let i = 0; i < blocks.length; i++) {\n        const content = blocks[i];\n        if (content) {\n            switch (content['@type']) {\n                case 'pageBlockAnimation': {\n                    const { animation } = content;\n\n                    loadAnimationContent(store, animation, null, useSizeLimit);\n                    loadAnimationThumbnailContent(store, animation, null);\n                    break;\n                }\n                case 'pageBlockPhoto': {\n                    const { photo } = content;\n\n                    loadBigPhotoContent(store, photo, null);\n                    break;\n                }\n                case 'pageBlockVideo': {\n                    const { video } = content;\n\n                    loadVideoThumbnailContent(store, video, null);\n                    loadVideoContent(store, video, null, useSizeLimit);\n                    break;\n                }\n            }\n        }\n    }\n}\n\nfunction loadMediaViewerContent(messages, useSizeLimit = false) {\n    if (!messages) return;\n    if (!messages.length) return;\n\n    const store = FileStore.getStore();\n\n    for (let i = 0; i < messages.length; i++) {\n        let message = messages[i];\n        const { content } = message;\n        if (content) {\n            switch (content['@type']) {\n                case 'messageAnimation': {\n                    const { animation } = content;\n\n                    loadAnimationContent(store, animation, message, useSizeLimit);\n                    loadAnimationThumbnailContent(store, animation, message);\n                    break;\n                }\n                case 'messageChatChangePhoto': {\n                    const { photo } = content;\n\n                    loadBigPhotoContent(store, photo, message);\n                    break;\n                }\n                case 'messageDocument': {\n                    const { document } = content;\n\n                    loadDocumentContent(store, document, message, useSizeLimit);\n                    break;\n                }\n                case 'messagePhoto': {\n                    const { photo } = content;\n\n                    loadBigPhotoContent(store, photo, message);\n                    break;\n                }\n                case 'messageText': {\n                    const { web_page } = message.content;\n                    if (!web_page) {\n                        break;\n                    }\n\n                    const { animation, document, photo, video } = web_page;\n                    let loadPhoto = true;\n\n                    if (animation) {\n                        loadAnimationContent(store, animation, message, useSizeLimit);\n                        loadPhoto = !loadAnimationThumbnailContent(store, animation, message);\n                    }\n\n                    if (document) {\n                        loadDocumentContent(store, document, message, useSizeLimit);\n                        loadPhoto = false;\n                    }\n\n                    if (video) {\n                        loadVideoContent(store, video, message, useSizeLimit);\n                        loadPhoto = !loadVideoThumbnailContent(store, video, message);\n                    }\n\n                    if (loadPhoto) {\n                        loadBigPhotoContent(store, photo, message);\n                    }\n\n                    break;\n                }\n                case 'messageVideo': {\n                    const { video } = content;\n\n                    loadVideoThumbnailContent(store, video, message);\n                    loadVideoContent(store, video, message, useSizeLimit);\n                    break;\n                }\n            }\n        }\n    }\n}\n\nexport function cancelPreloadIVMediaViewerContent(index, blocks) {\n    if (!blocks.length) return;\n\n    const preload = [];\n    if (index > 0) {\n        preload.push(blocks[index - 1]);\n    }\n    if (index < blocks.length - 1) {\n        preload.push(blocks[index + 1]);\n    }\n\n    cancelLoadIVMediaViewerContent([blocks[index]]);\n    cancelLoadIVMediaViewerContent(blocks);\n}\n\nfunction cancelPreloadMediaViewerContent(index, history) {\n    if (!history.length) return;\n\n    const messages = [];\n    if (index > 0) {\n        messages.push(history[index - 1]);\n    }\n    if (index < history.length - 1) {\n        messages.push(history[index + 1]);\n    }\n\n    cancelLoadMediaViewerContent([history[index]]);\n    cancelLoadMediaViewerContent(messages);\n}\n\nfunction preloadMediaViewerContent(index, history) {\n    if (!history.length) return;\n\n    const messages = [];\n    if (index > 0) {\n        messages.push(history[index - 1]);\n    }\n    if (index < history.length - 1) {\n        messages.push(history[index + 1]);\n    }\n\n    loadMediaViewerContent([history[index]], false);\n    loadMediaViewerContent(messages, true);\n}\n\nexport function preloadIVMediaViewerContent(index, blocks) {\n    if (!blocks.length) return;\n\n    const preload = [];\n    if (index > 0) {\n        preload.push(blocks[index - 1]);\n    }\n    if (index < blocks.length - 1) {\n        preload.push(blocks[index + 1]);\n    }\n\n    loadIVMediaViewerContent([blocks[index]], false);\n    loadIVMediaViewerContent(preload, true);\n}\n\nfunction loadUserFileContent(store, file, userId) {\n    if (!file) return;\n\n    const { id } = file;\n    file = FileStore.get(id) || file;\n\n    const user = UserStore.get(userId);\n    if (!user) return;\n\n    const blob = file.blob || FileStore.getBlob(id);\n    if (blob) return;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateUserPhotoBlob(userId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, user)\n    );\n}\n\nfunction loadChatFileContent(store, file, chatId) {\n    if (!file) return;\n\n    const { id } = file;\n    file = FileStore.get(id) || file;\n\n    const chat = ChatStore.get(chatId);\n    if (!chat) return;\n\n    const dataUrl = FileStore.getDataUrl(id);\n    if (dataUrl) return;\n\n    const blob = file.blob || FileStore.getBlob(id);\n    if (blob) return;\n\n    FileStore.getLocalFile(\n        store,\n        file,\n        null,\n        () => FileStore.updateChatPhotoBlob(chatId, id),\n        () => FileStore.getRemoteFile(id, THUMBNAIL_PRIORITY, chat)\n    );\n}\n\nfunction loadProfileMediaViewerContent(chatId, photos) {\n    if (!photos) return;\n\n    const store = FileStore.getStore();\n\n    photos.forEach(photo => {\n        switch (photo['@type']) {\n            case 'chatPhoto': {\n                const { small, big } = photo;\n\n                loadChatFileContent(store, small, chatId);\n                loadChatFileContent(store, big, chatId);\n                break;\n            }\n            case 'profilePhoto': {\n                const userId = getChatUserId(chatId);\n\n                const { small, big } = photo;\n\n                loadUserFileContent(store, small, userId);\n                loadUserFileContent(store, big, userId);\n                break;\n            }\n            case 'userProfilePhoto': {\n                photo = getProfilePhoto(photo);\n                if (!photo) break;\n\n                const userId = getChatUserId(chatId);\n\n                const { small, big } = photo;\n\n                loadUserFileContent(store, small, userId);\n                loadUserFileContent(store, big, userId);\n                break;\n            }\n        }\n    });\n}\n\nfunction preloadProfileMediaViewerContent(chatId, index, history) {\n    if (!history.length) return;\n\n    const items = [];\n    if (index > 0) {\n        items.push(history[index - 1]);\n    }\n    if (index < history.length - 1) {\n        items.push(history[index + 1]);\n    }\n    if (index >= 0 && index < history.length) {\n        items.push(history[index]);\n    }\n\n    loadProfileMediaViewerContent(chatId, items);\n}\n\nfunction loadUserContent(store, userId) {\n    const user = UserStore.get(userId);\n    if (!user) return;\n\n    const { profile_photo } = user;\n    if (!profile_photo) return;\n\n    const { small: file } = profile_photo;\n\n    loadUserFileContent(store, file, userId);\n}\n\nfunction loadUsersContent(store, ids) {\n    if (!ids) return;\n\n    ids.forEach(id => loadUserContent(store, id));\n}\n\nfunction loadChatContent(store, chatId, full = false) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return;\n\n    const { photo } = chat;\n    loadChatPhotoContent(store, photo, chat.id, full);\n}\n\nfunction loadChatPhotoContent(store, photo, chatId, full) {\n    if (!photo) return;\n\n    const { small, big } = photo;\n\n    loadChatFileContent(store, small, chatId);\n    if (full) loadChatFileContent(store, big, chatId);\n}\n\nfunction loadChatsContent(store, ids) {\n    if (!ids) return;\n\n    ids.forEach(id => loadChatContent(store, id));\n}\n\nfunction loadDraftContent(store, chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return;\n\n    const { draft_message } = chat;\n    if (!draft_message) return;\n\n    const { reply_to_message_id } = draft_message;\n    if (!reply_to_message_id) return;\n\n    loadReplies(store, chatId, [reply_to_message_id]);\n}\n\nexport function loadRecentStickersContent(store, recent) {\n    if (!recent) return;\n\n    const { stickers } = recent;\n    loadStickersContent(store, stickers);\n}\n\nfunction loadStickerSetContent(store, stickerSet) {\n    // console.log('[sp] loadStickerSetContent');\n    if (!stickerSet) return;\n\n    const { stickers } = stickerSet;\n    loadStickersContent(store, stickers);\n}\n\nexport function loadBackgroundsContent(store, backgrounds) {\n    if (!backgrounds) return;\n\n    backgrounds.forEach(background => {\n        loadBackgroundContent(store, background, false);\n    });\n}\n\nexport function loadBackgroundContent(store, background, full = false) {\n    if (!background) return;\n\n    switch (background.type['@type']) {\n        case 'backgroundTypeFill': {\n            break;\n        }\n        case 'backgroundTypePattern': {\n            const { document } = background;\n            if (document) {\n                loadDocumentThumbnailContent(store, document, null);\n                if (full) loadDocumentContent(store, document, null, false);\n            }\n            break;\n        }\n        case 'backgroundTypeWallpaper': {\n            const { document } = background;\n            if (document) {\n                loadDocumentThumbnailContent(store, document, null);\n                if (full) loadDocumentContent(store, document, null, false);\n            }\n            break;\n        }\n    }\n}\n\nfunction loadStickersContent(store, stickers) {\n    if (!stickers) return;\n\n    stickers.forEach(sticker => {\n        loadStickerThumbnailContent(store, sticker, null);\n        if (sticker.is_animated) {\n            loadStickerContent(store, sticker, null);\n        }\n    });\n}\n\nfunction isGifMimeType(mimeType) {\n    return mimeType && mimeType.toLowerCase() === 'image/gif';\n}\n\nfunction getSrc(file) {\n    const dataUrl = file && FileStore.getDataUrl(file.id);\n    if (dataUrl) return dataUrl;\n\n    const blob = getBlob(file);\n\n    return FileStore.getBlobUrl(blob) || '';\n}\n\nfunction getBlob(file) {\n    return file ? FileStore.getBlob(file.id) || file.blob : null;\n}\n\nfunction getDownloadedSize(file) {\n    if (!file) return '0';\n    if (!file.local) return '0';\n    if (!file.local.is_downloading_active) return '0';\n\n    return getSizeString(file.local.downloaded_size);\n}\n\nfunction getUploadedSize(file) {\n    if (!file) return '0';\n    if (!file.remote) return '0';\n    if (!file.remote.is_uploading_active) return '0';\n\n    return getSizeString(file.remote.uploaded_size);\n}\n\nfunction getExtension(fileName) {\n    if (!fileName) {\n        return '';\n    }\n\n    const parts = fileName.split('.');\n    if (parts.length === 1 || (parts[0] === '' && parts.length === 2)) {\n        return '';\n    }\n    return parts.pop().toLowerCase();\n}\n\nfunction loadInstantViewContent(instantView) {\n    if (!instantView) return;\n\n    const { page_blocks } = instantView;\n    if (!page_blocks) return;\n\n    const store = FileStore.getStore();\n\n    page_blocks.forEach(pageBlock => loadPageBlockContent(store, pageBlock));\n}\n\nfunction loadPageBlockContent(store, b) {\n    if (!b) return;\n\n    switch (b['@type']) {\n        case 'pageBlockAnchor': {\n            break;\n        }\n        case 'pageBlockAnimation': {\n            const { animation, caption } = b;\n\n            loadAnimationThumbnailContent(store, animation, null);\n            loadAnimationContent(store, animation, null);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockAudio': {\n            const { audio, caption } = b;\n\n            loadAudioThumbnailContent(store, audio, null);\n            loadAudioContent(store, audio, null);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockAuthorDate': {\n            const { author } = b;\n\n            loadRichTextContent(store, author);\n            break;\n        }\n        case 'pageBlockBlockQuote': {\n            const { text, credit } = b;\n\n            loadRichTextContent(store, text);\n            loadRichTextContent(store, credit);\n            break;\n        }\n        // actually not a pageBlock child but load content in the same way\n        case 'pageBlockCaption': {\n            const { text, credit } = b;\n\n            loadRichTextContent(store, text);\n            loadRichTextContent(store, credit);\n            break;\n        }\n        case 'pageBlockChatLink': {\n            const { photo } = b;\n\n            loadChatPhotoContent(store, photo, 0);\n            break;\n        }\n        case 'pageBlockCollage': {\n            const { page_blocks, caption } = b;\n\n            loadPageBlockContent(store, caption);\n            page_blocks.forEach(x => loadPageBlockContent(store, x));\n            break;\n        }\n        case 'pageBlockCover': {\n            const { cover } = b;\n\n            loadPageBlockContent(store, cover);\n            break;\n        }\n        case 'pageBlockDetails': {\n            const { header, page_blocks } = b;\n\n            loadPageBlockContent(store, header);\n            page_blocks.forEach(x => loadPageBlockContent(store, x));\n            break;\n        }\n        case 'pageBlockDivider': {\n            break;\n        }\n        case 'pageBlockEmbedded': {\n            const { poster_photo, caption } = b;\n\n            loadPhotoContent(store, poster_photo, null);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockEmbeddedPost': {\n            const { author_photo, page_blocks, caption } = b;\n\n            loadPhotoContent(store, author_photo, null);\n            page_blocks.forEach(x => loadPageBlockContent(store, x));\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockFooter': {\n            const { footer } = b;\n\n            loadRichTextContent(store, footer);\n            break;\n        }\n        case 'pageBlockHeader': {\n            const { header } = b;\n\n            loadRichTextContent(store, header);\n            break;\n        }\n        case 'pageBlockKicker': {\n            const { kicker } = b;\n\n            loadRichTextContent(store, kicker);\n            break;\n        }\n        case 'pageBlockList': {\n            const { items } = b;\n\n            items.forEach(x => loadPageBlockContent(store, x));\n            break;\n        }\n        // actually not a pageBlock child but load content in the same way\n        case 'pageBlockListItem': {\n            const { page_blocks } = b;\n\n            page_blocks.forEach(x => loadPageBlockContent(store, x));\n            break;\n        }\n        case 'pageBlockMap': {\n            const { caption } = b;\n\n            loadPageBlockMapContent(store, b, null);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockParagraph': {\n            const { text } = b;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'pageBlockPhoto': {\n            const { photo, caption } = b;\n\n            loadPhotoContent(store, photo, null, IV_PHOTO_SIZE);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockPreformatted': {\n            const { text } = b;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'pageBlockPullQuote': {\n            const { text, credit } = b;\n\n            loadRichTextContent(store, text);\n            loadRichTextContent(store, credit);\n            break;\n        }\n        case 'pageBlockRelatedArticles': {\n            const { header, articles } = b;\n\n            loadRichTextContent(store, header);\n            articles.forEach(x => loadPageBlockContent(store, x));\n            break;\n        }\n        // actually not a pageBlock child but load content in the same way\n        case 'pageBlockRelatedArticle': {\n            const { photo } = b;\n\n            loadPhotoContent(store, photo, null);\n            break;\n        }\n        case 'pageBlockSlideshow': {\n            const { page_blocks, caption } = b;\n\n            loadPageBlockContent(store, caption);\n            page_blocks.forEach(x => loadPageBlockContent(store, x));\n            break;\n        }\n        case 'pageBlockSubheader': {\n            const { subheader } = b;\n\n            loadRichTextContent(store, subheader);\n            break;\n        }\n        case 'pageBlockSubtitle': {\n            const { subtitle } = b;\n\n            loadRichTextContent(store, subtitle);\n            break;\n        }\n        case 'pageBlockTable': {\n            const { caption, cells } = b;\n\n            loadRichTextContent(store, caption);\n            cells.forEach(row => row.forEach(x => loadPageBlockContent(store, x)));\n            break;\n        }\n        // actually not a pageBlock child but load content in the same way\n        case 'pageBlockTableCell': {\n            const { text } = b;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'pageBlockTitle': {\n            const { title } = b;\n\n            loadRichTextContent(store, title);\n            break;\n        }\n        case 'pageBlockVideo': {\n            const { video, caption } = b;\n\n            loadVideoThumbnailContent(store, video, null);\n            loadVideoContent(store, video, null);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n        case 'pageBlockVoiceNote': {\n            const { voice_note, caption } = b;\n\n            loadVoiceNoteContent(store, voice_note, null);\n            loadPageBlockContent(store, caption);\n            break;\n        }\n    }\n}\n\nfunction loadRichTextContent(store, t) {\n    if (!t) return;\n\n    switch (t['@type']) {\n        case 'richTextAnchor': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextBold': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextEmailAddress': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextFixed': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextIcon': {\n            const { document } = t;\n\n            loadDocumentThumbnailContent(store, document, null);\n            loadDocumentContent(store, document, null, false);\n            break;\n        }\n        case 'richTextItalic': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextMarked': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextPhoneNumber': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextPlain': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTexts': {\n            const { texts } = t;\n\n            texts.forEach(x => loadRichTextContent(store, x));\n            break;\n        }\n        case 'richTextStrikethrough': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextSubscript': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextSuperscript': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextUnderline': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n        case 'richTextUrl': {\n            const { text } = t;\n\n            loadRichTextContent(store, text);\n            break;\n        }\n    }\n}\n\nfunction getAnimationData(file) {\n    return new Promise(resolve => {\n        if (!file) {\n            resolve(null);\n            return;\n        }\n\n        const blob = FileStore.getBlob(file.id);\n        if (!blob) {\n            resolve(null);\n            return;\n        }\n\n        const fileReader = new FileReader();\n        fileReader.onload = event => resolve(JSON.parse(event.target.result));\n        fileReader.onerror = () => resolve(null);\n        fileReader.onabort = () => resolve(null);\n        fileReader.readAsText(blob);\n    });\n}\n\nexport {\n    getFileSize,\n    getSizeString,\n    saveData,\n    saveBlob,\n    loadMessageContents,\n    loadMediaViewerContent,\n    preloadMediaViewerContent,\n    cancelLoadMediaViewerContent,\n    cancelPreloadMediaViewerContent,\n    loadProfileMediaViewerContent,\n    preloadProfileMediaViewerContent,\n    loadChatContent,\n    loadChatsContent,\n    loadDraftContent,\n    loadInstantViewContent,\n    loadStickerContent,\n    loadStickersContent,\n    loadStickerSetContent,\n    loadStickerThumbnailContent,\n    loadUserContent,\n    loadUsersContent,\n    saveOrDownload,\n    download,\n    getMediaFile,\n    getMediaPreviewFile,\n    isGifMimeType,\n    getSrc,\n    getBlob,\n    getDownloadedSize,\n    getUploadedSize,\n    getExtension,\n    getViewerFile,\n    getViewerThumbnail,\n    getAnimationData\n};\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { PHOTO_SIZE, PHOTO_THUMBNAIL_SIZE } from '../Constants';\n\nexport function compareMaps(map1, map2) {\n    if (!map1 || !map2) return false;\n\n    let testVal;\n    if (map1.size !== map2.size) {\n        return false;\n    }\n\n    for (let [key, val] of map1) {\n        testVal = map2.get(key);\n        // in cases of an undefined value, make sure the key\n        // actually exists on the object so there are no false positives\n        if (testVal !== val || (testVal === undefined && !map2.has(key))) {\n            return false;\n        }\n    }\n    return true;\n}\n\nexport function isMobile() {\n    return isAndroid() || isIOS() || isWindowsPhone();\n}\n\nexport function isIOS() {\n    const iDevices = ['iPad Simulator', 'iPhone Simulator', 'iPod Simulator', 'iPad', 'iPhone', 'iPod'];\n\n    if (!!navigator.platform && iDevices.indexOf(navigator.platform) > -1) {\n        return true;\n    }\n\n    return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n}\n\nexport function isAndroid() {\n    const ua = navigator.userAgent.toLowerCase();\n    return ua.indexOf('android') > -1;\n}\n\nexport function isWindowsPhone() {\n    if (navigator.userAgent.match(/Windows Phone/i)) {\n        return true;\n    }\n\n    if (navigator.userAgent.match(/iemobile/i)) {\n        return true;\n    }\n\n    if (navigator.userAgent.match(/WPDesktop/i)) {\n        return true;\n    }\n\n    return false;\n}\n\nfunction isAppleDevice() {\n    const iDevices = ['iPad Simulator', 'iPhone Simulator', 'iPod Simulator', 'iPad', 'iPhone', 'iPod', 'MacIntel'];\n\n    if (!!navigator.platform) {\n        return iDevices.indexOf(navigator.platform) > -1;\n    }\n\n    return /iPad|iPhone|iPod|Mac\\sOS\\sX/.test(navigator.userAgent) && !window.MSStream;\n}\n\nfunction getOSName() {\n    let OSName = 'Unknown';\n    if (window.navigator.userAgent.indexOf('Windows NT 10.0') !== -1) OSName = 'Windows 10';\n    if (window.navigator.userAgent.indexOf('Windows NT 6.2') !== -1) OSName = 'Windows 8';\n    if (window.navigator.userAgent.indexOf('Windows NT 6.1') !== -1) OSName = 'Windows 7';\n    if (window.navigator.userAgent.indexOf('Windows NT 6.0') !== -1) OSName = 'Windows Vista';\n    if (window.navigator.userAgent.indexOf('Windows NT 5.1') !== -1) OSName = 'Windows XP';\n    if (window.navigator.userAgent.indexOf('Windows NT 5.0') !== -1) OSName = 'Windows 2000';\n    if (window.navigator.userAgent.indexOf('Mac') !== -1) OSName = 'Mac/iOS';\n    if (window.navigator.userAgent.indexOf('X11') !== -1) OSName = 'UNIX';\n    if (window.navigator.userAgent.indexOf('Linux') !== -1) OSName = 'Linux';\n\n    return OSName;\n}\n\nfunction getBrowser() {\n    let browser_name = '';\n    let isIE = /*@cc_on!@*/ false || !!document.documentMode;\n    let isEdge = !isIE && !!window.StyleMedia;\n    if (navigator.userAgent.indexOf('Chrome') !== -1 && !isEdge) {\n        browser_name = 'Chrome';\n    } else if (navigator.userAgent.indexOf('Safari') !== -1 && !isEdge) {\n        browser_name = 'Safari';\n    } else if (navigator.userAgent.indexOf('Firefox') !== -1) {\n        browser_name = 'Firefox';\n    } else if (navigator.userAgent.indexOf('MSIE') !== -1 || !!document.documentMode === true) {\n        //IF IE > 10\n        browser_name = 'IE';\n    } else if (isEdge) {\n        browser_name = 'Edge';\n    } else {\n        browser_name = 'Unknown';\n    }\n\n    return browser_name;\n}\n\nfunction stringToBoolean(string) {\n    switch (string.toLowerCase().trim()) {\n        case 'true':\n        case 'yes':\n        case '1':\n            return true;\n        case 'false':\n        case 'no':\n        case '0':\n        case null:\n            return false;\n        default:\n            return Boolean(string);\n    }\n}\n\nfunction orderCompare(order1, order2) {\n    let diff = order1.length - order2.length;\n    if (diff !== 0) return diff < 0 ? -1 : 1;\n    if (order1 === order2) return 0;\n\n    return order1 > order2 ? 1 : -1;\n}\n\nfunction getPhotoThumbnailSize(sizes) {\n    return getSize(sizes, PHOTO_THUMBNAIL_SIZE);\n}\n\nfunction getPhotoSize(sizes, displaySize = PHOTO_SIZE) {\n    return getSize(sizes, displaySize);\n}\n\nfunction getSize(sizes, dimension) {\n    if (!sizes) return null;\n    if (sizes.length === 0) return null;\n    if (dimension === 0) return null;\n\n    let iSize = sizes.find(x => x.type === 'i');\n    if (iSize){\n        return iSize;\n    }\n\n    let useWidth = sizes[0].width >= sizes[0].height;\n    let diff = Math.abs(dimension - (useWidth ? sizes[0].width : sizes[0].height));\n    let index = 0;\n    for (let i = 1; i < sizes.length; i++) {\n        if (!sizes[i]) {\n            continue;\n        }\n\n        if (sizes[i].type === 'i' && !sizes[i].photo.local.is_downloading_completed) {\n            continue;\n        }\n\n        let currDiff = Math.abs(dimension - (useWidth ? sizes[i].width : sizes[i].height));\n        if (currDiff < diff) {\n            index = i;\n            currDiff = diff;\n        }\n    }\n\n    return sizes[index];\n}\n\nfunction getFitSize(size, max, stretch = true) {\n    if (!size) return { width: 0, height: 0 };\n\n    if (!stretch) {\n        if (size.width < max && size.height < max) {\n            return size;\n        }\n    }\n\n    if (size.width > size.height) {\n        return { width: max, height: Math.floor((size.height * max) / size.width) };\n    }\n\n    return { width: Math.floor((size.width * max) / size.height), height: max };\n}\n\nfunction itemsInView(scrollContainerRef, itemsContainerRef) {\n    let scrollContainer = scrollContainerRef.current;\n    let itemsContainer = itemsContainerRef ? itemsContainerRef.current : scrollContainer;\n\n    const items = [];\n    for (let i = 0; i < itemsContainer.children.length; i++) {\n        let child = itemsContainer.children[i];\n        if (\n            child.offsetTop + child.offsetHeight >= scrollContainer.scrollTop &&\n            child.offsetTop <= scrollContainer.scrollTop + scrollContainer.offsetHeight\n        ) {\n            items.push(i);\n        }\n    }\n\n    return items;\n}\n\n// Returns a function, that, when invoked, will only be triggered at most once\n// during a given window of time. Normally, the throttled function will run\n// as much as it can, without ever going more than once per `wait` duration;\n// but if you'd like to disable the execution on the leading edge, pass\n// `{leading: false}`. To disable execution on the trailing edge, ditto.\nfunction throttle(func, wait, options) {\n    var context, args, result;\n    var timeout = null;\n    var previous = 0;\n    if (!options) options = {};\n    var later = function() {\n        previous = options.leading === false ? 0 : Date.now();\n        timeout = null;\n        result = func.apply(context, args);\n        if (!timeout) context = args = null;\n    };\n    return function() {\n        var now = Date.now();\n        if (!previous && options.leading === false) previous = now;\n        var remaining = wait - (now - previous);\n        context = this;\n        args = arguments;\n        if (remaining <= 0 || remaining > wait) {\n            if (timeout) {\n                clearTimeout(timeout);\n                timeout = null;\n            }\n            previous = now;\n            result = func.apply(context, args);\n            if (!timeout) context = args = null;\n        } else if (!timeout && options.trailing !== false) {\n            timeout = setTimeout(later, remaining);\n        }\n        return result;\n    };\n}\n\n// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\nfunction debounce(func, wait, immediate) {\n    var timeout;\n    return function() {\n        var context = this,\n            args = arguments;\n        var later = function() {\n            timeout = null;\n            if (!immediate) {\n                func.apply(context, args);\n            }\n        };\n        var callNow = immediate && !timeout;\n        clearTimeout(timeout);\n        timeout = setTimeout(later, wait);\n        if (callNow) {\n            func.apply(context, args);\n        }\n    };\n}\n\nexport function getFirstLetter(str) {\n    if (!str) return '';\n\n    for (let char of str) {\n        if (char.toUpperCase() !== char.toLowerCase()) {\n            return char;\n        } else if (char >= '0' && char <= '9') {\n            return char;\n        } else if (char.length > 1) {\n            return char;\n        }\n    }\n\n    return [...str].length > 0 ? [...str][0] : '';\n}\n\nfunction getLetters(title) {\n    if (!title) return null;\n    if (title.length === 0) return null;\n\n    const split = title.split(' ');\n    if (split.length === 1) {\n        return getFirstLetter(split[0]);\n    }\n    if (split.length > 1) {\n        return getFirstLetter(split[0]) + getFirstLetter(split[split.length - 1]);\n    }\n\n    return null;\n}\n\nasync function readImageSize(file) {\n    return new Promise((resolve, reject) => {\n        let useBlob = false;\n        const reader = new FileReader();\n\n        reader.addEventListener('load', function() {\n            try {\n                const image = new Image();\n                image.addEventListener('load', function() {\n                    const { width, height } = image;\n                    if (useBlob) {\n                        window.URL.revokeObjectURL(image.src);\n                    }\n\n                    resolve([width, height]);\n                });\n\n                image.src = useBlob ? window.URL.createObjectURL(file) : reader.result;\n            } catch {\n                reject();\n            }\n        });\n\n        reader.readAsDataURL(file);\n    });\n}\n\n/**\n * use this to make a Base64 encoded string URL friendly,\n * i.e. '+' and '/' are replaced with '-' and '_' also any trailing '='\n * characters are removed\n *\n * @param {String} str the encoded string\n * @returns {String} the URL friendly encoded String\n */\nfunction Base64EncodeUrl(str) {\n    return str\n        .replace(/\\+/g, '-')\n        .replace(/\\//g, '_')\n        .replace(/\\=+$/, '');\n}\n\n/**\n * Use this to recreate a Base64 encoded string that was made URL friendly\n * using Base64EncodeurlFriendly.\n * '-' and '_' are replaced with '+' and '/' and also it is padded with '+'\n *\n * @param {String} str the encoded string\n * @returns {String} the URL friendly encoded String\n */\nfunction Base64DecodeUrl(str) {\n    str = (str + '===').slice(0, str.length + (str.length % 4));\n    return str.replace(/-/g, '+').replace(/_/g, '/');\n}\n\nfunction arrayBufferToBase64(buffer) {\n    var binary = '';\n    var bytes = new Uint8Array(buffer);\n    var len = bytes.byteLength;\n    for (var i = 0; i < len; i++) {\n        binary += String.fromCharCode(bytes[i]);\n    }\n    return Base64EncodeUrl(window.btoa(binary));\n}\n\nfunction isAuthorizationReady(state) {\n    if (!state) return false;\n\n    return state['@type'] === 'authorizationStateReady';\n}\n\nfunction between(item, first, last, inclusive = false) {\n    return inclusive ? item >= first && item <= last : item > first && item < last;\n}\n\nfunction clamp(item, first, last) {\n    if (item < first) return first;\n    if (item > last) return last;\n\n    return item;\n}\n\nfunction getDurationString(secondsTotal, duration, reverse) {\n    if (reverse && duration > 0) {\n        secondsTotal = Math.max(Math.floor(duration) - secondsTotal, 0);\n    }\n\n    let hours = Math.floor(secondsTotal / 3600);\n    let minutes = Math.floor((secondsTotal - hours * 3600) / 60);\n    let seconds = secondsTotal - hours * 3600 - minutes * 60;\n\n    if (hours > 0 && minutes < 10) {\n        minutes = '0' + minutes;\n    }\n    if (seconds < 10) {\n        seconds = '0' + seconds;\n    }\n\n    return (reverse ? '-': '') + (hours > 0 ? hours + ':' : '') + minutes + ':' + seconds;\n}\n\nexport function getRandomInt(min, max) {\n    min = Math.ceil(min);\n    max = Math.floor(max);\n    return Math.floor(Math.random() * (max - min)) + min; //The maximum is exclusive and the minimum is inclusive\n}\n\nfunction historyEquals(first, second) {\n    if (!first && second) return false;\n    if (first && !second) return false;\n\n    if (!first && !second) return true;\n    if (first.length === 0 && second.length === 0) return true;\n\n    return first === second;\n}\n\nfunction insertByOrder(array, element, comparator) {\n    let i = 0;\n    for (; i < array.length && comparator(array[i], element) < 0; i++) {}\n\n    return [...array.slice(0, i), element, ...array.slice(i)];\n}\n\nexport {\n    getBrowser,\n    getOSName,\n    stringToBoolean,\n    orderCompare,\n    getSize,\n    getPhotoThumbnailSize,\n    getPhotoSize,\n    getFitSize,\n    itemsInView,\n    throttle,\n    debounce,\n    getLetters,\n    readImageSize,\n    arrayBufferToBase64,\n    isAuthorizationReady,\n    between,\n    clamp,\n    getDurationString,\n    isAppleDevice,\n    historyEquals,\n    insertByOrder\n};\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nclass ActionScheduler {\n    constructor(actionCallback, cancelCallback) {\n        this.actions = new Map();\n        this.actionCallback = actionCallback;\n        this.cancelCallback = cancelCallback;\n    }\n\n    add = (key, timeout, action, cancel) => {\n        if (this.actions.has(key)) {\n            return false;\n        }\n\n        let expire = new Date();\n        expire.setMilliseconds(expire.getMilliseconds() + timeout);\n\n        this.actions.set(key, { expire: expire, action: action, cancel: cancel });\n\n        if (this.timerId) {\n            clearTimeout(this.timerId);\n        }\n\n        this.setTimeout();\n\n        return true;\n    };\n\n    invoke = async key => {\n        const item = this.actions.get(key);\n        if (!item) return;\n\n        this.actions.delete(key);\n\n        await this.actionCallback({ key: key, action: item.action, cancel: item.cancel });\n        if (item.action) await item.action();\n\n        if (this.timerId) {\n            clearTimeout(this.timerId);\n        }\n\n        this.setTimeout();\n    };\n\n    remove = key => {\n        const item = this.actions.get(key);\n        if (!item) return;\n\n        this.actions.delete(key);\n\n        this.cancelCallback({ key: key, action: item.action, cancel: item.cancel });\n        if (item.cancel) item.cancel();\n\n        if (this.timerId) {\n            clearTimeout(this.timerId);\n        }\n\n        this.setTimeout();\n    };\n\n    setTimeout = () => {\n        let now = new Date();\n        let timeout = 1000000;\n        for (let [key, value] of this.actions) {\n            let actionTimeout = value.expire - now;\n            if (actionTimeout < timeout) timeout = actionTimeout;\n            if (timeout < 0) timeout = 0;\n        }\n\n        if (timeout < 1000000) {\n            this.timerId = setTimeout(this.handleTimer, timeout);\n        }\n    };\n\n    handleTimer = () => {\n        let now = new Date();\n        let expired = [];\n        for (let [key, value] of this.actions) {\n            let actionTimeout = value.expire - now;\n            if (actionTimeout <= 0) expired.push({ key: key, value: value });\n        }\n\n        for (let item of expired) {\n            this.actions.delete(item.key);\n            this.actionCallback({ key: item.key, action: item.value.action, cancel: item.value.cancel });\n            if (item.value.action) item.value.action();\n        }\n\n        this.setTimeout();\n    };\n}\n\nexport default ActionScheduler;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport ActionScheduler from '../Utils/ActionScheduler';\nimport { closeChat } from '../Actions/Client';\nimport { subscribeNotifications } from '../registerServiceWorker';\nimport { PAGE_WIDTH_SMALL } from '../Constants';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass ApplicationStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n        this.addStatistics();\n\n        this.isSmallWidth = window.innerWidth < PAGE_WIDTH_SMALL;\n        window.addEventListener('resize', this.onWindowResize);\n    }\n\n    onWindowResize = () => {\n        const { isSmallWidth } = this;\n\n        const nextIsSmallWidth = window.innerWidth < PAGE_WIDTH_SMALL;\n        if (nextIsSmallWidth !== isSmallWidth) {\n            this.isSmallWidth = nextIsSmallWidth;\n            TdLibController.clientUpdate({\n                '@type': 'clientUpdatePageWidth',\n                isSmallWidth: nextIsSmallWidth\n            })\n        }\n    };\n\n    reset = () => {\n        this.dialogsReady = false;\n        this.cacheLoaded = false;\n        this.setPhoneNumberRequest = null;\n        this.chatId = 0;\n        this.dialogChatId = 0;\n        this.messageId = null;\n        this.statistics = new Map();\n        this.authorizationState = null;\n        this.defaultPhone = null;\n        this.connectionState = null;\n        this.isChatDetailsVisible = false;\n        this.mediaViewerContent = null;\n        this.profileMediaViewerContent = null;\n        this.dragParams = null;\n        this.actionScheduler = new ActionScheduler(this.handleScheduledAction, this.handleCancelScheduledAction);\n    };\n\n    addScheduledAction = (key, timeout, action, cancel) => {\n        return this.actionScheduler.add(key, timeout, action, cancel);\n    };\n\n    invokeScheduledAction = async key => {\n        await this.actionScheduler.invoke(key);\n    };\n\n    removeScheduledAction = key => {\n        this.actionScheduler.remove(key);\n    };\n\n    handleScheduledAction = item => {\n        console.log('Invoked scheduled action key=', item.key);\n    };\n\n    handleCancelScheduledAction = item => {\n        console.log('Cancel scheduled action key=', item.key);\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                this.authorizationState = update.authorization_state;\n\n                switch (update.authorization_state['@type']) {\n                    case 'authorizationStateLoggingOut':\n                        this.loggingOut = true;\n                        break;\n                    case 'authorizationStateWaitTdlibParameters':\n                        TdLibController.sendTdParameters();\n                        break;\n                    case 'authorizationStateWaitEncryptionKey':\n                        TdLibController.send({ '@type': 'checkDatabaseEncryptionKey' });\n                        break;\n                    case 'authorizationStateWaitPhoneNumber': {\n                        if (this.setPhoneNumberRequest) {\n                            this.setPhoneNumberRequest();\n\n                            this.setPhoneNumberRequest = null;\n                        }\n\n                        break;\n                    }\n                    case 'authorizationStateWaitCode':\n                        break;\n                    case 'authorizationStateWaitPassword':\n                        break;\n                    case 'authorizationStateReady':\n                        this.loggingOut = false;\n                        this.setPhoneNumberRequest = null;\n                        subscribeNotifications();\n                        break;\n                    case 'authorizationStateClosing':\n                        break;\n                    case 'authorizationStateClosed':\n                        this.reset();\n\n                        if (!this.loggingOut) {\n                            document.title += ': Zzz…';\n\n                            TdLibController.clientUpdate({\n                                '@type': 'clientUpdateAppInactive'\n                            });\n                        } else {\n                            TdLibController.init();\n                        }\n                        break;\n                    default:\n                        break;\n                }\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'updateChatIsMarkedAsUnread': {\n                const { chat_id, is_marked_as_unread } = update;\n                if (chat_id === this.chatId && is_marked_as_unread) {\n                    closeChat();\n                }\n\n                break;\n            }\n            case 'updateConnectionState': {\n                this.connectionState = update.state;\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'updateFatalError': {\n                this.emit(update['@type'], update);\n\n                break;\n            }\n            case 'updateServiceNotification': {\n                const { type, content } = update;\n\n                if (!content) return;\n                if (content['@type'] === 'messageText') {\n                    const { text } = content;\n                    if (!text) return;\n\n                    if (text['@type'] === 'formattedText' && text.text) {\n                        switch (type) {\n                            case 'AUTH_KEY_DROP_DUPLICATE':\n                                let result = window.confirm(text.text);\n                                if (result) {\n                                    TdLibController.logOut();\n                                }\n                                break;\n                            default:\n                                alert(text.text);\n                                break;\n                        }\n                    }\n                }\n\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateAppInactive': {\n                this.emit('clientUpdateAppInactive');\n                break;\n            }\n            case 'clientUpdateCacheLoaded': {\n                this.cacheLoaded = true;\n                this.emit('clientUpdateCacheLoaded');\n                break;\n            }\n            case 'clientUpdateChatDetailsVisibility': {\n                const { visibility } = update;\n\n                this.isChatDetailsVisible = visibility;\n                this.emit('clientUpdateChatDetailsVisibility', update);\n                break;\n            }\n            case 'clientUpdateChatId': {\n                if (this.recording) {\n                    this.emit('clientUpdateInputShake');\n                    break;\n                }\n\n                const extendedUpdate = {\n                    '@type': 'clientUpdateChatId',\n                    nextChatId: update.chatId,\n                    nextMessageId: update.messageId,\n                    previousChatId: this.chatId,\n                    previousMessageId: this.messageId\n                };\n\n                this.chatId = update.chatId;\n                this.messageId = update.messageId;\n\n                this.emit('clientUpdateChatId', extendedUpdate);\n                break;\n            }\n            case 'clientUpdateTdLibDatabaseExists': {\n                this.emit('clientUpdateTdLibDatabaseExists', update);\n                break;\n            }\n            case 'clientUpdateDeleteMessages': {\n                this.emit('clientUpdateDeleteMessages', update);\n                break;\n            }\n            case 'clientUpdateDialogsReady': {\n                this.dialogsReady = true;\n                this.emit('clientUpdateDialogsReady', update);\n                break;\n            }\n            case 'clientUpdateDragging': {\n                const { dragging, files } = update;\n\n                this.dragParams = dragging ? { dragging, files } : null;\n                this.emit('clientUpdateDragging', update);\n                break;\n            }\n            case 'clientUpdateMediaViewerContent': {\n                const { content } = update;\n                this.mediaViewerContent = content;\n\n                this.emit('clientUpdateMediaViewerContent', update);\n                break;\n            }\n            case 'clientUpdateNewContentAvailable': {\n                this.emit('clientUpdateNewContentAvailable', update);\n                break;\n            }\n            case 'clientUpdatePageWidth': {\n                this.emit('clientUpdatePageWidth', update);\n                break;\n            }\n            case 'clientUpdateProfileMediaViewerContent': {\n                const { content } = update;\n                this.profileMediaViewerContent = content;\n\n                this.emit('clientUpdateProfileMediaViewerContent', update);\n                break;\n            }\n            case 'clientUpdateRecordStart': {\n                this.recording = true;\n                break;\n            }\n            case 'clientUpdateRecordStop': {\n                this.recording = false;\n                break;\n            }\n            case 'clientUpdateRecordError': {\n                this.recording = false;\n                break;\n            }\n            case 'clientUpdateSearchChat': {\n                this.emit('clientUpdateSearchChat', update);\n                break;\n            }\n            case 'clientUpdateSetPhone': {\n                const { phone } = update;\n\n                this.defaultPhone = phone;\n\n                if (!phone) {\n                    this.setPhoneNumberRequest = null;\n                    TdLibController.clientUpdate({\n                        '@type': 'clientUpdateSetPhoneCanceled'\n                    });\n                } else {\n                    if (\n                        this.authorizationState &&\n                        (this.authorizationState['@type'] === 'authorizationStateWaitPhoneNumber' || this.authorizationState['@type'] === 'authorizationStateWaitOtherDeviceConfirmation')\n                    ) {\n                        this.setPhoneNumber(phone);\n                    } else {\n                        this.setPhoneNumberRequest = () => this.setPhoneNumber(phone);\n                    }\n                }\n\n                this.emit('clientUpdateSetPhone', update);\n                break;\n            }\n            case 'clientUpdateSetPhoneResult': {\n                this.emit('clientUpdateSetPhoneResult', update);\n                break;\n            }\n            case 'clientUpdateSetPhoneError': {\n                this.emit('clientUpdateSetPhoneError', update);\n                break;\n            }\n            case 'clientUpdateDialogChatId': {\n                const { chatId } = update;\n                this.dialogChatId = chatId;\n\n                this.emit('clientUpdateDialogChatId', update);\n                break;\n            }\n            case 'clientUpdateFocusWindow': {\n                if (!this.authorizationState) {\n                    break;\n                }\n\n                TdLibController.send({\n                    '@type': 'setOption',\n                    name: 'online',\n                    value: { '@type': 'optionValueBoolean', value: update.focused }\n                });\n\n                this.emit('clientUpdateFocusWindow', update);\n                break;\n            }\n            case 'clientUpdateForward': {\n                this.emit('clientUpdateForward', update);\n                break;\n            }\n            case 'clientUpdateLeaveChat': {\n                if (update.inProgress && this.chatId === update.chatId) {\n                    TdLibController.setChatId(0);\n                }\n\n                break;\n            }\n        }\n    };\n\n    setPhoneNumber = phone => {\n        TdLibController.send({\n            '@type': 'setAuthenticationPhoneNumber',\n            phone_number: phone\n        })\n            .then(result => {\n                TdLibController.clientUpdate({\n                    '@type': 'clientUpdateSetPhoneResult',\n                    result\n                });\n            })\n            .catch(error => {\n                TdLibController.clientUpdate({\n                    '@type': 'clientUpdateSetPhoneError',\n                    error\n                });\n            });\n    };\n\n    onUpdateStatistics = update => {\n        if (!update) return;\n\n        if (this.statistics.has(update['@type'])) {\n            const count = this.statistics.get(update['@type']);\n\n            this.statistics.set(update['@type'], count + 1);\n        } else {\n            this.statistics.set(update['@type'], 1);\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    addStatistics = () => {\n        TdLibController.on('update', this.onUpdateStatistics);\n    };\n\n    setChatId = (chatId, messageId = null) => {\n        const update = {\n            '@type': 'clientUpdateChatId',\n            nextChatId: chatId,\n            nextMessageId: messageId,\n            previousChatId: this.chatId,\n            previousMessageId: this.messageId\n        };\n\n        this.chatId = chatId;\n        this.messageId = messageId;\n        this.emit(update['@type'], update);\n    };\n\n    getChatId() {\n        return this.chatId;\n    }\n\n    getMessageId() {\n        return this.messageId;\n    }\n\n    getConnectionState() {\n        return this.connectionState;\n    }\n\n    getAuthorizationState() {\n        return this.authorizationState;\n    }\n\n    assign(source1, source2) {\n        Object.assign(source1, source2);\n        //this.set(Object.assign({}, source1, source2));\n    }\n}\n\nconst store = new ApplicationStore();\nwindow.app = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport { getSearchMessagesFilter, openMedia } from '../Utils/Message';\nimport { getRandomInt } from '../Utils/Common';\nimport { isCurrentSource, playlistItemEquals } from '../Utils/Player';\nimport { supportsStreaming } from '../Utils/File';\nimport { getValidBlocks, isValidAudioBlock, isValidVoiceNoteBlock, openInstantViewMedia } from '../Utils/InstantView';\nimport { PLAYER_PLAYBACKRATE_MAX, PLAYER_PLAYBACKRATE_NORMAL, PLAYER_PRELOAD_MAX_SIZE, PLAYER_PRELOAD_PRIORITY, PLAYER_VOLUME_MAX, PLAYER_VOLUME_MIN, PLAYER_VOLUME_NORMAL } from '../Constants';\nimport FileStore from './FileStore';\nimport MessageStore from './MessageStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nconst RepeatEnum = Object.freeze({\n    NONE: 'NONE',\n    REPEAT: 'REPEAT',\n    REPEAT_ONE: 'REPEAT_ONE'\n});\n\nexport { RepeatEnum };\n\nclass PlayerStore extends EventEmitter {\n    constructor() {\n        super();\n\n        const { playbackRate, audioPlaybackRate, volume } = this.loadPlayerSettings();\n\n        this.reset();\n\n        this.playbackRate = playbackRate;\n        this.audioPlaybackRate = audioPlaybackRate;\n        this.volume = volume;\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.playbackRate = PLAYER_PLAYBACKRATE_NORMAL;\n        this.audioPlaybackRate = PLAYER_PLAYBACKRATE_NORMAL;\n        this.volume = PLAYER_VOLUME_NORMAL;\n        this.repeat = RepeatEnum.NONE;\n        this.shuffle = false;\n\n        this.pipParams = { left: document.documentElement.clientWidth - 300, top: document.documentElement.clientHeight - 300 };\n        this.times = new Map();\n\n        this.closeInternal();\n    };\n\n    closeInternal = () => {\n        this.playlist = null;\n        this.message = null;\n        this.time = null;\n        this.videoStream = null;\n        this.instantView = null;\n        this.block = null;\n    }\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    onUpdate = async update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    close = () => {\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMediaClose'\n        });\n    };\n\n    loadPlayerSettings() {\n        const player = JSON.parse(localStorage.getItem('player')) || {};\n\n        let { playbackRate, audioPlaybackRate, volume } = player;\n\n        playbackRate = +playbackRate;\n        audioPlaybackRate = +audioPlaybackRate;\n        volume = +volume;\n\n        playbackRate =\n            playbackRate >= PLAYER_PLAYBACKRATE_NORMAL && playbackRate <= PLAYER_PLAYBACKRATE_MAX\n                ? playbackRate\n                : PLAYER_PLAYBACKRATE_NORMAL;\n        audioPlaybackRate =\n            audioPlaybackRate >= PLAYER_PLAYBACKRATE_NORMAL && audioPlaybackRate <= PLAYER_PLAYBACKRATE_MAX\n                ? audioPlaybackRate\n                : PLAYER_PLAYBACKRATE_NORMAL;\n        volume = volume >= PLAYER_VOLUME_MIN && volume <= PLAYER_VOLUME_MAX ? volume : PLAYER_VOLUME_NORMAL;\n\n        return { playbackRate, audioPlaybackRate, volume };\n    }\n\n    savePlayerSettings() {\n        const { volume, playbackRate, audioPlaybackRate } = this;\n\n        localStorage.setItem('player', JSON.stringify({ volume, playbackRate, audioPlaybackRate }));\n    }\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateMediaClose': {\n                this.closeInternal();\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaActive': {\n                const { source } = update;\n\n                switch (source['@type']) {\n                    case 'message': {\n                        this.message = source;\n                        this.emit(update['@type'], update);\n                        this.getPlaylist(source);\n                        break;\n                    }\n                    case 'instantViewSource': {\n                        const { block, instantView } = source;\n                        this.instantView = instantView;\n                        this.block = block;\n                        this.getPlaylist(source);\n                        // this.playlist = null;\n                        // TdLibController.clientUpdate({\n                        //     '@type': 'clientUpdateMediaPlaylistLoading',\n                        //     source: { '@type': 'instantViewSource', block, instantView }\n                        // });\n                        this.emit(update['@type'], update);\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'clientUpdateMediaVolume': {\n                const { volume } = update;\n\n                this.volume = volume;\n\n                this.savePlayerSettings();\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaRepeat': {\n                const { repeat } = update;\n\n                this.repeat = repeat;\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaShuffle': {\n                const { shuffle } = update;\n\n                this.shuffle = shuffle;\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaPlaybackRate': {\n                const { playbackRate } = update;\n\n                this.playbackRate = playbackRate;\n\n                this.savePlayerSettings();\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaAudioPlaybackRate': {\n                const { audioPlaybackRate } = update;\n\n                this.audioPlaybackRate = audioPlaybackRate;\n\n                this.savePlayerSettings();\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaPlay': {\n                this.playing = true;\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaTitleMouseOver': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaPause': {\n                this.playing = false;\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaSeek': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaSeeking': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaStop': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaNext': {\n                this.emit(update['@type'], update);\n\n                this.moveToNextMedia(false);\n                break;\n            }\n            case 'clientUpdateMediaPrev': {\n                this.emit(update['@type'], update);\n\n                this.moveToPrevMedia();\n                break;\n            }\n            case 'clientUpdateMediaEnding': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaEnd': {\n                this.emit(update['@type'], update);\n\n                if (update.moveNext) {\n                    if (this.moveToNextMedia(true)) {\n                    } else {\n                        this.close();\n                    }\n                } else {\n                    this.close();\n                }\n                break;\n            }\n            case 'clientUpdateMediaShortcut': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaHint': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaTime': {\n                const { source, duration, currentTime, buffered, timestamp } = update;\n\n                if (this.time) {\n                    const { chatId, messageId, block } = this.time;\n                    if (isCurrentSource(chatId, messageId, block, source)) {\n                        this.time = {\n                            ...this.time,\n                            currentTime,\n                            duration,\n                            buffered,\n                            timestamp\n                        };\n                    }\n                }\n\n                if (buffered && currentTime && duration && supportsStreaming()) {\n                    for (let i = 0; i < buffered.length; i++) {\n                        const start = buffered.start(i);\n                        const end = buffered.end(i);\n                        if (start <= currentTime && currentTime <= end && currentTime + 30 < end) {\n                            this.preloadNextMedia();\n                            break;\n                        }\n                    }\n                }\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaProgress': {\n                const { source, buffered } = update;\n\n                if (this.time) {\n                    const { chatId, messageId, block } = this.time;\n                    if (isCurrentSource(chatId, messageId, block, source)) {\n                        this.time = { ...this.time, buffered };\n                    }\n                }\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaLoadedMetadata': {\n                const { source, duration, videoWidth, videoHeight } = update;\n                const { message, block } = source;\n\n                this.time = {\n                    chatId: message ? message.chat_id : 0,\n                    messageId: message ? message.id : 0,\n                    block,\n                    duration,\n                    videoWidth,\n                    videoHeight\n                };\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaCaptureStream': {\n                this.videoStream = update.stream;\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaViewerPlay': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaViewerPause': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaViewerEnded': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaPlaylistLoading': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaPlaylistPrev': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaPlaylist': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMediaPlaylistNext': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdatePictureInPicture': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    preloadNextMedia = async () => {\n        const { message, block, playlist, repeat, shuffle } = this;\n\n        if (!playlist) return;\n        if (!message && !block) return;\n        if (repeat !== RepeatEnum.NONE) return;\n        if (shuffle) return;\n\n        const { items } = playlist;\n        if (!items) return;\n\n        const index = items.findIndex(x => playlistItemEquals(x, message || block));\n        if (index === -1) return;\n\n        const nextIndex = index - 1;\n        if (nextIndex === -1) return;\n\n        const nextItem = items[nextIndex];\n        if (!nextItem) return;\n\n        let audio = null;\n        switch (nextItem['@type']) {\n            case 'pageBlockAudio': {\n                audio = nextItem.audio;\n                break;\n            }\n            case 'message': {\n                const { content } = nextItem;\n                switch (content['@type']) {\n                    case 'messageAudio': {\n                        audio = content.audio;\n                        break;\n                    }\n                }\n            }\n        }\n\n        if (!audio) return;\n\n        let { audio: file } = audio;\n        if (!file) return;\n        file = FileStore.get(file.id) || file;\n\n        const { id, local, expected_size } = file;\n\n        const offset = 0;\n        const limit = expected_size > PLAYER_PRELOAD_MAX_SIZE ? PLAYER_PRELOAD_MAX_SIZE : 0;\n\n        const { is_downloading_active, is_downloading_completed, download_offset, downloaded_prefix_size } = local;\n        if (is_downloading_completed) {\n            // console.log('[cache] preload cancel completed', id, [offset, limit], [download_offset, downloaded_prefix_size]);\n            return;\n        }\n        if (is_downloading_active) {\n            // console.log('[cache] preload cancel active', id, [offset, limit], [download_offset, downloaded_prefix_size]);\n            return;\n        }\n\n        if (download_offset <= offset && limit > 0 && limit <= downloaded_prefix_size) {\n            // console.log('[cache] preload cancel size', id, [offset, limit], [download_offset, downloaded_prefix_size]);\n            return;\n        }\n\n        // console.log('[cache] preload start', id, [offset, limit], [download_offset, downloaded_prefix_size], file);\n        const result = await TdLibController.send({\n            '@type': 'downloadFile',\n            file_id: id,\n            offset,\n            limit,\n            priority: PLAYER_PRELOAD_PRIORITY,\n            synchronous: true\n        });\n\n        // console.log('[cache] preload stop', id, [offset, limit], [download_offset, downloaded_prefix_size], result);\n    };\n\n    openPlaylistItem(item) {\n        const { instantView } = this;\n\n        switch (item['@type']) {\n            case 'message': {\n                openMedia(item.chat_id, item.id, false);\n                break;\n            }\n            case 'pageBlockAudio': {\n                openInstantViewMedia(item.audio, item.caption, item, instantView, false);\n                break;\n            }\n            case 'pageBlockVoiceNote': {\n                openInstantViewMedia(item.voice_note, item.caption, item, instantView, false);\n                break;\n            }\n        }\n    }\n\n    moveToPrevMedia = () => {\n        const { playlist, message, block } = this;\n        if (!playlist) return;\n        if (!message && !block) return;\n\n        const { items } = playlist;\n        if (!items) return;\n\n        const index = items.findIndex(x => playlistItemEquals(x, message || block));\n        if (index === -1) return;\n\n        if (index + 1 < items.length) {\n            this.openPlaylistItem(items[index + 1]);\n        }\n    };\n\n    moveToNextMedia = useRepeatShuffle => {\n        const { playlist, message, block } = this;\n\n        if (!playlist) return false;\n        if (!message && !block) return false;\n\n        const { items } = playlist;\n        if (!items) return false;\n\n        const index = items.findIndex(x => playlistItemEquals(x, message || block));\n        if (index === -1) return false;\n\n        let nextIndex = -1;\n        if (!useRepeatShuffle) {\n            nextIndex = index - 1;\n        } else {\n            switch (this.repeat) {\n                case RepeatEnum.NONE: {\n                    if (this.shuffle) {\n                        nextIndex = getRandomInt(0, items.length);\n                    } else {\n                        nextIndex = index - 1;\n                    }\n                    break;\n                }\n                case RepeatEnum.REPEAT_ONE: {\n                    nextIndex = index;\n                    break;\n                }\n                case RepeatEnum.REPEAT: {\n                    if (this.shuffle) {\n                        nextIndex = getRandomInt(0, items.length);\n                    } else {\n                        nextIndex = index - 1 >= 0 ? index - 1 : items.length - 1;\n                    }\n                    break;\n                }\n            }\n        }\n\n        if (nextIndex >= 0) {\n            this.openPlaylistItem(items[nextIndex])\n            return true;\n        }\n\n        return false;\n    };\n\n    getCurrentTime = (uniqueId) => {\n        return this.times.get(uniqueId) || { currentTime: 0, duration: 0 };\n    };\n\n    setCurrentTime = (uniqueId, info) => {\n        if (info.currentTime < 30 || info.currentTime > info.duration - 10) {\n            info.currentTime = 0;\n        }\n\n        this.times.set(uniqueId, info);\n    };\n\n    clearCurrentTime = (uniqueId) => {\n        this.times.delete(uniqueId);\n    };\n\n    getPlaylist = async source => {\n        const { playlist: currentPlaylist } = this;\n\n        if (currentPlaylist) {\n            const { items } = currentPlaylist;\n            if (items && items.find(x => playlistItemEquals(x, source['@type'] === 'instantViewSource' ? source.block : source))) {\n                return;\n            }\n        }\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMediaPlaylistLoading',\n            source\n        });\n\n        let items = [];\n        let totalCount = 0;\n        switch (source['@type']) {\n            case 'message': {\n                const { chat_id: chatId, id: messageId } = source;\n                const filter = getSearchMessagesFilter(chatId, messageId);\n                if (!filter) {\n                    this.playlist = {\n                        source,\n                        totalCount: 1,\n                        items: [source]\n                    };\n\n                    TdLibController.clientUpdate({\n                        '@type': 'clientUpdateMediaPlaylist',\n                        source,\n                        playlist: this.playlist\n                    });\n\n                    return;\n                }\n\n                const result = await TdLibController.send({\n                    '@type': 'searchChatMessages',\n                    chat_id: chatId,\n                    query: '',\n                    sender_user_id: 0,\n                    from_message_id: messageId,\n                    offset: -50,\n                    limit: 100,\n                    filter\n                });\n\n                MessageStore.setItems(result.messages);\n\n                items = result.messages;\n                totalCount = result.total_count;\n                break;\n            }\n            case 'instantViewSource': {\n                const { block, instantView } = source;\n                items = getValidBlocks(instantView, block['@type'] === 'pageBlockAudio' ? isValidAudioBlock : isValidVoiceNoteBlock).reverse();\n                totalCount = items.length;\n            }\n        }\n\n        this.playlist = {\n            source,\n            totalCount,\n            items\n        };\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMediaPlaylist',\n            source,\n            playlist: this.playlist\n        });\n    };\n}\n\nconst store = new PlayerStore();\nwindow.player = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport { getBlob } from '../Utils/File';\nimport FileStore from './FileStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass MessageStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.items = new Map();\n        this.selectedItems = new Map();\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'updateNewMessage': {\n                this.set(update.message);\n                this.emit('updateNewMessage', update);\n                break;\n            }\n            case 'updateDeleteMessages':\n                this.emit('updateDeleteMessages', update);\n                break;\n            case 'updateMessageEdited': {\n                const chat = this.items.get(update.chat_id);\n                if (chat) {\n                    const message = chat.get(update.message_id);\n                    if (message) {\n                        message.reply_markup = update.reply_markup;\n                        message.edit_date = update.edit_date;\n                    }\n                }\n                this.emit('updateMessageEdited', update);\n                break;\n            }\n            case 'updateMessageViews': {\n                const chat = this.items.get(update.chat_id);\n                if (chat) {\n                    const message = chat.get(update.message_id);\n                    if (message && update.views > message.views) {\n                        message.views = update.views;\n                    }\n                }\n                this.emit('updateMessageViews', update);\n                break;\n            }\n            case 'updateMessageContent': {\n                const { chat_id, message_id, new_content } = update;\n\n                const message = this.get(chat_id, message_id);\n                if (message) {\n                    update.old_content = message.content;\n                    message.content = new_content;\n\n                    switch (new_content['@type']) {\n                        case 'messagePhoto': {\n                            if (update.old_content['@type'] === 'messagePhoto') {\n                                const { photo: oldPhoto } = update.old_content;\n                                if (!oldPhoto) break;\n\n                                const { photo: newPhoto } = new_content;\n                                if (!newPhoto) break;\n\n                                const oldSize = oldPhoto.sizes.find(x => x.type === 'i');\n                                if (!oldSize) break;\n\n                                const newSize = newPhoto.sizes.find(x => x.type === 'i');\n                                if (newSize.photo.id === oldSize.photo.id) break;\n\n                                const oldBlob = getBlob(oldSize.photo);\n                                if (!oldBlob) break;\n\n                                FileStore.setBlob(newSize.photo.id, oldBlob);\n                            }\n\n                            break;\n                        }\n                    }\n                }\n\n                this.emit('updateMessageContent', update);\n                break;\n            }\n            case 'updateMessageContentOpened': {\n                const { chat_id, message_id } = update;\n\n                const message = this.get(chat_id, message_id);\n                if (message) {\n                    const { content } = message;\n                    switch (content['@type']) {\n                        case 'messageVoiceNote': {\n                            message.content.is_listened = true;\n                            break;\n                        }\n                        case 'messageVideoNote': {\n                            message.content.is_viewed = true;\n                            break;\n                        }\n                    }\n                }\n\n                this.emit('updateMessageContentOpened', update);\n                break;\n            }\n            case 'updateMessageSendSucceeded': {\n                const chat = this.items.get(update.message.chat_id);\n                if (chat) {\n                    const message = chat.get(update.old_message_id);\n                    if (message) {\n                        message.sending_state = update.message.sending_state;\n                    }\n                }\n\n                this.set(update.message);\n                this.emit('updateMessageSendSucceeded', update);\n                break;\n            }\n            case 'updateMessageSendFailed': {\n                if (update.message.sending_state) {\n                    update.message.sending_state.error_code = update.error_code;\n                    update.message.sending_state.error_message = update.error_message;\n                }\n\n                const chat = this.items.get(update.message.chat_id);\n                if (chat) {\n                    const message = chat.get(update.old_message_id);\n                    if (message) {\n                        message.sending_state = update.message.sending_state;\n                        if (message.sending_state) {\n                            message.sending_state.error_code = update.error_code;\n                            message.sending_state.error_message = update.error_message;\n                        }\n                    }\n                    if (update.old_message_id !== update.message.id) {\n                        this.set(update.message);\n                    }\n                }\n                this.emit('updateMessageSendFailed', update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateChatId': {\n                if (this.selectedItems.size > 0) {\n                    this.selectedItems.clear();\n\n                    this.emit('clientUpdateClearSelection', { '@type': 'clientUpdateClearSelection' });\n                }\n\n                break;\n            }\n            case 'clientUpdateClearSelection': {\n                this.selectedItems.clear();\n\n                this.emit('clientUpdateClearSelection', update);\n                break;\n            }\n            case 'clientUpdateEditMessage': {\n                this.emit('clientUpdateEditMessage', update);\n                break;\n            }\n            case 'clientUpdateMessageShake': {\n                this.emit('clientUpdateMessageShake', update);\n                break;\n            }\n            case 'clientUpdateMessageHighlighted': {\n                this.emit('clientUpdateMessageHighlighted', update);\n                break;\n            }\n            case 'clientUpdateMessageSelected': {\n                if (update.selected) {\n                    this.selectedItems.set(`chatId=${update.chatId}_messageId=${update.messageId}`, {\n                        chatId: update.chatId,\n                        messageId: update.messageId\n                    });\n                } else {\n                    this.selectedItems.delete(`chatId=${update.chatId}_messageId=${update.messageId}`);\n                }\n\n                this.emit('clientUpdateMessageSelected', update);\n                break;\n            }\n            case 'clientUpdateMessagesInView': {\n                this.emit('clientUpdateMessagesInView', update);\n                break;\n            }\n            case 'clientUpdateOpenReply': {\n                this.emit('clientUpdateOpenReply', update);\n                break;\n            }\n            case 'clientUpdateRecordStart': {\n                this.emit('clientUpdateRecordStart', update);\n                break;\n            }\n            case 'clientUpdateRecordStop': {\n                this.emit('clientUpdateRecordStop', update);\n                break;\n            }\n            case 'clientUpdateRecordError': {\n                this.emit('clientUpdateRecordError', update);\n                break;\n            }\n            case 'clientUpdateReply': {\n                this.emit('clientUpdateReply', update);\n                break;\n            }\n            case 'clientUpdateTryEditMessage': {\n                this.emit('clientUpdateTryEditMessage', update);\n                break;\n            }\n        }\n    };\n\n    hasSelectedMessage(chatId, messageId) {\n        return this.selectedItems.has(`chatId=${chatId}_messageId=${messageId}`);\n    }\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    load(chatId, messageId) {\n        TdLibController.send({\n            '@type': 'getMessage',\n            chat_id: chatId,\n            message_id: messageId\n        })\n            .then(message => {\n                this.set(message);\n                this.emit('getMessageResult', message);\n            })\n            .catch(error => {\n                const deletedMessage = {\n                    '@type': 'deletedMessage',\n                    chat_id: chatId,\n                    id: messageId,\n                    content: null\n                };\n                this.set(deletedMessage);\n                this.emit('getMessageResult', deletedMessage);\n            });\n    }\n\n    get(chatId, messageId) {\n        let chat = this.items.get(chatId);\n        if (!chat) {\n            //this.load(chatId, messageId);\n            return null;\n        }\n\n        let message = chat.get(messageId);\n        if (!message) {\n            //this.load(chatId, messageId);\n            return null;\n        }\n\n        return message;\n    }\n\n    set(message) {\n        if (!message) return;\n\n        let chat = this.items.get(message.chat_id);\n        if (!chat) {\n            chat = new Map();\n            this.items.set(message.chat_id, chat);\n        }\n\n        chat.set(message.id, message);\n    }\n\n    setItems(messages) {\n        for (let i = 0; i < messages.length; i++) {\n            this.set(messages[i]);\n        }\n    }\n}\n\nconst store = new MessageStore();\nwindow.message = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { getRichText } from '../../../Utils/InstantView';\n\nfunction RichText(props) {\n    return getRichText(props.text);\n}\n\nRichText.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default RichText;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport OptionStore from '../Stores/OptionStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass UserStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.items = new Map();\n        this.fullInfoItems = new Map();\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'updateUser': {\n                this.set(update.user);\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'updateUserFullInfo':\n                this.setFullInfo(update.user_id, update.user_full_info);\n\n                this.emit(update['@type'], update);\n                break;\n            case 'updateUserStatus': {\n                let user = this.get(update.user_id);\n                if (user) {\n                    this.assign(user, { status: update.status });\n                }\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateOpenUser': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    assign(source1, source2) {\n        Object.assign(source1, source2);\n        //this.set(Object.assign({}, source1, source2));\n    }\n\n    getMyId() {\n        const myId = OptionStore.get('my_id');\n        if (!myId) return null;\n        if (!myId.value) return null;\n\n        return myId.value;\n    }\n\n    get(userId) {\n        return this.items.get(userId);\n    }\n\n    set(user) {\n        this.items.set(user.id, user);\n    }\n\n    getFullInfo(id) {\n        return this.fullInfoItems.get(id);\n    }\n\n    setFullInfo(id, fullInfo) {\n        this.fullInfoItems.set(id, fullInfo);\n    }\n}\n\nconst store = new UserStore();\nwindow.user = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nclass EventEmitter {\n    constructor() {\n        this.observers = {};\n    }\n\n    on(events, listener) {\n        events.split(' ').forEach(event => {\n            this.observers[event] = this.observers[event] || [];\n            this.observers[event].push(listener);\n        });\n        return this;\n    }\n\n    off(event, listener) {\n        if (!this.observers[event]) return;\n        if (!listener) {\n            delete this.observers[event];\n            return;\n        }\n\n        this.observers[event] = this.observers[event].filter(l => l !== listener);\n    }\n\n    emit(event, ...args) {\n        if (this.observers[event]) {\n            const cloned = [].concat(this.observers[event]);\n            cloned.forEach(observer => {\n                observer(...args);\n            });\n        }\n\n        if (this.observers['*']) {\n            const cloned = [].concat(this.observers['*']);\n            cloned.forEach(observer => {\n                observer.apply(observer, [event, ...args]);\n            });\n        }\n    }\n}\n\nexport default EventEmitter;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { getAuthor, getMessageAudio } from './Message';\nimport { getBlockAudio } from './InstantView';\nimport { getSrc, supportsStreaming } from './File';\nimport { getAudioTitle } from './Media';\nimport PlayerStore from '../Stores/PlayerStore';\n\nexport function playlistItemEquals(item1, item2) {\n    if (!item1) return false;\n    if (!item2) return false;\n    if (item1['@type'] !== item2['@type']) return false;\n\n    switch (item1['@type']) {\n        case 'message': {\n            return item1.chat_id === item2.chat_id && item1.id === item2.id;\n        }\n    }\n\n    return item1 === item2;\n}\n\nexport function getMediaTitle(source, t = k => k) {\n    if (!source) return null;\n\n    switch (source['@type']) {\n        case 'message': {\n            const { content } = source;\n            if (!content) return null;\n\n            switch (content['@type']) {\n                case 'messageAudio': {\n                    const { audio } = content;\n                    if (audio) {\n                        return getAudioTitle(audio);\n                    }\n                    break;\n                }\n                case 'messageText': {\n                    const { web_page } = content;\n                    if (web_page) {\n                        const { audio } = web_page;\n                        if (audio) {\n                            return getAudioTitle(audio);\n                        }\n                    }\n                    break;\n                }\n            }\n\n            return getAuthor(source, t);\n        }\n        case 'pageBlockAudio': {\n            const { audio } = source;\n            if (audio) {\n                return getAudioTitle(audio);\n            }\n\n            return null;\n        }\n        case 'pageBlockVoiceNote': {\n\n            return t('AttachAudio');\n        }\n    }\n\n    return null;\n}\n\nexport function getAudio(source) {\n    if (!source) return null;\n\n    switch (source['@type']) {\n        case 'message': {\n            return getMessageAudio(source.chat_id, source.id);\n        }\n        case 'pageBlockAudio': {\n            return getBlockAudio(source);\n        }\n    }\n\n    return false;\n}\n\nexport function isCurrentSource(chatId, messageId, block, source) {\n    if (!source) return false;\n\n    switch (source['@type']) {\n        case 'message': {\n            return source.chat_id === chatId && source.id === messageId;\n        }\n        case 'instantViewSource': {\n            return source.block === block;\n        }\n    }\n\n    return false;\n}\n\nexport function getCurrentTime(source) {\n    if (!source) return { currentTime: 0, duration: 0 };\n\n    let audio = null;\n    switch (source['@type']) {\n        case 'message': {\n            const { chat_id, id } = source;\n            audio = getMessageAudio(chat_id, id);\n            break;\n        }\n        case 'instantViewSource': {\n            const { block } = source;\n            audio = getBlockAudio(block);\n            break;\n        }\n    }\n\n    if (!audio) return { currentTime: 0, duration: 0 };\n\n    const { audio: file } = audio;\n    if (!file) return { currentTime: 0, duration: 0 };\n\n    const { remote } = file;\n    if (!remote) return { currentTime: 0, duration: 0 };\n\n    const { unique_id } = remote;\n    if (!unique_id) return { currentTime: 0, duration: 0 };\n\n    return PlayerStore.getCurrentTime(unique_id);\n}\n\nexport function getMediaMimeType(source) {\n    if (!source) return '';\n\n    switch (source['@type']) {\n        case 'message': {\n            const { content } = source;\n            if (content) {\n                const { audio, voice_note, video_note, web_page } = content;\n\n                if (audio) {\n                    return audio.mime_type;\n                }\n\n                if (voice_note) {\n                    return voice_note.mime_type;\n                }\n\n                if (video_note) {\n                    return 'video/mp4';\n                }\n\n                if (web_page) {\n                    if (web_page.audio) {\n                        return web_page.audio.mime_type;\n                    }\n\n                    if (web_page.voice_note) {\n                        return web_page.voice_note.mime_type;\n                    }\n\n                    if (web_page.video_note) {\n                        return 'video/mp4';\n                    }\n                }\n            }\n\n            break;\n        }\n        case 'instantViewSource': {\n            const { block } = source;\n            if (block) {\n                const { audio, voice_note, video_note } = block;\n\n                if (audio) {\n                    return audio.mime_type;\n                }\n\n                if (voice_note) {\n                    return voice_note.mime_type;\n                }\n\n                if (video_note) {\n                    return 'video/mp4';\n                }\n            }\n\n            break;\n        }\n    }\n\n    return '';\n}\n\nexport function getMediaSrc(source) {\n    if (!source) return '';\n\n    switch (source['@type']) {\n        case 'message': {\n            const { content } = source;\n            if (content) {\n                const { audio, voice_note, video_note, web_page } = content;\n\n                if (audio) {\n                    const { audio: file } = audio;\n                    if (file) {\n                        let src = getSrc(file);\n                        if (!src && supportsStreaming()) {\n                            src = `/streaming/file?id=${file.id}&size=${file.size}&mime_type=${audio.mime_type}`;\n                        }\n\n                        return src;\n                    }\n                }\n\n                if (voice_note) {\n                    const { voice } = voice_note;\n                    if (voice) {\n                        return getSrc(voice);\n                    }\n                }\n\n                if (video_note) {\n                    const { video } = video_note;\n                    if (video) {\n                        return getSrc(video);\n                    }\n                }\n\n                if (web_page) {\n                    if (web_page.audio) {\n                        const { audio: file } = web_page.audio;\n                        if (file) {\n                            let src = getSrc(file);\n                            if (!src && supportsStreaming()) {\n                                src = `/streaming/file?id=${file.id}&size=${file.size}&mime_type=${web_page.audio.mime_type}`;\n                            }\n\n                            return src;\n                        }\n                    }\n\n                    if (web_page.voice_note) {\n                        const { voice } = web_page.voice_note;\n                        if (voice) {\n                            return getSrc(voice);\n                        }\n                    }\n\n                    if (web_page.video_note) {\n                        const { video } = web_page.video_note;\n                        if (video) {\n                            return getSrc(video);\n                        }\n                    }\n                }\n            }\n\n            break;\n        }\n        case 'instantViewSource': {\n            const { block } = source;\n            if (block) {\n                const { audio, voice_note, video_note } = block;\n\n                if (audio) {\n                    const { audio: file } = audio;\n                    if (file) {\n                        let src = getSrc(file);\n                        if (!src && supportsStreaming()) {\n                            src = `/streaming/file?id=${file.id}&size=${file.size}&mime_type=${audio.mime_type}`;\n                        }\n\n                        return src;\n                    }\n                }\n\n                if (voice_note) {\n                    const { voice } = voice_note;\n                    if (voice) {\n                        return getSrc(voice);\n                    }\n                }\n\n                if (video_note) {\n                    const { video } = video_note;\n                    if (video) {\n                        return getSrc(video);\n                    }\n                }\n            }\n\n            break;\n        }\n    }\n\n    return '';\n}","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport TdLibController from '../Controllers/TdLibController';\n\nexport function openArchive() {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateArchive',\n        open: true\n    });\n}\n\nexport function closeArchive() {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateArchive',\n        open: false\n    });\n}\n\nexport function editMessage(chatId, messageId) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateEditMessage',\n        chatId,\n        messageId\n    });\n}\n\nexport function deleteMessages(chatId, messageIds) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateDeleteMessages',\n        chatId,\n        messageIds\n    });\n}\n\nexport function replyMessage(chatId, messageId) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateReply',\n        chatId,\n        messageId\n    });\n}\n\nexport function forward(info) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateForward',\n        info\n    });\n}\n\nexport function forwardMessages(chatId, messageIds) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateForward',\n        info: {\n            chatId,\n            messageIds\n        }\n    });\n}\n\nexport function openUser(userId, popup = false) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateOpenUser',\n        userId,\n        popup\n    });\n}\n\nexport function openChat(chatId, messageId = null, popup = false) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateOpenChat',\n        chatId,\n        messageId,\n        popup\n    });\n}\n\nexport function closeChat() {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateOpenChat',\n        chatId: 0,\n        messageId: null,\n        popup: false\n    });\n}\n\nexport function openReply(chatId, messageId) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateOpenReply',\n        chatId,\n        messageId\n    });\n}\n\nexport function highlightMessage(chatId, messageId) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateMessageHighlighted',\n        chatId,\n        messageId\n    });\n}\n\nexport function selectMessage(chatId, messageId, selected) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateMessageSelected',\n        chatId,\n        messageId,\n        selected\n    });\n}\n\nexport function clearSelection() {\n    TdLibController.clientUpdate({ '@type': 'clientUpdateClearSelection' });\n}\n\nexport function setInstantViewViewerContent(content) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateInstantViewViewerContent',\n        content\n    });\n}\n\nexport function setMediaViewerContent(content) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateMediaViewerContent',\n        content\n    });\n}\n\nexport function setProfileMediaViewerContent(content) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateProfileMediaViewerContent',\n        content\n    });\n}\n\nexport function setInstantViewContent(content) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateInstantViewContent',\n        content\n    });\n}\n\nexport function searchChat(chatId, query = null) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateSearchChat',\n        chatId,\n        query\n    });\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport dateFormat from '../Utils/Date';\nimport { getFirstLetter, getLetters, getSize } from './Common';\nimport { PROFILE_PHOTO_BIG_SIZE, PROFILE_PHOTO_SMALL_SIZE, SERVICE_NOTIFICATIONS_USER_ID } from '../Constants';\nimport UserStore from '../Stores/UserStore';\n\nfunction getUserStatus(user) {\n    if (!user) return null;\n    if (!user.status) return null;\n\n    if (user.id === SERVICE_NOTIFICATIONS_USER_ID) {\n        return 'service notifications';\n    }\n\n    if (user.type && user.type['@type'] === 'userTypeBot') {\n        return 'bot';\n    }\n\n    switch (user.status['@type']) {\n        case 'userStatusEmpty': {\n            return 'last seen a long time ago';\n        }\n        case 'userStatusLastMonth': {\n            return 'last seen within a month';\n        }\n        case 'userStatusLastWeek': {\n            return 'last seen within a week';\n        }\n        case 'userStatusOffline': {\n            let { was_online } = user.status;\n            if (!was_online) return 'offline';\n\n            const now = new Date();\n            const wasOnline = new Date(was_online * 1000);\n            if (wasOnline > now) {\n                return 'last seen just now';\n            }\n\n            let diff = new Date(now - wasOnline);\n\n            // within a minute\n            if (diff.getTime() / 1000 < 60) {\n                return 'last seen just now';\n            }\n\n            // within an hour\n            if (diff.getTime() / 1000 < 60 * 60) {\n                const minutes = Math.floor(diff.getTime() / 1000 / 60);\n                return `last seen ${minutes === 1 ? '1 minute' : minutes + ' minutes'} ago`;\n            }\n\n            // today\n            const today = new Date();\n            today.setHours(0, 0, 0, 0);\n            if (wasOnline > today) {\n                // up to 6 hours ago\n                if (diff.getTime() / 1000 < 6 * 60 * 60) {\n                    const hours = Math.floor(diff.getTime() / 1000 / 60 / 60);\n                    return `last seen ${hours === 1 ? '1 hour' : hours + ' hours'} ago`;\n                }\n\n                // other\n                return `last seen today at ${dateFormat(wasOnline, 'H:MM')}`;\n            }\n\n            // yesterday\n            let yesterday = new Date();\n            yesterday.setDate(now.getDate() - 1);\n            today.setHours(0, 0, 0, 0);\n            if (wasOnline > yesterday) {\n                return `last seen yesterday at ${dateFormat(wasOnline, 'H:MM')}`;\n            }\n\n            return `last seen ${dateFormat(wasOnline, 'dd.mm.yyyy')}`;\n        }\n        case 'userStatusOnline': {\n            return 'online';\n        }\n        case 'userStatusRecently': {\n            return 'last seen recently';\n        }\n    }\n\n    return null;\n}\n\nfunction isUserOnline(user) {\n    if (!user) return false;\n\n    const { id, status, type } = user;\n    if (!status) return false;\n    if (!type) return false;\n    if (id === SERVICE_NOTIFICATIONS_USER_ID) return false;\n\n    return status['@type'] === 'userStatusOnline' && type['@type'] !== 'userTypeBot';\n}\n\nfunction getUserFullName(userId, user, t = k => k) {\n    user = UserStore.get(userId) || user;\n    if (!user) return null;\n\n    const { type, first_name, last_name } = user;\n    if (!type) return null;\n\n    switch (type['@type']) {\n        case 'userTypeBot':\n        case 'userTypeRegular': {\n            if (first_name && last_name) return `${first_name} ${last_name}`;\n            if (first_name) return first_name;\n            if (last_name) return last_name;\n        }\n        case 'userTypeDeleted':\n        case 'userTypeUnknown': {\n            return t('HiddenName');\n        }\n    }\n\n    return null;\n}\n\nfunction getUserShortName(userId, t = k => k) {\n    const user = UserStore.get(userId);\n    if (!user) return null;\n\n    const { type, first_name, last_name } = user;\n    if (!type) return null;\n\n    switch (type['@type']) {\n        case 'userTypeBot':\n        case 'userTypeRegular': {\n            if (first_name) return first_name;\n            if (last_name) return last_name;\n        }\n        case 'userTypeDeleted':\n        case 'userTypeUnknown': {\n            return t('HiddenName');\n        }\n    }\n\n    return null;\n}\n\nfunction isUserBlocked(userId) {\n    const fullInfo = UserStore.getFullInfo(userId);\n    if (fullInfo) {\n        return fullInfo.is_blocked;\n    }\n\n    return false;\n}\n\nfunction getUserLetters(userId, firstName, lastName, t) {\n    const user = UserStore.get(userId);\n    if (!user && !(firstName || lastName)) return null;\n\n    const title = getUserFullName(userId, null, t) || `${firstName} ${lastName}`.trim();\n    const letters = getLetters(title);\n    if (letters && letters.length > 0) {\n        return letters;\n    }\n\n    if (user) {\n        firstName = user.first_name;\n        lastName = user.last_name;\n    }\n\n    const firstNameSymbol = getFirstLetter(firstName) || firstName.charAt(0);\n    if (firstNameSymbol) return firstNameSymbol;\n\n    const lastNameSymbol = getFirstLetter(lastName) || lastName.charAt(0);\n    if (lastNameSymbol) return lastNameSymbol;\n\n    return '';\n}\n\nfunction getUserStatusOrder(user) {\n    if (!user) return 0;\n    if (!user.status) return 0;\n    if (user.type['@type'] === 'userTypeBot') return 0;\n\n    switch (user.status['@type']) {\n        case 'userStatusEmpty': {\n            return 1;\n        }\n        case 'userStatusLastMonth': {\n            return 10;\n        }\n        case 'userStatusLastWeek': {\n            return 100;\n        }\n        case 'userStatusOffline': {\n            return user.status.was_online;\n        }\n        case 'userStatusOnline': {\n            return user.status.expires;\n        }\n        case 'userStatusRecently': {\n            return 1000;\n        }\n    }\n}\n\nfunction getProfilePhoto(photo) {\n    if (!photo) return null;\n\n    const { id, sizes } = photo;\n    if (!sizes) return null;\n    if (!sizes.length) return null;\n\n    const { photo: small } = getSize(sizes, PROFILE_PHOTO_SMALL_SIZE);\n    const { photo: big } = getSize(sizes, PROFILE_PHOTO_BIG_SIZE);\n\n    return {\n        '@type': 'profilePhoto',\n        id,\n        small,\n        big\n    };\n}\n\nfunction getProfilePhotoDateHint(userProfilePhoto) {\n    if (!userProfilePhoto) return null;\n\n    const { added_date } = userProfilePhoto;\n    if (!added_date) return null;\n\n    const date = new Date(added_date * 1000);\n    return dateFormat(date, 'H:MM:ss d.mm.yyyy');\n}\n\nexport function isDeletedUser(userId) {\n    const user = UserStore.get(userId);\n\n    return user && user.type['@type'] === 'userTypeDeleted';\n}\n\nexport {\n    getUserStatus,\n    isUserOnline,\n    getUserFullName,\n    isUserBlocked,\n    getUserLetters,\n    getUserStatusOrder,\n    getProfilePhoto,\n    getProfilePhotoDateHint,\n    getUserShortName\n};\n","\n/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nclass Currency{\n    constructor(){\n        this.list = new Map([\n            [\"AED\", \"د.إ\"],\n            [\"AFN\", \"؋\"],\n            [\"ARS\", \"$\"],\n            [\"AUD\", \"$\"],\n            [\"AZN\", \"₼\"],\n            [\"BND\", \"B$\"],\n            [\"BRL\", \"R$\"],\n            [\"CAD\", \"$\"],\n            [\"CHF\", \"Fr\"],\n            [\"CLP\", \"$\"],\n            [\"CNY\", \"¥\"],\n            [\"COP\", \"$\"],\n            [\"EGP\", \"E£\"],\n            [\"EUR\", \"€\"],\n            [\"GBP\", \"£\"],\n            [\"HKD\", \"$\"],\n            [\"IDR\", \"Rp\"],\n            [\"ILS\", \"₪\"],\n            [\"INR\", \"₹\"],\n            [\"ISK\", \"kr\"],\n            [\"JPY\", \"¥\"],\n            [\"KRW\", \"₩\"],\n            [\"KZT\", \"₸\"],\n            [\"MXN\", \"$\"],\n            [\"MYR\", \"RM\"],\n            [\"NOK\", \"kr\"],\n            [\"NZD\", \"$\"],\n            [\"PHP\", \"₱\"],\n            [\"RUB\", \"₽\"],\n            [\"SAR\", \"SR\"],\n            [\"SEK\", \"kr\"],\n            [\"SGD\", \"$\"],\n            [\"TRY\", \"₺\"],\n            [\"TTD\", \"$\"],\n            [\"TWD\", \"$\"],\n            [\"TZS\", \"TSh\"],\n            [\"UAH\", \"₴\"],\n            [\"UGX\", \"USh\"],\n            [\"USD\", \"$\"],\n            [\"UYU\", \"$\"],\n            [\"VND\", \"₫\"],\n            [\"YER\", \"﷼\"],\n            [\"ZAR\", \"R\"],\n            [\"IRR\", \"﷼\"],\n            [\"IQD\", \"ع.د\"],\n            [\"VEF\", \"Bs.F.\"]\n        ]);\n    }\n\n    get(currency){\n        return this.list.get(currency);\n    }\n\n    set(currency, symbol){\n        this.list.set(currency, symbol);\n    }\n\n    getPow(currency){\n        if (currency === 'CLF'){\n            return 4;\n        }\n        if (['BHD', 'IQD', 'JOD', 'KWD', 'LYD', 'OMR', 'TND'].includes(currency)){\n            return 3;\n        }\n        if (['BIF', 'BYR', 'CLP', 'CVE', 'DJF', 'GNF', 'ISK', 'JPY', 'KMF', 'KRW', 'MGA', 'PYG', 'RWF', 'UGX', 'UYI', 'VND', 'VUV', 'XAF', 'XOF', 'XPF'].includes(currency)){\n            return 0;\n        }\n        if (currency === 'MRO'){\n            return 1;\n        }\n\n        return 2;\n    }\n\n    getString(totalAmount, currency){\n        const amount = (totalAmount/Math.pow(10.0, this.getPow(currency))).toFixed(2);\n        return `${amount} ${this.get(currency)}`;\n    }\n}\n\nlet currency = new Currency();\nexport default currency;","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport Currency from './Currency';\nimport MessageAuthor from '../Components/Message/MessageAuthor';\nimport ChatStore from '../Stores/ChatStore';\nimport UserStore from '../Stores/UserStore';\nimport MessageStore from '../Stores/MessageStore';\n\nlet serviceMap = new Map();\nserviceMap.set('messageBasicGroupChatCreate', 'messageBasicGroupChatCreate');\nserviceMap.set('messageChatAddMembers', 'messageChatAddMembers');\nserviceMap.set('messageChatChangePhoto', 'messageChatChangePhoto');\nserviceMap.set('messageChatChangeTitle', 'messageChatChangeTitle');\nserviceMap.set('messageChatDeleteMember', 'messageChatDeleteMember');\nserviceMap.set('messageChatDeletePhoto', 'messageChatDeletePhoto');\nserviceMap.set('messageChatJoinByLink', 'messageChatJoinByLink');\nserviceMap.set('messageChatSetTtl', 'messageChatSetTtl');\nserviceMap.set('messageChatUpgradeFrom', 'messageChatUpgradeFrom');\nserviceMap.set('messageChatUpgradeTo', 'messageChatUpgradeTo');\nserviceMap.set('messageContactRegistered', 'messageContactRegistered');\nserviceMap.set('messageCustomServiceAction', 'messageCustomServiceAction');\nserviceMap.set('messageGameScore', 'messageGameScore');\nserviceMap.set('messagePassportDataReceived', 'messagePassportDataReceived');\nserviceMap.set('messagePassportDataSent', 'messagePassportDataSent');\nserviceMap.set('messagePaymentSuccessful', 'messagePaymentSuccessful');\nserviceMap.set('messagePaymentSuccessfulBot', 'messagePaymentSuccessfulBot');\nserviceMap.set('messagePinMessage', 'messagePinMessage');\nserviceMap.set('messageScreenshotTaken', 'messageScreenshotTaken');\nserviceMap.set('messageSupergroupChatCreate', 'messageSupergroupChatCreate');\nserviceMap.set('messageUnsupported', 'messageUnsupported');\nserviceMap.set('messageWebsiteConnected', 'messageWebsiteConnected');\n\nfunction isServiceMessage(message) {\n    if (!message) return false;\n    if (!message.content) return false;\n\n    return serviceMap.has(message.content['@type']) || message.ttl > 0;\n}\n\nfunction getTTLString(ttl) {\n    if (ttl < 60) {\n        const seconds = ttl === 1 ? 'second' : 'seconds';\n        return `${ttl} ${seconds}`;\n    }\n    if (ttl < 60 * 60) {\n        const minutes = Math.floor(ttl / 60) === 1 ? 'minute' : 'minutes';\n        return `${ttl} ${minutes}`;\n    }\n    if (ttl < 24 * 60 * 60) {\n        const hours = Math.floor(ttl / 60 / 60) === 1 ? 'hour' : 'hours';\n        return `${ttl} ${hours}`;\n    }\n    if (ttl < 7 * 24 * 60 * 60) {\n        const days = Math.floor(ttl / 60 / 60 / 24) === 1 ? 'day' : 'days';\n        return `${ttl} ${days}`;\n    }\n    if (ttl === 7 * 24 * 60 * 60) {\n        return '1 week';\n    }\n\n    return `${ttl} seconds`;\n}\n\nfunction getPassportElementTypeString(type) {\n    switch (type['@type']) {\n        case 'passportElementTypeAddress': {\n            return 'Address';\n        }\n        case 'passportElementTypeBankStatement': {\n            return 'Bank Statement';\n        }\n        case 'passportElementTypeDriverLicense': {\n            return 'Driver Licence';\n        }\n        case 'passportElementTypeEmailAddress': {\n            return 'Email';\n        }\n        case 'passportElementTypeIdentityCard': {\n            return 'Identity Card';\n        }\n        case 'passportElementTypeInternalPassport': {\n            return 'Internal Passport';\n        }\n        case 'passportElementTypePassport': {\n            return 'Passport';\n        }\n        case 'passportElementTypePassportRegistration': {\n            return 'Passport Registration';\n        }\n        case 'passportElementTypePersonalDetails': {\n            return 'Personal details';\n        }\n        case 'passportElementTypePhoneNumber': {\n            return 'Phone Number';\n        }\n        case 'passportElementTypeRentalAgreement': {\n            return 'Tenancy Agreement';\n        }\n        case 'passportElementTypeTemporaryRegistration': {\n            return 'Temporary Registration';\n        }\n        case 'passportElementTypeUtilityBill': {\n            return 'Utility Bill';\n        }\n    }\n\n    return '';\n}\n\nfunction getMessageAuthor(message, openUser) {\n    if (!message) return null;\n\n    const { chat_id, sender_user_id } = message;\n\n    if (sender_user_id !== 0) {\n        return <MessageAuthor userId={sender_user_id} openUser={openUser} />;\n    }\n\n    const chat = ChatStore.get(chat_id);\n    if (!chat) return null;\n\n    return chat.title;\n}\n\nfunction getServiceMessageContent(message, openUser = false) {\n    if (!message) return null;\n    if (!message.content) return null;\n\n    const isOutgoing = message.sender_user_id === UserStore.getMyId();\n    const chat = ChatStore.get(message.chat_id);\n    const isChannel = chat.type['@type'] === 'chatTypeSupergroup' && chat.type.is_channel;\n\n    const { ttl, sender_user_id, content } = message;\n    if (ttl > 0) {\n        switch (content['@type']) {\n            case 'messagePhoto': {\n                if (isOutgoing) {\n                    return 'You sent a self-destructing photo. Please view it on your mobile';\n                }\n\n                return (\n                    <>\n                        <MessageAuthor userId={sender_user_id} openUser={openUser} />\n                        {' sent a self-destructing photo. Please view it on your mobile'}\n                    </>\n                );\n            }\n            case 'messageVideo': {\n                if (isOutgoing) {\n                    return 'You sent a self-destructing video. Please view it on your mobile';\n                }\n\n                return (\n                    <>\n                        <MessageAuthor userId={sender_user_id} openUser={openUser} />\n                        {' sent a self-destructing video. Please view it on your mobile'}\n                    </>\n                );\n            }\n            default: {\n                if (isOutgoing) {\n                    return 'You sent a self-destructing message. Please view it on your mobile';\n                }\n\n                return (\n                    <>\n                        <MessageAuthor userId={sender_user_id} openUser={openUser} />\n                        {' sent a self-destructing message. Please view it on your mobile'}\n                    </>\n                );\n            }\n        }\n    }\n\n    switch (content['@type']) {\n        case 'messageBasicGroupChatCreate': {\n            const { title } = ChatStore.get(message.chat_id);\n\n            if (isOutgoing) {\n                return `You created group «${title}»`;\n            }\n\n            return (\n                <>\n                    <MessageAuthor userId={sender_user_id} openUser={openUser} />\n                    {` created group «${title}»`}\n                </>\n            );\n        }\n        case 'messageChatAddMembers': {\n            const members = content.member_user_ids\n                .map(x => <MessageAuthor key={x} userId={x} openUser={openUser} />)\n                .reduce((accumulator, current, index, array) => {\n                    const separator = index === array.length - 1 ? ' and ' : ', ';\n                    return accumulator === null ? [current] : [...accumulator, separator, current];\n                }, null);\n\n            if (isOutgoing) {\n                return content.member_user_ids.length === 1 && content.member_user_ids[0] === UserStore.getMyId() ? (\n                    'You joined the group'\n                ) : (\n                    <>\n                        {'You added '}\n                        {members}\n                    </>\n                );\n            }\n\n            return content.member_user_ids.length === 1 && content.member_user_ids[0] === message.sender_user_id ? (\n                <>\n                    <MessageAuthor userId={sender_user_id} openUser={openUser} />\n                    {' joined the group'}\n                </>\n            ) : (\n                <>\n                    <MessageAuthor userId={sender_user_id} openUser={openUser} />\n                    {' added '}\n                    {members}\n                </>\n            );\n        }\n        case 'messageChatChangePhoto': {\n            if (isChannel) {\n                return 'Channel photo updated';\n            }\n\n            if (isOutgoing) {\n                return 'You updated group photo';\n            }\n\n            return (\n                <>\n                    <MessageAuthor userId={sender_user_id} openUser={openUser} />\n                    {` updated group photo`}\n                </>\n            );\n        }\n        case 'messageChatChangeTitle': {\n            const { title } = content;\n\n            if (isChannel) {\n                return `Channel name was changed to «${title}»`;\n            }\n\n            if (isOutgoing) {\n                return `You changed group name to «${title}»`;\n            }\n\n            return (\n                <>\n                    <MessageAuthor userId={sender_user_id} openUser={openUser} />\n                    {` changed group name to «${title}»`}\n                </>\n            );\n        }\n        case 'messageChatDeleteMember': {\n            if (isOutgoing) {\n                return content.user_id === UserStore.getMyId() ? (\n                    'You left the group'\n                ) : (\n                    <>\n                        {'You removed '}\n                        <MessageAuthor userId={content.user_id} openUser={openUser} />\n                    </>\n                );\n            }\n\n            return content.user_id === sender_user_id ? (\n                <>\n                    <MessageAuthor userId={sender_user_id} openUser={openUser} />\n                    {' left the group'}\n                </>\n            ) : (\n                <>\n                    <MessageAuthor userId={sender_user_id} openUser={openUser} />\n                    {' removed '}\n                    <MessageAuthor userId={content.user_id} openUser={openUser} />\n                </>\n            );\n        }\n        case 'messageChatDeletePhoto': {\n            if (isChannel) {\n                return 'Channel photo removed';\n            }\n\n            if (isOutgoing) {\n                return 'You removed group photo';\n            }\n\n            return (\n                <>\n                    <MessageAuthor userId={sender_user_id} openUser={openUser} />\n                    {' removed group photo'}\n                </>\n            );\n        }\n        case 'messageChatJoinByLink': {\n            if (isOutgoing) {\n                return 'You joined the group via invite link';\n            }\n\n            return (\n                <>\n                    <MessageAuthor userId={sender_user_id} openUser={openUser} />\n                    {' joined the group via invite link'}\n                </>\n            );\n        }\n        case 'messageChatSetTtl': {\n            const { ttl } = content;\n            const ttlString = getTTLString(ttl);\n\n            if (ttl <= 0) {\n                if (isOutgoing) {\n                    return 'You disabled the self-destruct timer';\n                }\n\n                return (\n                    <>\n                        <MessageAuthor userId={sender_user_id} openUser={openUser} />\n                        {' disabled the self-destruct timer'}\n                    </>\n                );\n            }\n\n            if (isOutgoing) {\n                return `You set the self-destruct timer to ${ttlString}`;\n            }\n\n            return (\n                <>\n                    <MessageAuthor userId={sender_user_id} openUser={openUser} />\n                    {` set the self-destruct timer to ${ttlString}`}\n                </>\n            );\n        }\n        case 'messageChatUpgradeFrom': {\n            return 'The group was upgraded to a supergroup';\n        }\n        case 'messageChatUpgradeTo': {\n            return 'Group migrated to a supergroup';\n        }\n        case 'messageContactRegistered': {\n            return (\n                <>\n                    <MessageAuthor userId={sender_user_id} openUser={openUser} />\n                    {' just joined Telegram'}\n                </>\n            );\n        }\n        case 'messageCustomServiceAction': {\n            return content.text;\n        }\n        case 'messageGameScore': {\n            const messageGame = MessageStore.get(message.chat_id, content.game_message_id);\n            if (\n                messageGame &&\n                messageGame.content &&\n                messageGame.content['@type'] === 'messageGame' &&\n                messageGame.content.game\n            ) {\n                const { game } = messageGame.content;\n\n                if (isOutgoing) {\n                    return `You scored ${content.score} in «${game.title}»`;\n                }\n\n                return (\n                    <>\n                        <MessageAuthor userId={messageGame.sender_user_id} openUser={openUser} />\n                        {` scored ${content.score} in «${game.title}»`}\n                    </>\n                );\n            }\n\n            if (isOutgoing) {\n                return `You scored ${content.score}`;\n            }\n\n            return (\n                <>\n                    <MessageAuthor userId={sender_user_id} openUser={openUser} />\n                    {` scored ${content.score}`}\n                </>\n            );\n        }\n        case 'messagePassportDataReceived': {\n            return 'Telegram Passport data received';\n        }\n        case 'messagePassportDataSent': {\n            const chat = ChatStore.get(message.chat_id);\n\n            const passportElementTypes = content.types\n                .map(x => getPassportElementTypeString(x))\n                .reduce((accumulator, current) => {\n                    return accumulator === null ? [current] : [...accumulator, ', ', current];\n                }, null);\n\n            return (\n                <>\n                    <MessageAuthor userId={chat.type.user_id} openUser={openUser} />\n                    {' received the following documents: '}\n                    {passportElementTypes}\n                </>\n            );\n        }\n        case 'messagePaymentSuccessful': {\n            const chat = ChatStore.get(message.chat_id);\n\n            const messageInvoice = MessageStore.get(message.chat_id, content.invoice_message_id);\n            if (\n                messageInvoice &&\n                messageInvoice.content &&\n                messageInvoice.content['@type'] === 'messageInvoice' &&\n                messageInvoice.content.invoice\n            ) {\n                const { invoice } = messageInvoice.content;\n\n                return (\n                    <>\n                        {`You have just successfully transferred ${Currency.getString(\n                            content.total_amount,\n                            content.currency\n                        )} to `}\n                        <MessageAuthor userId={chat.type.user_id} openUser={openUser} />\n                        {` for ${invoice.title}`}\n                    </>\n                );\n            }\n\n            return (\n                <>\n                    {`You have just successfully transferred ${Currency.getString(\n                        content.total_amount,\n                        content.currency\n                    )} to `}\n                    <MessageAuthor userId={chat.type.user_id} openUser={openUser} />\n                </>\n            );\n        }\n        case 'messagePaymentSuccessfulBot': {\n            return 'Payment successful';\n        }\n        case 'messagePinMessage': {\n            const author = getMessageAuthor(message, openUser);\n            const pinnedMessage = MessageStore.get(message.chat_id, content.message_id);\n            if (!pinnedMessage || !pinnedMessage.content) {\n                return (\n                    <>\n                        {author}\n                        {' pinned a message'}\n                    </>\n                );\n            }\n\n            let pinnedContent = ' pinned a message';\n            if (isServiceMessage(pinnedMessage)) {\n                pinnedContent = ' pinned a service message';\n            } else {\n                switch (pinnedMessage.content['@type']) {\n                    case 'messageAnimation': {\n                        pinnedContent = ' pinned a GIF';\n                        break;\n                    }\n                    case 'messageAudio': {\n                        pinnedContent = ' pinned a track';\n                        break;\n                    }\n                    case 'messageCall': {\n                        pinnedContent = ' pinned a call';\n                        break;\n                    }\n                    case 'messageContact': {\n                        pinnedContent = ' pinned a contact';\n                        break;\n                    }\n                    case 'messageDocument': {\n                        pinnedContent = ' pinned a file';\n                        break;\n                    }\n                    case 'messageExpiredPhoto': {\n                        pinnedContent = ' pinned a photo';\n                        break;\n                    }\n                    case 'messageExpiredVideo': {\n                        pinnedContent = ' pinned a video';\n                        break;\n                    }\n                    case 'messageGame': {\n                        pinnedContent = ' pinned a game';\n                        break;\n                    }\n                    case 'messageInvoice': {\n                        pinnedContent = ' pinned an invoice';\n                        break;\n                    }\n                    case 'messageLocation': {\n                        pinnedContent = ' pinned a map';\n                        break;\n                    }\n                    case 'messagePhoto': {\n                        pinnedContent = ' pinned a photo';\n                        break;\n                    }\n                    case 'messagePoll': {\n                        pinnedContent = ' pinned a poll';\n                        break;\n                    }\n                    case 'messageSticker': {\n                        pinnedContent = ' pinned a sticker';\n                        break;\n                    }\n                    case 'messageText': {\n                        const maxLength = 16;\n                        const text = pinnedMessage.content.text.text;\n                        if (text.length <= maxLength) {\n                            pinnedContent = ` pinned «${text}»`;\n                        } else {\n                            pinnedContent = ` pinned «${text.substring(0, maxLength)}...»`;\n                        }\n\n                        break;\n                    }\n                    case 'messageUnsupported': {\n                        pinnedContent = ' pinned unsupported message';\n                        break;\n                    }\n                    case 'messageVenue': {\n                        pinnedContent = ' pinned a venue';\n                        break;\n                    }\n                    case 'messageVideo': {\n                        pinnedContent = ' pinned a video';\n                        break;\n                    }\n                    case 'messageVideoNote': {\n                        pinnedContent = ' pinned a video message';\n                        break;\n                    }\n                    case 'messageVoiceNote': {\n                        pinnedContent = ' pinned a voice message';\n                        break;\n                    }\n                }\n            }\n\n            return (\n                <>\n                    {author}\n                    {pinnedContent}\n                </>\n            );\n        }\n        case 'messageScreenshotTaken': {\n            if (isOutgoing) {\n                return 'You took a screenshot!';\n            }\n\n            return (\n                <>\n                    <MessageAuthor userId={sender_user_id} openUser={openUser} />\n                    {' took a screenshot!'}\n                </>\n            );\n        }\n        case 'messageSupergroupChatCreate': {\n            const { title } = content;\n\n            if (isChannel) {\n                return 'Channel created';\n            }\n\n            if (isOutgoing) {\n                return `You created group «${title}»`;\n            }\n\n            return (\n                <>\n                    <MessageAuthor userId={sender_user_id} openUser={openUser} />\n                    {` created group «${title}»`}\n                </>\n            );\n        }\n        case 'messageUnsupported': {\n            return 'Unsupported message';\n        }\n        case 'messageWebsiteConnected': {\n            return `You allowed this bot to message you when you logged in on ${content.domain_name}.`;\n        }\n    }\n\n    return `[${message.content['@type']}]`;\n}\n\nexport { isServiceMessage, getServiceMessageContent };\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport classNames from 'classnames';\nimport { getUserFullName } from '../../Utils/User';\nimport { getChatTitle, isPrivateChat } from '../../Utils/Chat';\nimport { openUser as openUserCommand, openChat as openChatCommand } from '../../Actions/Client';\nimport ChatStore from '../../Stores/ChatStore';\nimport UserStore from '../../Stores/UserStore';\nimport './MessageAuthor.css';\n\nclass MessageAuthor extends React.Component {\n    state = { };\n\n    static getDerivedStateFromProps(props, state) {\n        const { chatId, userId, t } = props;\n\n        if (state.prevChatId !== chatId || state.prevUserId !== userId) {\n            return {\n                prevChatId: chatId,\n                prevUserId: userId,\n\n                fullName: MessageAuthor.getFullName(userId, chatId, t)\n            };\n        }\n\n        return null;\n    }\n\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\n        const { fullName } = this.state;\n\n        return fullName !== nextState.fullName;\n    }\n\n    componentDidMount() {\n        ChatStore.on('updateChatTitle', this.onUpdateChatTitle);\n        UserStore.on('updateUser', this.onUpdateUser);\n    }\n\n    componentWillUnmount() {\n        ChatStore.off('updateChatTitle', this.onUpdateChatTitle);\n        UserStore.off('updateUser', this.onUpdateUser);\n    }\n\n    onUpdateUser = update => {\n        const { chatId, userId, t } = this.props;\n        const { user } = update;\n\n        if (userId !== user.id) return;\n\n        const fullName = MessageAuthor.getFullName(userId, chatId, t);\n        this.setState({ fullName });\n    };\n\n    onUpdateChatTitle = update => {\n        const { chatId, userId, t } = this.props;\n        const { chat_id } = update;\n\n        if (chat_id !== chatId) return;\n        if (userId) return;\n\n        const fullName = MessageAuthor.getFullName(userId, chatId, t);\n        this.setState({ fullName });\n    };\n\n    static getFullName = (userId, chatId, t) => {\n        const user = UserStore.get(userId);\n        if (user) {\n            return getUserFullName(userId, null, t);\n        }\n\n        const chat = ChatStore.get(chatId);\n        if (chat) {\n            return getChatTitle(chatId, false, t);\n        }\n\n        return '';\n    };\n\n    handleSelect = event => {\n        const { chatId, userId, openUser, openChat } = this.props;\n\n        if (openUser && userId) {\n            event.stopPropagation();\n\n            openUserCommand(userId, true);\n            return;\n        }\n\n        if (openChat && chatId) {\n            event.stopPropagation();\n\n            openChatCommand(chatId, null, true);\n            return;\n        }\n    };\n\n    render() {\n        const { chatId, userId, openUser, openChat } = this.props;\n        const { fullName } = this.state;\n\n        const user = UserStore.get(userId);\n        if (user) {\n            const tileColor = isPrivateChat(chatId)\n                ? 'message-author-color'\n                : `user_color_${(Math.abs(userId) % 8) + 1}`;\n            const className = classNames([tileColor], 'message-author');\n\n            return openUser ? (\n                <a className={className} onClick={this.handleSelect}>\n                    {fullName}\n                </a>\n            ) : (\n                <>{fullName}</>\n            );\n        }\n\n        const chat = ChatStore.get(chatId);\n        if (chat) {\n            const className = classNames('message-author-color', 'message-author');\n\n            return openChat ? (\n                <a className={className} onClick={this.handleSelect}>\n                    {fullName}\n                </a>\n            ) : (\n                <>{fullName}</>\n            );\n        }\n\n        return null;\n    }\n}\n\nMessageAuthor.propTypes = {\n    chatId: PropTypes.number,\n    userId: PropTypes.number,\n    openUser: PropTypes.bool,\n    openChat: PropTypes.bool\n};\n\nMessageAuthor.defaultProps = {\n    openUser: false,\n    openChat: false\n};\n\nexport default withTranslation()(MessageAuthor);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport { isGroupChat } from '../../Utils/Chat';\nimport { modalManager } from '../../Utils/Modal';\nimport { openChat, openUser } from '../../Actions/Client';\nimport TdLibController from '../../Controllers/TdLibController';\nimport './MentionLink.css';\n\nclass MentionLink extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {};\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        const { userId, username } = props;\n\n        if (state.prevUserId !== userId || state.prevUsername !== username) {\n            return {\n                prevUserId: userId,\n                prevUsername: username,\n                error: false\n            };\n        }\n\n        return null;\n    }\n\n    handleClick = async event => {\n        event.stopPropagation();\n        event.preventDefault();\n\n        const { userId, username, popup } = this.props;\n        if (userId) {\n            openUser(userId, popup);\n        } else if (username) {\n            const chat = await TdLibController.send({\n                '@type': 'searchPublicChat',\n                username\n            }).catch(() => {\n                this.setState({ error: true });\n            });\n\n            if (chat) {\n                if (isGroupChat(chat.id)) {\n                    openChat(chat.id, null, false);\n                } else {\n                    openChat(chat.id, null, popup);\n                }\n            }\n        }\n    };\n\n    handleClose = () => {\n        this.setState({ error: false });\n    };\n\n    handleDialogClick = event => {\n        event.preventDefault();\n        event.stopPropagation();\n    };\n\n    render() {\n        const { children, t, title, username } = this.props;\n        const { error } = this.state;\n\n        return (\n            <>\n                <a title={title} onClick={this.handleClick}>\n                    {children}\n                </a>\n                {error && (\n                    <Dialog\n                        manager={modalManager}\n                        transitionDuration={0}\n                        open={true}\n                        onClose={this.handleClose}\n                        onClick={this.handleDialogClick}\n                        aria-labelledby='confirm-dialog-title'>\n                        <DialogTitle id='confirm-dialog-title'>{t('Error')}</DialogTitle>\n                        <DialogContent classes={{ root: 'safe-link-content-root' }}>\n                            <DialogContentText>{`Can't find username ${username}.`}</DialogContentText>\n                        </DialogContent>\n                        <DialogActions>\n                            <Button onClick={this.handleClose}>{t('Ok')}</Button>\n                        </DialogActions>\n                    </Dialog>\n                )}\n            </>\n        );\n    }\n}\n\nMentionLink.propTypes = {\n    userId: PropTypes.number,\n    username: PropTypes.string,\n    title: PropTypes.string,\n    popup: PropTypes.bool\n};\n\nMentionLink.defaultProps = {\n    popup: true\n};\n\nexport default withTranslation()(MentionLink);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport emojiRegex from 'emoji-regex';\nimport MentionLink from '../Components/Additional/MentionLink';\nimport Poll from '../Components/Message/Media/Poll';\nimport SafeLink from '../Components/Additional/SafeLink';\nimport dateFormat from '../Utils/Date';\nimport { searchChat, setMediaViewerContent } from '../Actions/Client';\nimport { getChatTitle, isMeChat } from './Chat';\nimport { openUser } from './../Actions/Client';\nimport { getFitSize, getPhotoSize, getSize } from './Common';\nimport { download, saveOrDownload, supportsStreaming } from './File';\nimport { getAudioTitle } from './Media';\nimport { getDecodedUrl } from './Url';\nimport { getServiceMessageContent } from './ServiceMessage';\nimport { getUserFullName } from './User';\nimport { getBlockAudio } from './InstantView';\nimport { LOCATION_HEIGHT, LOCATION_SCALE, LOCATION_WIDTH, LOCATION_ZOOM, PHOTO_DISPLAY_SIZE, PHOTO_SIZE, PLAYER_AUDIO_2X_MIN_DURATION } from '../Constants';\nimport AppStore from '../Stores/ApplicationStore';\nimport ChatStore from '../Stores/ChatStore';\nimport FileStore from '../Stores/FileStore';\nimport MessageStore from '../Stores/MessageStore';\nimport PlayerStore from '../Stores/PlayerStore';\nimport UserStore from '../Stores/UserStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nexport function isMetaBubble(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) {\n        return false;\n    }\n\n    const { content } = message;\n    if (!content) {\n        return false;\n    }\n\n    const { caption } = content;\n    if (caption && caption.text && caption.text.length > 0) {\n        return false;\n    }\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            return true;\n        }\n        case 'messageLocation': {\n            return true;\n        }\n        case 'messagePhoto': {\n            return true;\n        }\n        case 'messageSticker': {\n            return true;\n        }\n        case 'messageVideo': {\n            return true;\n        }\n        case 'messageVideoNote': {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nexport function isMessageUnread(chatId, messageId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) {\n        return false;\n    }\n\n    const { last_read_inbox_message_id, last_read_outbox_message_id } = chat;\n\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) {\n        return false;\n    }\n\n    const { id, is_outgoing } = message;\n    const isMe = isMeChat(chatId);\n    if (is_outgoing && isMe) {\n        return false;\n    }\n\n    return is_outgoing ? id > last_read_outbox_message_id : id > last_read_inbox_message_id;\n}\n\nfunction getAuthor(message, t = k => k) {\n    if (!message) return null;\n\n    const { forward_info } = message;\n\n    if (forward_info) {\n        switch (forward_info['@type']) {\n            case 'messageForwardedFromUser': {\n                if (forward_info.sender_user_id > 0) {\n                    const user = UserStore.get(forward_info.sender_user_id);\n                    if (user) {\n                        return getUserFullName(forward_info.sender_user_id, null, t);\n                    }\n                }\n                break;\n            }\n            case 'messageForwardedPost': {\n                const chat = ChatStore.get(forward_info.chat_id);\n                if (chat) {\n                    return chat.title;\n                }\n                break;\n            }\n        }\n    }\n\n    return getTitle(message, t);\n}\n\nfunction getTitle(message, t = k => k) {\n    if (!message) return null;\n\n    const { sender_user_id, chat_id } = message;\n\n    if (sender_user_id) {\n        const user = UserStore.get(sender_user_id);\n        if (user) {\n            return getUserFullName(sender_user_id, null, t);\n        }\n    }\n\n    if (chat_id) {\n        const chat = ChatStore.get(chat_id);\n        if (chat) {\n            return chat.title;\n        }\n    }\n\n    return null;\n}\n\nfunction substring(text, start, end) {\n    if (start < 0) start = 0;\n    if (start > text.length - 1) start = text.length - 1;\n    if (end < start) end = start;\n    if (end > text.length) end = text.length;\n\n    return text.substring(start, end);\n}\n\nfunction stopPropagation(event) {\n    event.stopPropagation();\n}\n\nfunction searchCurrentChat(event, text) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    const { chatId } = AppStore;\n\n    searchChat(chatId, text);\n}\n\nfunction getFormattedText(formattedText, t = k => k) {\n    if (formattedText['@type'] !== 'formattedText') return null;\n\n    const { text, entities } = formattedText;\n    if (!text) return null;\n    if (!entities) return [text];\n    if (!entities.length) return [text];\n\n    let deleteLineBreakAfterPre = false;\n    let result = [];\n    let index = 0;\n    for (let i = 0; i < entities.length; i++) {\n        const entity = entities[i];\n        const { offset, length, type } = entity;\n\n        // skip nested entities\n        if (index > offset) {\n            continue;\n        }\n\n        let textBefore = substring(text, index, offset);\n        const textBeforeLength = textBefore.length;\n        if (textBefore) {\n            if (deleteLineBreakAfterPre && textBefore.length > 0 && textBefore[0] === '\\n') {\n                textBefore = textBefore.substr(1);\n                deleteLineBreakAfterPre = false;\n            }\n            if (textBefore) {\n                result.push(textBefore);\n            }\n        }\n\n        const entityKey = offset;\n        let entityText = substring(text, offset, offset + length);\n        if (deleteLineBreakAfterPre && entityText.length > 0 && entityText[0] === '\\n') {\n            entityText = entityText.substr(1);\n            deleteLineBreakAfterPre = false;\n        }\n\n        switch (type['@type']) {\n            case 'textEntityTypeBold': {\n                result.push(<strong key={entityKey}>{entityText}</strong>);\n                break;\n            }\n            case 'textEntityTypeBotCommand': {\n                const command = entityText.length > 0 && entityText[0] === '/' ? substring(entityText, 1) : entityText;\n                result.push(\n                    <a key={entityKey} onClick={stopPropagation} href={`tg://bot_command?command=${command}&bot=`}>\n                        {entityText}\n                    </a>\n                );\n                break;\n            }\n            case 'textEntityTypeCashtag': {\n                result.push(\n                    <a key={entityKey} onClick={event => searchCurrentChat(event, entityText)}>\n                        {entityText}\n                    </a>\n                );\n                break;\n            }\n            case 'textEntityTypeCode': {\n                result.push(<code key={entityKey}>{entityText}</code>);\n                break;\n            }\n            case 'textEntityTypeEmailAddress': {\n                result.push(\n                    <a\n                        key={entityKey}\n                        href={`mailto:${entityText}`}\n                        onClick={stopPropagation}\n                        target='_blank'\n                        rel='noopener noreferrer'>\n                        {entityText}\n                    </a>\n                );\n                break;\n            }\n            case 'textEntityTypeHashtag': {\n                result.push(\n                    <a key={entityKey} onClick={event => searchCurrentChat(event, entityText)}>\n                        {entityText}\n                    </a>\n                );\n                break;\n            }\n            case 'textEntityTypeItalic': {\n                result.push(<em key={entityKey}>{entityText}</em>);\n                break;\n            }\n            case 'textEntityTypeMentionName': {\n                result.push(\n                    <MentionLink key={entityKey} userId={type.user_id} title={getUserFullName(type.user_id, null, t)}>\n                        {entityText}\n                    </MentionLink>\n                );\n                break;\n            }\n            case 'textEntityTypeMention': {\n                result.push(\n                    <MentionLink key={entityKey} username={entityText}>\n                        {entityText}\n                    </MentionLink>\n                );\n                break;\n            }\n            case 'textEntityTypePhoneNumber': {\n                result.push(\n                    <a key={entityKey} href={`tel:${entityText}`} onClick={stopPropagation}>\n                        {entityText}\n                    </a>\n                );\n                break;\n            }\n            case 'textEntityTypePre': {\n                result.push(<pre key={entityKey}>{entityText}</pre>);\n                deleteLineBreakAfterPre = true;\n                break;\n            }\n            case 'textEntityTypePreCode': {\n                result.push(\n                    <pre key={entityKey}>\n                        <code>{entityText}</code>\n                    </pre>\n                );\n                deleteLineBreakAfterPre = true;\n                break;\n            }\n            case 'textEntityTypeTextUrl': {\n                const url = type.url ? type.url : entityText;\n\n                result.push(\n                    <SafeLink key={entityKey} url={url}>\n                        {entityText}\n                    </SafeLink>\n                );\n                break;\n            }\n            case 'textEntityTypeUrl': {\n                result.push(\n                    <SafeLink key={entityKey} url={entityText}>\n                        {entityText}\n                    </SafeLink>\n                );\n                break;\n            }\n            default:\n                result.push(entityText);\n                break;\n        }\n\n        index += textBeforeLength + entity.length;\n    }\n\n    if (index < text.length) {\n        let textAfter = text.substring(index);\n        if (deleteLineBreakAfterPre && textAfter.length > 0 && textAfter[0] === '\\n') {\n            textAfter = textAfter.substr(1);\n        }\n        if (textAfter) {\n            result.push(textAfter);\n        }\n    }\n\n    return result;\n}\n\nfunction getText(message, meta, t = k => k) {\n    if (!message) return null;\n\n    let result = [];\n\n    const { content } = message;\n    if (!content) return [meta];\n\n    const { text, caption } = content;\n\n    if (text && text['@type'] === 'formattedText' && text.text) {\n        result = getFormattedText(text, t);\n    } else if (caption && caption['@type'] === 'formattedText' && caption.text) {\n        const formattedText = getFormattedText(caption, t);\n        if (formattedText) {\n            result = result.concat(formattedText);\n        }\n    }\n\n    return result && result.length > 0 ? [...result, meta] : [];\n}\n\nfunction getWebPage(message) {\n    if (!message) return null;\n    if (!message.content) return null;\n\n    return message.content.web_page;\n}\n\nfunction getDate(date) {\n    if (!date) return null;\n\n    const d = new Date(date * 1000);\n\n    return dateFormat(d, 'H:MM'); //date.toDateString();\n}\n\nfunction getDateHint(date) {\n    if (!date) return null;\n\n    const d = new Date(date * 1000);\n    return dateFormat(d, 'H:MM:ss d.mm.yyyy'); //date.toDateString();\n}\n\nfunction isForwardOriginHidden(forwardInfo) {\n    if (!forwardInfo) return false;\n\n    const { origin } = forwardInfo;\n    if (!origin) return false;\n\n    switch (origin['@type']) {\n        case 'messageForwardOriginUser': {\n            return false;\n        }\n        case 'messageForwardOriginHiddenUser': {\n            return true;\n        }\n        case 'messageForwardOriginChannel': {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nfunction getForwardTitle(forwardInfo, t = key => key) {\n    if (!forwardInfo) return '';\n\n    const { origin } = forwardInfo;\n    if (!origin) return '';\n\n    switch (origin['@type']) {\n        case 'messageForwardOriginUser': {\n            const { sender_user_id } = origin;\n\n            return getUserFullName(sender_user_id, null, t);\n        }\n        case 'messageForwardOriginHiddenUser': {\n            const { sender_name } = origin;\n\n            return sender_name;\n        }\n        case 'messageForwardOriginChannel': {\n            const { chat_id, author_signature } = origin;\n\n            return getChatTitle(chat_id, false, t) + (author_signature ? ` (${author_signature})` : '');\n        }\n    }\n\n    return '';\n}\n\nfunction getUnread(message) {\n    if (!message) return false;\n    if (!message.chat_id) return false;\n    if (!message.is_outgoing) return false;\n\n    let chat = ChatStore.get(message.chat_id);\n    if (!chat) return false;\n\n    return chat.last_read_outbox_message_id < message.id;\n}\n\nfunction getSenderUserId(message) {\n    if (!message) return null;\n\n    return message.sender_user_id;\n}\n\nfunction filterDuplicateMessages(result, history) {\n    if (result.messages.length === 0) return;\n    if (history.length === 0) return;\n\n    const map = history.reduce(function(accumulator, current) {\n        accumulator.set(current.id, current.id);\n        return accumulator;\n    }, new Map());\n\n    result.messages = result.messages.filter(x => !map.has(x.id));\n}\n\nfunction filterMessages(messages) {\n    return messages.filter(x => x.content['@type'] !== 'messageChatUpgradeTo');\n}\n\nfunction getContent(message, t = key => key) {\n    if (!message) return null;\n\n    const { content } = message;\n    if (!content) return null;\n\n    let caption = '';\n    if (content.caption && content.caption.text) {\n        caption = `, ${content.caption.text}`;\n    }\n\n    if (message.ttl > 0) {\n        return getServiceMessageContent(message);\n    }\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            return t('AttachGif') + caption;\n        }\n        case 'messageAudio': {\n            return t('AttachMusic') + caption;\n        }\n        case 'messageBasicGroupChatCreate': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageCall': {\n            return t('Call') + caption;\n        }\n        case 'messageChatAddMembers': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatChangePhoto': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatChangeTitle': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatDeleteMember': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatDeletePhoto': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatJoinByLink': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatSetTtl': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatUpgradeFrom': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageChatUpgradeTo': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageContact': {\n            return t('AttachContact') + caption;\n        }\n        case 'messageContactRegistered': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageCustomServiceAction': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageDocument': {\n            const { document } = content;\n            if (document && document.file_name) {\n                return document.file_name + caption;\n            }\n\n            return t('AttachDocument') + caption;\n        }\n        case 'messageExpiredPhoto': {\n            return t('AttachPhoto') + caption;\n        }\n        case 'messageExpiredVideo': {\n            return t('AttachVideo') + caption;\n        }\n        case 'messageGame': {\n            return t('AttachGame') + caption;\n        }\n        case 'messageGameScore': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageInvoice': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageLocation': {\n            return t('AttachLocation') + caption;\n        }\n        case 'messagePassportDataReceived': {\n            return getServiceMessageContent(message);\n        }\n        case 'messagePassportDataSent': {\n            return getServiceMessageContent(message);\n        }\n        case 'messagePaymentSuccessful': {\n            return getServiceMessageContent(message);\n        }\n        case 'messagePaymentSuccessfulBot': {\n            return getServiceMessageContent(message);\n        }\n        case 'messagePhoto': {\n            return t('AttachPhoto') + caption;\n        }\n        case 'messagePoll': {\n            const { poll } = content;\n\n            return '📊 ' + (poll.question || t('Poll')) + caption;\n        }\n        case 'messagePinMessage': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageScreenshotTaken': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageSticker': {\n            const { sticker } = content;\n            let emoji = '';\n            if (sticker && sticker.emoji) {\n                emoji = sticker.emoji;\n            }\n\n            return t('AttachSticker') + (emoji ? ` ${emoji}` : '') + caption;\n        }\n        case 'messageSupergroupChatCreate': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageText': {\n            return content.text.text + caption;\n        }\n        case 'messageUnsupported': {\n            return getServiceMessageContent(message);\n        }\n        case 'messageVenue': {\n            return t('AttachLocation') + caption;\n        }\n        case 'messageVideo': {\n            return t('AttachVideo') + caption;\n        }\n        case 'messageVideoNote': {\n            return t('AttachRound') + caption;\n        }\n        case 'messageVoiceNote': {\n            return t('AttachAudio') + caption;\n        }\n        case 'messageWebsiteConnected': {\n            return getServiceMessageContent(message);\n        }\n        default: {\n            return t('UnsupportedAttachment');\n        }\n    }\n}\n\nfunction isMediaContent(content) {\n    if (!content) return false;\n\n    return content['@type'] === 'messagePhoto';\n}\n\nfunction getLocationId(\n    location,\n    width = LOCATION_WIDTH,\n    height = LOCATION_HEIGHT,\n    zoom = LOCATION_ZOOM,\n    scale = LOCATION_SCALE\n) {\n    if (!location) return null;\n\n    const { longitude, latitude } = location;\n    return `loc=${latitude},${longitude}&size=${width},${height}&scale=${scale}&zoom=${zoom}`;\n}\n\nfunction isVideoMessage(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content } = message;\n    if (!content) return false;\n\n    switch (content['@type']) {\n        case 'messageVideo': {\n            return true;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            return Boolean(web_page.video);\n        }\n        default: {\n            return false;\n        }\n    }\n}\n\nfunction isLottieMessage(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content } = message;\n    if (!content) return false;\n\n    switch (content['@type']) {\n        case 'messageDocument': {\n            const { document } = content;\n            if (!document) return false;\n\n            const { file_name } = document;\n\n            return file_name && file_name.toLowerCase().endsWith('.json');\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (!web_page) return false;\n\n            const { document } = web_page;\n            if (!document) return false;\n\n            const { file_name } = document;\n\n            return file_name && file_name.toLowerCase().endsWith('.json');\n        }\n        default: {\n            return false;\n        }\n    }\n}\n\nfunction isAnimationMessage(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content } = message;\n    if (!content) return false;\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            return true;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            return Boolean(web_page.animation);\n        }\n        default: {\n            return false;\n        }\n    }\n}\n\nfunction isContentOpened(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return true;\n\n    const { content } = message;\n    if (!content) return true;\n\n    switch (content['@type']) {\n        case 'messageVoiceNote': {\n            return content.is_listened;\n        }\n        case 'messageVideoNote': {\n            return content.is_viewed;\n        }\n        default: {\n            return true;\n        }\n    }\n}\n\nexport function hasVoice(source) {\n    if (!source) return false;\n\n    switch (source['@type']) {\n        case 'message': {\n            const message = MessageStore.get(source.chat_id, source.id);\n            if (!message) return false;\n\n            const { content } = message;\n            if (!content) return false;\n\n            switch (content['@type']) {\n                case 'messageVoiceNote': {\n                    const { voice_note } = content;\n                    if (voice_note) {\n                        return true;\n                    }\n\n                    break;\n                }\n                case 'messageText': {\n                    const { web_page } = content;\n                    if (web_page) {\n                        const { voice_note } = web_page;\n                        if (voice_note) {\n                            return true;\n                        }\n                    }\n\n                    break;\n                }\n            }\n            break;\n        }\n        case 'pageBlockVoiceNote': {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nexport function useAudioPlaybackRate(source) {\n    if (!source) return false;\n\n    let audio = null;\n    switch (source['@type']) {\n        case 'message': {\n            audio = getMessageAudio(source.chat_id, source.id);\n            break;\n        }\n        case 'pageBlockAudio': {\n            audio = getBlockAudio(source);\n            break;\n        }\n    }\n\n    return audio && audio.duration > PLAYER_AUDIO_2X_MIN_DURATION;\n}\n\nexport function getMessageAudio(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return null;\n\n    const { content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAudio': {\n            const { audio } = content;\n\n            return audio;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { audio } = web_page;\n\n                return audio;\n            }\n\n            break;\n        }\n    }\n\n    return null;\n}\n\nfunction hasAudio(source) {\n    if (!source) return false;\n\n    switch (source['@type']) {\n        case 'message': {\n            return !!getMessageAudio(source.chat_id, source.id);\n        }\n        case 'pageBlockAudio': {\n            return !!getBlockAudio(source);\n        }\n    }\n\n    return false;\n}\n\nfunction hasVideoNote(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content } = message;\n    if (!content) return false;\n\n    switch (content['@type']) {\n        case 'messageVideoNote': {\n            const { video_note } = content;\n            if (video_note) {\n                return true;\n            }\n\n            break;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { video_note } = web_page;\n                if (video_note) {\n                    return true;\n                }\n            }\n\n            break;\n        }\n    }\n\n    return false;\n}\n\nfunction getSearchMessagesFilter(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return null;\n\n    const { content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAudio': {\n            const { audio } = content;\n            if (audio) {\n                return {\n                    '@type': 'searchMessagesFilterAudio'\n                };\n            }\n            break;\n        }\n        case 'messageVoiceNote': {\n            const { voice_note } = content;\n            if (voice_note) {\n                return {\n                    '@type': 'searchMessagesFilterVoiceNote'\n                };\n            }\n            break;\n        }\n        case 'messageVideoNote': {\n            const { video_note } = content;\n            if (video_note) {\n                return null;\n\n                return {\n                    '@type': 'searchMessagesFilterVideoNote'\n                };\n            }\n            break;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { audio, voice_note, video_note } = web_page;\n                if (audio) {\n                    return null;\n\n                    return {\n                        '@type': 'searchMessagesFilterAudio'\n                    };\n                }\n\n                if (voice_note) {\n                    return null;\n\n                    return {\n                        '@type': 'searchMessagesFilterVoiceNote'\n                    };\n                }\n\n                if (video_note) {\n                    return null;\n\n                    return {\n                        '@type': 'searchMessagesFilterVideoNote'\n                    };\n                }\n                break;\n            }\n        }\n    }\n\n    return null;\n}\n\nfunction openAnimation(animation, message, fileCancel) {\n    if (!animation) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    let { animation: file } = animation;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    } else {\n        // download file at loadMediaViewerContent instead\n        // download(file, message, FileStore.updateAnimationBlob(chat_id, id, file.id));\n    }\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateActiveAnimation',\n        chatId: chat_id,\n        messageId: id\n    });\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    setMediaViewerContent({\n        chatId: chat_id,\n        messageId: id\n    });\n}\n\nfunction openAudio(audio, message, fileCancel) {\n    if (!audio) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    let { audio: file } = audio;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active && !supportsStreaming()) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    } else {\n        if (!supportsStreaming()) {\n            download(file, message, () => FileStore.updateAudioBlob(chat_id, id, file.id));\n        }\n    }\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    const { remote } = file;\n    const { unique_id } = remote;\n    const { currentTime, duration } = PlayerStore.getCurrentTime(unique_id);\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateMediaActive',\n        source: MessageStore.get(chat_id, id),\n        currentTime,\n        duration\n    });\n}\n\nfunction openChatPhoto(photo, message, fileCancel) {\n    if (!photo) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    const photoSize = getPhotoSize(photo.sizes);\n    if (!photoSize) return;\n\n    let { photo: file } = photoSize;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    }\n\n    download(file, message, () => FileStore.updatePhotoBlob(chat_id, id, file.id));\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    setMediaViewerContent({\n        chatId: chat_id,\n        messageId: id\n    });\n}\n\nfunction openContact(contact, message, fileCancel) {\n    if (!contact) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    openUser(contact.user_id, true);\n}\n\nfunction openDocument(document, message, fileCancel) {\n    if (!document) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    let { document: file } = document;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    }\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    if (isLottieMessage(chat_id, id)) {\n        TdLibController.send({\n            '@type': 'openMessageContent',\n            chat_id: chat_id,\n            message_id: id\n        });\n\n        setMediaViewerContent({\n            chatId: chat_id,\n            messageId: id\n        });\n    } else {\n        saveOrDownload(file, document.file_name, message);\n    }\n}\n\nfunction openGame(game, message, fileCancel) {\n    if (!game) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    const { animation } = game;\n    if (animation) {\n        let { animation: file } = animation;\n        if (!file) return;\n\n        file = FileStore.get(file.id) || file;\n        if (fileCancel && file.local.is_downloading_active) {\n            FileStore.cancelGetRemoteFile(file.id, message);\n            return;\n        } else if (fileCancel && file.remote.is_uploading_active) {\n            FileStore.cancelUploadFile(file.id, message);\n            return;\n        }\n\n        download(file, message, () => FileStore.updateAnimationBlob(chat_id, id, file.id));\n    }\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateActiveAnimation',\n        chatId: chat_id,\n        messageId: id\n    });\n}\n\nfunction openPhoto(photo, message, fileCancel) {\n    if (!photo) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    const photoSize = getPhotoSize(photo.sizes);\n    if (!photoSize) return;\n\n    let { photo: file } = photoSize;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    }\n\n    download(file, message, () => FileStore.updatePhotoBlob(chat_id, id, file.id));\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    setMediaViewerContent({\n        chatId: chat_id,\n        messageId: id\n    });\n}\n\nasync function openSticker(sticker, message, fileCancel) {\n    if (!sticker) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    const { set_id } = sticker;\n    if (!set_id) return;\n\n    const stickerSet = await TdLibController.send({\n        '@type': 'getStickerSet',\n        set_id\n    });\n\n    if (!stickerSet) return;\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateStickerSet',\n        stickerSet\n    });\n}\n\nfunction openVideo(video, message, fileCancel) {\n    if (!video) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    let { video: file } = video;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active && !supportsStreaming()) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    }\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    setMediaViewerContent({\n        chatId: chat_id,\n        messageId: id\n    });\n}\n\nfunction openVideoNote(videoNote, message, fileCancel) {\n    if (!videoNote) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    let { video: file } = videoNote;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    }\n\n    download(file, message, () => FileStore.updateVideoNoteBlob(chat_id, id, file.id));\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    const { remote } = file;\n    const { unique_id } = remote;\n    const { currentTime, duration } = PlayerStore.getCurrentTime(unique_id);\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateMediaActive',\n        source: MessageStore.get(chat_id, id),\n        currentTime,\n        duration\n    });\n}\n\nfunction openVoiceNote(voiceNote, message, fileCancel) {\n    if (!voiceNote) return;\n    if (!message) return;\n\n    const { chat_id, id } = message;\n\n    let { voice: file } = voiceNote;\n    if (!file) return;\n\n    file = FileStore.get(file.id) || file;\n    if (fileCancel && file.local.is_downloading_active) {\n        FileStore.cancelGetRemoteFile(file.id, message);\n        return;\n    } else if (fileCancel && file.remote.is_uploading_active) {\n        FileStore.cancelUploadFile(file.id, message);\n        return;\n    } else {\n        download(file, message, () => FileStore.updateVoiceNoteBlob(chat_id, id, file.id));\n    }\n\n    TdLibController.send({\n        '@type': 'openMessageContent',\n        chat_id: chat_id,\n        message_id: id\n    });\n\n    const { remote } = file;\n    const { unique_id } = remote;\n    const { currentTime, duration } = PlayerStore.getCurrentTime(unique_id);\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateMediaActive',\n        source: MessageStore.get(chat_id, id),\n        currentTime,\n        duration\n    });\n}\n\nfunction openMedia(chatId, messageId, fileCancel = true) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return;\n\n    const { content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            const { animation } = content;\n            if (animation) {\n                openAnimation(animation, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageAudio': {\n            const { audio } = content;\n            if (audio) {\n                // openDocument(audio, message, fileCancel);\n                openAudio(audio, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageChatChangePhoto': {\n            const { photo } = content;\n            if (photo) {\n                openChatPhoto(photo, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageContact': {\n            const { contact } = content;\n            if (contact) {\n                openContact(contact, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageDocument': {\n            const { document } = content;\n            if (document) {\n                openDocument(document, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageGame': {\n            const { game } = content;\n            if (game) {\n                openGame(game, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messagePhoto': {\n            const { photo } = content;\n            if (photo) {\n                openPhoto(photo, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageSticker': {\n            const { sticker } = content;\n            if (sticker) {\n                openSticker(sticker, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { animation, audio, document, photo, sticker, video, video_note, voice_note } = web_page;\n\n                if (animation) {\n                    openAnimation(animation, message, fileCancel);\n                    break;\n                }\n\n                if (audio) {\n                    openAudio(audio, message, fileCancel);\n                    break;\n                }\n\n                if (document) {\n                    openDocument(document, message, fileCancel);\n                    break;\n                }\n\n                if (sticker) {\n                    openSticker(sticker, message, fileCancel);\n                    break;\n                }\n\n                if (video) {\n                    openVideo(video, message, fileCancel);\n                    break;\n                }\n\n                if (video_note) {\n                    openVideoNote(video_note, message, fileCancel);\n                    break;\n                }\n\n                if (voice_note) {\n                    openVoiceNote(voice_note, message, fileCancel);\n                    break;\n                }\n\n                if (photo) {\n                    openPhoto(photo, message, fileCancel);\n                    break;\n                }\n            }\n\n            break;\n        }\n        case 'messageVideo': {\n            const { video } = content;\n            if (video) {\n                openVideo(video, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageVideoNote': {\n            const { video_note } = content;\n            if (video_note) {\n                openVideoNote(video_note, message, fileCancel);\n            }\n\n            break;\n        }\n        case 'messageVoiceNote': {\n            const { voice_note } = content;\n            if (voice_note) {\n                openVoiceNote(voice_note, message, fileCancel);\n            }\n\n            break;\n        }\n    }\n}\n\nfunction isDeletedMessage(message) {\n    return message && message['@type'] === 'deletedMessage';\n}\n\nexport function getReplyMinithumbnail(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return;\n\n    const { content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            const { animation } = content;\n            if (!animation) return null;\n\n            const { minithumbnail } = animation;\n            return minithumbnail || null;\n        }\n        case 'messageAudio': {\n            return null;\n        }\n        case 'messageChatChangePhoto': {\n            const { photo } = content;\n            if (!photo) return null;\n\n            return photo.minithumbnail || null;\n        }\n        case 'messageDocument': {\n            const { document } = content;\n            if (!document) return null;\n\n            const { minithumbnail } = document;\n            return minithumbnail || null;\n        }\n        case 'messageGame': {\n            const { game } = content;\n            if (!game) return null;\n\n            const { animation, photo } = game;\n            if (animation) {\n                const { minithumbnail } = animation;\n                if (minithumbnail) {\n                    return minithumbnail;\n                }\n            }\n\n            if (photo) {\n                return photo.minithumbnail || null;\n            }\n\n            return null;\n        }\n        case 'messagePhoto': {\n            const { photo } = content;\n            if (!photo) return null;\n\n            return photo.minithumbnail || null;\n        }\n        case 'messageSticker': {\n            return null;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { animation, audio, document, photo, sticker, video, video_note } = web_page;\n                if (photo) {\n                    return photo.minithumbnail || null;\n                }\n                if (animation) {\n                    const { minithumbnail } = animation;\n                    return minithumbnail || null;\n                }\n                if (audio) {\n                    return null;\n                }\n                if (document) {\n                    const { minithumbnail } = document;\n                    return minithumbnail || null;\n                }\n                if (sticker) {\n                    return null;\n                }\n                if (video) {\n                    const { minithumbnail } = video;\n                    return minithumbnail || null;\n                }\n                if (video_note) {\n                    const { minithumbnail } = video_note;\n                    return minithumbnail || null;\n                }\n            }\n\n            break;\n        }\n        case 'messageVideo': {\n            const { video } = content;\n            if (!video) return null;\n\n            const { minithumbnail } = video;\n            return minithumbnail || null;\n        }\n        case 'messageVideoNote': {\n            const { video_note } = content;\n            if (!video_note) return null;\n\n            const { minithumbnail } = video_note;\n            return minithumbnail || null;\n        }\n    }\n\n    return null;\n}\n\nfunction getReplyPhotoSize(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return;\n\n    const { content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            const { animation } = content;\n            if (!animation) return null;\n\n            const { thumbnail } = animation;\n            return thumbnail || null;\n        }\n        case 'messageAudio': {\n            const { audio } = content;\n            if (!audio) return null;\n\n            const { album_cover_thumbnail } = audio;\n            return album_cover_thumbnail || null;\n        }\n        case 'messageChatChangePhoto': {\n            const { photo } = content;\n            if (!photo) return null;\n\n            return getPhotoSize(photo.sizes);\n        }\n        case 'messageDocument': {\n            const { document } = content;\n            if (!document) return null;\n\n            const { thumbnail } = document;\n            return thumbnail || null;\n        }\n        case 'messageGame': {\n            const { game } = content;\n            if (!game) return null;\n\n            const { animation, photo } = game;\n            if (animation) {\n                const { thumbnail } = animation;\n                if (thumbnail) {\n                    return thumbnail;\n                }\n            }\n\n            if (photo) {\n                return getPhotoSize(photo.sizes);\n            }\n\n            return null;\n        }\n        case 'messagePhoto': {\n            const { photo } = content;\n            if (!photo) return null;\n\n            return getPhotoSize(photo.sizes);\n        }\n        case 'messageSticker': {\n            const { sticker } = content;\n            if (!sticker) return null;\n\n            const { thumbnail } = sticker;\n            return thumbnail || null;\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (web_page) {\n                const { animation, audio, document, photo, sticker, video, video_note } = web_page;\n                if (photo) {\n                    return getPhotoSize(photo.sizes);\n                }\n                if (animation) {\n                    const { thumbnail } = animation;\n                    return thumbnail || null;\n                }\n                if (audio) {\n                    const { album_cover_thumbnail } = audio;\n                    return album_cover_thumbnail || null;\n                }\n                if (document) {\n                    const { thumbnail } = document;\n                    return thumbnail || null;\n                }\n                if (sticker) {\n                    const { thumbnail } = sticker;\n                    return thumbnail || null;\n                }\n                if (video) {\n                    const { thumbnail } = video;\n                    return thumbnail || null;\n                }\n                if (video_note) {\n                    const { thumbnail } = video_note;\n                    return thumbnail || null;\n                }\n            }\n\n            break;\n        }\n        case 'messageVideo': {\n            const { video } = content;\n            if (!video) return null;\n\n            const { thumbnail } = video;\n            return thumbnail || null;\n        }\n        case 'messageVideoNote': {\n            const { video_note } = content;\n            if (!video_note) return null;\n\n            const { thumbnail } = video_note;\n            return thumbnail || null;\n        }\n    }\n\n    return null;\n}\n\nfunction getEmojiMatches(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return 0;\n\n    const { content } = message;\n    if (!content) return 0;\n    if (content['@type'] !== 'messageText') return 0;\n\n    const { text: textContent } = content;\n    if (!textContent) return;\n    if (textContent['@type'] !== 'formattedText') return 0;\n\n    const { text, entities } = textContent;\n    if (!text) return 0;\n    if (entities && entities.length > 0) return 0;\n\n    let lastIndex = 0;\n    let emojiMatches = 0;\n    let m;\n    const re = emojiRegex();\n    do {\n        m = re.exec(text);\n\n        if (m) {\n            emojiMatches += 1;\n            // none-emoji symbol between prev and current emojis or before first\n            if (lastIndex !== m.index) {\n                emojiMatches = 0;\n                break;\n            }\n            // more than 3 emojis in a row\n            if (emojiMatches > 3) {\n                emojiMatches = 0;\n                break;\n            }\n            lastIndex = re.lastIndex;\n        }\n        // none-emoji symbol at the end\n        if (!m && lastIndex !== text.length) {\n            emojiMatches = 0;\n            break;\n        }\n    } while (m);\n\n    return emojiMatches;\n}\n\nfunction messageComparatorDesc(left, right) {\n    return left.id - right.id;\n}\n\nfunction checkInclusion(index, entities) {\n    if (!entities) return false;\n    if (!entities.length) return false;\n\n    for (let i = 0; i < entities.length; i++) {\n        if (index >= entities[i].offset && index < entities[i].offset + entities[i].length) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nfunction checkIntersection(startIndex, endIndex, entities) {\n    if (!entities) return false;\n    if (!entities.length) return false;\n\n    for (let i = 0; i < entities.length; i++) {\n        if (startIndex <= entities[i].offset && entities[i].offset + entities[i].length - 1 <= endIndex) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nfunction checkEntity(startIndex, endIndex, entities) {\n    return (\n        !checkInclusion(startIndex, entities) &&\n        !checkInclusion(endIndex, entities) &&\n        !checkIntersection(startIndex, endIndex, entities)\n    );\n}\n\nfunction removeOffsetAfter(start, countToRemove, entities) {\n    if (!entities) return;\n    if (!entities.length) return;\n\n    entities.forEach(e => {\n        if (e.offset > start) {\n            e.offset -= countToRemove;\n        }\n    });\n}\n\nfunction addOffsetAfter(start, countToAdd, entities) {\n    if (!entities) return;\n    if (!entities.length) return;\n\n    entities.forEach(e => {\n        if (e.offset > start) {\n            e.offset += countToAdd;\n        }\n    });\n}\n\nfunction removeEntities(startIndex, endIndex, entities) {\n    if (!entities) return;\n    if (!entities.length) return;\n\n    for (let i = 0; i < entities.length; i++) {\n        const entity = entities[i];\n        const entityStart = entity.offset;\n        const entityEnd = entity.offset + entity.length - 1;\n        if (\n            (startIndex <= entityStart && entityStart <= endIndex) ||\n            (startIndex <= entityEnd && entityEnd <= endIndex) ||\n            (entityStart < startIndex && endIndex > entityEnd)\n        ) {\n            entities.splice(i--, 1);\n        }\n    }\n}\n\nfunction addTextNode(offset, length, text, nodes) {\n    const node = document.createTextNode(text.substr(offset, length));\n    nodes.push(node);\n}\n\nexport function getNodes(text, entities, t = k => k) {\n    if (!text) return [];\n\n    entities = (entities || []).sort((a, b) => {\n        if (a.offset - b.offset !== 0) {\n            return a.offset - b.offset;\n        }\n\n        return b.length - a.length;\n    });\n\n    let nodes = [];\n    let offset = 0;\n    let prevEntity = null;\n    entities.forEach(x => {\n        if (x.offset - offset > 0) {\n            addTextNode(offset, x.offset - offset, text, nodes);\n            offset = x.offset;\n        }\n\n        if (!(prevEntity && checkInclusion(x.offset, [prevEntity]))) {\n            switch (x.type['@type']) {\n                case 'textEntityTypeBold': {\n                    const node = document.createElement('b');\n                    node.innerText = text.substr(x.offset, x.length);\n                    nodes.push(node);\n                    break;\n                }\n                case 'textEntityTypeBotCommand': {\n                    addTextNode(x.offset, x.length, text, nodes);\n                    break;\n                }\n                case 'textEntityTypeCashtag': {\n                    addTextNode(x.offset, x.length, text, nodes);\n                    break;\n                }\n                case 'textEntityTypeCode': {\n                    const node = document.createTextNode('`' + text.substr(x.offset, x.length) + '`');\n                    nodes.push(node);\n                    break;\n                }\n                case 'textEntityTypeEmailAddress': {\n                    addTextNode(x.offset, x.length, text, nodes);\n                    break;\n                }\n                case 'textEntityTypeHashtag': {\n                    addTextNode(x.offset, x.length, text, nodes);\n                    break;\n                }\n                case 'textEntityTypeItalic': {\n                    const node = document.createElement('i');\n                    node.innerText = text.substr(x.offset, x.length);\n                    nodes.push(node);\n                    break;\n                }\n                case 'textEntityTypeMention': {\n                    addTextNode(x.offset, x.length, text, nodes);\n                    break;\n                }\n                case 'textEntityTypeMentionName': {\n                    try {\n                        const { user_id } = x.type;\n                        const user = UserStore.get(user_id);\n                        if (user) {\n                            const node = document.createElement('a');\n                            // node.href = getDecodedUrl(url, false);\n                            node.title = getUserFullName(user_id, null, t);\n                            // node.target = '_blank';\n                            // node.rel = 'noopener noreferrer';\n                            node.dataset.userId = user_id;\n                            node.innerText = text.substr(x.offset, x.length);\n                            nodes.push(node);\n                        } else {\n                            addTextNode(x.offset, x.length, text, nodes);\n                        }\n                    } catch {\n                        addTextNode(x.offset, x.length, text, nodes);\n                    }\n                    break;\n                }\n                case 'textEntityTypePhoneNumber': {\n                    addTextNode(x.offset, x.length, text, nodes);\n                    break;\n                }\n                case 'textEntityTypePre': {\n                    const node = document.createTextNode('```' + text.substr(x.offset, x.length) + '```');\n                    nodes.push(node);\n                    break;\n                }\n                case 'textEntityTypePreCode': {\n                    const node = document.createTextNode('```' + text.substr(x.offset, x.length) + '```');\n                    nodes.push(node);\n                    break;\n                }\n                case 'textEntityTypeTextUrl': {\n                    try {\n                        const { url } = x.type;\n\n                        const node = document.createElement('a');\n                        node.href = getDecodedUrl(url, false);\n                        node.title = getDecodedUrl(url, false);\n                        node.target = '_blank';\n                        node.rel = 'noopener noreferrer';\n                        node.innerText = text.substr(x.offset, x.length);\n                        nodes.push(node);\n                    } catch {\n                        addTextNode(x.offset, x.length, text, nodes);\n                    }\n                    break;\n                }\n                case 'textEntityTypeUrl': {\n                    addTextNode(x.offset, x.length, text, nodes);\n                    break;\n                }\n                default: {\n                    addTextNode(x.offset, x.length, text, nodes);\n                    break;\n                }\n            }\n\n            prevEntity = x;\n            offset += x.length;\n        }\n    });\n\n    if (offset < text.length) {\n        addTextNode(offset, text.length - offset, text, nodes);\n    }\n\n    return nodes;\n}\n\n// based on code from official Android Telegram client\n// https://github.com/DrKLO/Telegram/blob/28eb8dfd0ef959fd5ad7d5d22f1d32879707c0a0/TMessagesProj/src/main/java/org/telegram/messenger/MediaDataController.java#L3782\nexport function getEntities(text) {\n    const entities = [];\n    if (!text) return { text, entities };\n\n    text = text.replace(/<div><br><\\/div>/gi, '<br>');\n    text = text.replace(/<div>/gi, '<br>');\n    text = text.replace(/<\\/div>/gi, '');\n    text = text.split('<br>').join('\\n');\n\n    // 0 looking for html entities\n    text = getHTMLEntities(text, entities);\n\n    // 1 looking for ``` and ` in order to find mono and pre entities\n    text = getMonoPreEntities(text, entities);\n\n    // 2 looking for bold, italic entities\n    text = getBoldItalicEntities(text, entities);\n\n    return { text, entities };\n}\n\nfunction compareEntities(a, b) {\n    const { offset: offsetA } = a;\n    const { offset: offsetB } = b;\n\n    if (offsetA < offsetB) {\n        return -1;\n    }\n\n    if (offsetA > offsetB) {\n        return 1;\n    }\n\n    return 0;\n}\n\nexport function getUrlMentionHashtagEntities(text, entities) {\n    const { text: t1, entities: e1 } = getUrlEntities(text, entities);\n\n    const { text: t2, entities: e2 } = getMentionHashtagEntities(t1, e1);\n\n    return { text: t2, entities: e2 };\n}\n\nconst urlRegExp = /((ftp|http|https):\\/\\/)?([\\w_-]+(?:(?:\\.[\\w_-]+)+))([\\w.,@?^=%&:/~+#-]*[\\w@?^=%&/~+#-])?/g;\n\nexport function getUrlEntities(text, entities) {\n    let e = [];\n    const regExp = urlRegExp;\n    let result = regExp.exec(text);\n    while (result) {\n        const { index: offset } = result;\n        const length = result[0].length;\n\n        e.push({\n            '@type': 'textEntity',\n            type: { '@type': 'textEntityTypeUrl' },\n            length,\n            offset\n        });\n\n        result = regExp.exec(text);\n    }\n\n    return { text, entities: [...entities, ...e].sort(compareEntities) };\n}\n\nexport function getMentionHashtagEntities(text, entities) {\n    let e = [];\n    const regExp = mentionHashtagRegExp;\n    let result = regExp.exec(text);\n    while (result) {\n        let { index: offset } = result;\n        let i = 1;\n\n        let ch = text[offset];\n        if (ch !== '#' && ch !== '@') {\n            offset++;\n            i++;\n            ch = text[offset];\n        }\n\n        const length = result[0].length - i + 1;\n\n        if (ch === '@') {\n            e.push({\n                '@type': 'textEntity',\n                type: { '@type': 'textEntityTypeMention' },\n                length,\n                offset\n            });\n        } else if (ch === '#') {\n            e.push({\n                '@type': 'textEntity',\n                type: { '@type': 'textEntityTypeHashtag' },\n                length,\n                offset\n            });\n        }\n\n        result = regExp.exec(text);\n    }\n\n    return { text, entities: [...entities, ...e].sort(compareEntities) };\n}\n\nconst twitterInstagramEntities = new Map();\nconst mentionHashtagRegExp = /(^|\\s|\\()@[a-zA-Z\\d_.]{1,32}|(^|\\s|\\()#[\\w]+/g;\n\n// based on https://github.com/DrKLO/Telegram/blob/5a2a813dc029ba1b9a31b514a78eb85fced0183f/TMessagesProj/src/main/java/org/telegram/messenger/MessageObject.java#L3191\nexport function getTwitterInstagramEntities(patternType, text, entities) {\n    const key = `${patternType}_${text}`;\n\n    let e = [];\n    if (!twitterInstagramEntities.has(key)) {\n        let result = mentionHashtagRegExp.exec(text);\n        while (result) {\n            let { index: offset } = result;\n            let i = 1;\n\n            let ch = text[offset];\n            if (ch !== '@' && ch !== '#') {\n                offset++;\n                i++;\n                ch = text[offset];\n            }\n\n            const length = result[0].length - i + 1;\n            const foundText = result[0].substr(i);\n            let url = null;\n\n            // instagram\n            if (patternType === 1) {\n                if (ch === '@') {\n                    url = 'https://instagram.com/' + foundText;\n                } else if (ch === '#') {\n                    url = 'https://instagram.com/explore/tags/' + foundText;\n                }\n                // twitter\n            } else if (patternType === 2) {\n                if (ch === '@') {\n                    url = 'https://twitter.com/' + foundText;\n                } else if (ch === '#') {\n                    url = 'https://twitter.com/hashtag/' + foundText;\n                }\n            }\n\n            if (url) {\n                e.push({\n                    '@type': 'textEntity',\n                    type: { '@type': 'textEntityTypeTextUrl', url },\n                    length,\n                    offset\n                });\n            }\n\n            result = mentionHashtagRegExp.exec(text);\n        }\n\n        twitterInstagramEntities.set(key, e);\n    } else {\n        e = twitterInstagramEntities.get(key);\n    }\n\n    return { text, entities: [...entities, ...e].sort(compareEntities) };\n}\n\nexport function getHTMLEntities(text, entities) {\n    const result = new DOMParser().parseFromString(text, 'text/html');\n\n    let offset = 0;\n    let length = 0;\n\n    let finalText = '';\n    result.body.childNodes.forEach(node => {\n        const { textContent, nodeName } = node;\n\n        length = textContent.length;\n        finalText += textContent;\n\n        if (!checkEntity(offset, offset + length - 1, entities)) {\n            return;\n        }\n\n        switch (nodeName) {\n            case '#text': {\n                offset += length;\n                break;\n            }\n            case 'A': {\n                if (node.dataset.userId) {\n                    entities.push({\n                        '@type': 'textEntity',\n                        offset,\n                        length,\n                        type: { '@type': 'textEntityTypeMentionName', user_id: node.dataset.userId },\n                        textContent: finalText.substring(offset, offset + length)\n                    });\n                } else if (node.href) {\n                    entities.push({\n                        '@type': 'textEntity',\n                        offset,\n                        length,\n                        type: { '@type': 'textEntityTypeTextUrl', url: node.href },\n                        textContent: finalText.substring(offset, offset + length)\n                    });\n                }\n                offset += length;\n                break;\n            }\n            case 'B':\n            case 'STRONG': {\n                entities.push({\n                    '@type': 'textEntity',\n                    offset,\n                    length,\n                    type: { '@type': 'textEntityTypeBold' },\n                    textContent: finalText.substring(offset, offset + length)\n                });\n                offset += length;\n                break;\n            }\n            case 'BR': {\n                break;\n            }\n            case 'CODE': {\n                entities.push({\n                    '@type': 'textEntity',\n                    offset,\n                    length,\n                    type: { '@type': 'textEntityTypeCode' },\n                    textContent: finalText.substring(offset, offset + length)\n                });\n                offset += length;\n                break;\n            }\n            case 'I':\n            case 'EM': {\n                entities.push({\n                    '@type': 'textEntity',\n                    offset,\n                    length,\n                    type: { '@type': 'textEntityTypeItalic' },\n                    textContent: finalText.substring(offset, offset + length)\n                });\n                offset += length;\n                break;\n            }\n            case 'PRE': {\n                entities.push({\n                    '@type': 'textEntity',\n                    offset,\n                    length,\n                    type: { '@type': 'textEntityTypePre' },\n                    textContent: finalText.substring(offset, offset + length)\n                });\n                offset += length;\n                break;\n            }\n            default: {\n                offset += length;\n                break;\n            }\n        }\n    });\n    text = finalText;\n\n    return text;\n}\n\nexport function getMonoPreEntities(text, entities) {\n    const mono = '`';\n    const pre = '```';\n    let isPre = false;\n\n    let index = -1;     // first index of end tag\n    let lastIndex = 0;  // first index after end tag\n    let start = -1;     // first index of start tag\n\n    let offset = 0, length = 0;\n\n    while ((index = text.indexOf(isPre ? pre : mono, lastIndex)) !== -1) {\n        if (start === -1) {\n            // find start tag\n            isPre = text.length - index > 2 && text[index + 1] === mono && text[index + 2] === mono;\n            start = index;\n            lastIndex = index + (isPre ? 3 : 1);\n        } else {\n            // find end tag\n            for (let i = index + (isPre ? 3 : 1); i < text.length; i++) {\n                if (text[i] === mono) {\n                    index++;\n                } else {\n                    break;\n                }\n            }\n\n            lastIndex = index + (isPre ? 3 : 1);\n            if (isPre) {\n                // add pre tag\n\n                let textBefore = text.substring(0, start);\n                let textContent = text.substring(start + 3, index);\n                let textAfter = text.substring(index + 3, text.length);\n\n                if (textContent.length > 0) {\n                    offset = start;\n                    length = index - start - 3;\n\n                    text = textBefore + textContent + textAfter;\n\n                    const entity = {\n                        '@type': 'textEntity',\n                        offset,\n                        length,\n                        language: '',\n                        type: { '@type': 'textEntityTypePre' },\n                        textContent: text.substring(offset, offset + length)\n                    };\n                    removeEntities(offset, offset + length - 1 + 6);\n                    removeOffsetAfter(offset + length, 6, entities);\n                    entities.push(entity);\n                    lastIndex -= 6;\n\n                    // clean text before\n                    if (textBefore.length > 0) {\n                        const lastChar = textBefore[textBefore.length - 1];\n                        if (lastChar !== '\\n') {\n                            if (lastChar === ' ' || lastChar === '\\xA0') {\n                                textBefore = textBefore.substr(0, textBefore.length - 1) + '\\n';\n                                text = textBefore + textContent + textAfter;\n                            } else {\n                                textBefore += '\\n';\n                                text = textBefore + textContent + textAfter;\n                                addOffsetAfter(offset - 1, 1, entities);\n                                lastIndex += 1;\n                            }\n                        }\n                    }\n\n                    // clean text after\n                    if (textAfter.length > 0) {\n                        const firstChar = textAfter[0];\n                        if (firstChar !== '\\n') {\n                            if (firstChar === ' ' || firstChar === '\\xA0') {\n                                textAfter = '\\n' + textAfter.substr(1);\n                                text = textBefore + textContent + textAfter;\n                            } else {\n                                textAfter = '\\n' + textAfter;\n                                text = textBefore + textContent + textAfter;\n                                addOffsetAfter(offset + length - 1, 1, entities);\n                                lastIndex += 1;\n                            }\n                        }\n                    }\n\n                    // clean text content\n                    if (textContent.length > 2) {\n                        if (textContent[0] === '\\n') {\n                            textContent = textContent.substring(1);\n                            text = textBefore + textContent + textAfter;\n                            entity.length -= 1;\n                            entity.textContent = textContent;\n                            removeOffsetAfter(entity.offset + entity.length - 1, 1, entities);\n                            lastIndex -= 1;\n                        }\n                    }\n\n                    if (textContent.length > 2) {\n                        if (textContent[textContent.length - 1] === '\\n') {\n                            textContent = textContent.substring(0, textContent.length - 1);\n                            text = textBefore + textContent + textAfter;\n                            entity.length -= 1;\n                            entity.textContent = textContent;\n                            removeOffsetAfter(entity.offset + entity.length - 1, 1, entities);\n                            lastIndex -= 1;\n                        }\n                    }\n                }\n            } else {\n                // add code tag\n                if (start + 1 !== index) {\n                    offset = start;\n                    length = index - start - 1;\n\n                    text =\n                        text.substring(0, start) +\n                        text.substring(start + 1, index) +\n                        text.substring(index + 1, text.length);\n\n                    const entity = {\n                        '@type': 'textEntity',\n                        offset,\n                        length,\n                        type: { '@type': 'textEntityTypeCode' },\n                        textContent: text.substring(offset, offset + length)\n                    };\n                    removeEntities(offset, offset + length - 1 + 2);\n                    removeOffsetAfter(offset + length, 2, entities);\n                    entities.push(entity);\n                    lastIndex -= 2;\n                }\n            }\n\n            start = -1;\n            isPre = false;\n        }\n    }\n\n    // 1.1 case when ``` is one ` mono symbol\n    if (start !== -1 && isPre) {\n        offset = start;\n        length = 1;\n\n        if (checkEntity(offset, offset + length + 2 - 1, entities)) {\n            text = text.substring(0, start) + text.substring(start + 2, text.length);\n\n            const entity = {\n                '@type': 'textEntity',\n                offset,\n                length,\n                type: { '@type': 'textEntityTypeCode' },\n                textContent: text.substring(offset, offset + length)\n            };\n            removeEntities(offset, offset + length - 1 + 2);\n            removeOffsetAfter(offset + length, 2, entities);\n            entities.push(entity);\n        }\n    }\n\n    return text;\n}\n\nexport function getBoldItalicEntities(text, entities) {\n    const bold = '**';\n    const italic = '__';\n\n\n    let index = -1;     // first index of end tag\n    let lastIndex = 0;  // first index after end tag\n    let start = -1;     // first index of start tag\n\n    let offset = 0, length = 0;\n\n    for (let c = 0; c < 2; c++) {\n        lastIndex = 0;\n        start = -1;\n        const checkString = c === 0 ? bold : italic;\n        const checkChar = c === 0 ? '*' : '_';\n        while ((index = text.indexOf(checkString, lastIndex)) !== -1) {\n            if (start === -1) {\n                const prevChar = index === 0 ? ' ' : text[index - 1];\n                if (\n                    !checkInclusion(index, entities) &&\n                    (prevChar === ' ' || prevChar === '\\xA0' || prevChar === '\\n')\n                ) {\n                    start = index;\n                }\n                lastIndex = index + 2;\n            } else {\n                for (let a = index + 2; a < text.length; a++) {\n                    if (text[a] === checkChar) {\n                        index++;\n                    } else {\n                        break;\n                    }\n                }\n                lastIndex = index + 2;\n                if (checkInclusion(index, entities) || checkIntersection(start, index, entities)) {\n                    start = -1;\n                    continue;\n                }\n                if (start + 2 !== index) {\n                    offset = start;\n                    length = index - start - 2;\n                    text =\n                        text.substring(0, start) +\n                        text.substring(start + 2, index) +\n                        text.substring(index + 2, text.length);\n\n                    const entity = {\n                        '@type': 'textEntity',\n                        offset,\n                        length,\n                        language: '',\n                        type: { '@type': c === 0 ? 'textEntityTypeBold' : 'textEntityTypeItalic' },\n                        textContent: text.substring(offset, offset + length)\n                    };\n                    removeOffsetAfter(offset + length, 4, entities);\n                    entities.push(entity);\n                    lastIndex -= 4;\n                }\n                start = -1;\n            }\n        }\n    }\n\n    return text;\n}\n\nexport function canMessageBeEdited(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { can_be_edited } = message;\n\n    return can_be_edited;\n}\n\nexport function showMessageForward(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { forward_info, content } = message;\n\n    return forward_info && content && content['@type'] !== 'messageSticker' && content['@type'] !== 'messageAudio';\n}\n\nexport function isTextMessage(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content } = message;\n\n    return content && content['@type'] === 'messageText';\n}\n\nexport function isMessagePinned(chatId, messageId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    return chat.pinned_message_id === messageId;\n}\n\nexport function canMessageBeUnvoted(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content } = message;\n    if (!content) return;\n    if (content['@type'] !== 'messagePoll') return;\n\n    const { poll } = content;\n    if (!poll) return false;\n\n    const { type, is_closed, options } = poll;\n    if (!type) return false;\n    if (type['@type'] !== 'pollTypeRegular') return false;\n    if (is_closed) return false;\n\n    return options.some(x => x.is_chosen || x.is_being_chosen);\n}\n\nexport function canMessageBeClosed(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return false;\n\n    const { content, can_be_edited } = message;\n    if (!content) return;\n    if (content['@type'] !== 'messagePoll') return;\n\n    return can_be_edited;\n}\n\nexport function canMessageBeForwarded(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n\n    return message && message.can_be_forwarded;\n}\n\nexport function canMessageBeDeleted(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n\n    return message && (message.can_be_deleted_only_for_self || message.can_be_deleted_for_all_users);\n}\n\nexport function getMessageStyle(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return null;\n\n    const { content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            const { animation, caption } = content;\n            if (caption && caption.text) {\n                return { maxWidth: PHOTO_DISPLAY_SIZE };\n            }\n            if (!animation) return null;\n\n            const { width, height, thumbnail } = animation;\n\n            const size = thumbnail || { width, height };\n            if (!size) return null;\n\n            const fitSize = getFitSize(size, PHOTO_DISPLAY_SIZE, true);\n            if (!fitSize) return null;\n\n            return { width: fitSize.width };\n        }\n        case 'messageGame': {\n            return { maxWidth : PHOTO_DISPLAY_SIZE + 10 + 9 * 2 };\n        }\n        case 'messagePhoto': {\n            const { photo, caption } = content;\n            if (caption && caption.text) {\n                return { maxWidth: PHOTO_DISPLAY_SIZE };\n            }\n            if (!photo) return null;\n\n            const size = getSize(photo.sizes, PHOTO_SIZE);\n            if (!size) return null;\n\n            const fitSize = getFitSize(size, PHOTO_DISPLAY_SIZE, true);\n            if (!fitSize) return null;\n\n            return { width: fitSize.width };\n        }\n        case 'messageText': {\n            const { web_page } = content;\n            if (!web_page) return null;\n\n            return { maxWidth : PHOTO_DISPLAY_SIZE + 10 + 9 * 2 };\n        }\n        case 'messageVideo': {\n            const { video, caption } = content;\n            if (caption && caption.text) {\n                return { maxWidth: PHOTO_DISPLAY_SIZE };\n            }\n\n            if (!video) return null;\n\n            const { thumbnail, width, height } = video;\n\n            const size = thumbnail || { width, height };\n            if (!size) return null;\n\n            const fitSize = getFitSize(size, PHOTO_DISPLAY_SIZE, true);\n            if (!fitSize) return null;\n\n            return { width: fitSize.width };\n        }\n    }\n\n    return null;\n}\n\nexport {\n    getAuthor,\n    getTitle,\n    getText,\n    getFormattedText,\n    getWebPage,\n    getContent,\n    getDate,\n    getDateHint,\n    isForwardOriginHidden,\n    getForwardTitle,\n    getUnread,\n    getSenderUserId,\n    filterDuplicateMessages,\n    filterMessages,\n    isMediaContent,\n    isDeletedMessage,\n    isVideoMessage,\n    isAnimationMessage,\n    isLottieMessage,\n    getLocationId,\n    isContentOpened,\n    hasAudio,\n    hasVideoNote,\n    getSearchMessagesFilter,\n    openMedia,\n    getReplyPhotoSize,\n    getEmojiMatches,\n    messageComparatorDesc,\n    substring,\n    stopPropagation\n};\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport dateFormat from '../Utils/Date';\nimport { getUserFullName, getUserShortName, getUserStatus, isUserOnline } from './User';\nimport { getSupergroupStatus } from './Supergroup';\nimport { getBasicGroupStatus } from './BasicGroup';\nimport { getLetters } from './Common';\nimport { getContent, isMessageUnread } from './Message';\nimport { isServiceMessage } from './ServiceMessage';\nimport { formatPhoneNumber } from './Phone';\nimport { getChannelStatus } from './Channel';\nimport { SERVICE_NOTIFICATIONS_USER_ID } from '../Constants';\nimport BasicGroupStore from '../Stores/BasicGroupStore';\nimport ChatStore from '../Stores/ChatStore';\nimport NotificationStore from '../Stores/NotificationStore';\nimport SupergroupStore from '../Stores/SupergroupStore';\nimport UserStore from '../Stores/UserStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nexport function getChatPosition(chatId, chatList = { '@type': 'chatListMain'}) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n\n    const { positions } = chat;\n    if (!positions) return null;\n    if (!positions.length) return null;\n\n    switch (chatList['@type']) {\n        case 'chatListMain': {\n            return positions.find(x => x.list['@type'] === 'chatListMain');\n        }\n        case 'chatListArchive': {\n            return positions.find(x => x.list['@type'] === 'chatListArchive');\n        }\n        case 'chatListFilter': {\n            return positions.find(x => x.list['@type'] === 'chatListFilter' && x.list.chat_filter_id === chatList.chat_filter_id);\n        }\n    }\n\n    return null;\n}\n\nexport function isChatPinned(chatId, chatList = { '@type': 'chatListMain'}) {\n    const position = getChatPosition(chatId, chatList);\n    if (!position) return false;\n\n    return position.is_pinned;\n}\n\nexport function hasChatList(chatId, chatList = { '@type': 'chatListMain'}) {\n    const position = getChatPosition(chatId, chatList);\n\n    return Boolean(position);\n}\n\nexport function getChatOrder(chatId, chatList = { '@type': 'chatListMain' }) {\n    const position = getChatPosition(chatId, chatList);\n    if (!position) return '0';\n\n    return position.order;\n}\n\nexport function chatListEquals(list1, list2) {\n    if (list1 && !list2) return false;\n    if (!list1 && list2) return false;\n    if (!list1 && !list2) return true;\n\n    if (list1['@type'] !== list2['@type']) return false;\n\n    switch (list1['@type']) {\n        case 'chatListMain': {\n            return true;\n        }\n        case 'chatListArchive': {\n            return true;\n        }\n        case 'chatListFilter': {\n            return list1.chat_filter_id === list2.chat_filter_id;\n        }\n    }\n\n    return false;\n}\n\nexport function positionListEquals(p1, p2) {\n    if (p1 && !p2) return false;\n    if (!p1 && p2) return false;\n    if (!p1 && !p2) return true;\n\n    const { list: list1 } = p1;\n    const { list: list2 } = p2;\n\n    return chatListEquals(list1, list2);\n}\n\nexport function canUnpinMessage(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { pinned_message_id } = chat;\n\n    return pinned_message_id > 0;\n}\n\nexport function isChatArchived(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { positions } = chat;\n    if (!positions) return false;\n\n    const archivePosition = positions.find(x => x.list['@type'] === 'chatListArchive');\n    if (!archivePosition) return false;\n    if (archivePosition.order === '0') return false;\n\n    return true;\n}\n\nexport function canAddChatToList(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { is_sponsored, positions } = chat;\n    if (is_sponsored) return false;\n    if (!positions) return false;\n\n    const mainPosition = positions.find(x => x.list['@type'] === 'chatListMain');\n    if (mainPosition && isMeChat(chatId) || chatId === SERVICE_NOTIFICATIONS_USER_ID) {\n        return false;\n    }\n\n    return true;\n}\n\nexport function draftEquals(draft1, draft2) {\n    if (!draft1 && !draft2) return true;\n    if (draft1 && !draft2) return false;\n    if (draft2 && !draft1) return false;\n\n    const { input_message_text: inputMessageText1, reply_to_message_id: replyToMessageId1 } = draft1;\n    const { input_message_text: inputMessageText2, reply_to_message_id: replyToMessageId2 } = draft2;\n\n    if (replyToMessageId1 !== replyToMessageId2) {\n        return false;\n    }\n\n    if (inputMessageText1['@type'] !== inputMessageText2['@type']) {\n        return false;\n    }\n\n    if (inputMessageText1['@type'] !== 'inputMessageText') {\n        return true;\n    }\n\n    const { text: formattedText1 } = inputMessageText1;\n    const { text: formattedText2 } = inputMessageText2;\n\n    if (!formattedText1 && !formattedText2) return true;\n    if (formattedText1 && !formattedText2) return false;\n    if (formattedText2 && !formattedText1) return false;\n\n    const { text: text1, entities: entities1 } = formattedText1;\n    const { text: text2, entities: entities2 } = formattedText2;\n\n    if (text1 !== text2) {\n        return false;\n    }\n\n    return entitiesEquals(entities1, entities2);\n}\n\nfunction entitiesEquals(entities1, entities2) {\n    if (!entities1 && !entities2) return true;\n    if (entities1 && !entities2) return false;\n    if (entities2 && !entities1) return false;\n\n    if (entities1.length !== entities2.length) {\n        return false;\n    }\n\n    const map = new Map();\n    entities1.forEach(x => {\n        map.set(`${x.type['@type']}_${x.offset}_${x.length}`, x);\n    });\n\n    return entities2.every(x => map.has(`${x.type['@type']}_${x.offset}_${x.length}`));\n}\n\nfunction getGroupChatTypingString(inputTypingManager) {\n    if (!inputTypingManager) return null;\n\n    let size = inputTypingManager.actions.size;\n    if (size > 2) {\n        return `${size} people are typing`;\n    } else if (size > 1) {\n        let firstUser;\n        let secondUser;\n        for (let userId of inputTypingManager.actions.keys()) {\n            if (!firstUser) {\n                firstUser = UserStore.get(userId);\n            } else if (!secondUser) {\n                secondUser = UserStore.get(userId);\n                break;\n            }\n        }\n\n        if (!firstUser || !secondUser) {\n            return `${size} people are typing`;\n        }\n\n        firstUser = firstUser.first_name ? firstUser.first_name : firstUser.second_name;\n        secondUser = secondUser.first_name ? secondUser.first_name : secondUser.second_name;\n\n        if (!firstUser || !secondUser) {\n            return `${size} people are typing`;\n        }\n\n        return `${firstUser} and ${secondUser} are typing`;\n    } else {\n        let firstUser;\n        if (inputTypingManager.actions.size >= 1) {\n            for (let userId of inputTypingManager.actions.keys()) {\n                if (!firstUser) {\n                    firstUser = UserStore.get(userId);\n                    break;\n                }\n            }\n\n            if (!firstUser) {\n                return `1 person is typing`;\n            }\n\n            firstUser = firstUser.first_name ? firstUser.first_name : firstUser.second_name;\n\n            if (!firstUser) {\n                return `1 person is typing`;\n            }\n\n            let action = inputTypingManager.actions.values().next().value.action;\n            switch (action['@type']) {\n                case 'chatActionRecordingVideo':\n                    return `${firstUser} is recording a video`;\n                case 'chatActionRecordingVideoNote':\n                    return `${firstUser} is recording a video message`;\n                case 'chatActionRecordingVoiceNote':\n                    return `${firstUser} is recording a voice message`;\n                case 'chatActionStartPlayingGame':\n                    return `${firstUser} is playing a game`;\n                case 'chatActionUploadingDocument':\n                    return `${firstUser} is sending a file`;\n                case 'chatActionUploadingPhoto':\n                    return `${firstUser} is sending a photo`;\n                case 'chatActionUploadingVideo':\n                    return `${firstUser} is sending a video`;\n                case 'chatActionUploadingVideoNote':\n                    return `${firstUser} is sending a video message`;\n                case 'chatActionUploadingVoiceNote':\n                    return `${firstUser} is sending a voice message`;\n                case 'chatActionChoosingContact':\n                case 'chatActionChoosingLocation':\n                case 'chatActionTyping':\n                default:\n                    return `${firstUser} is typing`;\n            }\n        }\n    }\n\n    return null;\n}\n\nfunction getPrivateChatTypingString(inputTypingManager) {\n    if (!inputTypingManager) return null;\n\n    if (inputTypingManager.actions.size >= 1) {\n        let action = inputTypingManager.actions.values().next().value.action;\n        switch (action['@type']) {\n            case 'chatActionRecordingVideo':\n                return 'recording a video';\n            case 'chatActionRecordingVideoNote':\n                return 'recording a video message';\n            case 'chatActionRecordingVoiceNote':\n                return 'recording a voice message';\n            case 'chatActionStartPlayingGame':\n                return 'playing a game';\n            case 'chatActionUploadingDocument':\n                return 'sending a file';\n            case 'chatActionUploadingPhoto':\n                return 'sending a photo';\n            case 'chatActionUploadingVideo':\n                return 'sending a video';\n            case 'chatActionUploadingVideoNote':\n                return 'sending a video message';\n            case 'chatActionUploadingVoiceNote':\n                return 'sending a voice message';\n            case 'chatActionChoosingContact':\n            case 'chatActionChoosingLocation':\n            case 'chatActionTyping':\n            default:\n                return 'typing';\n        }\n    }\n\n    return null;\n}\n\nfunction getChatTypingString(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n    if (!chat.type) return null;\n\n    let typingManager = ChatStore.getTypingManager(chat.id);\n    if (!typingManager) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const typingString = getPrivateChatTypingString(typingManager);\n            return typingString ? typingString + '...' : null;\n        }\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            const typingString = getGroupChatTypingString(typingManager);\n            return typingString ? typingString + '...' : null;\n        }\n    }\n\n    return null;\n}\n\nfunction getMessageSenderFullName(message, t = k => k) {\n    if (!message) return null;\n    if (isServiceMessage(message)) return null;\n    if (!message.sender_user_id) return null;\n\n    return getUserFullName(message.sender_user_id, null, t);\n}\n\nfunction getMessageSenderName(message, t = k => k) {\n    if (!message) return null;\n    if (isServiceMessage(message)) return null;\n\n    const chat = ChatStore.get(message.chat_id);\n    if (chat && chat.type['@type'] !== 'chatTypeBasicGroup' && chat.type['@type'] !== 'chatTypeSupergroup') {\n        return null;\n    }\n\n    return getUserShortName(message.sender_user_id, t);\n}\n\nfunction getLastMessageSenderName(chat, t = k => k) {\n    if (!chat) return null;\n\n    return getMessageSenderName(chat.last_message, t);\n}\n\nfunction getLastMessageContent(chat, t = key => key) {\n    if (!chat) return null;\n\n    const { last_message } = chat;\n    if (!last_message) return null;\n\n    return getContent(last_message, t);\n}\n\nfunction showChatUnreadMessageIcon(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { is_marked_as_unread, last_message, last_read_outbox_message_id } = chat;\n    if (!last_message) return false;\n\n    const { is_outgoing } = last_message;\n\n    return (\n        is_outgoing && last_message.id > last_read_outbox_message_id && !is_marked_as_unread && !showChatDraft(chatId)\n    );\n}\n\nfunction showChatUnreadMentionCount(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { unread_mention_count } = chat;\n\n    return unread_mention_count > 0;\n}\n\nfunction showChatUnreadCount(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { is_marked_as_unread, unread_count, unread_mention_count } = chat;\n\n    return (\n        unread_count > 1 ||\n        (unread_count === 1 && unread_mention_count === 0) ||\n        (is_marked_as_unread && unread_count === 0 && unread_mention_count === 0)\n    );\n}\n\nfunction isChatUnread(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { is_marked_as_unread, unread_count, unread_mention_count } = chat;\n\n    return is_marked_as_unread || unread_count > 0;\n}\n\nfunction isChatMuted(chatId) {\n    return getChatMuteFor(chatId) > 0;\n}\n\nfunction getChatMuteFor(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return 0;\n\n    const { notification_settings } = chat;\n    if (!notification_settings) return 0;\n\n    const { use_default_mute_for, mute_for } = notification_settings;\n\n    if (use_default_mute_for) {\n        const settings = getScopeNotificationSettings(chatId);\n\n        return settings ? settings.mute_for : false;\n    }\n\n    return mute_for;\n}\n\nexport function getScopeNotificationSettings(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return NotificationStore.settings.get('notificationSettingsScopePrivateChats');\n        }\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            let settings = null;\n            if (isChannelChat(chatId)) {\n                settings = NotificationStore.settings.get('notificationSettingsScopeChannelChats');\n            } else {\n                settings = NotificationStore.settings.get('notificationSettingsScopeGroupChats');\n            }\n            return settings;\n        }\n    }\n\n    return null;\n}\n\nfunction getMessageDate(message) {\n    const date = new Date(message.date * 1000);\n\n    const dayStart = new Date();\n    dayStart.setHours(0, 0, 0, 0);\n    if (date > dayStart) {\n        return dateFormat(date, 'H:MM');\n    }\n\n    const now = new Date();\n    const day = now.getDay();\n    const weekStart = now.getDate() - day + (day === 0 ? -6 : 1);\n    const monday = new Date(now.setDate(weekStart));\n    if (date > monday) {\n        return dateFormat(date, 'ddd');\n    }\n\n    return dateFormat(date, 'd.mm.yyyy');\n}\n\nfunction getLastMessageDate(chat) {\n    if (!chat) return null;\n    if (!chat.last_message) return null;\n    if (!chat.last_message.date) return null;\n    if (showChatDraft(chat.id)) return null;\n\n    return getMessageDate(chat.last_message);\n}\n\nfunction getChatSubtitleWithoutTyping(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n\n    const { type } = chat;\n    if (!type) return null;\n\n    switch (type['@type']) {\n        case 'chatTypeBasicGroup': {\n            const basicGroup = BasicGroupStore.get(type.basic_group_id);\n            if (basicGroup) {\n                return getBasicGroupStatus(basicGroup, chatId);\n            }\n\n            break;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const user = UserStore.get(type.user_id);\n            if (user) {\n                return getUserStatus(user);\n            }\n\n            break;\n        }\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(type.supergroup_id);\n            if (supergroup) {\n                return supergroup.is_channel\n                    ? getChannelStatus(supergroup, chatId)\n                    : getSupergroupStatus(supergroup, chatId);\n            }\n\n            break;\n        }\n    }\n\n    return null;\n}\n\nfunction getChatSubtitle(chatId, showSavedMessages = false) {\n    if (isMeChat(chatId) && showSavedMessages) {\n        return null;\n    }\n\n    const chatTypingString = getChatTypingString(chatId);\n    if (chatTypingString) {\n        return chatTypingString;\n    }\n\n    return getChatSubtitleWithoutTyping(chatId);\n}\n\nfunction getChatLetters(chatId, t) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n\n    let title = chat.title || t('HiddenName');\n    if (title.length === 0) return null;\n\n    let letters = getLetters(title);\n    if (letters && letters.length > 0) {\n        return letters;\n    }\n\n    return chat.title.charAt(0);\n}\n\nfunction isAccentChatSubtitleWithoutTyping(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n    if (!chat.type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            return false;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const user = UserStore.get(chat.type.user_id);\n            if (user) {\n                return isUserOnline(user);\n            }\n\n            break;\n        }\n        case 'chatTypeSupergroup': {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nfunction isAccentChatSubtitle(chatId) {\n    const typingString = getChatTypingString(chatId);\n    if (typingString) return false;\n\n    return isAccentChatSubtitleWithoutTyping(chatId);\n}\n\nfunction getChatUsername(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n    if (!chat.type) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            return null;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const user = UserStore.get(chat.type.user_id);\n            if (user) {\n                return user.username;\n            }\n\n            break;\n        }\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(chat.type.supergroup_id);\n            if (supergroup) {\n                return supergroup.username;\n            }\n            break;\n        }\n    }\n\n    return null;\n}\n\nfunction getChatPhoneNumber(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n    if (!chat.type) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            return null;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const user = UserStore.get(chat.type.user_id);\n            if (user) {\n                return formatPhoneNumber(user.phone_number);\n            }\n\n            break;\n        }\n        case 'chatTypeSupergroup': {\n            return null;\n        }\n    }\n\n    return null;\n}\n\nfunction getChatBio(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n    if (!chat.type) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            const fullInfo = BasicGroupStore.getFullInfo(chat.type.basic_group_id);\n            if (fullInfo) {\n                return fullInfo.description;\n            }\n\n            break;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const fullInfo = UserStore.getFullInfo(chat.type.user_id);\n            if (fullInfo) {\n                return fullInfo.bio;\n            }\n\n            break;\n        }\n        case 'chatTypeSupergroup': {\n            const fullInfo = SupergroupStore.getFullInfo(chat.type.supergroup_id);\n            if (fullInfo) {\n                return fullInfo.description;\n            }\n\n            break;\n        }\n    }\n\n    return null;\n}\n\nfunction isPrivateChat(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n    if (!chat.type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            return false;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nfunction isGroupChat(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n    if (!chat.type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            return true;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nfunction isChannelChat(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n    if (!chat.type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(chat.type.supergroup_id);\n\n            return supergroup && supergroup.is_channel;\n        }\n        case 'chatTypeBasicGroup':\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nfunction isChatMember(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type } = chat;\n    if (!type) return false;\n\n    switch (type['@type']) {\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(type.supergroup_id);\n            if (supergroup && supergroup.status) {\n                switch (supergroup.status['@type']) {\n                    case 'chatMemberStatusAdministrator': {\n                        return true;\n                    }\n                    case 'chatMemberStatusBanned': {\n                        return false;\n                    }\n                    case 'chatMemberStatusCreator': {\n                        return supergroup.status.is_member;\n                    }\n                    case 'chatMemberStatusLeft': {\n                        return false;\n                    }\n                    case 'chatMemberStatusMember': {\n                        return true;\n                    }\n                    case 'chatMemberStatusRestricted': {\n                        return supergroup.status.is_member;\n                    }\n                }\n            }\n            break;\n        }\n        case 'chatTypeBasicGroup': {\n            const basicGroup = BasicGroupStore.get(type.basic_group_id);\n            if (basicGroup && basicGroup.status) {\n                switch (basicGroup.status['@type']) {\n                    case 'chatMemberStatusAdministrator': {\n                        return true;\n                    }\n                    case 'chatMemberStatusBanned': {\n                        return false;\n                    }\n                    case 'chatMemberStatusCreator': {\n                        return basicGroup.status.is_member;\n                    }\n                    case 'chatMemberStatusLeft': {\n                        return false;\n                    }\n                    case 'chatMemberStatusMember': {\n                        return true;\n                    }\n                    case 'chatMemberStatusRestricted': {\n                        return basicGroup.status.is_member;\n                    }\n                }\n            }\n            break;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return true;\n        }\n    }\n\n    return false;\n}\nexport function isContactChat(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n    if (!chat.type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            return false;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const user = UserStore.get(chat.type.user_id);\n            if (!user) return false;\n\n            return user.is_contact || user.is_mutual_contact;\n        }\n    }\n\n    return false;\n}\n\nexport function isNonContactChat(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n    if (!chat.type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            return false;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const user = UserStore.get(chat.type.user_id);\n            if (!user) return false;\n\n            return !user.is_contact;\n        }\n    }\n\n    return false;\n}\n\nexport function isBotChat(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n    if (!chat.type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            return false;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const user = UserStore.get(chat.type.user_id);\n            if (!user) return false;\n\n            return user.type['@type'] === 'userTypeBot';\n        }\n    }\n\n    return false;\n}\n\nexport function isChatRead(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return true;\n\n    const { last_message } = chat;\n    if (!last_message) return true;\n\n    const { id } = last_message;\n\n    return !isMessageUnread(chatId, id);\n}\n\nfunction getChatTitle(chatId, showSavedMessages = false, t = key => key) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n\n    if (isMeChat(chatId) && showSavedMessages) {\n        return t('SavedMessages');\n    }\n\n    return chat.title || t('HiddenName');\n}\n\nexport function getChatType(chatId, t = key => key) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return '';\n\n    switch (chat.type['@type']) {\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            if (isMeChat(chatId)) {\n                return '';\n            }\n\n            if (isBotChat(chatId)) {\n                return t('Bot');\n            }\n\n            if (isContactChat(chatId)) {\n                return t('FilterContact');\n            }\n\n            return t('FilterNonContact');\n        }\n        case 'chatTypeBasicGroup': {\n            return t('AccDescrGroup');\n        }\n        case 'chatTypeSupergroup': {\n            return isChannelChat(chatId) ? t('AccDescrGroup') : t('AccDescrChannel');\n        }\n    }\n\n    return '';\n}\n\nexport function isDeletedPrivateChat(chatId) {\n    const fallbackValue = false;\n\n    const chat = ChatStore.get(chatId);\n    if (!chat) return fallbackValue;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            return false;\n        }\n        case 'chatTypeSecret':\n        case 'chatTypePrivate': {\n            const user = UserStore.get(chat.type.user_id);\n\n            return user && user.type['@type'] === 'userTypeDeleted';\n        }\n    }\n\n    return fallbackValue;\n}\n\nfunction isMeChat(chatId) {\n    const fallbackValue = false;\n\n    const chat = ChatStore.get(chatId);\n    if (!chat) return fallbackValue;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            return false;\n        }\n        case 'chatTypeSecret':\n        case 'chatTypePrivate': {\n            return UserStore.getMyId() === chat.type.user_id;\n        }\n    }\n\n    return fallbackValue;\n}\n\nfunction getGroupChatMembers(chatId) {\n    const fallbackValue = [];\n\n    const chat = ChatStore.get(chatId);\n    if (!chat) return fallbackValue;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            const fullInfo = BasicGroupStore.getFullInfo(chat.type.basic_group_id);\n            if (fullInfo) {\n                return fullInfo.members || fallbackValue;\n            }\n\n            break;\n        }\n        case 'chatTypeSupergroup': {\n            break;\n        }\n        case 'chatTypeSecret':\n        case 'chatTypePrivate': {\n            break;\n        }\n    }\n\n    return fallbackValue;\n}\n\nasync function getChatFullInfo(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n\n    const { type } = chat;\n    if (!type) return null;\n\n    switch (type['@type']) {\n        case 'chatTypePrivate': {\n            return await TdLibController.send({\n                '@type': 'getUserFullInfo',\n                user_id: type.user_id\n            });\n        }\n        case 'chatTypeSecret': {\n            return await TdLibController.send({\n                '@type': 'getUserFullInfo',\n                user_id: type.user_id\n            });\n        }\n        case 'chatTypeBasicGroup': {\n            return await TdLibController.send({\n                '@type': 'getBasicGroupFullInfo',\n                basic_group_id: type.basic_group_id\n            });\n        }\n        case 'chatTypeSupergroup': {\n            return await TdLibController.send({\n                '@type': 'getSupergroupFullInfo',\n                supergroup_id: type.supergroup_id\n            });\n        }\n    }\n\n    return null;\n}\n\nfunction hasBasicGroupId(chatId, basicGroupId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type } = chat;\n\n    return type && type['@type'] === 'chatTypeBasicGroup' && type.basic_group_id === basicGroupId;\n}\n\n\nfunction isSupergroup(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type } = chat;\n\n    return type && type['@type'] === 'chatTypeSupergroup';\n}\n\nfunction getSupergroupId(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type } = chat;\n\n    if (type && type['@type'] === 'chatTypeSupergroup') {\n        return type.supergroup_id;\n    }\n\n    return 0;\n}\n\nfunction hasSupergroupId(chatId, supergroupId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type } = chat;\n\n    return isSupergroup(chatId) && type.supergroup_id === supergroupId;\n}\n\nfunction hasUserId(chatId, userId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type } = chat;\n\n    return (\n        type && (type['@type'] === 'chatTypePrivate' || type['@type'] === 'chatTypeSecret') && type.user_id === userId\n    );\n}\n\nfunction getChatUserId(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return 0;\n\n    const { type } = chat;\n\n    return type && (type['@type'] === 'chatTypePrivate' || type['@type'] === 'chatTypeSecret') ? type.user_id : 0;\n}\n\nfunction getPhotoFromChat(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n\n    if (isPrivateChat(chatId)) {\n        const user = UserStore.get(getChatUserId(chatId));\n        if (user) {\n            return user.profile_photo;\n        }\n    }\n\n    return chat.photo;\n}\n\nfunction canSendMediaMessages(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type, permissions: globalPermissions } = chat;\n    if (!type) return false;\n    if (!globalPermissions) return false;\n\n    const { can_send_media_messages } = globalPermissions;\n\n    switch (type['@type']) {\n        case 'chatTypeBasicGroup': {\n            const basicGroup = BasicGroupStore.get(type.basic_group_id);\n            if (!basicGroup) return false;\n\n            const { status } = basicGroup;\n            if (!status) return false;\n\n            const { is_member, permissions } = status;\n\n            switch (status['@type']) {\n                case 'chatMemberStatusAdministrator': {\n                    return true;\n                }\n                case 'chatMemberStatusBanned': {\n                    return false;\n                }\n                case 'chatMemberStatusCreator': {\n                    return is_member;\n                }\n                case 'chatMemberStatusLeft': {\n                    return false;\n                }\n                case 'chatMemberStatusMember': {\n                    return true;\n                }\n                case 'chatMemberStatusRestricted': {\n                    return is_member && permissions && permissions.can_send_media_messages;\n                }\n            }\n\n            break;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return can_send_media_messages;\n        }\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(chat.type.supergroup_id);\n            if (!supergroup) return false;\n\n            const { status } = supergroup;\n            if (!status) return false;\n\n            const { is_member, permissions } = status;\n\n            switch (status['@type']) {\n                case 'chatMemberStatusAdministrator': {\n                    return true;\n                }\n                case 'chatMemberStatusBanned': {\n                    return false;\n                }\n                case 'chatMemberStatusCreator': {\n                    return is_member; //can_send_media_messages && is_member;\n                }\n                case 'chatMemberStatusLeft': {\n                    return false;\n                }\n                case 'chatMemberStatusMember': {\n                    return can_send_media_messages && !supergroup.is_channel;\n                }\n                case 'chatMemberStatusRestricted': {\n                    return can_send_media_messages && is_member && permissions && permissions.can_send_media_messages;\n                }\n            }\n        }\n    }\n\n    return false;\n}\n\nfunction getChatShortTitle(chatId, showSavedMessages = false, t = k => k) {\n    if (isMeChat(chatId) && showSavedMessages) {\n        return t('SavedMessages');\n    }\n\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n    if (!chat.type) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            return chat.title;\n        }\n        case 'chatTypeSupergroup': {\n            return chat.title;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return getUserShortName(chat.type.user_id, t);\n        }\n    }\n\n    return null;\n}\n\nfunction getGroupChatMembersCount(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n    if (!chat.type) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            const basicGroup = BasicGroupStore.get(chat.type.basic_group_id);\n            if (basicGroup) {\n                return basicGroup.member_count;\n            }\n\n            return 0;\n        }\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(chat.type.supergroup_id);\n            if (supergroup) {\n                return supergroup.member_count;\n            }\n\n            return 0;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return 0;\n        }\n    }\n\n    return 0;\n}\n\nfunction canClearHistory(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n    if (!chat.type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            return true;\n        }\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(chat.type.supergroup_id);\n            if (supergroup) {\n                return !Boolean(supergroup.username);\n            }\n\n            return true;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nfunction canDeleteChat(chatId) {\n    return !isMeChat(chatId);\n}\n\nfunction canSendPolls(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type, permissions: globalPermissions } = chat;\n    if (!type) return false;\n    if (!globalPermissions) return false;\n\n    const { can_send_polls } = globalPermissions;\n\n    switch (type['@type']) {\n        case 'chatTypeBasicGroup': {\n            const basicGroup = BasicGroupStore.get(type.basic_group_id);\n            if (!basicGroup) return false;\n\n            const { status } = basicGroup;\n            if (!status) return false;\n\n            const { is_member, permissions } = status;\n\n            switch (status['@type']) {\n                case 'chatMemberStatusAdministrator': {\n                    return true;\n                }\n                case 'chatMemberStatusBanned': {\n                    return false;\n                }\n                case 'chatMemberStatusCreator': {\n                    return is_member;\n                }\n                case 'chatMemberStatusLeft': {\n                    return false;\n                }\n                case 'chatMemberStatusMember': {\n                    return true;\n                }\n                case 'chatMemberStatusRestricted': {\n                    return is_member && permissions && permissions.can_send_polls;\n                }\n            }\n\n            break;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return can_send_polls;\n        }\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(type.supergroup_id);\n            if (!supergroup) return false;\n\n            const { status } = supergroup;\n            if (!status) return false;\n\n            const { is_member, permissions } = status;\n\n            switch (status['@type']) {\n                case 'chatMemberStatusAdministrator': {\n                    return true;\n                }\n                case 'chatMemberStatusBanned': {\n                    return false;\n                }\n                case 'chatMemberStatusCreator': {\n                    return is_member; //can_send_polls && is_member;\n                }\n                case 'chatMemberStatusLeft': {\n                    return false;\n                }\n                case 'chatMemberStatusMember': {\n                    return can_send_polls && !supergroup.is_channel;\n                }\n                case 'chatMemberStatusRestricted': {\n                    return can_send_polls && is_member && permissions && permissions.can_send_polls;\n                }\n            }\n        }\n    }\n\n    return false;\n}\n\nfunction canSendMessages(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type, permissions: globalPermissions } = chat;\n    if (!type) return false;\n    if (!globalPermissions) return false;\n\n    const { can_send_messages } = globalPermissions;\n\n    switch (type['@type']) {\n        case 'chatTypeBasicGroup': {\n            const basicGroup = BasicGroupStore.get(type.basic_group_id);\n            if (!basicGroup) return false;\n\n            const { status } = basicGroup;\n            if (!status) return false;\n\n            const { is_member, permissions } = status;\n\n            switch (status['@type']) {\n                case 'chatMemberStatusAdministrator': {\n                    return true;\n                }\n                case 'chatMemberStatusBanned': {\n                    return false;\n                }\n                case 'chatMemberStatusCreator': {\n                    return is_member;\n                }\n                case 'chatMemberStatusLeft': {\n                    return false;\n                }\n                case 'chatMemberStatusMember': {\n                    return true;\n                }\n                case 'chatMemberStatusRestricted': {\n                    return is_member && permissions && permissions.can_send_messages;\n                }\n            }\n\n            break;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return can_send_messages;\n        }\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(type.supergroup_id);\n            if (!supergroup) return false;\n\n            const { status } = supergroup;\n            if (!status) return false;\n\n            const { is_member, permissions } = status;\n\n            switch (status['@type']) {\n                case 'chatMemberStatusAdministrator': {\n                    return true;\n                }\n                case 'chatMemberStatusBanned': {\n                    return false;\n                }\n                case 'chatMemberStatusCreator': {\n                    return is_member; //can_send_messages && is_member;\n                }\n                case 'chatMemberStatusLeft': {\n                    return false;\n                }\n                case 'chatMemberStatusMember': {\n                    return can_send_messages && !supergroup.is_channel;\n                }\n                case 'chatMemberStatusRestricted': {\n                    return can_send_messages && is_member && permissions && permissions.can_send_messages;\n                }\n            }\n        }\n    }\n\n    return false;\n}\n\nfunction showChatDraft(chatId) {\n    const chat = ChatStore.get(chatId);\n    const draft = getChatDraft(chatId);\n\n    return draft && chat.unread_count === 0 && chat.unread_mention_count === 0;\n}\n\nfunction getChatDraft(chatId) {\n    const chat = ChatStore.get(chatId);\n\n    if (chat) {\n        const { draft_message } = chat;\n        if (draft_message) {\n            const { input_message_text } = draft_message;\n            if (input_message_text) {\n                return input_message_text.text;\n            }\n        }\n    }\n\n    return null;\n}\n\nfunction getChatDraftReplyToMessageId(chatId) {\n    let replyToMessageId = 0;\n    const chat = ChatStore.get(chatId);\n    if (chat) {\n        const { draft_message } = chat;\n        if (draft_message) {\n            replyToMessageId = draft_message.reply_to_message_id;\n        }\n    }\n\n    return replyToMessageId;\n}\n\nfunction canPinMessages(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type, permissions: globalPermissions } = chat;\n    if (!type) return false;\n    if (!globalPermissions) return false;\n\n    const { can_pin_messages } = globalPermissions;\n\n    switch (type['@type']) {\n        case 'chatTypeBasicGroup': {\n            const basicGroup = BasicGroupStore.get(type.basic_group_id);\n            if (!basicGroup) return false;\n\n            const { status } = basicGroup;\n            if (!status) return false;\n\n            const { is_member, permissions } = status;\n\n            switch (status['@type']) {\n                case 'chatMemberStatusAdministrator': {\n                    return status.can_pin_messages;\n                }\n                case 'chatMemberStatusBanned': {\n                    return false;\n                }\n                case 'chatMemberStatusCreator': {\n                    return false;\n                }\n                case 'chatMemberStatusLeft': {\n                    return false;\n                }\n                case 'chatMemberStatusMember': {\n                    return false;\n                }\n                case 'chatMemberStatusRestricted': {\n                    return is_member && permissions && permissions.can_pin_messages;\n                }\n            }\n\n            break;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return can_pin_messages;\n        }\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(type.supergroup_id);\n            if (!supergroup) return false;\n\n            const { status } = supergroup;\n            if (!status) return false;\n\n            const { is_member, permissions } = status;\n\n            switch (status['@type']) {\n                case 'chatMemberStatusAdministrator': {\n                    return can_pin_messages || status.can_pin_messages;\n                }\n                case 'chatMemberStatusBanned': {\n                    return false;\n                }\n                case 'chatMemberStatusCreator': {\n                    return is_member; //can_pin_messages && is_member;\n                }\n                case 'chatMemberStatusLeft': {\n                    return false;\n                }\n                case 'chatMemberStatusMember': {\n                    return false;\n                }\n                case 'chatMemberStatusRestricted': {\n                    return can_pin_messages && is_member && permissions && permissions.can_pin_messages;\n                }\n            }\n        }\n    }\n\n    return false;\n}\n\nfunction isChatVerified(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type } = chat;\n    if (!type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            return false;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            const user = UserStore.get(type.user_id);\n\n            return user && user.is_verified;\n        }\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(type.supergroup_id);\n\n            return supergroup && supergroup.is_verified;\n        }\n    }\n\n    return false;\n}\n\nfunction isChatSecret(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type } = chat;\n    if (!type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeBasicGroup': {\n            return false;\n        }\n        case 'chatTypePrivate': {\n            return false;\n        }\n        case 'chatTypeSecret': {\n            return true;\n        }\n        case 'chatTypeSupergroup': {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nexport function isCreator(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { type } = chat;\n    if (!type) return false;\n\n    switch (type['@type']) {\n        case 'chatTypeBasicGroup': {\n            const { basic_group_id } = type;\n            const basicGroup = BasicGroupStore.get(basic_group_id);\n            if (!basicGroup) return false;\n\n            const { status } = basicGroup;\n            if (status) return false;\n\n            return status['@type'] === 'chatMemberStatusCreator';\n        }\n        case 'chatTypePrivate': {\n            return false;\n        }\n        case 'chatTypeSecret': {\n            return false;\n        }\n        case 'chatTypeSupergroup': {\n            const { supergroup_id } = type;\n            const supergroup = SupergroupStore.get(supergroup_id);\n            if (!supergroup) return false;\n\n            const { status } = supergroup;\n            if (!status) return false;\n\n            return status['@type'] === 'chatMemberStatusCreator';\n        }\n    }\n\n    return false;\n}\n\nexport function getChatTypeId(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return 0;\n\n    const { type } = chat;\n    if (!type) return 0;\n\n    switch (type['@type']) {\n        case 'chatTypeSupergroup': {\n            return type.supergroup_id;\n        }\n        case 'chatTypeBasicGroup': {\n            return type.basic_group_id;\n        }\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return type.user_id;\n        }\n    }\n}\n\nexport {\n    showChatDraft,\n    getChatDraft,\n    getChatDraftReplyToMessageId,\n    getChatTypingString,\n    showChatUnreadMessageIcon,\n    showChatUnreadMentionCount,\n    showChatUnreadCount,\n    getChatMuteFor,\n    getChatSubtitle,\n    getChatSubtitleWithoutTyping,\n    getLastMessageSenderName,\n    getMessageSenderName,\n    getMessageSenderFullName,\n    getLastMessageContent,\n    getLastMessageDate,\n    getMessageDate,\n    getChatLetters,\n    isAccentChatSubtitle,\n    isAccentChatSubtitleWithoutTyping,\n    isChatMuted,\n    getChatUsername,\n    getChatPhoneNumber,\n    getChatBio,\n    isPrivateChat,\n    isGroupChat,\n    isChannelChat,\n    isChatUnread,\n    isChatMember,\n    isChatVerified,\n    isChatSecret,\n    getChatTitle,\n    getGroupChatMembers,\n    getChatFullInfo,\n    hasBasicGroupId,\n    hasSupergroupId,\n    isSupergroup,\n    getSupergroupId,\n    hasUserId,\n    getChatUserId,\n    getPhotoFromChat,\n    getChatShortTitle,\n    getGroupChatMembersCount,\n    isMeChat,\n    canClearHistory,\n    canDeleteChat,\n    canPinMessages,\n    canSendMediaMessages,\n    canSendMessages,\n    canSendPolls\n};\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport ChatStore from '../Stores/ChatStore';\n\nfunction getBasicGroupStatus(basicGroup, chatId) {\n    if (!basicGroup) return null;\n\n    const { status, member_count: count } = basicGroup;\n\n    if (\n        status &&\n        (status['@type'] === 'chatMemberStatusBanned' ||\n            status['@type'] === 'chatMemberStatusLeft' ||\n            (status['@type'] === 'chatMemberStatusCreator' && !status.is_member))\n    ) {\n        return 'group is inaccessible';\n    }\n\n    if (!count) return '0 members';\n    if (count === 1) return '1 member';\n\n    const onlineCount = ChatStore.getOnlineMemberCount(chatId);\n    if (onlineCount > 1) {\n        return `${count} members, ${onlineCount} online`;\n    }\n\n    return `${count} members`;\n}\n\nexport { getBasicGroupStatus };\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport SupergroupStore from '../Stores/SupergroupStore';\nimport ChatStore from '../Stores/ChatStore';\n\nexport function getChannelStatus(supergroup, chatId) {\n    if (!supergroup) return '';\n\n    let { status, is_channel, member_count: count } = supergroup;\n    if (!is_channel) return '';\n\n    if (status && status['@type'] === 'chatMemberStatusBanned') {\n        return 'channel is inaccessible';\n    }\n\n    if (!count) {\n        const fullInfo = SupergroupStore.getFullInfo(supergroup.id);\n        if (fullInfo) {\n            count = fullInfo.member_count;\n        }\n    }\n\n    if (!count) return '0 subscribers';\n    if (count === 1) return '1 subscriber';\n\n    const onlineCount = ChatStore.getOnlineMemberCount(chatId);\n    if (onlineCount > 1) {\n        return `${count} subscribers, ${onlineCount} online`;\n    }\n\n    return `${count} subscribers`;\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport IconButton from '@material-ui/core/IconButton';\nimport CallIcon from '@material-ui/icons/Call';\nimport { getCallTitle } from '../../../Utils/Media';\nimport { getDurationString } from '../../../Utils/Common';\nimport './Call.css';\n\nclass Call extends React.Component {\n    render() {\n        const { chatId, messageId, duration, openMedia, title, meta } = this.props;\n\n        const callTitle = getCallTitle(chatId, messageId);\n        const durationString = getDurationString(Math.floor(duration || 0));\n\n        return (\n            <div className={classNames('document', { 'media-title': title })}>\n                <IconButton color='primary' aria-label='Call'>\n                    <CallIcon fontSize='large' />\n                </IconButton>\n                <div className='document-content'>\n                    <div className='document-title'>{callTitle}</div>\n                    <div className='document-action'>\n                        {durationString}\n                        {meta}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nCall.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    openMedia: PropTypes.func\n};\n\nexport default Call;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { withTranslation } from 'react-i18next';\nimport UserTile from '../../Tile/UserTile';\nimport { formatPhoneNumber } from '../../../Utils/Phone';\nimport { getUserFullName } from '../../../Utils/User';\nimport UserStore from '../../../Stores/UserStore';\nimport './Contact.css';\n\nclass Contact extends React.Component {\n    render() {\n        const { contact, title, openMedia, meta, caption, t } = this.props;\n        if (!contact) return null;\n\n        const { user_id: id, first_name, last_name, phone_number } = contact;\n\n        const user = UserStore.get(id) || {\n            '@type': 'user',\n            type: { '@type': 'userTypeRegular' },\n            id,\n            first_name,\n            last_name\n        };\n\n        const fullName = getUserFullName(id, user, t);\n        const number = formatPhoneNumber(phone_number);\n\n        return (\n            <div className={classNames('contact', { 'media-title': title })}>\n                <div className='contact-tile'>\n                    <UserTile userId={id} firstName={first_name} lastName={last_name} />\n                </div>\n                <div className='contact-content'>\n                    <div className='contact-name'>\n                        {id > 0 ? <a onClick={openMedia}>{fullName}</a> : <span>{fullName}</span>}\n                    </div>\n                    <div className='contact-phone'>\n                        {number}\n                        {!caption && meta}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nContact.propTypes = {\n    chatId: PropTypes.number.isRequired,\n    messageId: PropTypes.number.isRequired,\n    contact: PropTypes.object.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default withTranslation()(Contact);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport Animation from './Animation';\nimport Photo from './Photo';\nimport { getFormattedText } from '../../../Utils/Message';\nimport { getFitSize, getSize } from '../../../Utils/Common';\nimport { getSrc } from '../../../Utils/File';\nimport { PHOTO_DISPLAY_SIZE, PHOTO_SIZE } from '../../../Constants';\nimport './Game.css';\n\nclass Game extends React.Component {\n    getContent = () => {\n        const { chatId, messageId, game, size, displaySize, openMedia } = this.props;\n        if (!game) return null;\n\n        const { photo, animation } = game;\n\n        if (animation) {\n            const animationSrc = getSrc(animation.animation);\n            if (animationSrc || animation.thumbnail) {\n                return <Animation chatId={chatId} messageId={messageId} animation={animation} openMedia={openMedia} />;\n            }\n        }\n\n        if (photo) {\n            let style = {\n                width: 0,\n                height: 0\n            };\n            const photoSize = getSize(photo.sizes, size);\n            if (photoSize) {\n                const fitPhotoSize = getFitSize(photoSize, displaySize);\n                if (fitPhotoSize) {\n                    style.width = fitPhotoSize.width;\n                    style.height = fitPhotoSize.height;\n                }\n            }\n\n            return <Photo chatId={chatId} messageId={messageId} photo={photo} style={style} openMedia={openMedia} />;\n        }\n\n        return null;\n    };\n\n    render() {\n        const { game, meta, t } = this.props;\n        if (!game) return null;\n\n        const { title, text, description } = game;\n        const formattedText = getFormattedText(text, t);\n\n        return (\n            <>\n                <div className='game'>\n                    <div className='border' />\n                    <div className='game-wrapper'>\n                        {title && <div className='game-title'>{title}</div>}\n                        {formattedText && <div className='game-text'>{formattedText}</div>}\n                        {description && <div className='game-description'>{description}</div>}\n                        {this.getContent()}\n                    </div>\n                </div>\n                {meta}\n            </>\n        );\n    }\n}\n\nGame.propTypes = {\n    chatId: PropTypes.number.isRequired,\n    messageId: PropTypes.number.isRequired,\n    game: PropTypes.object.isRequired,\n    openMedia: PropTypes.func,\n\n    size: PropTypes.number,\n    displaySize: PropTypes.number\n};\n\nGame.defaultProps = {\n    size: PHOTO_SIZE,\n    displaySize: PHOTO_DISPLAY_SIZE\n};\n\nexport default withTranslation()(Game);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Location from './Location';\nimport './Venue.css';\n\nclass Venue extends React.Component {\n    render() {\n        const { chatId, messageId, venue, openMedia, meta, title, caption } = this.props;\n        if (!venue) return null;\n\n        const { title: venueTitle, address, location } = venue;\n        if (!location) return null;\n\n        const { longitude, latitude } = location;\n        const source = `https://maps.google.com/?q=${latitude},${longitude}`;\n\n        return (\n            <div className='venue'>\n                <Location\n                    type='venue'\n                    chatId={chatId}\n                    messageId={messageId}\n                    location={location}\n                    openMedia={openMedia}\n                    title={title}\n                    caption={caption}\n                />\n                <div className='venue-content'>\n                    <a href={source} target='_blank' rel='noopener noreferrer'>\n                        <div className='venue-title'>{venueTitle}</div>\n                    </a>\n                    <div className='venue-subtitle'>\n                        {address}\n                        {!caption && meta}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nVenue.propTypes = {\n    chatId: PropTypes.number.isRequired,\n    messageId: PropTypes.number.isRequired,\n    venue: PropTypes.object.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default Venue;\n","export function LOG(message, ...optionalParams) {\n    return;\n    console.log(message, ...optionalParams);\n}\n\nexport function ERROR(message, ...optionalParams) {\n    console.error(message, ...optionalParams);\n}\n\nexport function logSourceBufferRanges (sourceBuffer, currentTime, duration) {\n    const ranges = [];\n    for (let i = 0; i < sourceBuffer.buffered.length; i++) {\n        ranges.push({ start: sourceBuffer.buffered.start(i), end: sourceBuffer.buffered.end(i)})\n    }\n\n    LOG('[SourceBuffer] ranges', sourceBuffer.id, currentTime, duration, sourceBuffer.pendingUpdates.length, JSON.stringify(ranges));\n}\n\nexport const strtokBITSET = {\n    get: (buf, off, bit) => {\n        return (buf[off] & (1 << bit)) !== 0;\n    },\n    len: 1\n};\n\nfunction readUTF16String(buffer) {\n    let offset = 2;\n    let label = 'utf-16';\n    if (buffer[0] === 0xFE && buffer[1] === 0xFF) { // big endian\n        offset = 2;\n        label = 'utf-16be';\n    } else if (buffer[0] === 0xFF && buffer[1] === 0xFE) { // little endian\n        offset = 2;\n        label = 'utf-16le';\n    }\n\n    return new TextDecoder(label).decode(buffer.slice(offset));\n}\n\nfunction readUTF8String(buffer) {\n    return new TextDecoder('utf-8').decode(buffer);\n}\n\nfunction readWindows1292String(buffer) {\n    return new TextDecoder('iso-8859-1').decode(buffer);\n}\n\n/**\n *\n * @param buffer Decoder input data\n * @param encoding 'utf16le' | 'utf16' | 'utf8' | 'iso-8859-1'\n * @return {string}\n */\nexport function decodeString(buffer, encoding) {\n    // annoying workaround for a double BOM issue\n    // https://github.com/leetreveil/musicmetadata/issues/84\n    if (buffer[0] === 0xFF && buffer[1] === 0xFE && buffer[2] === 0xFE && buffer[3] === 0xFF) {\n        buffer = buffer.slice(2);\n    }\n\n    if (encoding === 'utf16le' || encoding === 'utf16') {\n        return readUTF16String(buffer);\n    } else if (encoding === 'utf8') {\n        return readUTF8String(buffer);\n    } else if (encoding === 'iso-8859-1') {\n        return readWindows1292String(buffer);\n    }\n\n    throw Error(encoding + ' encoding is not supported!');\n}\n\nexport function trimRightNull(x) {\n    const pos0 = x.indexOf('\\0');\n    return pos0 === -1 ? x : x.substr(0, pos0);\n}\n\n/**\n * Read bit-aligned number start from buffer\n * Total offset in bits = byteOffset * 8 + bitOffset\n * @param buf Byte buffer\n * @param byteOffset Starting offset in bytes\n * @param bitOffset Starting offset in bits: 0 = lsb\n * @param len Length of number in bits\n * @return {number} decoded bit aligned number\n */\nexport function getBitAllignedNumber(buf, byteOffset, bitOffset, len){\n    const byteOff = byteOffset + ~~(bitOffset / 8);\n    const bitOff = bitOffset % 8;\n    let value = buf[byteOff];\n    value &= 0xff >> bitOff;\n    const bitsRead = 8 - bitOff;\n    const bitsLeft = len - bitsRead;\n    if (bitsLeft < 0) {\n        value >>= (8 - bitOff - len);\n    } else if (bitsLeft > 0) {\n        value <<= bitsLeft;\n        value |= getBitAllignedNumber(buf, byteOffset, bitOffset + bitsRead, bitsLeft);\n    }\n    return value;\n}\n\n/**\n * Read bit-aligned number start from buffer\n * Total offset in bits = byteOffset * 8 + bitOffset\n * @param buf Byte buffer\n * @param byteOffset Starting offset in bytes\n * @param bitOffset Starting offset in bits: 0 = most significant bit, 7 is least significant bit\n * @return {boolean} decoded bit aligned number\n */\nexport function isBitSet(buf, byteOffset, bitOffset) {\n    return getBitAllignedNumber(buf, byteOffset, bitOffset, 1) === 1;\n}","import { trimRightNull } from './Common';\n\n/**\n * 28 bits (representing up to 256MB) integer, the msb is 0 to avoid 'false syncsignals'.\n * 4 * %0xxxxxxx\n */\nexport const UINT32SYNCSAFE = {\n    get: (buf, off) => {\n        return buf[off + 3] & 0x7f | (buf[off + 2] << 7) | (buf[off + 1] << 14) | (buf[off] << 21);\n    },\n    len: 4\n};\n\nexport const UINT8 = {\n    get: (buf, off) => {\n        return buf[off];\n    }\n}\n\nexport const UINT32_BE = {\n    get: (buf, off) => {\n        return buf[off + 3] | (buf[off + 2] << 8) | (buf[off + 1] << 16) | (buf[off] << 24);\n    }\n}\n\nexport const UINT24_BE = {\n    get: (buf, off) => {\n        return buf[off + 2] | (buf[off + 1] << 8) | (buf[off] << 16);\n    }\n}\n\nexport const UINT16_BE = {\n    get: (buf, off) => {\n        return buf[off + 1] | (buf[off] << 8);\n    }\n}\n\nexport const ASCII_TEXT = {\n    get: (buf, off, len) => {\n        return new TextDecoder('ascii').decode(buf.slice(off, off + len));\n    }\n}\n\nexport const Id3v1StringType = {\n    get: (buf, off, len) => {\n        let value = new TextDecoder('ascii').decode(buf.slice(off, off + len));\n        value = trimRightNull(value);\n        value = value.trim();\n        return value.length > 0 ? value : undefined;\n    }\n}","import {Id3v1StringType, UINT8} from '../../Utils/Token';\n\n/**\n * Spec: http://id3.org/ID3v1\n * Wiki: https://en.wikipedia.org/wiki/ID3\n */\nexport const ID3v1Header = {\n    len: 128,\n\n    /**\n     * @param buf Buffer possibly holding the 128 bytes ID3v1.1 metadata header\n     * @param off Offset in buffer in bytes\n     * @returns ID3v1.1 header if first 3 bytes equals 'TAG', otherwise null is returned\n     */\n    get: (buf, off) => {\n        const header = Id3v1StringType.get(buf, off, 3);\n        return header === 'TAG' ? {\n            header,\n            title: Id3v1StringType.get(buf, off + 3, 30),\n            artist: Id3v1StringType.get(buf, off + 33, 30),\n            album: Id3v1StringType.get(buf, off + 63, 30),\n            year: Id3v1StringType.get(buf, off + 93, 4),\n            comment: Id3v1StringType.get(buf, off + 97, 28),\n            // ID3v1.1 separator for track\n            zeroByte: UINT8.get(buf, off + 127),\n            // track: ID3v1.1 field added by Michael Mutschler\n            track: UINT8.get(buf, off + 126),\n            genre: UINT8.get(buf, off + 127)\n        } : null;\n    }\n};","import {ID3v1Header} from './ID3v1Token';\nimport {Id3v1StringType} from '../../Utils/Token';\n\nexport class ID3v1Parser {\n    parse(buffer) {\n        if (buffer.length < 128) {\n            console.log('[ID3v1Parser] Skip checking for ID3v1 because the file-size is less than 128 bytes');\n            return null;\n        }\n\n        return ID3v1Header.get(buffer, buffer.length - ID3v1Header.len);\n    }\n}\n\nexport function hasID3v1Header(buffer) {\n    if (buffer.length >= 128) {\n        const tag = Id3v1StringType.get(buffer, buffer.length - 128, 3);\n        return tag === 'TAG';\n    }\n    return false;\n}","import { strtokBITSET } from '../../Utils/Common';\nimport { UINT16_BE, UINT32_BE, ASCII_TEXT, UINT32SYNCSAFE } from '../../Utils/Token';\n\n/**\n * ID3v2 header\n * Ref: http://id3.org/id3v2.3.0#ID3v2_header\n */\nexport const ID3v2Header = {\n    get: (buffer, offset) => {\n        // ID3v2/file identifier   'ID3'\n        const fileIdentifier = ASCII_TEXT.get(buffer, offset, 3); // new TextDecoder('ascii').decode(buffer.slice(offset, 3));\n\n        // ID3v2 versionIndex\n        const version = {\n            major: buffer[offset + 3],\n            revision: buffer[offset + 4]\n        };\n\n        // ID3v2 flags\n        const flags = {\n            raw: buffer[offset + 5],\n            // Unsynchronisation\n            unsynchronisation: strtokBITSET.get(buffer, offset + 5, 7),\n            // Extended header\n            isExtendedHeader: strtokBITSET.get(buffer, offset + 5, 6),\n            // Experimental indicator\n            expIndicator: strtokBITSET.get(buffer, offset + 5, 5),\n            footer: strtokBITSET.get(buffer, offset + 5, 4)\n        };\n\n        // ID3v2 size\n        // The ID3v2 tag size is the size of the complete tag after unsychronisation, including padding, excluding the header but not excluding the extended header\n        const size = UINT32SYNCSAFE.get(buffer, offset + 6);\n\n        return {\n            fileIdentifier,\n            version,\n            flags,\n            size\n        };\n    },\n    len: 10\n}\n\n/**\n * ID3v2 header\n * Ref: http://id3.org/id3v2.3.0#ID3v2_extended_header\n */\nexport const ExtendedHeader = {\n    len: 10,\n\n    get: (buf, off) => {\n        // Extended header size (10 or 6 excluding itself)\n        const size = UINT32_BE.get(buf, off);\n\n        // Extended Flags\n        const extendedFlags = UINT16_BE.get(buf, off + 4);\n\n        // Size of padding\n        const sizeOfPadding = UINT32_BE.get(buf, off + 6);\n\n        // CRC data present\n        const crcDataPresent = strtokBITSET.get(buf, off + 4, 31);\n\n        const crcData = crcDataPresent ? UINT32_BE.get(buf, off + 10) : null;\n\n        return {\n            size,\n            extendedFlags,\n            sizeOfPadding,\n            crcDataPresent,\n            crcData\n        };\n    }\n}\n\nexport const TextEncodingToken = {\n    len: 1,\n\n    get: (buf, off) => {\n        switch (buf[off]) {\n            case 0x00:\n                return { encoding: 'iso-8859-1' }; // binary\n            case 0x01:\n                return { encoding: 'utf16', bom: true };\n            case 0x02:\n                return { encoding: 'utf16', bom: false };\n            case 0x03:\n                return { encoding: 'utf8', bom: false };\n            default:\n                return { encoding: 'utf8', bom: false };\n\n        }\n    }\n};","import {TextEncodingToken} from './ID3v2Token';\nimport {decodeString} from '../../Utils/Common';\n\nconst defaultEnc = 'iso-8859-1';\n\nexport class FrameParser {\n\n    /**\n     * Create id3v2 frame parser\n     * @param major - Major version, e.g. (4) for  id3v2.4\n     */\n    constructor(major)  {\n        this.major = major;\n    }\n\n    readData(b, type) {\n\n        if (b.length === 0) {\n            console.log(`id3v2.${this.major} header has empty tag type=${type}`);\n            return;\n        }\n\n        const {encoding, bom} = TextEncodingToken.get(b, 0);\n        let output = [];\n\n        console.debug(`Parsing tag type=${type}, encoding=${encoding}, bom=${bom}`);\n        switch (type) {\n            case 'TPE1': // 4.2.1. Text information frames - details\n            case 'TIT2': {\n                const text = decodeString(b.slice(1), encoding).replace(/\\x00+$/, '');\n                output = this.major >= 4 ? this.splitValue(type, text) : [text];\n            }\n            default:\n                //console.log('Warning: unsupported id3v2-tag-type: ' + type);\n                break;\n        }\n\n        return output;\n    }\n\n    /**\n     * id3v2.4 defines that multiple T* values are separated by 0x00\n     * id3v2.3 defines that TCOM, TEXT, TOLY, TOPE & TPE1 values are separated by /\n     * @param tag - Tag name\n     * @param text - Concatenated tag value\n     * @returns Split tag value\n     */\n    splitValue(tag, text) {\n        let values;\n        if (this.major < 4) {\n            values = text.split(/\\x00/g);\n            if (values.length > 1) {\n                console.log(`ID3v2.${this.major} ${tag} uses non standard null-separator.`);\n            } else {\n                values = text.split(/\\//g);\n            }\n        } else {\n            values = text.split(/\\x00/g);\n        }\n        return FrameParser.trimArray(values);\n    }\n\n    static trimArray(values) {\n        return values.map(value => value.replace(/\\x00+$/, '').trim());\n    }\n}","import { ExtendedHeader, ID3v2Header } from './ID3v2Token';\nimport { strtokBITSET } from '../../Utils/Common';\nimport { ASCII_TEXT, UINT24_BE, UINT32_BE, UINT32SYNCSAFE } from '../../Utils/Token';\nimport { FrameParser } from './FrameParser';\n\nexport class ID3v2Parser {\n    static removeUnsyncBytes(buffer) {\n        let readI = 0;\n        let writeI = 0;\n        while (readI < buffer.length - 1) {\n            if (readI !== writeI) {\n                buffer[writeI] = buffer[readI];\n            }\n            readI += (buffer[readI] === 0xFF && buffer[readI + 1] === 0) ? 2 : 1;\n            writeI++;\n        }\n        if (readI < buffer.length) {\n            buffer[writeI++] = buffer[readI];\n        }\n        return buffer.slice(0, writeI);\n    }\n\n    static readFrameData(buf, frameHeader, majorVer, includeCovers, warningCollector) {\n        const frameParser = new FrameParser(majorVer, warningCollector);\n        switch (majorVer) {\n            case 2:\n                return frameParser.readData(buf, frameHeader.id, includeCovers);\n            case 3:\n            case 4:\n                if (frameHeader.flags.format.unsynchronisation) {\n                    buf = ID3v2Parser.removeUnsyncBytes(buf);\n                }\n                if (frameHeader.flags.format.data_length_indicator) {\n                    buf = buf.slice(4, buf.length);\n                }\n                return frameParser.readData(buf, frameHeader.id, includeCovers);\n            default:\n                throw new Error('Unexpected majorVer: ' + majorVer);\n        }\n    }\n\n    static readFrameFlags(b) {\n        return {\n            status: {\n                tag_alter_preservation: strtokBITSET.get(b, 0, 6),\n                file_alter_preservation: strtokBITSET.get(b, 0, 5),\n                read_only: strtokBITSET.get(b, 0, 4)\n            },\n            format: {\n                grouping_identity: strtokBITSET.get(b, 1, 7),\n                compression: strtokBITSET.get(b, 1, 3),\n                encryption: strtokBITSET.get(b, 1, 2),\n                unsynchronisation: strtokBITSET.get(b, 1, 1),\n                data_length_indicator: strtokBITSET.get(b, 1, 0)\n            }\n        };\n    }\n\n    static readFrameHeader(v, majorVer) {\n        let header;\n        switch (majorVer) {\n\n            case 2:\n                header = {\n                    id: ASCII_TEXT.get(v, 0, 3),\n                    length: UINT24_BE.get(v, 3)\n                };\n                break;\n\n            case 3:\n                header = {\n                    id: ASCII_TEXT.get(v, 0, 4),\n                    length: UINT32_BE.get(v, 4),\n                    flags: ID3v2Parser.readFrameFlags(v.slice(8, 10))\n                };\n                break;\n\n            case 4:\n                header = {\n                    id: ASCII_TEXT.get(v, 0, 4),\n                    length: UINT32SYNCSAFE.get(v, 4),\n                    flags: ID3v2Parser.readFrameFlags(v.slice(8, 10))\n                };\n                break;\n\n            default:\n                throw new Error('Unexpected majorVer: ' + majorVer);\n        }\n\n        return header;\n    }\n\n    static getFrameHeaderLength(majorVer) {\n        switch (majorVer) {\n            case 2:\n                return 6;\n            case 3:\n            case 4:\n                return 10;\n            default:\n                throw new Error('header versionIndex is incorrect');\n        }\n    }\n\n    parseMetadata(data) {\n        let offset = 0;\n        const tags = [];\n\n        while (true) {\n            if (offset === data.length) break;\n\n            const frameHeaderLength = ID3v2Parser.getFrameHeaderLength(this.id3Header.version.major);\n            if (offset + frameHeaderLength > data.length) {\n                console.log('Illegal ID3v2 tag length');\n                break;\n            }\n\n            const frameHeaderBytes = data.slice(offset, offset += frameHeaderLength);\n            const frameHeader = ID3v2Parser.readFrameHeader(frameHeaderBytes, this.id3Header.version.major);\n\n            // Last frame. Check first char is a letter, bit of defensive programming\n            if (frameHeader.id === '' || frameHeader.id === '\\u0000\\u0000\\u0000\\u0000' || 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.indexOf(frameHeader.id[0]) === -1) {\n                console.log('Illegal ID3v2 tag header', frameHeaderBytes, frameHeader.id);\n                break;\n            }\n\n            const frameDataBytes = data.slice(offset, offset += frameHeader.length);\n            const values = ID3v2Parser.readFrameData(frameDataBytes, frameHeader, this.id3Header.version.major, true, []);\n\n            console.log('[ID3v2Parser] parseMetadata', offset, frameHeader.length, frameHeader.id, values);\n            tags.push({ id: frameHeader.id, value: values });\n        }\n        return tags;\n    }\n\n    parseExtendedHeader(buffer) {\n        const extendedHeader = ExtendedHeader.get(buffer, 10);\n\n        return this.parseId3Data(buffer, this.id3Header.size + extendedHeader.size + 4, this.id3Header.size);\n    }\n\n    parseId3Data(buf, offset, dataLen) {\n        const buffer = buf.slice(offset, offset + dataLen);\n        return this.parseMetadata(buffer)\n    }\n\n    parse(buffer) {\n        const id3Header = ID3v2Header.get(buffer, 0);\n\n        this.id3Header = id3Header;\n        if (id3Header.fileIdentifier !== 'ID3') {\n            throw new Error('expected ID3-header file-identifier \\'ID3\\' was not found');\n        }\n\n        if (id3Header.flags.isExtendedHeader) {\n            return this.parseExtendedHeader(buffer);\n        } else {\n            return this.parseId3Data(buffer, ID3v2Header.len, id3Header.size);\n        }\n    }\n}\n\nexport function hasID3v2Header(buffer) {\n    if (buffer.length > 10) {\n        const tag = ASCII_TEXT.get(buffer, 0, 3);\n        return tag === 'ID3';\n    }\n    return false;\n}","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { hasID3v1Header, ID3v1Parser } from './ID3v1/ID3v1Parser';\nimport { hasID3v2Header, ID3v2Parser } from './ID3v2/ID3v2Parser';\nimport { getArrayBuffer } from '../../../../Utils/File';\n\nexport class ID3Parser {\n\n    async parse(file) {\n        const tags = { artist: '', title: '' };\n        const result = { tags };\n\n        if (!file) return result;\n\n        const arrayBuffer = await getArrayBuffer(file);\n        if (!arrayBuffer) return result;\n\n        const buffer = new Uint8Array(arrayBuffer);\n        if (!buffer) return result;\n\n        if (hasID3v2Header(buffer)) {\n            const id3Tags = new ID3v2Parser().parse(buffer);\n            if (id3Tags) {\n                const artistTag = id3Tags.find(x => x.id === 'TPE1');\n                if (artistTag && artistTag.value.length > 0){\n                    tags.artist = artistTag.value[0];\n                }\n                const titleTag = id3Tags.find(x => x.id === 'TIT2');\n                if (titleTag && titleTag.value.length > 0){\n                    tags.title = titleTag.value[0];\n                }\n            }\n        } else if (hasID3v1Header(buffer)) {\n            const id3Tags = new ID3v1Parser().parse(buffer);\n\n            if (id3Tags) {\n                tags.artist = id3Tags.artist;\n                tags.title = id3Tags.title;\n            }\n        }\n\n        return result;\n    }\n}","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { PHOTO_DISPLAY_SIZE, THUMBNAIL_BLURRED_SIZE_90 } from '../Constants';\nimport MessageStore from '../Stores/MessageStore';\nimport Animation from '../Components/Message/Media/Animation';\nimport Audio from '../Components/Message/Media/Audio';\nimport Call from '../Components/Message/Media/Call';\nimport Contact from '../Components/Message/Media/Contact';\nimport Document from '../Components/Message/Media/Document';\nimport Game from '../Components/Message/Media/Game';\nimport Location from '../Components/Message/Media/Location';\nimport Photo from '../Components/Message/Media/Photo';\nimport Poll from '../Components/Message/Media/Poll';\nimport Sticker, { StickerSourceEnum } from '../Components/Message/Media/Sticker';\nimport Venue from '../Components/Message/Media/Venue';\nimport Video from '../Components/Message/Media/Video';\nimport VideoNote from '../Components/Message/Media/VideoNote';\nimport VoiceNote from '../Components/Message/Media/VoiceNote';\nimport React from 'react';\nimport { getRandomInt, readImageSize } from './Common';\nimport FileStore from '../Stores/FileStore';\nimport { ID3Parser } from '../Components/Player/Steaming/MP3/ID3Parser';\n\nconst waveformCache = new Map();\n\nexport function getNormalizedWaveform(data) {\n    if (waveformCache.has(data)) {\n        return waveformCache.get(data);\n    }\n\n    const bytes = Array.from(atob(data)).map(x => x.charCodeAt(0) & 0xFF);\n    const waveform = [];\n    const barsCount = Math.floor(bytes.length * 8 / 5);\n    for (let i = 0; i < barsCount; i++) {\n        const byteIndex = Math.floor(i * 5 / 8);\n        const barPadding = i * 5 % 8;\n\n        const bits = bytes[byteIndex] | (((byteIndex + 1 < bytes.length) ? bytes[byteIndex + 1] : 0) << 8);\n        waveform.push(((bits >>> barPadding) & 0x1F) / 31.0);\n    }\n\n    for (let i = 0; i < (100 - barsCount); i++) {\n        waveform.push(0);\n    }\n\n    waveformCache.set(data, waveform);\n\n    return waveform;\n}\n\nexport function getCallTitle(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return null;\n\n    const { content, is_outgoing } = message;\n    if (content['@type'] !== 'messageCall') return null;\n\n    const { discard_reason, duration } = content;\n    if (is_outgoing) {\n        return discard_reason['@type'] === 'callDiscardReasonMissed' ? 'Cancelled Call' : 'Outgoing Call';\n    } else if (discard_reason['@type'] === 'callDiscardReasonMissed') {\n        return 'Missed Call';\n    } else if (discard_reason['@type'] === 'callDiscardReasonDeclined') {\n        return 'Declined Call';\n    }\n\n    return 'Incoming Call';\n}\n\nexport function isEditedMedia(chatId, messageId) {\n    const message = MessageStore.get(chatId, messageId);\n    if (!message) return;\n\n    const { content } = message;\n    switch (content['@type']) {\n        case 'messageAnimation': {\n            return true;\n        }\n        case 'messageAudio': {\n            return true;\n        }\n        case 'messageDocument': {\n            return true;\n        }\n        case 'messagePhoto': {\n            return true;\n        }\n        case 'messageVideo': {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nexport function isValidAnimatedSticker(sticker, chatId, messageId) {\n    if (!sticker) return false;\n    if (!sticker.is_animated) return false;\n\n    const message = MessageStore.get(chatId, messageId);\n    if (message) {\n        const { sending_state } = message;\n        if (sending_state && !sticker.set_id) return false;\n    }\n\n    return true;\n}\n\nexport function isBlurredThumbnail(thumbnail, displaySize = PHOTO_DISPLAY_SIZE, blurredSize = THUMBNAIL_BLURRED_SIZE_90) {\n    if (!thumbnail) return false;\n    // if (displaySize <= blurredSize * 2) return false;\n\n    return Math.max(thumbnail.width, thumbnail.height) <= blurredSize;\n}\n\nexport function getAudioTitle(audio) {\n    if (!audio) return null;\n\n    const { file_name, title, performer } = audio;\n    const trimmedTitle = title ? title.trim() : '';\n    const trimmedPerformer = performer ? performer.trim() : '';\n\n    return trimmedTitle || trimmedPerformer\n        ? `${trimmedPerformer || 'Unknown Artist'} — ${trimmedTitle || 'Unknown Track'}`\n        : file_name;\n}\n\nexport function getAudioShortTitle(audio) {\n    if (!audio) return null;\n\n    const { file_name, title, performer } = audio;\n    const trimmedTitle = title ? title.trim() : '';\n    const trimmedPerformer = performer ? performer.trim() : '';\n\n    return trimmedTitle || trimmedPerformer ? `${trimmedPerformer || 'Unknown Artist'}` : file_name;\n}\n\nexport function getAudioSubtitle(audio) {\n    if (!audio) return null;\n\n    const { title } = audio;\n    const trimmedTitle = title ? title.trim() : '';\n\n    return trimmedTitle || 'Unknown Track';\n}\n\nexport function getStickers(sets) {\n    return sets.reduce((stickers, set) => stickers.concat(set.stickers), []);\n}\n\nexport function getNeighborStickersFromSets(sticker, sets, stickersPerRow) {\n    const result = [];\n    const [row, column] = toRowColumn(sticker, sets, stickersPerRow);\n    if (row === -1) return [];\n    if (column === -1) return [];\n\n    const prevPrevRow = row - 2;\n    const prevRow = row - 1;\n    const nextRow = row + 1;\n    const nextNextRow = row + 2;\n\n    const prevColumn = column - 1;\n    const nextColumn = column + 1;\n\n    let skipPrevRow = prevRow < 0;\n    let skipPrePrevRow = prevPrevRow < 0;\n    if (!skipPrevRow) {\n        if (prevColumn >= 0) {\n            let index = toIndex(prevRow, prevColumn, sets, stickersPerRow);\n            if (index === -1) {\n                skipPrevRow = true;\n                index = skipPrePrevRow ? -1 : toIndex(prevPrevRow, prevColumn, sets, stickersPerRow);\n                skipPrePrevRow = index === -1;\n            }\n            if (index !== -1) {\n                result.push(index);\n            }\n        }\n\n        let index = skipPrevRow ? -1 : toIndex(prevRow, column, sets, stickersPerRow);\n        if (index === -1) {\n            skipPrevRow = true;\n            index = skipPrePrevRow ? -1 : toIndex(prevPrevRow, column, sets, stickersPerRow);\n            skipPrePrevRow = index === -1;\n        }\n        if (index !== -1) {\n            result.push(index);\n        }\n\n        if (nextColumn < stickersPerRow) {\n            let index = skipPrevRow ? -1 : toIndex(prevRow, nextColumn, sets, stickersPerRow);\n            if (index === -1) {\n                index = skipPrePrevRow ? -1 : toIndex(prevPrevRow, nextColumn, sets, stickersPerRow);\n            }\n            if (index !== -1) {\n                result.push(index);\n            }\n        }\n    }\n\n    if (prevColumn >= 0) {\n        const index = toIndex(row, prevColumn, sets, stickersPerRow);\n        if (index !== -1) {\n            result.push(index);\n        }\n    }\n\n    if (nextColumn < stickersPerRow) {\n        const index = toIndex(row, nextColumn, sets, stickersPerRow);\n        if (index !== -1) {\n            result.push(index);\n        }\n    }\n\n    let totalRows = sets.reduce((totalRows, set) => totalRows + Math.ceil(set.stickers.length / stickersPerRow), 0);\n    let skipNextRow = nextRow >= totalRows;\n    let skipNextNextRow = nextRow >= totalRows;\n    if (!skipNextRow) {\n        if (prevColumn >= 0) {\n            let index = toIndex(nextRow, prevColumn, sets, stickersPerRow);\n            if (index === -1) {\n                skipNextRow = true;\n                index = skipNextNextRow ? -1 : toIndex(nextNextRow, prevColumn, sets, stickersPerRow);\n                skipNextNextRow = index === -1;\n            }\n            if (index !== -1) {\n                result.push(index);\n            }\n        }\n\n        let index = skipNextRow ? -1 : toIndex(nextRow, column, sets, stickersPerRow);\n        if (index === -1) {\n            skipNextRow = true;\n            index = skipNextNextRow ? -1 : toIndex(nextNextRow, column, sets, stickersPerRow);\n            skipNextNextRow = index === -1;\n        }\n        if (index !== -1) {\n            result.push(index);\n        }\n\n        if (nextColumn < stickersPerRow) {\n            let index = skipNextRow ? -1 : toIndex(nextRow, nextColumn, sets, stickersPerRow);\n            if (index === -1) {\n                index = skipNextNextRow ? -1 : toIndex(nextNextRow, nextColumn, sets, stickersPerRow);\n            }\n            if (index !== -1) {\n                result.push(index);\n            }\n        }\n    }\n\n    const items = getStickers(sets);\n    return result.map(x => items[x]);\n}\n\nfunction toRowColumn(sticker, sets, stickersPerRow) {\n    const setIndex = sets.findIndex(x => x.id === sticker.set_id);\n    if (setIndex === -1) return [-1, -1];\n\n    const stickerIndex = sets[setIndex].stickers.findIndex(x => x.sticker.id === sticker.sticker.id);\n    if (stickerIndex === -1) return [-1, -1];\n\n    let prevRows = 0;\n    for (let i = 0; i < setIndex; i++) {\n        prevRows += Math.ceil(sets[i].stickers.length / stickersPerRow);\n    }\n\n    return [prevRows + Math.floor(stickerIndex / stickersPerRow), stickerIndex % stickersPerRow];\n}\n\nfunction toIndex(row, column, sets, stickersPerRow) {\n    let index = -1;\n    let totalRows = 0;\n    let setIndex = -1;\n    for (let i = 0; i < sets.length; i++) {\n        let setRows = Math.ceil(sets[i].stickers.length / stickersPerRow);\n        totalRows += setRows;\n        if (totalRows > row) {\n            setIndex = i;\n            break;\n        }\n    }\n    if (setIndex === -1) return index;\n\n    let setRow = row;\n    let setColumn = column;\n    for (let i = 0; i < setIndex; i++) {\n        let setRows = Math.ceil(sets[i].stickers.length / stickersPerRow);\n        setRow -= setRows;\n    }\n\n    index = stickersPerRow * setRow + setColumn;\n\n    if (index >= sets[setIndex].stickers.length) return -1;\n\n    for (let i = 0; i < setIndex; i++) {\n        index += sets[i].stickers.length;\n    }\n\n    return index;\n}\n\nfunction getInputMediaThumbnail(thumbnail) {\n    if (!thumbnail) return null;\n\n    const { file, width, height } = thumbnail;\n    if (!file) return null;\n\n    return {\n        '@type': 'inputThumbnail',\n        thumbnail: {\n            '@type': 'inputFileId',\n            id: file.id\n        },\n        width,\n        height\n    };\n}\n\nfunction getInputMediaCaption(text) {\n    if (!text) return null;\n\n    return {\n        '@type': 'formattedText',\n        text: text,\n        entities: null\n    };\n}\n\nexport function getInputMediaContent(media, text) {\n    if (!media) return null;\n\n    switch (media['@type']) {\n        case 'animation': {\n            const { animation: file, thumbnail, width, height, duration } = media;\n\n            return {\n                '@type': 'inputMessageAnimation',\n                animation: {\n                    '@type': 'inputFileId',\n                    id: file.id\n                },\n                thumbnail: getInputMediaThumbnail(thumbnail),\n                duration,\n                width,\n                height,\n                caption: getInputMediaCaption(text)\n            };\n        }\n        case 'audio': {\n            const { audio: file, album_cover_thumbnail: thumbnail, title, performer, duration } = media;\n\n            return {\n                '@type': 'inputMessageAudio',\n                audio: {\n                    '@type': 'inputFileId',\n                    id: file.id\n                },\n                album_cover_thumbnail: getInputMediaThumbnail(thumbnail),\n                duration,\n                title,\n                performer,\n                caption: getInputMediaCaption(text)\n            };\n        }\n        case 'contact': {\n            return {\n                '@type': 'inputMessageContact',\n                contact: media\n            };\n        }\n        case 'document': {\n            const { document: file, thumbnail } = media;\n\n            return {\n                '@type': 'inputMessageDocument',\n                document: {\n                    '@type': 'inputFileId',\n                    id: file.id\n                },\n                thumbnail: getInputMediaThumbnail(thumbnail),\n                caption: getInputMediaCaption(text)\n            };\n        }\n        case 'game': {\n            return null;\n        }\n        case 'invoice': {\n            return null;\n        }\n        case 'location': {\n            return {\n                '@type': 'inputMessageLocation',\n                location: media,\n                live_period: 0\n            };\n        }\n        case 'photo': {\n            const { sizes } = media;\n            if (!sizes.length) return null;\n\n            const thumbnail = sizes[0];\n            const photo = sizes[sizes.length - 1];\n            if (!photo) return null;\n\n            const { photo: file, width, height } = photo;\n\n            return {\n                '@type': 'inputMessagePhoto',\n                photo: {\n                    '@type': 'inputFileId',\n                    id: file.id\n                },\n                thumbnail: getInputMediaThumbnail(thumbnail),\n                added_sticker_file_ids: [],\n                width,\n                height,\n                caption: getInputMediaCaption(text),\n                ttl: 0\n            };\n        }\n        case 'poll': {\n            return null;\n        }\n        case 'sticker': {\n            const { sticker: file, thumbnail, width, height } = media;\n\n            return {\n                '@type': 'inputMessageSticker',\n                sticker: {\n                    '@type': 'inputFileId',\n                    id: file.id\n                },\n                thumbnail: getInputMediaThumbnail(thumbnail),\n                width,\n                height,\n                caption: getInputMediaCaption(text)\n            };\n        }\n        case 'venue': {\n            return {\n                '@type': 'inputMessageVenue',\n                venue: media\n            };\n        }\n        case 'video': {\n            const { video: file, thumbnail, width, height, duration, supports_streaming } = media;\n\n            return {\n                '@type': 'inputMessageVideo',\n                video: {\n                    '@type': 'inputFileId',\n                    id: file.id\n                },\n                thumbnail: getInputMediaThumbnail(thumbnail),\n                added_sticker_file_ids: [],\n                duration,\n                width,\n                height,\n                supports_streaming,\n                caption: getInputMediaCaption(text),\n                ttl: 0\n            };\n        }\n        case 'videoNote': {\n            const { video: file, thumbnail, duration, length } = media;\n\n            return {\n                '@type': 'inputMessageVideoNote',\n                video: {\n                    '@type': 'inputFileId',\n                    id: file.id\n                },\n                thumbnail: getInputMediaThumbnail(thumbnail),\n                duration,\n                length,\n                ttl: 0\n            };\n        }\n        case 'voiceNote': {\n            const { voice: file, duration, waveform } = media;\n\n            return {\n                '@type': 'inputMessageVideoNote',\n                voice_note: {\n                    '@type': 'inputFileId',\n                    id: file.id\n                },\n                duration,\n                waveform\n            };\n        }\n    }\n\n    return null;\n}\n\nexport function getMedia(message, openMedia, hasTitle = false, hasCaption = false, inlineMeta = null) {\n    if (!message) return null;\n\n    const { chat_id, id, content } = message;\n    if (!content) return null;\n\n    switch (content['@type']) {\n        case 'messageAnimation':\n            return (\n                <Animation\n                    type='message'\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    animation={content.animation}\n                    openMedia={openMedia}\n                    stretch={true}\n                />\n            );\n        case 'messageAudio':\n            return (\n                <Audio\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    audio={content.audio}\n                    openMedia={openMedia}\n                    meta={inlineMeta}\n                />\n            );\n        case 'messageCall':\n            return (\n                <Call\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    duraton={content.duration}\n                    discardReason={content.discard_reason}\n                    openMedia={openMedia}\n                    meta={inlineMeta}\n                />\n            );\n        case 'messageContact':\n            return (\n                <Contact\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    contact={content.contact}\n                    openMedia={openMedia}\n                    meta={inlineMeta}\n                />\n            );\n        case 'messageDocument':\n            return (\n                <Document\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    document={content.document}\n                    openMedia={openMedia}\n                    meta={inlineMeta}\n                />\n            );\n        case 'messageGame':\n            return (\n                <Game\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    game={content.game}\n                    openMedia={openMedia}\n                    meta={inlineMeta}\n                />\n            );\n        case 'messageLocation':\n            return (\n                <Location\n                    type='message'\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    location={content.location}\n                    openMedia={openMedia}\n                />\n            );\n        case 'messagePhoto':\n            return (\n                <Photo\n                    type='message'\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    photo={content.photo}\n                    openMedia={openMedia}\n                    stretch={true}\n                />\n            );\n        case 'messagePoll':\n            return <Poll chatId={chat_id} messageId={id} poll={content.poll} openMedia={openMedia} meta={inlineMeta} />;\n        case 'messageSticker':\n            return (\n                <Sticker\n                    chatId={chat_id}\n                    messageId={id}\n                    sticker={content.sticker}\n                    source={StickerSourceEnum.MESSAGE}\n                    openMedia={openMedia}\n                />\n            );\n        case 'messageText':\n            return null;\n        case 'messageVenue':\n            return (\n                <Venue\n                    type='message'\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    venue={content.venue}\n                    openMedia={openMedia}\n                    meta={inlineMeta}\n                />\n            );\n        case 'messageVideo':\n            return (\n                <Video\n                    type='message'\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    video={content.video}\n                    openMedia={openMedia}\n                    stretch={true}\n                />\n            );\n        case 'messageVideoNote':\n            return (\n                <VideoNote\n                    type='message'\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    videoNote={content.video_note}\n                    openMedia={openMedia}\n                />\n            );\n        case 'messageVoiceNote':\n            return (\n                <VoiceNote\n                    type='message'\n                    title={hasTitle}\n                    caption={hasCaption}\n                    chatId={chat_id}\n                    messageId={id}\n                    voiceNote={content.voice_note}\n                    openMedia={openMedia}\n                    meta={inlineMeta}\n                />\n            );\n        default:\n            return [`[${content['@type']}]`, inlineMeta];\n    }\n}\n\nexport async function getMediaTags(file) {\n    return new Promise(async resolve => {\n        const tag = await new ID3Parser().parse(file);\n\n        const { tags } = tag;\n        const { artist, title } = tags;\n\n        const audio = document.createElement('audio');\n        const url = URL.createObjectURL(file);\n\n        audio.src = url;\n        audio.addEventListener('loadedmetadata', function(){\n            URL.revokeObjectURL(url);\n            const duration = audio.duration;\n            audio.src = null;\n            resolve({ title, performer : artist, duration : Math.trunc(duration) });\n        },false);\n        audio.addEventListener('error', function() {\n            resolve(null);\n        });\n    })\n}\n\nexport async function getMediaDocumentFromFile(file) {\n    if (!file) {\n        return null;\n    }\n\n    const fileId = -getRandomInt(1, 1000000);\n    FileStore.setBlob(fileId, file);\n\n    const { name, type, size } = file;\n\n    if (type === 'audio/mp3') {\n        const tags = await getMediaTags(file);\n        if (tags) {\n            const { title, performer, duration } = tags;\n\n            return ({\n                '@type': 'messageAudio',\n                audio: {\n                    '@type': 'audio',\n                    duration,\n                    title,\n                    performer,\n                    file_name: name,\n                    mime_type: type,\n                    album_cover_minithumbnail: null,\n                    album_cover_thumbnail: null,\n                    audio: {\n                        '@type': 'file',\n                        id: fileId,\n                        size,\n                        expected_size: size,\n                        local: {\n                            is_downloading_completed: true\n                        }\n                    }\n                }\n            });\n        }\n    }\n\n    return ({\n        '@type': 'messageDocument',\n        document: {\n            '@type': 'document',\n            file_name: name,\n            mime_type: type,\n            minithumbnail: null,\n            thumbnail: null,\n            document: {\n                '@type': 'file',\n                id: fileId,\n                size,\n                expected_size: size,\n                local: {\n                    is_downloading_completed: true\n                }\n            }\n        }\n    });\n}\n\nexport async function getMediaPhotoFromFile(file) {\n    if (!file) {\n        return null;\n    }\n\n    if (file.type.startsWith('image')) {\n        const [width, height] = await readImageSize(file);\n\n        const fileId = -getRandomInt(1, 1000000);\n        FileStore.setBlob(fileId, file);\n\n        const photoSize = {\n            '@type': 'photoSize',\n            photo: {\n                '@type': 'file',\n                id: fileId,\n                size: file.size,\n                expected_size: file.expected_size,\n                local: {\n                    is_downloading_completed: true\n                }\n            },\n            width,\n            height\n        };\n\n        return ({\n            '@type': 'messagePhoto',\n            photo: {\n                '@type': 'photo',\n                has_stickers: false,\n                minithumbnail: null,\n                sizes: [ photoSize ]\n            }\n        });\n    } else {\n        return null;\n    }\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass SupergroupStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.items = new Map();\n        this.fullInfoItems = new Map();\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'updateSupergroup': {\n                const prevSupergroup = this.get(update.supergroup.id);\n\n                this.set(update.supergroup);\n\n                this.emit(update['@type'], { ...update, prevSupergroup });\n                break;\n            }\n            case 'updateSupergroupFullInfo':\n                this.setFullInfo(update.supergroup_id, update.supergroup_full_info);\n\n                this.emit(update['@type'], update);\n                break;\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {};\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    get(id) {\n        return this.items.get(id);\n    }\n\n    set(supergroup) {\n        this.items.set(supergroup.id, supergroup);\n    }\n\n    getFullInfo(id) {\n        return this.fullInfoItems.get(id);\n    }\n\n    setFullInfo(id, fullInfo) {\n        this.fullInfoItems.set(id, fullInfo);\n    }\n}\n\nconst store = new SupergroupStore();\nwindow.supergroup = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass InstantViewStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.items = [];\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateBlocksInView': {\n                this.emit('clientUpdateBlocksInView', update);\n                break;\n            }\n            case 'clientUpdateInstantViewContent': {\n                const { content } = update;\n\n                if (content) {\n                    this.items.push(content.instantView);\n                } else {\n                    this.items = [];\n                }\n\n                this.emit('clientUpdateInstantViewContent', update);\n\n                break;\n            }\n            case 'clientUpdateInstantViewUrl': {\n                this.emit('clientUpdateInstantViewUrl', update);\n                break;\n            }\n            case 'clientUpdateInstantViewViewerContent': {\n                const { content } = update;\n\n                this.viewerContent = content;\n\n                this.emit('clientUpdateInstantViewViewerContent', update);\n                break;\n            }\n            case 'clientUpdatePrevInstantView': {\n                if (this.items.length <= 1) return;\n\n                this.items.pop();\n                const prevInstantView = this.items.pop();\n\n                TdLibController.clientUpdate({\n                    '@type': 'clientUpdateInstantViewContent',\n                    content: {\n                        instantView: prevInstantView\n                    }\n                });\n\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    hasPrev() {\n        return this.items.length > 1;\n    }\n\n    getCurrent() {\n        return this.items.length > 0 ? this.items[this.items.length - 1] : null;\n    }\n}\n\nconst store = new InstantViewStore();\nwindow.instantView = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\nimport { isEmptyText } from '../../../Utils/InstantView';\n\nfunction Caption(props) {\n    const { text, credit } = props;\n\n    const hasText = !isEmptyText(text);\n    const hastCredit = !isEmptyText(credit);\n    if (!hasText && !hastCredit) return null;\n\n    return (\n        <figcaption>\n            {hasText && <RichText text={text} />}\n            {hastCredit && (\n                <cite>\n                    <RichText text={credit} />\n                </cite>\n            )}\n        </figcaption>\n    );\n}\n\nCaption.propTypes = {\n    text: PropTypes.object.isRequired,\n    credit: PropTypes.object.isRequired\n};\n\nexport default Caption;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Anchor(props) {\n    return <a id={props.name} />;\n}\n\nAnchor.propTypes = {\n    name: PropTypes.string.isRequired\n};\n\nexport default Anchor;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Caption from './Caption';\nimport MediaAnimation from '../../../Components/Message/Media/Animation';\nimport { IV_PHOTO_DISPLAY_SIZE } from '../../../Constants';\n\nfunction Animation(props) {\n    const { animation, block, caption, need_autoplay, openMedia } = props;\n\n    return (\n        <figure>\n            <MediaAnimation\n                type='iv'\n                pageBlock={block}\n                animation={animation}\n                displaySize={IV_PHOTO_DISPLAY_SIZE}\n                openMedia={openMedia}\n            />\n            <Caption text={caption.text} credit={caption.credit} />\n        </figure>\n    );\n}\n\nAnimation.propTypes = {\n    block: PropTypes.object.isRequired,\n    animation: PropTypes.object,\n    caption: PropTypes.object.isRequired,\n    needAutoplay: PropTypes.bool.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default Animation;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\nimport dateFormat from '../../../Utils/Date';\nimport { isEmptyText } from '../../../Utils/InstantView';\n\nfunction AuthorDate(props) {\n    const { author, publishDate } = props;\n\n    const hasAuthor = !isEmptyText(author);\n    const hasDate = publishDate > 0;\n    if (!hasAuthor && !hasDate) return null;\n\n    const d = publishDate > 0 ? new Date(publishDate * 1000) : null;\n\n    return (\n        <address>\n            {hasAuthor && (\n                <a rel='author'>\n                    <RichText text={author} />\n                </a>\n            )}\n            {hasAuthor && hasDate && ' • '}\n            {hasDate && <time dateTime={d.toISOString()}>{dateFormat(d, 'dd mmm, yyyy')}</time>}\n        </address>\n    );\n}\n\nAuthorDate.propTypes = {\n    author: PropTypes.object,\n    publishDate: PropTypes.number\n};\n\nexport default AuthorDate;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Blockquote(props) {\n    const { text, credit } = props;\n    return (\n        <blockquote>\n            <RichText text={text} />\n            {credit && (\n                <cite>\n                    <RichText text={credit} />\n                </cite>\n            )}\n        </blockquote>\n    );\n}\n\nBlockquote.propTypes = {\n    text: PropTypes.object.isRequired,\n    credit: PropTypes.object.isRequired\n};\n\nexport default Blockquote;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withIV } from '../IVContext';\nimport Caption from './Caption';\nimport { getPageBlock } from '../../../Utils/InstantView';\n\nfunction Collage(props) {\n    const { pageBlocks, caption, iv } = props;\n\n    return (\n        <div className='collage'>\n            {pageBlocks.map((x, index) => getPageBlock(x, iv, index))}\n            <Caption text={caption.text} credit={caption.credit} />\n        </div>\n    );\n}\n\nCollage.propTypes = {\n    pageBlocks: PropTypes.array.isRequired,\n    caption: PropTypes.object.isRequired\n};\n\nexport default withIV(Collage);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withIV } from '../IVContext';\nimport { getPageBlock } from '../../../Utils/InstantView';\n\nfunction Cover(props) {\n    return getPageBlock(props.cover, props.iv);\n}\n\nCover.propTypes = {\n    cover: PropTypes.object.isRequired\n};\n\nexport default withIV(Cover);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withIV } from '../IVContext';\nimport RichText from '../RichText/RichText';\nimport { getPageBlock } from '../../../Utils/InstantView';\n\nfunction Details(props) {\n    const { header, pageBlocks, isOpen, iv } = props;\n\n    return (\n        <details open={isOpen}>\n            <summary>\n                <RichText text={header} />\n            </summary>\n            {pageBlocks.map((x, index) => getPageBlock(x, iv, index))}\n        </details>\n    );\n}\n\nDetails.propTypes = {\n    header: PropTypes.object.isRequired,\n    pageBlocks: PropTypes.array.isRequired,\n    isOpen: PropTypes.bool.isRequired\n};\n\nexport default withIV(Details);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Divider() {\n    return <hr />;\n}\n\nexport default Divider;\n","/**\n *\n * inject script to facilitate iframe resizing\n * https://github.com/davidjbradshaw/iframe-resizer\n *\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport ReactDOM from 'react-dom';\nimport { iframeResizer as iframeResizerLib } from 'iframe-resizer';\n\nclass IframeResizer extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.frameRef = React.createRef();\n    }\n\n    componentDidMount() {\n        // can't update until we have a mounted iframe\n        this.updateIframe(this.props);\n        this.resizeIframe(this.props);\n    }\n\n    componentWillUnmount() {\n        // React will remove the iframe, however we need to manually\n        // call iframe-resizer to stop its listeners\n        const frame = this.frameRef.current;\n        if (!frame) return;\n\n        const { iframeResizer } = frame;\n        if (!iframeResizer) return;\n\n        iframeResizer.removeListeners();\n    }\n\n    componentWillReceiveProps(nextProps) {\n        // can replace content if we got new props\n        this.updateIframe(nextProps);\n        this.resizeIframe(nextProps);\n    }\n\n    updateIframe = props => {\n        // has src - no injected content\n        if (props.src) return;\n        // do we have content to inject (content or children)\n        const content = props.content || props.children;\n        if (!content) return;\n        // get frame to inject into\n        const frame = this.frameRef.current;\n        if (!frame) return;\n        // verify frame document access\n        // Due to browser security, this will fail with the following error\n        //   Uncaught DOMException: Failed to read the 'contentDocument' property from 'HTMLIFrameElement':\n        //   Blocked a frame with origin \"http://<hostname>\" from accessing a cross-origin frame.\n        // resolve this by loading documents from the same domain name,\n        // or injecting HTML `content` vs. loading via `src`\n        const doc = frame.contentDocument;\n        if (!doc) return;\n        // replace iframe document content\n        if (typeof content === 'string') {\n            // assume this is a HTML block\n            //   we could send this in via REACT dangerously set HTML\n            //   but we are in an iframe anyway, already a red-headed step-child.\n            doc.open();\n            doc.write(content);\n            doc.close();\n        } else {\n            // assume this is a REACT component\n            doc.open();\n            doc.write('<div id=\"iframe-root\"></div>');\n            doc.close();\n            ReactDOM.render(content, doc.getElementById('iframe-root'));\n        }\n    };\n\n    // inject the iframe resizer \"content window\" script\n    injectIframeResizerUrl = () => {\n        if (!this.props.iframeResizerUrl) return;\n        const frame = this.frameRef.current;\n        if (!frame) return;\n        // verify frame document access\n        // Due to browser security, this will fail with the following error\n        //   Uncaught DOMException: Failed to read the 'contentDocument' property from 'HTMLIFrameElement':\n        //   Blocked a frame with origin \"http://<hostname>\" from accessing a cross-origin frame.\n        // resolve this by loading documents from the same domain name,\n        // or injecting HTML `content` vs. loading via `src`\n        const doc = frame.contentDocument;\n        if (!doc) return;\n        // where can we insert into? (fail into whatever we can find)\n        let injectTarget = null;\n        ['head', 'HEAD', 'body', 'BODY', 'div', 'DIV'].forEach(tagName => {\n            if (injectTarget) return;\n            const found = doc.getElementsByTagName(tagName);\n            if (!(found && found.length)) return;\n            injectTarget = found[0];\n        });\n        if (!injectTarget) {\n            console.error('Unable to inject iframe resizer script');\n            return;\n        }\n        const resizerScriptElement = document.createElement('script');\n        resizerScriptElement.type = 'text/javascript';\n        resizerScriptElement.src = this.props.iframeResizerUrl;\n        injectTarget.appendChild(resizerScriptElement);\n    };\n\n    onLoad = () => {\n        this.injectIframeResizerUrl();\n        // DISABLED because it's causing a loading loop :(\n        // if (this.props.onIframeLoaded) this.props.onIframeLoaded();\n    };\n\n    resizeIframe = props => {\n        const frame = this.frameRef.current;\n        if (!frame) return;\n        if (props.iframeResizerEnable) {\n            iframeResizerLib(props.iframeResizerOptions, frame);\n        }\n    };\n\n    render() {\n        const { src, id, frameBorder, className, style } = this.props;\n        return (\n            <iframe\n                ref={this.frameRef}\n                src={src}\n                id={id}\n                frameBorder={frameBorder}\n                className={className}\n                style={style}\n                onLoad={this.onLoad}\n            />\n        );\n    }\n}\nIframeResizer.propTypes = {\n    // iframe content/document\n    // option 1. content of HTML to load in the iframe\n    content: PropTypes.oneOfType([PropTypes.string, PropTypes.element]),\n    // option 2. src to a URL to load in the iframe\n    src: PropTypes.string,\n    // iframe-resizer controls and helpers\n    iframeResizerEnable: PropTypes.bool,\n    iframeResizerOptions: PropTypes.object,\n    iframeResizerUrl: PropTypes.oneOfType([\n        PropTypes.string, // URL to inject\n        PropTypes.bool // false = disable inject\n    ]),\n    // misc props to pass through to iframe\n    id: PropTypes.string,\n    frameBorder: PropTypes.number,\n    className: PropTypes.string,\n    style: PropTypes.object\n    // optional extra callback when iframe is loaded\n    // onIframeLoaded: PropTypes.func,\n};\nIframeResizer.defaultProps = {\n    // resize iframe\n    iframeResizerEnable: true,\n    iframeResizerOptions: {\n        // log: true,\n        // autoResize: true,\n        // checkOrigin: false,\n        // resizeFrom: 'parent',\n        // heightCalculationMethod: 'max',\n        // initCallback: () => { console.log('ready!'); },\n        // resizedCallback: () => { console.log('resized!'); },\n    },\n    iframeResizerUrl: 'https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/3.5.8/iframeResizer.contentWindow.min.js',\n    // misc props to pass through to iframe\n    frameBorder: 0,\n    style: {\n        width: '100%',\n        minHeight: 20\n    }\n};\n\nexport default IframeResizer;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport ReactIframeResizer from '../../Additional/IframeResizer';\nimport Caption from './Caption';\n\nclass Embedded extends React.Component {\n    state = {};\n\n    static getDerivedStateFromProps(props, state) {\n        if (props.url !== state.prevUrl || props.html !== state.prevHtml) {\n            return {\n                url: null,\n                html: null,\n                prevUrl: props.url,\n                prevHtml: props.html\n            };\n        }\n\n        return null;\n    }\n\n    componentDidMount() {\n        this.setIframeSource();\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        const { url, html } = this.props;\n\n        if (url !== prevProps.url || html !== prevProps.html) {\n            this.setIframeSource();\n        }\n    }\n\n    setIframeSource() {\n        const { url, html } = this.props;\n\n        this.setState({\n            url,\n            html\n        });\n    }\n\n    render() {\n        const { url, html } = this.state;\n        const { width, height, caption, isFullWidth, allowScrolling } = this.props;\n\n        const options = {\n            scrolling: allowScrolling\n        };\n\n        const hasWidthHeight = width > 0 && height > 0;\n        const hasSource = Boolean(url) || Boolean(html);\n\n        return (\n            <figure>\n                {hasSource && (\n                    <>\n                        {hasWidthHeight ? (\n                            <iframe\n                                src={url ? url : null}\n                                srcDoc={url ? null : html}\n                                width={width > 0 ? width : null}\n                                height={height > 0 ? height : null}\n                                allowFullScreen={isFullWidth}\n                                scrolling={allowScrolling ? 'auto' : 'no'}\n                                frameBorder={0}\n                            />\n                        ) : (\n                            <ReactIframeResizer\n                                content={html}\n                                src={url}\n                                iframeResizerOptions={options}\n                                style={{ width: '100%' }}\n                            />\n                        )}\n                    </>\n                )}\n                <Caption text={caption.text} credit={caption.credit} />\n            </figure>\n        );\n    }\n}\n\nEmbedded.propTypes = {\n    url: PropTypes.string.isRequired,\n    html: PropTypes.string.isRequired,\n    posterPhoto: PropTypes.object,\n    width: PropTypes.number.isRequired,\n    height: PropTypes.number.isRequired,\n    caption: PropTypes.object.isRequired,\n    isFullWidth: PropTypes.bool.isRequired,\n    allowScrolling: PropTypes.bool.isRequired\n};\n\nexport default Embedded;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withIV } from '../IVContext';\nimport Caption from './Caption';\nimport { getPageBlock } from '../../../Utils/InstantView';\nimport AuthorDate from './AuthorDate';\nimport RichText from '../RichText/RichText';\n\nfunction EmbeddedPost(props) {\n    const { url, author, authorPhoto, date, pageBlocks, caption, iv } = props;\n\n    return (\n        <blockquote>\n            <figure>\n                {Boolean(author) && <h3>{author}</h3>}\n                <AuthorDate author={null} publishDate={date} />\n                {pageBlocks.map((x, index) => getPageBlock(x, iv, index))}\n                <Caption text={caption.text} credit={caption.credit} />\n            </figure>\n        </blockquote>\n    );\n}\n\nEmbeddedPost.propTypes = {\n    url: PropTypes.string.isRequired,\n    author: PropTypes.string.isRequired,\n    authorPhoto: PropTypes.object,\n    date: PropTypes.number.isRequired,\n    pageBlocks: PropTypes.array.isRequired,\n    caption: PropTypes.object.isRequired\n};\n\nexport default withIV(EmbeddedPost);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport './ErrorHandler.css';\n\nclass ErrorHandler extends React.Component {\n    state = {\n        error: null,\n        errorInfo: null\n    };\n\n    componentDidCatch(error, errorInfo) {\n        this.setState({ error, errorInfo });\n    }\n\n    render() {\n        const { children } = this.props;\n        const { error, errorInfo } = this.state;\n        if (error || errorInfo) {\n            return (\n                <div className='error-handler'>\n                    <span>\n                        <pre>\n                            {`${error.name}: ${error.message}`}\n                            {errorInfo.componentStack}\n                        </pre>\n                    </span>\n                </div>\n            );\n        }\n\n        return children;\n    }\n}\n\nexport default ErrorHandler;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Footer(props) {\n    return (\n        <footer>\n            <RichText text={props.footer} />\n        </footer>\n    );\n}\n\nFooter.propTypes = {\n    footer: PropTypes.object.isRequired\n};\n\nexport default Footer;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Header(props) {\n    return (\n        <h3>\n            <RichText text={props.header} />\n        </h3>\n    );\n}\n\nHeader.propTypes = {\n    header: PropTypes.object.isRequired\n};\n\nexport default Header;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Kicker(props) {\n    const { kicker } = props;\n    return (\n        <h6 className='kicker'>\n            <RichText text={kicker} />\n        </h6>\n    );\n}\n\nKicker.propTypes = {\n    kicker: PropTypes.object.isRequired\n};\n\nexport default Kicker;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withIV } from '../IVContext';\nimport { getPageBlock } from '../../../Utils/InstantView';\n\nfunction ListItem(props) {\n    return <li data-before={props.label}>{props.pageBlocks.map((x, index) => getPageBlock(x, props.iv, index))}</li>;\n}\n\nListItem.propTypes = {\n    label: PropTypes.string.isRequired,\n    pageBlocks: PropTypes.array.isRequired\n};\n\nexport default withIV(ListItem);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport ListItem from './ListItem';\n\nfunction List(props) {\n    return (\n        <ul>\n            {props.items.map((x, index) => (\n                <ListItem key={index} label={x.label} pageBlocks={x.page_blocks} />\n            ))}\n        </ul>\n    );\n}\n\nList.propTypes = {\n    items: PropTypes.array.isRequired\n};\n\nexport default List;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Paragraph(props) {\n    return (\n        <p>\n            <RichText text={props.text} />\n        </p>\n    );\n}\n\nParagraph.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default Paragraph;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Caption from './Caption';\nimport MediaPhoto from '../../../Components/Message/Media/Photo';\nimport { IV_PHOTO_DISPLAY_SIZE, IV_PHOTO_SIZE } from '../../../Constants';\n\nfunction Photo(props) {\n    const { photo, caption, url, openMedia } = props;\n\n    return (\n        <figure>\n            <MediaPhoto photo={photo} size={IV_PHOTO_SIZE} displaySize={IV_PHOTO_DISPLAY_SIZE} openMedia={openMedia} />\n            <Caption text={caption.text} credit={caption.credit} />\n        </figure>\n    );\n}\n\nPhoto.propTypes = {\n    photo: PropTypes.object,\n    caption: PropTypes.object.isRequired,\n    url: PropTypes.string.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default Photo;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Preformatted(props) {\n    return (\n        <pre>\n            <RichText text={props.text} />\n        </pre>\n    );\n}\n\nPreformatted.propTypes = {\n    text: PropTypes.object.isRequired,\n    language: PropTypes.string.isRequired\n};\n\nexport default Preformatted;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction PullQuote(props) {\n    const { text, credit } = props;\n    return (\n        <aside>\n            <RichText text={text} />\n            {credit && (\n                <cite>\n                    <RichText text={credit} />\n                </cite>\n            )}\n        </aside>\n    );\n}\n\nPullQuote.propTypes = {\n    text: PropTypes.object.isRequired,\n    credit: PropTypes.object.isRequired\n};\n\nPullQuote.propTypes = {};\n\nexport default PullQuote;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport SafeLink from '../../Additional/SafeLink';\nimport dateFormat from '../../../Utils/Date';\nimport TdLibController from '../../../Controllers/TdLibController';\n\nclass RelatedArticle extends React.Component {\n    handleClick = event => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        const { url } = this.props;\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateInstantViewUrl',\n            url\n        });\n    };\n\n    render() {\n        const { author, description, publishDate, title, url } = this.props;\n\n        const d = publishDate > 0 ? new Date(publishDate * 1000) : null;\n        const hasAuthorDateSeparator = author && d;\n        const hasAuthorDate = d || author;\n\n        return (\n            <li>\n                <SafeLink url={url} onClick={this.handleClick}>\n                    {title}\n                </SafeLink>\n                {hasAuthorDate && (\n                    <address>\n                        {author}\n                        {hasAuthorDateSeparator && ' • '}\n                        {d && <time dateTime={d.toISOString()}>{dateFormat(d, 'dd mmm, yyyy')}</time>}\n                    </address>\n                )}\n                {/*{ description && (*/}\n                {/*    <div>{description}</div>*/}\n                {/*)}*/}\n            </li>\n        );\n    }\n}\n\nRelatedArticle.propTypes = {\n    url: PropTypes.string.isRequired,\n    title: PropTypes.string.isRequired,\n    description: PropTypes.string.isRequired,\n    photo: PropTypes.object,\n    author: PropTypes.string.isRequired,\n    publishDate: PropTypes.number.isRequired\n};\n\nexport default RelatedArticle;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RelatedArticle from './RelatedArticle';\nimport RichText from '../RichText/RichText';\n\nfunction RelatedArticles(props) {\n    return (\n        <>\n            <h4>\n                <RichText text={props.header} />\n            </h4>\n            <ul className='related-articles'>\n                {props.articles.map(x => (\n                    <RelatedArticle\n                        key={x.url}\n                        url={x.url}\n                        title={x.title}\n                        description={x.description}\n                        photo={x.photo}\n                        author={x.author}\n                        publishDate={x.publish_date}\n                    />\n                ))}\n            </ul>\n        </>\n    );\n}\n\nRelatedArticles.propTypes = {\n    header: PropTypes.object.isRequired,\n    articles: PropTypes.array.isRequired\n};\n\nexport default RelatedArticles;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withIV } from '../IVContext';\nimport Caption from './Caption';\nimport { getPageBlock } from '../../../Utils/InstantView';\n\nfunction Slideshow(props) {\n    const { pageBlocks, caption, iv } = props;\n\n    return (\n        <div className='slideshow'>\n            {pageBlocks.map((x, index) => getPageBlock(x, iv, index))}\n            <Caption text={caption.text} credit={caption.credit} />\n        </div>\n    );\n}\n\nSlideshow.propTypes = {\n    pageBlocks: PropTypes.array.isRequired,\n    caption: PropTypes.object.isRequired\n};\n\nexport default withIV(Slideshow);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Subheader(props) {\n    return (\n        <h4>\n            <RichText text={props.subheader} />\n        </h4>\n    );\n}\n\nSubheader.propTypes = {\n    subheader: PropTypes.object.isRequired\n};\n\nexport default Subheader;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Subtitle(props) {\n    return (\n        <h2>\n            <RichText text={props.subtitle} />\n        </h2>\n    );\n}\n\nSubtitle.propTypes = {\n    subtitle: PropTypes.object.isRequired\n};\n\nexport default Subtitle;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\n\nfunction Title(props) {\n    return (\n        <h1>\n            <RichText text={props.title} />\n        </h1>\n    );\n}\n\nTitle.propTypes = {\n    title: PropTypes.object.isRequired\n};\n\nexport default Title;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Bold(props) {\n    return (\n        <b>\n            <RichText text={props.text} />\n        </b>\n    );\n}\n\nBold.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default Bold;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction EmailAddress(props) {\n    return (\n        <a href={`mailto:${props.emailAddress}`}>\n            <RichText text={props.text} />\n        </a>\n    );\n}\n\nEmailAddress.propTypes = {\n    emailAddress: PropTypes.string.isRequired,\n    text: PropTypes.object.isRequired\n};\n\nexport default EmailAddress;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Fixed(props) {\n    return (\n        <code>\n            <RichText text={props.text} />\n        </code>\n    );\n}\n\nFixed.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default Fixed;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { getSrc } from '../../../Utils/File';\nimport FileStore from '../../../Stores/FileStore';\n\nclass Icon extends React.Component {\n    componentDidMount() {\n        FileStore.on('clientUpdateDocumentThumbnailBlob', this.onClientUpdateDocumentThumbnailBlob);\n        FileStore.on('clientUpdateDocumentBlob', this.onClientUpdateDocumentBlob);\n    }\n\n    componentWillUnmount() {\n        FileStore.off('clientUpdateDocumentThumbnailBlob', this.onClientUpdateDocumentThumbnailBlob);\n        FileStore.off('clientUpdateDocumentBlob', this.onClientUpdateDocumentBlob);\n    }\n\n    onClientUpdateDocumentThumbnailBlob = update => {\n        const { document } = this.props;\n        if (!document) return;\n\n        const { thumbnail } = document;\n        if (!thumbnail) return;\n\n        const { file } = thumbnail;\n        if (!file) return;\n\n        const { fileId } = update;\n\n        if (file.id !== fileId) {\n            return;\n        }\n\n        this.forceUpdate();\n    };\n\n    onClientUpdateDocumentBlob = update => {\n        const { document } = this.props;\n        if (!document) return;\n\n        const file = document.document;\n        if (!file) return;\n\n        const { fileId } = update;\n\n        if (file.id !== fileId) {\n            return;\n        }\n\n        this.forceUpdate();\n    };\n\n    emptyPlaceholderSrc(width, height) {\n        return `data:image/svg+xml,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 ${width} ${height}\"%3E%3C/svg%3E`;\n    }\n\n    render() {\n        const { document, height, width } = this.props;\n        if (!document) return null;\n\n        const { thumbnail, document: file } = document;\n        const thumbnailSrc = getSrc(thumbnail ? thumbnail.file : null);\n        const src = getSrc(file);\n\n        return (\n            <img\n                src={src || thumbnailSrc || this.emptyPlaceholderSrc(1, 1)}\n                width={width > 0 ? width : null}\n                height={height > 0 ? height : null}\n                draggable={false}\n                alt=''\n            />\n        );\n    }\n}\n\nIcon.propTypes = {\n    document: PropTypes.object.isRequired,\n    height: PropTypes.number.isRequired,\n    width: PropTypes.number.isRequired\n};\n\nexport default Icon;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Italic(props) {\n    return (\n        <i>\n            <RichText text={props.text} />\n        </i>\n    );\n}\n\nItalic.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default Italic;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Marked(props) {\n    return (\n        <mark>\n            <RichText text={props.text} />\n        </mark>\n    );\n}\n\nMarked.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default Marked;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction PhoneNumber(props) {\n    return (\n        <a href={`tel:${props.phoneNumber}`}>\n            <RichText text={props.text} />\n        </a>\n    );\n}\n\nPhoneNumber.propTypes = {\n    phoneNumber: PropTypes.string.isRequired,\n    text: PropTypes.object.isRequired\n};\n\nexport default PhoneNumber;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction Plain(props) {\n    return props.text;\n}\n\nPlain.propTypes = {\n    text: PropTypes.string.isRequired\n};\n\nexport default Plain;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Strikethrough(props) {\n    return (\n        <del>\n            <RichText text={props.text} />\n        </del>\n    );\n}\n\nStrikethrough.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default Strikethrough;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Subscript(props) {\n    return (\n        <sub>\n            <RichText text={props.text} />\n        </sub>\n    );\n}\n\nSubscript.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default Subscript;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Superscript(props) {\n    return (\n        <sup>\n            <RichText text={props.text} />\n        </sup>\n    );\n}\n\nSuperscript.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default Superscript;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Anchor(props) {\n    const { name, text } = props;\n\n    return (\n        <a id={name}>\n            {text && <RichText text={text} />}\n        </a>\n    );\n}\n\nAnchor.propTypes = {\n    name: PropTypes.string.isRequired,\n    text: PropTypes.object\n};\n\nexport default Anchor;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Texts(props) {\n    return (\n        <>\n            {props.texts.map((x, index) => (\n                <RichText key={index} text={x} />\n            ))}\n        </>\n    );\n}\n\nTexts.propTypes = {\n    texts: PropTypes.arrayOf(PropTypes.object).isRequired\n};\n\nexport default Texts;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\n\nfunction Underline(props) {\n    return (\n        <ins>\n            <RichText text={props.text} />\n        </ins>\n    );\n}\n\nUnderline.propTypes = {\n    text: PropTypes.object.isRequired\n};\n\nexport default Underline;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from './RichText';\nimport SafeLink from '../../Additional/SafeLink';\nimport TdLibController from '../../../Controllers/TdLibController';\n\nclass Url extends React.Component {\n    handleClick = event => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        const { url } = this.props;\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateInstantViewUrl',\n            url\n        });\n    };\n\n    render() {\n        const { text, url } = this.props;\n\n        return (\n            <SafeLink url={url} onClick={this.handleClick}>\n                <RichText text={text} />\n            </SafeLink>\n        );\n    }\n}\n\nUrl.propTypes = {\n    text: PropTypes.object.isRequired,\n    url: PropTypes.string.isRequired\n};\n\nexport default Url;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withIV } from '../IVContext';\nimport RichText from '../RichText/RichText';\nimport { getPageBlock, isEmptyText } from '../../../Utils/InstantView';\n\nfunction Table(props) {\n    const { caption, cells, isBordered, isStriped, iv } = props;\n\n    return (\n        <table striped={isStriped ? '' : null} border={isBordered ? 1 : 0}>\n            {!isEmptyText(caption) && (\n                <caption>\n                    <RichText text={caption} />\n                </caption>\n            )}\n            <tbody>\n                {cells.map((row, rowIndex) => {\n                    return <tr key={rowIndex}>{row.map((x, index) => getPageBlock(x, iv, index))}</tr>;\n                })}\n            </tbody>\n        </table>\n    );\n}\n\nTable.propTypes = {\n    caption: PropTypes.object.isRequired,\n    cells: PropTypes.array.isRequired,\n    isBordered: PropTypes.bool.isRequired,\n    isStriped: PropTypes.bool.isRequired\n};\n\nexport default withIV(Table);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport RichText from '../RichText/RichText';\nimport { getHorizontalAlignment, getVerticalAlignment, isEmptyText } from '../../../Utils/InstantView';\n\nfunction TableCell(props) {\n    const { text, isHeader, colspan, rowspan, align, valign } = props;\n    if (isEmptyText(text)) return null;\n\n    const attributes = {\n        colSpan: colspan,\n        rowSpan: rowspan,\n        align: getHorizontalAlignment(align),\n        valign: getVerticalAlignment(valign)\n    };\n\n    const content = <RichText text={text} />;\n\n    return isHeader ? <th {...attributes}>{content}</th> : <td {...attributes}>{content}</td>;\n}\n\nTableCell.propTypes = {\n    text: PropTypes.object.isRequired,\n    isHeader: PropTypes.bool.isRequired,\n    colspan: PropTypes.number.isRequired,\n    rowspan: PropTypes.number.isRequired,\n    align: PropTypes.object.isRequired,\n    valign: PropTypes.object.isRequired\n};\n\nexport default TableCell;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Caption from './Caption';\nimport Location from '../../Message/Media/Location';\nimport { IV_LOCATION_HEIGHT, IV_LOCATION_WIDTH } from '../../../Constants';\n\nfunction Map(props) {\n    const { location, caption } = props;\n\n    return (\n        <figure>\n            <Location width={IV_LOCATION_WIDTH} height={IV_LOCATION_HEIGHT} location={location} />\n            <Caption text={caption.text} credit={caption.credit} />\n        </figure>\n    );\n}\n\nMap.propTypes = {\n    location: PropTypes.object.isRequired,\n    zoom: PropTypes.number.isRequired,\n    width: PropTypes.number.isRequired,\n    height: PropTypes.number.isRequired,\n    caption: PropTypes.object.isRequired\n};\n\nexport default Map;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport MediaAudio from '../../Message/Media/Audio';\nimport Caption from './Caption';\n\nfunction Audio(props) {\n    const { audio, block, caption, openMedia } = props;\n\n    return (\n        <figure>\n            <MediaAudio block={block} audio={audio} openMedia={openMedia} />\n            <Caption text={caption.text} credit={caption.credit} />\n        </figure>\n    );\n}\n\nAudio.propTypes = {\n    block: PropTypes.object.isRequired,\n    audio: PropTypes.object,\n    caption: PropTypes.object.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default Audio;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction ChatLink(props) {\n    return <div />;\n}\n\nChatLink.propTypes = {\n    title: PropTypes.string.isRequired,\n    photo: PropTypes.object,\n    username: PropTypes.string.isRequired\n};\n\nexport default ChatLink;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Caption from './Caption';\nimport MediaVideo from '../../../Components/Message/Media/Video';\nimport { IV_PHOTO_DISPLAY_SIZE } from '../../../Constants';\n\nfunction Video(props) {\n    const { video, caption, needAutoplay, isLooped, openMedia } = props;\n\n    return (\n        <figure>\n            <MediaVideo video={video} displaySize={IV_PHOTO_DISPLAY_SIZE} openMedia={openMedia} />\n            <Caption text={caption.text} credit={caption.credit} />\n        </figure>\n    );\n}\n\nVideo.propTypes = {\n    video: PropTypes.object,\n    caption: PropTypes.object.isRequired,\n    needAutoplay: PropTypes.bool.isRequired,\n    isLooped: PropTypes.bool.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default Video;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport MediaVoiceNote from '../../Message/Media/VoiceNote';\nimport Caption from './Caption';\n\nfunction VoiceNote(props) {\n    const { voiceNote, block, caption, openMedia } = props;\n\n    return (\n        <figure>\n            <MediaVoiceNote block={block} voiceNote={voiceNote} openMedia={openMedia} />\n            <Caption text={caption.text} credit={caption.credit} />\n        </figure>\n    );\n}\n\nVoiceNote.propTypes = {\n    block: PropTypes.object.isRequired,\n    voiceNote: PropTypes.object,\n    caption: PropTypes.object.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default VoiceNote;","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport Anchor from '../Components/InstantView/Blocks/Anchor';\nimport Animation from '../Components/InstantView/Blocks/Animation';\nimport AuthorDate from '../Components/InstantView/Blocks/AuthorDate';\nimport BlockQuote from '../Components/InstantView/Blocks/Blockquote';\nimport Collage from '../Components/InstantView/Blocks/Collage';\nimport Cover from '../Components/InstantView/Blocks/Cover';\nimport Details from '../Components/InstantView/Blocks/Details';\nimport Divider from '../Components/InstantView/Blocks/Divider';\nimport Embedded from '../Components/InstantView/Blocks/Embedded';\nimport EmbeddedPost from '../Components/InstantView/Blocks/EmbeddedPost';\nimport ErrorHandler from '../Components/InstantView/Blocks/ErrorHandler';\nimport Footer from '../Components/InstantView/Blocks/Footer';\nimport Header from '../Components/InstantView/Blocks/Header';\nimport Kicker from '../Components/InstantView/Blocks/Kicker';\nimport List from '../Components/InstantView/Blocks/List';\nimport ListItem from '../Components/InstantView/Blocks/ListItem';\nimport Paragraph from '../Components/InstantView/Blocks/Paragraph';\nimport Photo from '../Components/InstantView/Blocks/Photo';\nimport Preformatted from '../Components/InstantView/Blocks/Preformatted';\nimport PullQuote from '../Components/InstantView/Blocks/PullQuote';\nimport RelatedArticle from '../Components/InstantView/Blocks/RelatedArticle';\nimport RelatedArticles from '../Components/InstantView/Blocks/RelatedArticles';\nimport Slideshow from '../Components/InstantView/Blocks/Slideshow';\nimport Subheader from '../Components/InstantView/Blocks/Subheader';\nimport Subtitle from '../Components/InstantView/Blocks/Subtitle';\nimport Title from '../Components/InstantView/Blocks/Title';\nimport Bold from '../Components/InstantView/RichText/Bold';\nimport EmailAddress from '../Components/InstantView/RichText/EmailAddress';\nimport Fixed from '../Components/InstantView/RichText/Fixed';\nimport Icon from '../Components/InstantView/RichText/Icon';\nimport Italic from '../Components/InstantView/RichText/Italic';\nimport Marked from '../Components/InstantView/RichText/Marked';\nimport PhoneNumber from '../Components/InstantView/RichText/PhoneNumber';\nimport Plain from '../Components/InstantView/RichText/Plain';\nimport Strikethrough from '../Components/InstantView/RichText/Strikethrough';\nimport Subscript from '../Components/InstantView/RichText/Subscript';\nimport Superscript from '../Components/InstantView/RichText/Superscript';\nimport TextAnchor from '../Components/InstantView/RichText/Anchor';\nimport Texts from '../Components/InstantView/RichText/Texts';\nimport Underline from '../Components/InstantView/RichText/Underline';\nimport Url from '../Components/InstantView/RichText/Url';\nimport Table from '../Components/InstantView/Blocks/Table';\nimport TableCell from '../Components/InstantView/Blocks/TableCell';\nimport Map from '../Components/InstantView/Blocks/Map';\nimport Audio from '../Components/InstantView/Blocks/Audio';\nimport ChatLink from '../Components/InstantView/Blocks/ChatLink';\nimport Video from '../Components/InstantView/Blocks/Video';\nimport VoiceNote from '../Components/InstantView/Blocks/VoiceNote';\nimport { download, supportsStreaming } from './File';\nimport { setInstantViewViewerContent } from '../Actions/Client';\nimport FileStore from '../Stores/FileStore';\nimport TdLibController from '../Controllers/TdLibController';\n\nexport function getBlockAudio(block) {\n    if (!block) return null;\n    if (block['@type'] !== 'pageBlockAudio') return null;\n\n    return block.audio;\n}\n\nexport function openInstantViewMedia(media, caption, block, instantView, fileCancel) {\n    // console.log('[IV] openIVMedia', media);\n\n    if (!media) return;\n\n    const chatId = 0;\n    const messageId = 0;\n\n    switch (media['@type']) {\n        case 'animation': {\n            let { animation: file } = media;\n            if (!file) return;\n\n            file = FileStore.get(file.id) || file;\n            if (fileCancel && file.local.is_downloading_active) {\n                FileStore.cancelGetRemoteFile(file.id, media);\n                return;\n            } else if (fileCancel && file.remote.is_uploading_active) {\n                FileStore.cancelUploadFile(file.id, media);\n                return;\n            } else {\n                download(file, media, () => FileStore.updateAnimationBlob(chatId, messageId, file.id));\n            }\n\n            setInstantViewViewerContent({\n                media,\n                caption,\n                block,\n                instantView\n            });\n            break;\n        }\n        case 'audio': {\n            let { audio: file } = media;\n            if (!file) return;\n\n            file = FileStore.get(file.id) || file;\n            if (fileCancel && file.local.is_downloading_active && !supportsStreaming()) {\n                FileStore.cancelGetRemoteFile(file.id, media);\n                return;\n            } else if (fileCancel && file.remote.is_uploading_active) {\n                FileStore.cancelUploadFile(file.id, media);\n                return;\n            } else {\n                if (!supportsStreaming()) {\n                    download(file, media, () => FileStore.updateAudioBlob(chatId, messageId, file.id));\n                }\n            }\n\n            TdLibController.clientUpdate({\n                '@type': 'clientUpdateMediaActive',\n                source: {\n                    '@type': 'instantViewSource',\n                    instantView,\n                    block\n                }\n            });\n            break;\n        }\n        case 'photo': {\n            setInstantViewViewerContent({\n                media,\n                caption,\n                block,\n                instantView\n            });\n            break;\n        }\n        case 'video': {\n            let { video: file } = media;\n            if (!file) return;\n\n            file = FileStore.get(file.id) || file;\n            if (fileCancel && file.local.is_downloading_active) {\n                FileStore.cancelGetRemoteFile(file.id, media);\n                return;\n            } else if (fileCancel && file.remote.is_uploading_active) {\n                FileStore.cancelUploadFile(file.id, media);\n                return;\n            } else {\n                download(file, media, () => FileStore.updateVideoBlob(chatId, messageId, file.id));\n            }\n\n            setInstantViewViewerContent({\n                media,\n                caption,\n                block,\n                instantView\n            });\n            break;\n        }\n        case 'voiceNote': {\n            let { voice: file } = media;\n            if (!file) return;\n\n            file = FileStore.get(file.id) || file;\n            if (fileCancel && file.local.is_downloading_active) {\n                FileStore.cancelGetRemoteFile(file.id, media);\n                return;\n            } else if (fileCancel && file.remote.is_uploading_active) {\n                FileStore.cancelUploadFile(file.id, media);\n                return;\n            } else {\n                download(file, media, () => FileStore.updateVoiceNoteBlob(chatId, messageId, file.id));\n            }\n\n            TdLibController.clientUpdate({\n                '@type': 'clientUpdateMediaActive',\n                source: {\n                    '@type': 'instantViewSource',\n                    instantView,\n                    block\n                }\n            });\n            break;\n        }\n    }\n}\n\nexport function getPageBlock(block, iv, key = undefined, ref = null) {\n    if (!block) return null;\n\n    let element = null;\n    switch (block['@type']) {\n        case 'pageBlockAnchor': {\n            element = <Anchor name={block.name} />;\n            break;\n        }\n        case 'pageBlockAnimation': {\n            element = (\n                <Animation\n                    block={block}\n                    caption={block.caption}\n                    animation={block.animation}\n                    needAutoplay={block.need_autoplay}\n                    openMedia={() => openInstantViewMedia(block.animation, block.caption, block, iv, true)}\n                />\n            );\n            break;\n        }\n        case 'pageBlockAudio': {\n            element = (\n                <Audio\n                    block={block}\n                    caption={block.caption}\n                    audio={block.audio}\n                    openMedia={() => openInstantViewMedia(block.audio, block.caption, block, iv, true)}\n                />\n            );\n            break;\n        }\n        case 'pageBlockAuthorDate': {\n            element = <AuthorDate author={block.author} publishDate={block.publish_date} />;\n            break;\n        }\n        case 'pageBlockBlockQuote': {\n            element = <BlockQuote credit={block.credit} text={block.text} />;\n            break;\n        }\n        case 'pageBlockCollage': {\n            element = <Collage pageBlocks={block.page_blocks} caption={block.caption} />;\n            break;\n        }\n        case 'pageBlockChatLink': {\n            element = <ChatLink title={block.title} photo={block.photo} username={block.username} />;\n            break;\n        }\n        case 'pageBlockCover': {\n            element = <Cover cover={block.cover} />;\n            break;\n        }\n        case 'pageBlockDetails': {\n            element = <Details header={block.header} pageBlocks={block.page_blocks} isOpen={block.is_open} />;\n            break;\n        }\n        case 'pageBlockDivider': {\n            element = <Divider />;\n            break;\n        }\n        case 'pageBlockEmbedded': {\n            element = (\n                <Embedded\n                    url={block.url}\n                    html={block.html}\n                    posterPhoto={block.poster_photo}\n                    width={block.width}\n                    height={block.height}\n                    caption={block.caption}\n                    isFullWidth={block.is_full_width}\n                    allowScrolling={block.allow_scrolling}\n                />\n            );\n            break;\n        }\n        case 'pageBlockEmbeddedPost': {\n            element = (\n                <EmbeddedPost\n                    url={block.url}\n                    author={block.author}\n                    authorPhoto={block.author_photo}\n                    date={block.date}\n                    pageBlocks={block.page_blocks}\n                    caption={block.caption}\n                />\n            );\n            break;\n        }\n        case 'pageBlockFooter': {\n            element = <Footer footer={block.footer} />;\n            break;\n        }\n        case 'pageBlockHeader': {\n            element = <Header header={block.header} />;\n            break;\n        }\n        case 'pageBlockKicker': {\n            element = <Kicker kicker={block.kicker} />;\n            break;\n        }\n        case 'pageBlockList': {\n            element = <List items={block.items} />;\n            break;\n        }\n        case 'pageBlockListItem': {\n            element = <ListItem label={block.label} pageBlocks={block.page_blocks} />;\n            break;\n        }\n        case 'pageBlockMap': {\n            element = (\n                <Map\n                    location={block.location}\n                    zoom={block.zoom}\n                    width={block.width}\n                    height={block.height}\n                    caption={block.caption}\n                />\n            );\n            break;\n        }\n        case 'pageBlockParagraph': {\n            element = <Paragraph text={block.text} />;\n            break;\n        }\n        case 'pageBlockPhoto': {\n            element = (\n                <Photo\n                    caption={block.caption}\n                    photo={block.photo}\n                    url={block.url}\n                    openMedia={() => openInstantViewMedia(block.photo, block.caption, block, iv, true)}\n                />\n            );\n            break;\n        }\n        case 'pageBlockPreformatted': {\n            element = <Preformatted text={block.text} language={block.language} />;\n            break;\n        }\n        case 'pageBlockPullQuote': {\n            element = <PullQuote credit={block.credit} text={block.text} />;\n            break;\n        }\n        case 'pageBlockRelatedArticle': {\n            element = (\n                <RelatedArticle\n                    url={block.url}\n                    title={block.title}\n                    description={block.description}\n                    photo={block.photo}\n                    author={block.author}\n                    publishDate={block.publish_date}\n                />\n            );\n            break;\n        }\n        case 'pageBlockRelatedArticles': {\n            element = <RelatedArticles header={block.header} articles={block.articles} />;\n            break;\n        }\n        case 'pageBlockSlideshow': {\n            element = <Slideshow pageBlocks={block.page_blocks} caption={block.caption} />;\n            break;\n        }\n        case 'pageBlockSubheader': {\n            element = <Subheader subheader={block.subheader} />;\n            break;\n        }\n        case 'pageBlockSubtitle': {\n            element = <Subtitle subtitle={block.subtitle} />;\n            break;\n        }\n        case 'pageBlockTable': {\n            element = (\n                <Table\n                    caption={block.caption}\n                    cells={block.cells}\n                    isBordered={block.is_bordered}\n                    isStriped={block.is_striped}\n                />\n            );\n            break;\n        }\n        case 'pageBlockTableCell': {\n            element = (\n                <TableCell\n                    text={block.text}\n                    isHeader={block.is_header}\n                    colspan={block.colspan}\n                    rowspan={block.rowspan}\n                    align={block.align}\n                    valign={block.valign}\n                />\n            );\n            break;\n        }\n        case 'pageBlockTitle': {\n            element = <Title title={block.title} />;\n            break;\n        }\n        case 'pageBlockVideo': {\n            element = (\n                <Video\n                    block={block}\n                    caption={block.caption}\n                    video={block.video}\n                    needAutoplay={block.need_autoplay}\n                    isLooped={block.is_looped}\n                    openMedia={() => openInstantViewMedia(block.video, block.caption, block, iv, true)}\n                />\n            );\n            break;\n        }\n        case 'pageBlockVoiceNote': {\n            element = (\n                <VoiceNote\n                    block={block}\n                    caption={block.caption}\n                    voiceNote={block.voice_note}\n                    openMedia={() => openInstantViewMedia(block.voice_note, block.caption, block, iv, true)}\n                />\n            );\n            break;\n        }\n        default: {\n            element = <div>{`[${block['@type']}]`}</div>;\n            break;\n        }\n    }\n\n    return <ErrorHandler key={key} ref={ref}>{element}</ErrorHandler>;\n}\n\nexport function getRichText(richText) {\n    if (!richText) {\n        return null;\n    }\n\n    if (richText instanceof String) {\n        return richText;\n    }\n\n    switch (richText['@type']) {\n        case 'richTextAnchor': {\n            const { name, text } = richText;\n\n            return <TextAnchor text={text} name={name} />;\n        }\n        case 'richTextBold': {\n            const { text } = richText;\n\n            return <Bold text={text} />;\n        }\n        case 'richTextEmailAddress': {\n            const { email_address, text } = richText;\n\n            return <EmailAddress emailAddress={email_address} text={text} />;\n        }\n        case 'richTextFixed': {\n            const { text } = richText;\n\n            return <Fixed text={text} />;\n        }\n        case 'richTextIcon': {\n            const { document, height, width } = richText;\n\n            return <Icon document={document} height={height} width={width} />;\n        }\n        case 'richTextItalic': {\n            const { text } = richText;\n\n            return <Italic text={text} />;\n        }\n        case 'richTextMarked': {\n            const { text } = richText;\n\n            return <Marked text={text} />;\n        }\n        case 'richTextPhoneNumber': {\n            const { phone_number, text } = richText;\n\n            return <PhoneNumber phoneNumber={phone_number} text={text} />;\n        }\n        case 'richTextPlain': {\n            const { text } = richText;\n\n            return <Plain text={text} />;\n        }\n        case 'richTextStrikethrough': {\n            const { text } = richText;\n\n            return <Strikethrough text={text} />;\n        }\n        case 'richTextSubscript': {\n            const { text } = richText;\n\n            return <Subscript text={text} />;\n        }\n        case 'richTextSuperscript': {\n            const { text } = richText;\n\n            return <Superscript text={text} />;\n        }\n        case 'richTexts': {\n            const { texts } = richText;\n\n            return <Texts texts={texts} />;\n        }\n        case 'richTextUnderline': {\n            const { text } = richText;\n\n            return <Underline text={text} />;\n        }\n        case 'richTextUrl': {\n            const { text, url } = richText;\n\n            return <Url text={text} url={url} />;\n        }\n    }\n\n    return `[${richText['@type']}]`;\n}\n\nexport function isEmptyText(richText) {\n    if (!richText) return true;\n\n    switch (richText['@type']) {\n        case 'richTextAnchor': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextBold': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextEmailAddress': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextFixed': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextIcon': {\n            return false;\n        }\n        case 'richTextItalic': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextMarked': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextPhoneNumber': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextPlain': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextStrikethrough': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextSubscript': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextSuperscript': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTexts': {\n            const { texts } = richText;\n\n            return texts.every(isEmptyText);\n        }\n        case 'richTextUnderline': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n        case 'richTextUrl': {\n            const { text } = richText;\n\n            return isEmptyText(text);\n        }\n    }\n\n    return false;\n}\n\nexport function getHorizontalAlignment(align) {\n    if (!align) return null;\n\n    switch (align['@type']) {\n        case 'pageBlockHorizontalAlignmentCenter': {\n            return 'center';\n        }\n        case 'pageBlockHorizontalAlignmentLeft': {\n            return 'left';\n        }\n        case 'pageBlockHorizontalAlignmentRight': {\n            return 'right';\n        }\n    }\n\n    return null;\n}\n\nexport function getVerticalAlignment(valign) {\n    if (!valign) return null;\n\n    switch (valign['@type']) {\n        case 'pageBlockVerticalAlignmentBottom': {\n            return 'bottom';\n        }\n        case 'pageBlockVerticalAlignmentMiddle': {\n            return 'middle';\n        }\n        case 'pageBlockVerticalAlignmentTop': {\n            return 'top';\n        }\n    }\n\n    return null;\n}\n\nexport function getInnerBlocks(block) {\n    if (!block) return [];\n\n    switch (block['@type']) {\n        case 'pageBlockAnchor': {\n            return [];\n        }\n        case 'pageBlockAnimation': {\n            return [block.caption];\n        }\n        case 'pageBlockAudio': {\n            return [block.caption];\n        }\n        case 'pageBlockAuthorDate': {\n            return [];\n        }\n        case 'pageBlockBlockQuote': {\n            return [];\n        }\n        case 'pageBlockChatLink': {\n            return [];\n        }\n        case 'pageBlockCollage': {\n            const innerBlocks = block.page_blocks.map(x => [x, ...getInnerBlocks(x)]);\n\n            return [].concat.apply([], innerBlocks);\n        }\n        case 'pageBlockCover': {\n            return [block.cover];\n        }\n        case 'pageBlockDetails': {\n            const innerBlocks = block.page_blocks.map(x => [x, ...getInnerBlocks(x)]);\n\n            return [].concat.apply([], innerBlocks);\n        }\n        case 'pageBlockDivider': {\n            return [];\n        }\n        case 'pageBlockEmbedded': {\n            return [block.caption];\n        }\n        case 'pageBlockEmbeddedPost': {\n            const innerBlocks = block.page_blocks.map(x => [x, ...getInnerBlocks(x)]);\n\n            return [].concat.apply([block.caption], innerBlocks);\n        }\n        case 'pageBlockFooter': {\n            return [];\n        }\n        case 'pageBlockHeader': {\n            return [];\n        }\n        case 'pageBlockKicker': {\n            return [];\n        }\n        case 'pageBlockList': {\n            const innerBlocks = block.items.map(x => [x, ...getInnerBlocks(x)]);\n\n            return [].concat.apply([], innerBlocks);\n        }\n        case 'pageBlockListItem': {\n            const innerBlocks = block.page_blocks.map(x => [x, ...getInnerBlocks(x)]);\n\n            return [].concat.apply([], innerBlocks);\n        }\n        case 'pageBlockMap': {\n            return [block.caption];\n        }\n        case 'pageBlockParagraph': {\n            return [];\n        }\n        case 'pageBlockPhoto': {\n            return [block.caption];\n        }\n        case 'pageBlockPreformatted': {\n            return [];\n        }\n        case 'pageBlockPullQuote': {\n            return [];\n        }\n        case 'pageBlockRelatedArticle': {\n            return [];\n        }\n        case 'pageBlockRelatedArticles': {\n            return [...block.articles];\n        }\n        case 'pageBlockSlideshow': {\n            const innerBlocks = block.page_blocks.map(x => [x, ...getInnerBlocks(x)]);\n\n            return [].concat.apply([block.caption], innerBlocks);\n        }\n        case 'pageBlockSubheader': {\n            return [];\n        }\n        case 'pageBlockSubtitle': {\n            return [];\n        }\n        case 'pageBlockTable': {\n            return [...block.cells];\n        }\n        case 'pageBlockTableCell': {\n            return [];\n        }\n        case 'pageBlockTitle': {\n            return [];\n        }\n        case 'pageBlockVideo': {\n            return [block.caption];\n        }\n    }\n\n    return [];\n}\n\nexport function getBlockMedia(block) {\n    if (!block) return null;\n\n    switch (block['@type']) {\n        case 'pageBlockAnimation': {\n            return block.animation;\n        }\n        case 'pageBlockPhoto': {\n            return block.photo;\n        }\n        case 'pageBlockVideo': {\n            return block.video;\n        }\n    }\n\n    return null;\n}\n\nexport function getBlockCaption(block) {\n    if (!block) return null;\n\n    switch (block['@type']) {\n        case 'pageBlockAnimation': {\n            return block.caption;\n        }\n        case 'pageBlockPhoto': {\n            return block.caption;\n        }\n        case 'pageBlockVideo': {\n            return block.caption;\n        }\n    }\n\n    return null;\n}\n\nexport function getBlockUrl(block) {\n    if (!block) return null;\n\n    switch (block['@type']) {\n        case 'pageBlockPhoto': {\n            return block.url;\n        }\n    }\n\n    return null;\n}\n\nexport function isValidMediaBlock(block) {\n    if (!block) return false;\n\n    switch (block['@type']) {\n        case 'pageBlockAnimation': {\n            return true;\n        }\n        case 'pageBlockPhoto': {\n            return true;\n        }\n        case 'pageBlockVideo': {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nexport function isValidAudioBlock(block) {\n    if (!block) return false;\n\n    return block['@type'] === 'pageBlockAudio';\n}\n\nexport function isValidVoiceNoteBlock(block) {\n    if (!block) return false;\n\n    return block['@type'] === 'pageBlockVoiceNote';\n}\n\nexport function getValidBlocks(iv, func) {\n    if (!iv) return [];\n\n    const { page_blocks } = iv;\n\n    const blocks = [];\n    page_blocks.forEach(x => {\n        blocks.push(x);\n        const innerBlocks = getInnerBlocks(x);\n        innerBlocks.forEach(i => {\n            blocks.push(i);\n        });\n    });\n\n    return blocks.filter(func);\n}\n","/*\n * Date Format 1.2.3\n * (c) 2007-2009 Steven Levithan <stevenlevithan.com>\n * MIT license\n *\n * Includes enhancements by Scott Trenda <scott.trenda.net>\n * and Kris Kowal <cixar.com/~kris.kowal/>\n *\n * Accepts a date, a mask, or a date and a mask.\n * Returns a formatted version of the given date.\n * The date defaults to the current date/time.\n * The mask defaults to dateFormat.masks.default.\n */\n\nconst dateFormat = (function() {\n    const token = /d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\\1?|[LloSZWN]|\"[^\"]*\"|'[^']*'/g;\n    const timezone = /\\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\\d{4})?)\\b/g;\n    const timezoneClip = /[^-+\\dA-Z]/g;\n\n    // Regexes and supporting functions are cached through closure\n    return function(date, mask, utc, gmt) {\n        // You can't provide utc if you skip other args (use the 'UTC:' mask prefix)\n        if (arguments.length === 1 && kindOf(date) === 'string' && !/\\d/.test(date)) {\n            mask = date;\n            date = undefined;\n        }\n\n        date = date || new Date();\n\n        if (!(date instanceof Date)) {\n            date = new Date(date);\n        }\n\n        if (isNaN(date)) {\n            throw TypeError('Invalid date');\n        }\n\n        mask = String(dateFormat.masks[mask] || mask || dateFormat.masks['default']);\n\n        // Allow setting the utc/gmt argument via the mask\n        var maskSlice = mask.slice(0, 4);\n        if (maskSlice === 'UTC:' || maskSlice === 'GMT:') {\n            mask = mask.slice(4);\n            utc = true;\n            if (maskSlice === 'GMT:') {\n                gmt = true;\n            }\n        }\n\n        var _ = utc ? 'getUTC' : 'get';\n        var d = date[_ + 'Date']();\n        var D = date[_ + 'Day']();\n        var m = date[_ + 'Month']();\n        var y = date[_ + 'FullYear']();\n        var H = date[_ + 'Hours']();\n        var M = date[_ + 'Minutes']();\n        var s = date[_ + 'Seconds']();\n        var L = date[_ + 'Milliseconds']();\n        var o = utc ? 0 : date.getTimezoneOffset();\n        var W = getWeek(date);\n        var N = getDayOfWeek(date);\n        var flags = {\n            d: d,\n            dd: pad(d),\n            ddd: dateFormat.i18n.dayNames[D],\n            dddd: dateFormat.i18n.dayNames[D + 7],\n            m: m + 1,\n            mm: pad(m + 1),\n            mmm: dateFormat.i18n.monthNames[m],\n            mmmm: dateFormat.i18n.monthNames[m + 12],\n            yy: String(y).slice(2),\n            yyyy: y,\n            h: H % 12 || 12,\n            hh: pad(H % 12 || 12),\n            H: H,\n            HH: pad(H),\n            M: M,\n            MM: pad(M),\n            s: s,\n            ss: pad(s),\n            l: pad(L, 3),\n            L: pad(Math.round(L / 10)),\n            t: H < 12 ? dateFormat.i18n.timeNames[0] : dateFormat.i18n.timeNames[1],\n            tt: H < 12 ? dateFormat.i18n.timeNames[2] : dateFormat.i18n.timeNames[3],\n            T: H < 12 ? dateFormat.i18n.timeNames[4] : dateFormat.i18n.timeNames[5],\n            TT: H < 12 ? dateFormat.i18n.timeNames[6] : dateFormat.i18n.timeNames[7],\n            Z: gmt ? 'GMT' : utc ? 'UTC' : (String(date).match(timezone) || ['']).pop().replace(timezoneClip, ''),\n            o: (o > 0 ? '-' : '+') + pad(Math.floor(Math.abs(o) / 60) * 100 + (Math.abs(o) % 60), 4),\n            S: ['th', 'st', 'nd', 'rd'][d % 10 > 3 ? 0 : (((d % 100) - (d % 10) != 10) * d) % 10],\n            W: W,\n            N: N\n        };\n\n        return mask.replace(token, function(match) {\n            if (match in flags) {\n                return flags[match];\n            }\n            return match.slice(1, match.length - 1);\n        });\n    };\n})();\n\ndateFormat.masks = {\n    default: 'ddd mmm dd yyyy HH:MM:ss',\n    shortDate: 'm/d/yy',\n    mediumDate: 'mmm d, yyyy',\n    longDate: 'mmmm d, yyyy',\n    fullDate: 'dddd, mmmm d, yyyy',\n    shortTime: 'h:MM TT',\n    mediumTime: 'h:MM:ss TT',\n    longTime: 'h:MM:ss TT Z',\n    isoDate: 'yyyy-mm-dd',\n    isoTime: 'HH:MM:ss',\n    isoDateTime: \"yyyy-mm-dd'T'HH:MM:sso\",\n    isoUtcDateTime: \"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'\",\n    expiresHeaderFormat: 'ddd, dd mmm yyyy HH:MM:ss Z'\n};\n\n// Internationalization strings\ndateFormat.i18n = {\n    dayNames: [\n        'Sun',\n        'Mon',\n        'Tue',\n        'Wed',\n        'Thu',\n        'Fri',\n        'Sat',\n        'Sunday',\n        'Monday',\n        'Tuesday',\n        'Wednesday',\n        'Thursday',\n        'Friday',\n        'Saturday'\n    ],\n    monthNames: [\n        'Jan',\n        'Feb',\n        'Mar',\n        'Apr',\n        'May',\n        'Jun',\n        'Jul',\n        'Aug',\n        'Sep',\n        'Oct',\n        'Nov',\n        'Dec',\n        'January',\n        'February',\n        'March',\n        'April',\n        'May',\n        'June',\n        'July',\n        'August',\n        'September',\n        'October',\n        'November',\n        'December'\n    ],\n    timeNames: ['a', 'p', 'am', 'pm', 'A', 'P', 'AM', 'PM']\n};\n\nfunction pad(val, len) {\n    val = String(val);\n    len = len || 2;\n    while (val.length < len) {\n        val = '0' + val;\n    }\n    return val;\n}\n\n/**\n * Get the ISO 8601 week number\n * Based on comments from\n * http://techblog.procurios.nl/k/n618/news/view/33796/14863/Calculate-ISO-8601-week-and-year-in-javascript.html\n *\n * @param  {Object} `date`\n * @return {Number}\n */\nfunction getWeek(date) {\n    // Remove time components of date\n    var targetThursday = new Date(date.getFullYear(), date.getMonth(), date.getDate());\n\n    // Change date to Thursday same week\n    targetThursday.setDate(targetThursday.getDate() - ((targetThursday.getDay() + 6) % 7) + 3);\n\n    // Take January 4th as it is always in week 1 (see ISO 8601)\n    var firstThursday = new Date(targetThursday.getFullYear(), 0, 4);\n\n    // Change date to Thursday same week\n    firstThursday.setDate(firstThursday.getDate() - ((firstThursday.getDay() + 6) % 7) + 3);\n\n    // Check if daylight-saving-time-switch occurred and correct for it\n    var ds = targetThursday.getTimezoneOffset() - firstThursday.getTimezoneOffset();\n    targetThursday.setHours(targetThursday.getHours() - ds);\n\n    // Number of weeks between target Thursday and first Thursday\n    var weekDiff = (targetThursday - firstThursday) / (86400000 * 7);\n    return 1 + Math.floor(weekDiff);\n}\n\n/**\n * Get ISO-8601 numeric representation of the day of the week\n * 1 (for Monday) through 7 (for Sunday)\n *\n * @param  {Object} `date`\n * @return {Number}\n */\nfunction getDayOfWeek(date) {\n    var dow = date.getDay();\n    if (dow === 0) {\n        dow = 7;\n    }\n    return dow;\n}\n\n/**\n * kind-of shortcut\n * @param  {*} val\n * @return {String}\n */\nfunction kindOf(val) {\n    if (val === null) {\n        return 'null';\n    }\n\n    if (val === undefined) {\n        return 'undefined';\n    }\n\n    if (typeof val !== 'object') {\n        return typeof val;\n    }\n\n    if (Array.isArray(val)) {\n        return 'array';\n    }\n\n    return {}.toString\n        .call(val)\n        .slice(8, -1)\n        .toLowerCase();\n}\n\nexport default dateFormat;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport { getDisplayName } from '../../Utils/HOC';\n\nconst IVContext = React.createContext(null);\n\nexport default IVContext;\n\nexport function withIV(Component) {\n    class IVComponent extends React.Component {\n        render() {\n            return <IVContext.Consumer>{value => <Component iv={value} {...this.props} />}</IVContext.Consumer>;\n        }\n    }\n    IVComponent.displayName = `WithIV(${getDisplayName(Component)})`;\n\n    return IVComponent;\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\n\nexport function compose(...funcs) {\n    return funcs.reduce((a, b) => (...args) => a(b(...args)), arg => arg);\n}\n\nexport function withSaveRef() {\n    return Component => {\n        return React.forwardRef((props, ref) => <Component {...props} forwardedRef={ref} />);\n    };\n}\n\nexport function withRestoreRef() {\n    return Component => {\n        return class extends React.Component {\n            render() {\n                const { forwardedRef, ...rest } = this.props;\n\n                return <Component {...rest} ref={forwardedRef} />;\n            }\n        };\n    };\n}\n\nexport function getDisplayName(WrappedComponent) {\n    return WrappedComponent.displayName || WrappedComponent.name || 'Component';\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport ModalManager from '@material-ui/core/Modal/ModalManager';\n\nconst modalManager = new ModalManager();\n\nexport { modalManager };","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass BasicGroupStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.items = new Map();\n        this.fullInfoItems = new Map();\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'updateBasicGroup': {\n                this.set(update.basic_group);\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'updateBasicGroupFullInfo': {\n                this.setFullInfo(update.basic_group_id, update.basic_group_full_info);\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {};\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    get(groupId) {\n        return this.items.get(groupId);\n    }\n\n    set(group) {\n        this.items.set(group.id, group);\n    }\n\n    getFullInfo(id) {\n        return this.fullInfoItems.get(id);\n    }\n\n    setFullInfo(id, fullInfo) {\n        this.fullInfoItems.set(id, fullInfo);\n    }\n}\n\nconst store = new BasicGroupStore();\nwindow.basicgroup = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport CloseIcon from '../../Assets/Icons/Close';\nimport { ANIMATION_DURATION_300MS } from '../../Constants';\nimport FileStore from '../../Stores/FileStore';\nimport './FileProgress.css';\n\nclass FileProgress extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.completeAnimation = false;\n        const { file } = this.props;\n        this.state = {\n            prevPropsFile: file,\n            prevFile: null,\n            file: FileStore.get(file.id) || file\n        };\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        const { file } = props;\n        const { prevPropsFile } = state;\n\n        if (file && prevPropsFile && file.id !== prevPropsFile.id) {\n            return {\n                prevPropsFile: file,\n                prevFile: null,\n                file: FileStore.get(file.id) || file\n            };\n        }\n\n        return null;\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        const { download, upload, icon, thumbnailSrc } = this.props;\n\n        if (nextProps.thumbnailSrc !== thumbnailSrc) {\n            return true;\n        }\n\n        if (nextProps.icon !== icon) {\n            return true;\n        }\n\n        if (this.isDownloading(nextState.file, nextState.prevFile) && !download) {\n            return false;\n        }\n\n        if (this.isUploading(nextState.file, nextState.prevFile) && !upload) {\n            return false;\n        }\n\n        const nextLocal = nextState.file ? nextState.file.local : null;\n        const nextIdbKey = nextState.file ? nextState.file.idb_key : null;\n        const prevLocal = this.state.prevFile ? this.state.prevFile.local : null;\n        const prevIdbKey = this.state.prevFile ? this.state.prevFile.idb_key : null;\n        const isDownloadingCompleted =\n            prevLocal && nextLocal && !prevLocal.is_downloading_completed && nextLocal.is_downloading_completed;\n        const receiveIdbKey = nextIdbKey && !prevIdbKey;\n\n        if (nextState.file.id === this.state.file.id && isDownloadingCompleted && receiveIdbKey) {\n            return false;\n        }\n\n        if (nextState.file !== this.state.file) {\n            return true;\n        }\n\n        if (nextState.prevFile !== this.state.prevFile) {\n            return true;\n        }\n\n        return false;\n    }\n\n    componentDidMount() {\n        this.mount = true;\n        FileStore.on('updateFile', this.onUpdateFile);\n    }\n\n    componentWillUnmount() {\n        this.mount = false;\n        FileStore.off('updateFile', this.onUpdateFile);\n    }\n\n    fileEquals(file1, file2) {\n        if (file1 === file2 && file1 === null) return true;\n        if (file1 !== null && file2 === null) return false;\n        if (file1 === null && file2 !== null) return false;\n\n        const { local: local1, remote: remote1 } = file1;\n        const { local: local2, remote: remote2 } = file2;\n\n        if (local1.can_be_deleted !== local2.can_be_deleted) return false;\n        if (local1.can_be_downloaded !== local2.can_be_downloaded) return false;\n        if (local1.download_offset !== local2.download_offset) return false;\n        if (local1.downloaded_prefix_size !== local2.downloaded_prefix_size) return false;\n        if (local1.downloaded_size !== local2.downloaded_size) return false;\n        if (local1.is_downloading_active !== local2.is_downloading_active) return false;\n        if (local1.is_downloading_completed !== local2.is_downloading_completed) return false;\n        if (local1.path !== local2.path) return false;\n\n        if (remote1.id !== remote2.id) return false;\n        if (remote1.is_uploading_active !== remote2.is_uploading_active) return false;\n        if (remote1.is_uploading_completed !== remote2.is_uploading_completed) return false;\n        if (remote1.uploaded_size !== remote2.uploaded_size) return false;\n\n        return true;\n    }\n\n    onUpdateFile = update => {\n        const currentFile = this.state.file;\n        const nextFile = update.file;\n\n        if (currentFile && currentFile.id === nextFile.id) {\n            if (this.fileEquals(nextFile, currentFile)) {\n                // console.log('[fp] update equals', nextFile, currentFile);\n            } else {\n                // console.log('[fp] update', nextFile, currentFile);\n                this.setState({ file: nextFile, prevFile: currentFile });\n            }\n        }\n    };\n\n    isDownloading = (file, prevFile) => {\n        if (!this.props.download) return false;\n\n        const wasActive = prevFile && prevFile.local && prevFile.local.is_downloading_active;\n        const isActive = file && file.local && file.local.is_downloading_active;\n\n        return wasActive || isActive;\n    };\n\n    isUploading = (file, prevFile) => {\n        if (!this.props.upload) return false;\n\n        const wasActive = prevFile && prevFile.remote && prevFile.remote.is_uploading_active;\n        const isActive = file && file.remote && file.remote.is_uploading_active;\n\n        return wasActive || isActive;\n    };\n\n    getProgressParams = (file, prevFile) => {\n        const { local, remote } = file;\n\n        let wasActive = false;\n        let isActive = false;\n        let isCompleted = false;\n        let progressSize = 0;\n        let size = 0;\n        if (this.isDownloading(file, prevFile)) {\n            wasActive = prevFile && prevFile.local && prevFile.local.is_downloading_active;\n            isActive = local.is_downloading_active;\n            isCompleted = local.is_downloading_completed;\n            progressSize = local.downloaded_size;\n            size = file.size;\n            // console.log(\n            //     `FileProgress.getProgressParams isDownloading id=${\n            //         file.id\n            //     } was_active=${wasActive} is_active=${isActive} is_completed=${isCompleted} progress_size=${progressSize} size=${size}`,\n            //     file,\n            //     prevFile\n            // );\n        } else if (this.isUploading(file, prevFile)) {\n            wasActive = prevFile && prevFile.remote && prevFile.remote.is_uploading_active;\n            isActive = remote.is_uploading_active;\n            isCompleted = remote.is_uploading_completed;\n            progressSize = remote.uploaded_size;\n            size = file.size;\n            // console.log(\n            //     `FileProgress.getProgressParams isUploading id=${\n            //         file.id\n            //     } was_active=${wasActive} is_active=${isActive} is_completed=${isCompleted} progress_size=${progressSize} size=${size}`,\n            //     file,\n            //     prevFile\n            // );\n        } else {\n            // console.log(\n            //     `FileProgress.getProgressParams none id=${file.id} download=${this.props.download} upload=${\n            //         this.props.upload\n            //     } was_active=${wasActive} is_active=${isActive} is_completed=${isCompleted} progress_size=${progressSize} size=${size}`,\n            //     file,\n            //     prevFile\n            // );\n        }\n\n        return [wasActive, isActive, isCompleted, progressSize, size];\n    };\n\n    render() {\n        let { thumbnailSrc, cancelButton, zIndex, icon, completeIcon } = this.props;\n        const { file, prevFile } = this.state;\n        if (!file) return null;\n\n        const [wasActive, isActive, isCompleted, progressSize, size] = this.getProgressParams(file, prevFile);\n\n        let inProgress = isActive;\n        let progress = 0;\n        if (isActive) {\n            progress = progressSize && size ? 100 - ((size - progressSize) / size) * 100 : 1;\n        }\n\n        const startCompleteAnimation = wasActive && !isActive;\n        if (startCompleteAnimation) {\n            this.completeAnimation = true;\n            // console.log('FileProgress.render animationComplete=true');\n            progress = isCompleted ? 100 : 0;\n            inProgress = true;\n            setTimeout(() => {\n                this.completeAnimation = false;\n                if (!this.mount) return;\n                // console.log('FileProgress.render animationComplete=false');\n\n                this.setState({ prevFile: null });\n            }, ANIMATION_DURATION_300MS);\n        }\n\n        const style = {\n            zIndex: zIndex,\n            background: !thumbnailSrc && typeof thumbnailSrc !== 'undefined' ? null : 'rgba(0, 0, 0, 0.25)'\n        };\n\n        const isDownloadingCompleted =\n            file &&\n            file.local &&\n            (file.local.is_downloading_completed || file.idb_key || file.local.is_uploading_completed) &&\n            !this.completeAnimation &&\n            !isActive;\n\n        // console.log(\n        //     `[fp]] render \\\\\n        //     id=${file.id} showProgress=${inProgress} progress=${progress} \\\\\n        //     was_active=${wasActive} is_active=${isActive} is_completed=${isCompleted} \\\\\n        //     progress_size=${progressSize} size=${size} complete_animation=${this.completeAnimation} \\\\\n        //     is_downloading_completed=${isDownloadingCompleted}\n        //     completeIcon=${completeIcon}`,\n        //     file,\n        //     prevFile\n        // );\n        //cancelButton = true;\n        //inProgress = true;\n\n        if (isDownloadingCompleted) {\n            // console.log('FileProgress.render completeIcon');\n            if (completeIcon) {\n                return (\n                    <div className={classNames('file-progress', 'file-progress-complete')} style={style}>\n                        {completeIcon}\n                    </div>\n                );\n            }\n\n            return null;\n        }\n\n        if (inProgress || this.completeAnimation) {\n            // console.log('FileProgress.render inProgressIcon');\n            return (\n                <div className='file-progress' style={style}>\n                    <CircularProgress\n                        className='file-progress-indicator'\n                        classes={{ circle: 'file-progress-circle' }}\n                        variant='static'\n                        value={progress}\n                        size={48}\n                        thickness={2}\n                    />\n                    {cancelButton && <CloseIcon />}\n                </div>\n            );\n        }\n\n        if (icon) {\n            // console.log('FileProgress.render icon');\n            return (\n                <div className='file-progress' style={style}>\n                    {icon}\n                </div>\n            );\n        }\n\n        return null;\n    }\n}\n\nFileProgress.propTypes = {\n    file: PropTypes.object.isRequired,\n    thumbnailSrc: PropTypes.oneOfType([PropTypes.object, PropTypes.string]),\n    cancelButton: PropTypes.bool,\n    download: PropTypes.bool,\n    upload: PropTypes.bool,\n    zIndex: PropTypes.number,\n\n    icon: PropTypes.node,\n    completeIcon: PropTypes.node\n};\n\nFileProgress.defaultProps = {\n    cancelButton: false,\n    download: true,\n    upload: false\n};\n\nexport default FileProgress;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport createSvgIcon from '@material-ui/core/esm/utils/createSvgIcon';\n\nexport default createSvgIcon(\n    <path d='M5,19 L19,19 C19.5522847,19 20,19.4477153 20,20 C20,20.5128358 19.6139598,20.9355072 19.1166211,20.9932723 L19,21 L5,21 C4.44771525,21 4,20.5522847 4,20 C4,19.4871642 4.38604019,19.0644928 4.88337887,19.0067277 L5,19 L19,19 L5,19 Z M11.8833789,3.00672773 L12,3 C12.5128358,3 12.9355072,3.38604019 12.9932723,3.88337887 L13,4 L13,13.585 L16.2928932,10.2928932 C16.6533772,9.93240926 17.2206082,9.90467972 17.6128994,10.2097046 L17.7071068,10.2928932 C18.0675907,10.6533772 18.0953203,11.2206082 17.7902954,11.6128994 L17.7071068,11.7071068 L12.7071068,16.7071068 C12.3466228,17.0675907 11.7793918,17.0953203 11.3871006,16.7902954 L11.2928932,16.7071068 L6.29289322,11.7071068 C5.90236893,11.3165825 5.90236893,10.6834175 6.29289322,10.2928932 C6.65337718,9.93240926 7.22060824,9.90467972 7.61289944,10.2097046 L7.70710678,10.2928932 L11,13.585 L11,4 C11,3.48716416 11.3860402,3.06449284 11.8833789,3.00672773 L12,3 L11.8833789,3.00672773 Z' />,\n    'Download'\n);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport createSvgIcon from '@material-ui/core/esm/utils/createSvgIcon';\n\nexport default createSvgIcon(\n    <path\n        transform='translate(-12.000000, -12.000000)'\n        d='M19.3717789,13.8876217 L33.8466511,23.2537154 C34.2588127,23.5204082 34.3767385,24.0707284 34.1100457,24.48289 C34.0418356,24.5883056 33.9520666,24.6780745 33.8466511,24.7462846 L19.3717789,34.1123783 C18.9596173,34.3790711 18.4092971,34.2611454 18.1426043,33.8489838 C18.0495218,33.705129 18,33.5374371 18,33.3660938 L18,14.6339062 C18,14.1429865 18.3979691,13.7450173 18.8888889,13.7450173 C19.0602323,13.7450173 19.2279241,13.7945391 19.3717789,13.8876217 Z'\n    />,\n    'PlayArrow'\n);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nlet data = null;\nexport async function loadData() {\n    if (data) return;\n\n    try {\n        const response = await fetch('data/countries.txt');\n        const text = await response.text();\n\n        const lines = text.split('\\n');\n        const data2 = [];\n        lines.forEach(x => {\n            const split = x.split(';');\n            const item = {\n                prefix: split[0],\n                code: split[1],\n                name: split[2],\n                pattern: split[3],\n                count: Number(split[4]),\n                emoji: split[5]\n            };\n            data2.push(item);\n        });\n        data2.forEach(x => {\n            x.phone = '+' + x.prefix;\n        });\n\n        data = data2.filter(x => x.emoji);\n\n        return data;\n    } catch (error) {\n        console.error(error);\n    }\n}\n\nfunction clearPhone(phone) {\n    if (!phone) return phone;\n\n    return phone\n        .replace(/ /g, '')\n        .replace('+', '')\n        .toLowerCase();\n}\n\nfunction isPhoneWithOptionCode(phone, option) {\n    if (!phone) return false;\n    if (!option) return false;\n\n    phone = clearPhone(phone);\n    const code = clearPhone(option.phone);\n\n    return phone.startsWith(code) && option.pattern;\n}\n\nfunction getCountryFromPhone(phone, data) {\n    if (!data) return null;\n\n    const index = data.findIndex(x => isPhoneWithOptionCode(phone, x));\n\n    return index !== -1 ? data[index] : null;\n}\n\nfunction formatByPattern(phone, pattern) {\n    phone = clearPhone(phone);\n\n    let result = '';\n    let index = 0;\n    for (let i = 0; i < pattern.length && index < phone.length; i++) {\n        if (pattern[i] >= '0' && pattern[i] <= '9') {\n            result += pattern[i];\n            if (phone[index] === pattern[i]) {\n                index++;\n            }\n        } else if (pattern[i] === ' ') {\n            result += pattern[i];\n        } else if (pattern[i] === 'X') {\n            result += phone[index++];\n        }\n    }\n\n    result += ' ' + phone.substring(index);\n\n    return '+' + result;\n}\n\nexport function formatPhoneNumber(phone) {\n    if (!phone) return phone;\n    if (!data) return phone.startsWith('+') ? phone : '+' + phone;\n\n    const country = getCountryFromPhone(phone, data);\n    if (!country) return phone.startsWith('+') ? phone : '+' + phone;\n\n    return formatByPattern(phone, country.pattern);\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport './HeaderProgress.css';\n\nclass HeaderProgress extends React.Component {\n    render() {\n        return (\n            <>\n                <span className='header-progress'>.</span>\n                <span className='header-progress'>.</span>\n                <span className='header-progress'>.</span>\n            </>\n        );\n    }\n}\n\nexport default HeaderProgress;\n","class Storage {\n    constructor(options) {\n        this.store = options.store;\n    }\n\n    setItem(key, value) {\n        if (!this.store) return;\n\n        try {\n            this.store.setItem(key, value);\n        } catch (e) {}\n    }\n\n    getItem(key, value) {\n        if (!this.store) return;\n\n        try {\n            return this.store.getItem(key, value);\n        } catch (e) {}\n\n        return undefined;\n    }\n}\n\nfunction getDefaults() {\n    return {\n        prefix: 'i18next_res_',\n        expirationTime: Infinity,\n        versions: {},\n        store: window.localStorage\n    };\n}\n\nclass Cache {\n    constructor(services, options = {}) {\n        this.init(services, options);\n\n        this.type = 'backend';\n    }\n\n    init(services, options = {}) {\n        this.services = services;\n        this.options = { ...getDefaults(), ...this.options, ...options };\n        this.storage = new Storage(this.options);\n    }\n\n    read(language, namespace, callback) {\n        const nowMS = new Date().getTime();\n\n        if (!this.storage.store) {\n            return callback(null, null);\n        }\n\n        let local = this.storage.getItem(`${this.options.prefix}${language}-${namespace}`);\n\n        if (local) {\n            local = JSON.parse(local);\n            if (\n                // expiration field is mandatory, and should not be expired\n                local.i18nStamp &&\n                local.i18nStamp + this.options.expirationTime > nowMS &&\n                // there should be no language version set, or if it is, it should match the one in translation\n                this.options.versions[language] === local.i18nVersion\n            ) {\n                delete local.i18nVersion;\n                delete local.i18nStamp;\n                return callback(null, local);\n            }\n        }\n\n        return callback(null, null);\n    }\n\n    save(language, namespace, data) {\n        if (this.storage.store) {\n            data.i18nStamp = new Date().getTime();\n\n            // language version (if set)\n            if (this.options.versions[language]) {\n                data.i18nVersion = this.options.versions[language];\n            }\n\n            // save\n            this.storage.setItem(`${this.options.prefix}${language}-${namespace}`, JSON.stringify(data));\n        }\n    }\n}\n\nCache.type = 'backend';\n\nexport default Cache;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport i18n from 'i18next';\nimport LocalizationCache from '../Localization/Cache';\nimport { initReactI18next } from 'react-i18next';\nimport TdLibController from '../Controllers/TdLibController';\nimport React from 'react';\n\nconst fallbackLng = 'en';\nconst defaultNS = 'translation';\nconst lng = localStorage.getItem('i18next') || fallbackLng;\n\ni18n.use(initReactI18next).init({\n    ns: [defaultNS, 'local'],\n    defaultNS,\n    fallbackNS: ['auth', 'local', 'emoji', 'settings', 'translation', 'search'],\n    resources: {\n        en: {\n            auth: {\n                QRHint: '1. Open Telegram on your phone\\n2. Go to Settings > Devices > Scan QR\\n3. Scan this image to Log in',\n                LogInByPhone: 'Or log in by using your phone number',\n                LogInViaQR: 'Quick log in using QR code'\n            },\n            search: {\n                ChatsAndContacts: 'Chats and contacts',\n                SearchMessagesIn: 'Search messages in'\n            },\n            settings: {\n                ContactJoinedEnabled: 'Enabled',\n                ContactJoinedDisabled: 'Disabled',\n                NotificationsEnabled: 'Enabled',\n                NotificationsDisabled: 'Disabled',\n                PreviewEnabled: 'Enabled',\n                PreviewDisabled: 'Disabled',\n                BioAbout: 'Any details such as age, occupation or city.\\nExample: 23 y.o. designer from San Francisco.',\n                Archived: 'Archived',\n                Saved: 'Saved',\n                EditProfile: 'Edit Profile',\n                GeneralSettings: 'General Settings',\n                FilterChooseChats: 'Please choose at least one chat for this folder.',\n                FilterCreateError: 'Sorry, you can\\'t add more than 10 folders.'\n            },\n            local: {\n                CopyMessageLink: 'Copy Message Link',\n                DragToReposition: 'Drag to Reposition',\n                PollQuizOneRightAnswer: 'Quiz has only one right answer.',\n                LeftChannel: 'Left channel',\n                LeftGroup: 'Left group',\n                EnterPassword: 'Enter a Password',\n                YourAccountProtectedWithPassword: 'Your account is protected with an additional password.',\n                DeletedMessage: 'Deleted message',\n                YourPhone: 'Your Phone',\n                SignInToTelegram: 'Sign in to Telegram',\n                PhoneNumber: 'Phone Number',\n                Country: 'Country',\n                KeepMeSignedIn: 'Keep me signed in',\n                StartText: 'Please confirm your country code and enter your phone number.',\n                Next: 'Next',\n                InvalidPhoneNumber: 'Invalid phone number. Please check the number and try again.',\n                More: 'More',\n                SendFileConfirmation: 'Are you sure you want to send file?',\n                SendFilesConfirmation: 'Are you sure you want to send files?',\n                SendMessage: 'Send Message',\n                ChatInfo: 'Chat Info',\n                ChannelInfo: 'Channel Info',\n                Stickers: 'STICKERS',\n                Emoji: 'EMOJI',\n                SelectChatToStartMessaging: 'Please select a chat to start messaging',\n                Text: 'Text',\n                ViewChannelInfo: 'View channel info',\n                ViewGroupInfo: 'View group info',\n                ViewProfile: 'View profile',\n                GoToMessage: 'Go to message',\n                PhotosTitle: 'Photos',\n                VideosTitle: 'Videos',\n                VoiceTitle: 'Voice messages',\n                UpdateDraftConfirmation: 'Are you sure you want to update draft?',\n                RecordDeniedTitle: 'Permission Denied',\n                RecordDeniedDescription: 'You must allow your browser to access your microphone before being able to record voice notes. Click on the padlock icon next to the URL and then make sure you click Allow in the microphone settings to enable Telegram to access your microphone.',\n            },\n            emoji: {\n                Search: 'Search',\n                NotEmojiFound: 'No Emoji Found',\n                ChooseDefaultSkinTone: 'Choose your default skin tone',\n                SearchResults: 'Search Results',\n                Recent: 'Frequently Used',\n                SmileysPeople: 'Smileys & People',\n                AnimalsNature: 'Animals & Nature',\n                FoodDrink: 'Food & Drink',\n                Activity: 'Activity',\n                TravelPlaces: 'Travel & Places',\n                Objects: 'Objects',\n                Symbols: 'Symbols',\n                Flags: 'Flags',\n                Custom: 'Custom'\n            },\n            translation: {\n                AppName: 'Telegram',\n                Connecting: 'Connecting...',\n                ConnectingToProxy: 'Connecting to proxy...',\n                Loading: 'Loading...',\n                Updating: 'Updating...',\n                WaitingForNetwork: 'Waiting for network...',\n                ContinueOnThisLanguage: 'Continue in English',\n                SendAsFile: 'Send as a file',\n                SendAsPhoto: 'Send as a photo'\n            }\n        },\n\n        ru: {\n            auth: {\n                QRHint: '1. Open Telegram on your phone\\n2. Go to Settings > Devices > Scan QR\\n3. Scan this image to Log in',\n                LogInByPhone: 'Or log in by using your phone number',\n                LogInViaQR: 'Quick log in using QR code'\n            },\n            search: {\n                ChatsAndContacts: 'Чаты и контакты',\n                SearchMessagesIn: 'Искать сообщения в'\n            },\n            settings: {\n                ContactJoinedEnabled: 'Включено',\n                ContactJoinedDisabled: 'Выключено',\n                NotificationsEnabled: 'Включены',\n                NotificationsDisabled: 'Выключены',\n                PreviewEnabled: 'Включено',\n                PreviewDisabled: 'Выключено',\n                BioAbout:\n                    'Любые подробности, например: возраст, род занятий или город.\\nПример: 23 года, дизайнер из Санкт-Петербурга.',\n                Archived: 'Архив',\n                Saved: 'Избранное',\n                EditProfile: 'Редактровать профиль',\n                GeneralSettings: 'Основные настройки'\n            },\n            local: {\n                CopyMessageLink: 'Копировать ссылку на сообщение',\n                DragToReposition: 'Перетащите, чтобы изменить положение',\n                PollQuizOneRightAnswer: 'Quiz has only one right answer.',\n                LeftChannel: 'Канал покинут',\n                LeftGroup: 'Группа покинута',\n                EnterPassword: 'Введите пароль',\n                YourAccountProtectedWithPassword: 'Ваш аккаунт защищен дополнительным паролем.',\n                DeletedMessage: 'Удаленное сообщение',\n                YourPhone: 'Ваш телефон',\n                SignInToTelegram: 'Вход в Telegram',\n                PhoneNumber: 'Телефонный номер',\n                Country: 'Страна',\n                KeepMeSignedIn: 'Сохранить авторизацию',\n                StartText: 'Пожалуйста, укажите код страны и свой номер телефона.',\n                Next: 'Далее',\n                InvalidPhoneNumber: 'Некорректный номер телефона. Пожалуйста, проверьте номер и попробуйте ещё раз.',\n                More: 'Ещё',\n                SendFileConfirmation: 'Вы действительно хотите отправить файл?',\n                SendFilesConfirmation: 'Вы действительно хотите отправить файлы?',\n                SendMessage: 'Отправить сообщение',\n                ChatInfo: 'Информация о чате',\n                ChannelInfo: 'Информация о канале',\n                Stickers: 'СТИКЕРЫ',\n                Emoji: 'ЕМОДЗИ',\n                SelectChatToStartMessaging: 'Пожалуйста, выберите, кому хотели бы написать',\n                Text: 'Текст',\n                ViewChannelInfo: 'Информация о канале',\n                ViewGroupInfo: 'Информация о группе',\n                ViewProfile: 'Показать профиль',\n                GoToMessage: 'Перейти к сообщению',\n                PhotosTitle: 'Фотографии',\n                VideosTitle: 'Видеозаписи',\n                VoiceTitle: 'Голосовые сообщения',\n                UpdateDraftConfirmation: 'Вы действительно хотите обновить черновик сообщения?'\n            },\n            emoji: {\n                Search: 'Поиск',\n                NotEmojiFound: 'Емодзи не найдены',\n                ChooseDefaultSkinTone: 'Выберите тон кожи по умолчанию',\n                SearchResults: 'Результаты поиска',\n                Recent: 'Часто используемые',\n                SmileysPeople: 'Смайлики и люди',\n                AnimalsNature: 'Животные и природа',\n                FoodDrink: 'Еда и напитки',\n                Activity: 'Активность',\n                TravelPlaces: 'Путешествия и местности',\n                Objects: 'Предметы',\n                Symbols: 'Символы',\n                Flags: 'Флаги',\n                Custom: 'Пользовательские'\n            },\n            translation: {\n                AppName: 'Telegram',\n                Connecting: 'Соединение...',\n                ConnectingToProxy: 'Подключение к прокси...',\n                Loading: 'Загрузка...',\n                Updating: 'Обновление...',\n                WaitingForNetwork: 'Ожидание сети...',\n                ContinueOnThisLanguage: 'Продолжить на русском',\n                SendAsFile: 'Отправить как файл',\n                SendAsPhoto: 'Отправить как фото'\n            }\n        },\n\n        it: {\n            auth: {\n                QRHint: '1. Open Telegram on your phone\\n2. Go to Settings > Devices > Scan QR\\n3. Scan this image to Log in',\n                LogInByPhone: 'Or log in by using your phone number',\n                LogInViaQR: 'Quick log in using QR code'\n            },\n            search: {\n                ChatsAndContacts: 'Chat e contatti',\n                SearchMessagesIn: 'Cerca messaggi in'\n            },\n            settings: {\n                ContactJoinedEnabled: 'Attivato',\n                ContactJoinedDisabled: 'Disattivato',\n                NotificationsEnabled: 'Attivate',\n                NotificationsDisabled: 'Disattivate',\n                PreviewEnabled: 'Attivata',\n                PreviewDisabled: 'Disattivata',\n                BioAbout: 'Qualsiasi dettaglio come età, lavoro o città.\\nEsempio: Designer di 23 anni da San Francisco.',\n                Archived: 'Chat archiviate',\n                Saved: 'Messaggi salvati',\n                EditProfile: 'Modifica profilo',\n                GeneralSettings: 'Impostazioni generali'\n            },\n            local: {\n                CopyMessageLink: 'Copia link messaggio',\n                DragToReposition: 'Trascina per riposizionare',\n                PollQuizOneRightAnswer: 'Il quiz ha solo una risposta esatta.',\n                LeftChannel: 'Canale abbandonato',\n                LeftGroup: 'Gruppo abbandonato',\n                EnterPassword: 'Inserisci password',\n                YourAccountProtectedWithPassword: 'Il tuo account è protetto con una password aggiuntiva.',\n                DeletedMessage: 'Messaggi cancellati',\n                YourPhone: 'Il tuo numero',\n                SignInToTelegram: 'Accedi a Telegram',\n                PhoneNumber: 'Numero di telefono',\n                Country: 'Paese',\n                KeepMeSignedIn: 'Mantieni l\\'accesso',\n                StartText: 'Conferma il prefisso internazionale e inserisci il tuo numero di telefono.',\n                Next: 'Avanti',\n                InvalidPhoneNumber: 'Numero di telefono non valido. Per favore controlla il numero e riprova.',\n                More: 'Altro',\n                SendFileConfirmation: 'Sei sicuro di voler mandare il file?',\n                SendFilesConfirmation: 'Sei sicuro di voler mandare i file?',\n                SendMessage: 'Invia messaggio',\n                ChatInfo: 'Info chat',\n                ChannelInfo: 'Info canale',\n                Stickers: 'STICKER',\n                Emoji: 'EMOJI',\n                SelectChatToStartMessaging: 'Seleziona una chat per iniziare a messaggiare',\n                Text: 'Testo',\n                ViewChannelInfo: 'Visualizza info canale',\n                ViewGroupInfo: 'Visualizza info gruppo',\n                ViewProfile: 'Visualizza profilo',\n                GoToMessage: 'Vai al messaggio',\n                PhotosTitle: 'Foto',\n                VideosTitle: 'Video',\n                VoiceTitle: 'Messaggi vocali',\n                UpdateDraftConfirmation: 'Sei sicuro di voler aggiornare la bozza?'\n            },\n            emoji: {\n                Search: 'Cerca',\n                NotEmojiFound: 'Emoji non trovato',\n                ChooseDefaultSkinTone: 'Scegli ',\n                SearchResults: 'Risultati di ricerca',\n                Recent: 'Usati di recente',\n                SmileysPeople: 'Faccine e Persone',\n                AnimalsNature: 'Animali e Natura',\n                FoodDrink: 'Cibo e Bevande',\n                Activity: 'Attività',\n                TravelPlaces: 'Viaggi e Luoghi',\n                Objects: 'Oggetti',\n                Symbols: 'Simboli',\n                Flags: 'Bandiere',\n                Custom: 'Custom'\n            },\n            translation: {\n                AppName: 'Telegram',\n                Connecting: 'Connetto...',\n                ConnectingToProxy: 'Connetto al proxy...',\n                Loading: 'Carico...',\n                Updating: 'Aggiorno...',\n                WaitingForNetwork: 'Attendo la rete...',\n                ContinueOnThisLanguage: 'Continue in English',\n                SendAsFile: 'Invia come file',\n                SendAsPhoto: 'Invia come immagine'\n            }\n        },\n\n        es: {\n            auth: {\n                QRHint: '1. Open Telegram on your phone\\n2. Go to Settings > Devices > Scan QR\\n3. Scan this image to Log in',\n                LogInByPhone: 'Or log in by using your phone number',\n                LogInViaQR: 'Quick log in using QR code'\n            },\n            search: {\n                ChatsAndContacts: 'Chats y contactos',\n                SearchMessagesIn: 'Buscar mensajes en'\n            },\n            settings: {\n                ContactJoinedEnabled: 'Activado',\n                ContactJoinedDisabled: 'Desactivado',\n                NotificationsEnabled: 'Activadas',\n                NotificationsDisabled: 'Desactivadas',\n                PreviewEnabled: 'Activada',\n                PreviewDisabled: 'Desactivada',\n                BioAbout: 'Datos como la edad, ocupación o ciudad. Ejemplo: Diseñador de Chicago. 23 años.',\n                Archived: 'Archivados',\n                Saved: 'Guardados',\n                EditProfile: 'Editar perfil',\n                GeneralSettings: 'General'\n            },\n            local: {\n                CopyMessageLink: 'Copiar enlace del mensaje',\n                DragToReposition: 'Arrastra para posicionar',\n                PollQuizOneRightAnswer: 'Un cuestionario tiene sólo una respuesta correcta.',\n                LeftChannel: 'Salió del canal',\n                LeftGroup: 'Salió del grupo',\n                EnterPassword: 'Pon una contraseña',\n                YourAccountProtectedWithPassword: 'Tu cuenta está protegida con una contraseña adicional.',\n                DeletedMessage: 'Mensaje eliminado',\n                YourPhone: 'Tu teléfono',\n                SignInToTelegram: 'Iniciar sesión en Telegram',\n                PhoneNumber: 'Número de teléfono',\n                Country: 'País',\n                KeepMeSignedIn: 'Recordarme',\n                StartText: 'Por favor, confirma el código de tu país y pon tu número de teléfono.',\n                Next: 'Siguiente',\n                InvalidPhoneNumber: 'Número de teléfono inválido. Por favor, revisa el número y reinténtalo.',\n                More: 'Más',\n                SendFileConfirmation: '¿Quieres enviar el archivo?',\n                SendFilesConfirmation: '¿Quieres enviar los archivos?',\n                SendMessage: 'Enviar mensaje',\n                ChatInfo: 'Info. del chat',\n                ChannelInfo: 'Info. del canal',\n                Stickers: 'STICKERS',\n                Emoji: 'EMOJIS',\n                SelectChatToStartMessaging: 'Elige un chat para comenzar',\n                Text: 'Texto',\n                ViewChannelInfo: 'Ver info. del canal',\n                ViewGroupInfo: 'Ver info. del grupo',\n                ViewProfile: 'Ver perfil',\n                GoToMessage: 'Ir al mensaje',\n                PhotosTitle: 'Fotos',\n                VideosTitle: 'Videos',\n                VoiceTitle: 'Mensajes de voz',\n                UpdateDraftConfirmation: '¿Quieres actualizar el borrador?'\n            },\n            emoji: {\n                Search: 'Buscar',\n                NotEmojiFound: 'No se encontraron emojis',\n                ChooseDefaultSkinTone: 'Elige el tono de piel por defecto',\n                SearchResults: 'Resultados de búsqueda',\n                Recent: 'Uso frecuente',\n                SmileysPeople: 'Emoticonos y personas',\n                AnimalsNature: 'Animales y naturaleza',\n                FoodDrink: 'Comida y bebida',\n                Activity: 'Actividad',\n                TravelPlaces: 'Viajes y destinos',\n                Objects: 'Objetos',\n                Symbols: 'Símbolos',\n                Flags: 'Banderas',\n                Custom: 'Personalizado'\n            },\n            translation: {\n                AppName: 'Telegram',\n                Connecting: 'Conectando...',\n                ConnectingToProxy: 'Conectando al proxy...',\n                Loading: 'Cargando...',\n                Updating: 'Actualizando...',\n                WaitingForNetwork: 'Esperando red...',\n                ContinueOnThisLanguage: 'Continuar en español',\n                SendAsFile: 'Enviar como archivo',\n                SendAsPhoto: 'Enviar como foto'\n            }\n        },\n\n        pl: {\n            auth: {\n                QRHint: '1. Otwórz Telegram na swoim telefonie\\n2. Przejdź do Ustawienia » Urządzenia » Zeskanuj kod QR\\n3. Zeskanuj ten obraz, aby się zalogować',\n                LogInByPhone: 'Lub zaloguj się, używając swojego numeru telefonu',\n                LogInViaQR: 'Szybkie logowanie przy użyciu kodu QR'\n            },\n            search: {\n                ChatsAndContacts: 'Czaty i kontakty',\n                SearchMessagesIn: 'Szukaj wiadomości w'\n            },\n            settings: {\n                ContactJoinedEnabled: 'Włączone',\n                ContactJoinedDisabled: 'Wyłączone',\n                NotificationsEnabled: 'Włączone',\n                NotificationsDisabled: 'Wyłączone',\n                PreviewEnabled: 'Włączony',\n                PreviewDisabled: 'Wyłączony',\n                BioAbout: 'Różne szczegóły takie jak wiek, zawód lub miasto.\\nPrzykład: 23 lata, projektant z Warszawy.',\n                Archived: 'Zarchiwizowane',\n                Saved: 'Zapisane',\n                EditProfile: 'Edytuj profil',\n                GeneralSettings: 'Ustawienia ogólne',\n                FilterChooseChats: 'Wybierz co najmniej jeden czat dla tego folderu.',\n                FilterCreateError: 'Nie można dodać więcej niż 10 folderów.'\n            },\n            local: {\n                CopyMessageLink: 'Kopiuj link wiadomości',\n                DragToReposition: 'Przeciągnij, aby zmienić położenie',\n                PollQuizOneRightAnswer: 'Quiz ma tylko jedną poprawną odpowiedź.',\n                LeftChannel: 'Opuszczono kanał',\n                LeftGroup: 'Opuszczono grupę',\n                EnterPassword: 'Wprowadź hasło',\n                YourAccountProtectedWithPassword: 'Twoje konto jest zabezpieczone dodatkowym hasłem.',\n                DeletedMessage: 'Usunięta wiadomość',\n                YourPhone: 'Twój numer telefonu',\n                SignInToTelegram: 'Zaloguj się do Telegrama',\n                PhoneNumber: 'Numer telefonu',\n                Country: 'Kraj',\n                KeepMeSignedIn: 'Nie wylogowuj mnie',\n                StartText: 'Potwierdź kod twojego kraju i podaj swój numer telefonu.',\n                Next: 'Dalej',\n                InvalidPhoneNumber: 'Nieprawidłowy numer telefonu. Sprawdź numer i spróbuj ponownie.',\n                More: 'Więcej',\n                SendFileConfirmation: 'Czy na pewno chcesz wysłać plik?',\n                SendFilesConfirmation: 'Czy na pewno chcesz wysłać pliki?',\n                SendMessage: 'Wyślij wiadomość',\n                ChatInfo: 'Info o grupie',\n                ChannelInfo: 'Info o kanale',\n                Stickers: 'NAKLEJKI',\n                Emoji: 'EMOJI',\n                SelectChatToStartMessaging: 'Wybierz czat, aby rozpocząć rozmowę',\n                Text: 'Tekst',\n                ViewChannelInfo: 'Pokaż info o kanale',\n                ViewGroupInfo: 'Pokaż info o grupie',\n                ViewProfile: 'Pokaż profil',\n                GoToMessage: 'Idź do wiadomości',\n                PhotosTitle: 'Zdjęcia',\n                VideosTitle: 'Wideo',\n                VoiceTitle: 'Wiadomości głosowe',\n                UpdateDraftConfirmation: 'Czy na pewno chcesz zaktualizować wersję roboczą?',\n                RecordDeniedTitle: 'Odmowa dostępu',\n                RecordDeniedDescription: 'Zanim będzie można nagrywać notatki głosowe, należy zezwolić przeglądarce na dostęp do mikrofonu. Kliknij na ikonę kłódki obok adresu URL, a następnie upewnij się, że jest wybrane Zezwól w ustawieniach mikrofonu, aby umożliwić dostęp do twojego mikrofonu.'\n            },\n            emoji: {\n                Search: 'Szukaj',\n                NotEmojiFound: 'Nie znaleziono emoji',\n                ChooseDefaultSkinTone: 'Wybierz domyślny odcień skóry',\n                SearchResults: 'Wyniki wyszukiwania',\n                Recent: 'Często używane',\n                SmileysPeople: 'Uśmieszki i ludzie',\n                AnimalsNature: 'Zwierzęta i natura',\n                FoodDrink: 'Jedzenie i picie',\n                Activity: 'Aktywność',\n                TravelPlaces: 'Podróże i miejsca',\n                Objects: 'Obiekty',\n                Symbols: 'Symbole',\n                Flags: 'Flagi',\n                Custom: 'Własne'\n            },\n            translation: {\n                AppName: 'Telegram',\n                Connecting: 'Łączenie…',\n                ConnectingToProxy: 'Łączenie z proxy…',\n                Loading: 'Wczytywanie…',\n                Updating: 'Aktualizowanie…',\n                WaitingForNetwork: 'Czekam na sieć…',\n                ContinueOnThisLanguage: 'Kontynuuj po angielsku',\n                SendAsFile: 'Wyślij jako plik',\n                SendAsPhoto: 'Wyślij jako zdjęcie'\n            }\n        },\n    },\n    lng,\n    fallbackLng,\n    interpolation: {\n        escapeValue: false\n    },\n    react: {\n        wait: false\n    }\n});\n\nconst cache = new LocalizationCache(null, {\n    enabled: true,\n    prefix: 'i18next_res_',\n    expirationTime: Infinity\n});\n\nconst defaultResources = cache.read(fallbackLng, defaultNS, (err, data) => data);\nconst currentResources = cache.read(lng, defaultNS, (err, data) => data);\n\ni18n.addResourceBundle(fallbackLng, defaultNS, defaultResources);\ni18n.addResourceBundle(lng, defaultNS, currentResources);\n\nclass LocalizationStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.fallbackLng = fallbackLng;\n        this.i18n = i18n;\n        this.cache = cache;\n\n        this.addTdLibListener();\n    }\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    onUpdate = async update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                switch (update.authorization_state['@type']) {\n                    case 'authorizationStateWaitTdlibParameters':\n                        TdLibController.send({\n                            '@type': 'setOption',\n                            name: 'localization_target',\n                            value: { '@type': 'optionValueString', value: 'android' }\n                        });\n\n                        TdLibController.send({\n                            '@type': 'setOption',\n                            name: 'language_pack_id',\n                            value: { '@type': 'optionValueString', value: lng }\n                        });\n\n                        this.info = await TdLibController.send({\n                            '@type': 'getLocalizationTargetInfo',\n                            only_local: false\n                        });\n\n                        TdLibController.clientUpdate({\n                            '@type': 'clientUpdateLanguageChange',\n                            language: lng\n                        });\n                        break;\n                }\n                break;\n            }\n            case 'updateLanguagePackStrings': {\n                // add/remove new strings\n\n                this.emit('updateLanguagePackStrings', update);\n                break;\n            }\n        }\n    };\n\n    onClientUpdate = async update => {\n        switch (update['@type']) {\n            case 'clientUpdateLanguageChange': {\n                const { language } = update;\n\n                await this.loadLanguage(language);\n\n                localStorage.setItem('i18next', language);\n\n                await i18n.changeLanguage(language);\n\n                TdLibController.send({\n                    '@type': 'setOption',\n                    name: 'language_pack_id',\n                    value: { '@type': 'optionValueString', value: language }\n                });\n\n                this.emit('clientUpdateLanguageChange', update);\n                break;\n            }\n        }\n    };\n\n    processStrings = (lng, languagePackStrings) => {\n        if (!languagePackStrings) return {};\n        const { strings } = languagePackStrings;\n        if (!strings) return {};\n\n        let result = {};\n        for (let i = 0; i < strings.length; i++) {\n            const { value } = strings[i];\n            switch (value['@type']) {\n                case 'languagePackStringValueOrdinary': {\n                    result[strings[i].key] = value.value;\n                    break;\n                }\n                case 'languagePackStringValuePluralized': {\n                    if (value.zero_value) {\n                        result[strings[i].key + 'Z'] = value.zero_value;\n                    }\n                    if (value.one_value) {\n                        result[strings[i].key + 'O'] = value.one_value;\n                    }\n                    if (value.two_value) {\n                        result[strings[i].key + 'T'] = value.two_value;\n                    }\n                    if (value.few_value) {\n                        result[strings[i].key + 'F'] = value.few_value;\n                    }\n                    if (value.many_value) {\n                        result[strings[i].key + 'M'] = value.many_value;\n                    }\n                    if (value.other_value) {\n                        result[strings[i].key + 'OT'] = value.other_value;\n                    }\n                    break;\n                }\n                case 'languagePackStringValueDeleted': {\n                    break;\n                }\n            }\n        }\n\n        return result;\n    };\n\n    loadLanguage = async language => {\n        const result = await TdLibController.send({\n            '@type': 'getLanguagePackStrings',\n            language_pack_id: language,\n            keys: []\n        });\n\n        const resources = this.processStrings(language, result);\n        this.cache.save(language, defaultNS, resources);\n        i18n.addResourceBundle(language, defaultNS, resources);\n    };\n}\n\nconst store = new LocalizationStore();\nwindow.localization = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport { openChat } from '../../Actions/Client';\nimport { modalManager } from '../../Utils/Modal';\nimport { getDecodedUrl, getHref, isUrlSafe } from '../../Utils/Url';\nimport MessageStore from '../../Stores/MessageStore';\nimport TdLibController from '../../Controllers/TdLibController';\nimport './SafeLink.css';\n\nclass SafeLink extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {};\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        const { displayText, mail, url } = props;\n\n        if (state.prevUrl !== url || state.prevDisplayText !== displayText) {\n            return {\n                prevUrl: url,\n                prevDisplayText: displayText,\n                safe: isUrlSafe(displayText, url),\n                decodedUrl: getDecodedUrl(url, mail),\n                href: getHref(url, mail),\n                confirm: false\n            };\n        }\n\n        return null;\n    }\n\n    handleClick = event => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        this.setState({ confirm: true });\n    };\n\n    handleDialogClick = event => {\n        event.preventDefault();\n        event.stopPropagation();\n    };\n\n    handleClose = () => {\n        this.setState({ confirm: false });\n    };\n\n    handleDone = event => {\n        this.handleClose();\n\n        const { url, onClick } = this.props;\n        if (!url) return;\n\n        if (onClick) {\n            onClick(event);\n        } else {\n            const newWindow = window.open();\n            newWindow.opener = null;\n            newWindow.location = url;\n        }\n    };\n\n    isTelegramLink(url) {\n        if (!url) return false;\n\n        const lowerCaseUrl = url\n            .toLowerCase()\n            .replace('https://', '')\n            .replace('http://', '');\n\n        return lowerCaseUrl.startsWith('t.me') || lowerCaseUrl.startsWith('tg://');\n    }\n\n    handleSafeClick = async event => {\n        event.stopPropagation();\n\n        const { onClick, url: href } = this.props;\n\n        if (this.isTelegramLink(href)) {\n            event.preventDefault();\n            try {\n                const messageLinkInfo = await TdLibController.send({\n                    '@type': 'getMessageLinkInfo',\n                    url: href\n                });\n\n                MessageStore.setItems([messageLinkInfo.message]);\n\n                const { chat_id, message } = messageLinkInfo;\n                if (chat_id) {\n                    openChat(chat_id, message ? message.id : null);\n                    return;\n                }\n            } catch (error) {\n                console.log('[safeLink] messageLinkInfo error', error);\n            }\n\n            if (onClick) {\n                onClick(event);\n            }\n        }\n\n        if (onClick) {\n            event.preventDefault();\n            onClick(event);\n        }\n    };\n\n    render() {\n        const { className, children, t, url } = this.props;\n        const { confirm, decodedUrl, href, safe } = this.state;\n\n        if (!url) return null;\n        if (!decodedUrl) return null;\n\n        return (\n            <>\n                {safe ? (\n                    <a\n                        className={className}\n                        href={href}\n                        title={decodedUrl}\n                        target='_blank'\n                        rel='noopener noreferrer'\n                        onClick={this.handleSafeClick}>\n                        {children || url}\n                    </a>\n                ) : (\n                    <>\n                        <a className={className} title={decodedUrl} onClick={this.handleClick}>\n                            {children || url}\n                        </a>\n                        {confirm && (\n                            <Dialog\n                                manager={modalManager}\n                                transitionDuration={0}\n                                open={confirm}\n                                onClose={this.handleClose}\n                                onClick={this.handleDialogClick}\n                                aria-labelledby='confirm-dialog-title'>\n                                <DialogTitle id='confirm-dialog-title'>{t('Confirm')}</DialogTitle>\n                                <DialogContent classes={{ root: 'safe-link-content-root' }}>\n                                    <DialogContentText>{`Open this link?\\n\\n${decodedUrl}`}</DialogContentText>\n                                </DialogContent>\n                                <DialogActions>\n                                    <Button onClick={this.handleClose}>{t('Cancel')}</Button>\n                                    <Button onClick={this.handleDone} color='primary'>\n                                        {t('Open')}\n                                    </Button>\n                                </DialogActions>\n                            </Dialog>\n                        )}\n                    </>\n                )}\n            </>\n        );\n    }\n}\n\nSafeLink.propTypes = {\n    url: PropTypes.string.isRequired,\n    displayText: PropTypes.string,\n    mail: PropTypes.bool,\n    onClick: PropTypes.func\n};\n\nexport default withTranslation()(SafeLink);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nimport { arrayBufferToBase64, isAuthorizationReady } from './Utils/Common';\nimport { OPTIMIZATIONS_FIRST_START, PLAYER_STREAMING_PRIORITY } from './Constants';\nimport AppStore from './Stores/ApplicationStore';\nimport FileStore from './Stores/FileStore';\nimport NotificationStore from './Stores/NotificationStore';\nimport TdLibController from './Controllers/TdLibController';\n\nconst isLocalhost =\n    //false;\n    Boolean(\n        window.location.hostname === 'localhost' ||\n            // [::1] is the IPv6 localhost address.\n            window.location.hostname === '[::1]' ||\n            // 127.0.0.1/8 is considered localhost for IPv4.\n            window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n    );\n\nexport default async function register() {\n    console.log('[SW] Register');\n\n    if (OPTIMIZATIONS_FIRST_START) {\n        localStorage.setItem('register', 'true');\n    }\n\n    if ('serviceWorker' in navigator) {\n        // The URL constructor is available in all browsers that support SW.\n        const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n        if (publicUrl.origin !== window.location.origin) {\n            // Our service worker won't work if PUBLIC_URL is on a different origin\n            // from what our page is served on. This might happen if a CDN is used to\n            // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n            return;\n        }\n\n        const serviceWorkerName =\n            process.env.NODE_ENV === 'production' ? 'service-worker.js' : 'custom-service-worker.js';\n        const swUrl = `${process.env.PUBLIC_URL}/${serviceWorkerName}`;\n        console.log(`[SW] Service worker url: ${swUrl}`);\n\n        if (!isLocalhost) {\n            // Is not local host. Just register service worker\n            await registerValidSW(swUrl);\n        } else {\n            // This is running on localhost. Lets check if a service worker still exists or not.\n            await checkValidServiceWorker(swUrl);\n        }\n    }\n}\n\nasync function registerValidSW(swUrl) {\n    console.log('[SW] register');\n    try {\n        const registration = await navigator.serviceWorker.register(swUrl);\n        registration.onupdatefound = () => {\n            const installingWorker = registration.installing;\n            installingWorker.onstatechange = () => {\n                if (installingWorker.state === 'installed') {\n                    if (navigator.serviceWorker.controller) {\n                        // At this point, the old content will have been purged and\n                        // the fresh content will have been added to the cache.\n                        // It's the perfect time to display a \"New content is\n                        // available; please refresh.\" message in your web app.\n                        console.log('[SW] New content is available; please refresh.');\n\n                        TdLibController.clientUpdate({ '@type': 'clientUpdateNewContentAvailable' });\n                    } else {\n                        // At this point, everything has been precached.\n                        // It's the perfect time to display a\n                        // \"Content is cached for offline use.\" message.\n                        console.log('[SW] Content is cached for offline use.');\n                    }\n                }\n            };\n        };\n    } catch (error) {\n        console.error('[SW] Error during service worker registration: ', error);\n    }\n    console.log('[SW] register complete', navigator.serviceWorker, navigator.serviceWorker.controller);\n}\n\nexport async function subscribeNotifications() {\n    try {\n        const registration = await navigator.serviceWorker.ready;\n\n        let pushSubscription = await registration.pushManager.getSubscription();\n        if (pushSubscription) await pushSubscription.unsubscribe();\n\n        pushSubscription = await registration.pushManager.subscribe({ userVisibleOnly: true });\n        console.log('[SW] Received push subscription: ', JSON.stringify(pushSubscription));\n\n        const { endpoint } = pushSubscription;\n        const p256dh_base64url = arrayBufferToBase64(pushSubscription.getKey('p256dh'));\n        const auth_base64url = arrayBufferToBase64(pushSubscription.getKey('auth'));\n\n        if (endpoint && p256dh_base64url && auth_base64url) {\n            const { authorizationState } = AppStore;\n            if (isAuthorizationReady(authorizationState)) {\n                const deviceToken = {\n                    '@type': 'deviceTokenWebPush',\n                    endpoint,\n                    p256dh_base64url,\n                    auth_base64url\n                };\n                console.log('[SW] registerDevice', deviceToken);\n                const result = await TdLibController.send({\n                    '@type': 'registerDevice',\n                    device_token: deviceToken,\n                    other_user_ids: []\n                });\n                console.log('[SW] registerDevice result', result);\n            }\n        }\n    } catch (error) {\n        console.error('[SW] Error during service worker push subscription: ', error);\n        NotificationStore.enableSound = true;\n    }\n}\n\nasync function checkValidServiceWorker(swUrl) {\n    console.log('[SW] checkValid');\n    // Check if the service worker can be found. If it can't reload the page.\n    try {\n        const response = await fetch(swUrl);\n\n        // Ensure service worker exists, and that we really are getting a JS file.\n        if (response.status === 404 || response.headers.get('content-type').indexOf('javascript') === -1) {\n            console.log('[SW] unregister');\n            // No service worker found. Probably a different app. Reload the page.\n            const registration = await navigator.serviceWorker.ready;\n            await registration.unregister();\n\n            window.location.reload();\n        } else {\n            // Service worker found. Proceed as normal.\n            await registerValidSW(swUrl);\n        }\n    } catch (error) {\n        console.log('[SW] No internet connection found. App is running in offline mode.');\n    }\n}\n\nexport async function unregister() {\n    if ('serviceWorker' in navigator) {\n        const registration = await navigator.serviceWorker.ready;\n\n        await registration.unregister();\n    }\n}\n\nexport async function update() {\n    if ('serviceWorker' in navigator) {\n        const registration = await navigator.serviceWorker.ready;\n\n        await registration.update();\n    }\n}\n\nconst requests = [];\nwindow.requests = requests;\n\nasync function processRequest(request) {\n    const { fileId, offset, limit, resolve, reject } = request;\n\n    const file = FileStore.get(fileId);\n    try {\n        let filePart = null;\n        try {\n            if (file) {\n                const { local } = file;\n                if (local) {\n                    const { download_offset, downloaded_prefix_size } = local;\n                    // console.log('[cache] checkFile', fileId, [offset, limit], [download_offset, downloaded_prefix_size]);\n                    if (download_offset <= offset && offset + limit <= download_offset + downloaded_prefix_size) {\n\n                        // console.log('[cache] readExistingFile', fileId);\n                        filePart = await TdLibController.send({\n                            '@type': 'readFilePart',\n                            file_id: fileId,\n                            offset,\n                            count: limit\n                        });\n                    }\n                }\n            }\n        } catch (e) {\n            \n        }\n\n        if (!filePart) {\n            // console.log('[cache] downloadFile', fileId, [offset, limit]);\n            await TdLibController.send({\n                '@type': 'downloadFile',\n                file_id: fileId,\n                priority: PLAYER_STREAMING_PRIORITY,\n                offset,\n                limit,\n                synchronous: true\n            });\n\n            // console.log('[cache] readFilePart', fileId, [offset, limit]);\n            filePart = await TdLibController.send({\n                '@type': 'readFilePart',\n                file_id: fileId,\n                offset,\n                count: limit\n            });\n        }\n\n        const { data } = filePart;\n\n        resolve(data);\n    } catch (error) {\n        reject(error)\n    }\n}\n\nasync function getFilePart(fileId, offset, limit) {\n    const promise = new Promise(async (resolve, reject) => {\n\n        requests.push({\n            fileId,\n            offset,\n            limit,\n            resolve,\n            reject\n        });\n\n        if (requests.length > 1) {\n            return;\n        }\n\n        while (requests.length > 0) {\n            const request = requests[requests.length - 1];\n\n            await processRequest(request);\n\n            const index = requests.indexOf(request);\n            requests.splice(index, 1);\n        }\n    });\n\n    return await promise;\n}\n\nif ('serviceWorker' in navigator) {\n    navigator.serviceWorker.onmessage = async (e) => {\n        // console.log('[stream] client.onmessage', e.data);\n\n        switch (e.data['@type']) {\n            case 'getFile': {\n                const { fileId, offset, limit, start, end } = e.data;\n\n                try {\n                    const data = await getFilePart(fileId, offset, limit);\n\n                    navigator.serviceWorker.controller.postMessage({\n                        '@type': 'getFileResult',\n                        fileId,\n                        offset,\n                        limit,\n                        data\n                    });\n                } catch (error) {\n\n                    navigator.serviceWorker.controller.postMessage({\n                        '@type': 'getFileError',\n                        fileId,\n                        offset,\n                        limit,\n                        error\n                    });\n                }\n                break;\n            }\n        }\n    };\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport punycode from './Punycode';\n\nexport function getHref(url, mail) {\n    if (!url) return null;\n\n    if (mail) return url.startsWith('mailto:') ? url : 'mailto:' + url;\n\n    // if (url.startsWith('tg://')) return url;\n\n    return url.startsWith('http') ? url : 'http://' + url;\n}\n\nexport function isUrlSafe(displayText, url) {\n    if (displayText && displayText !== url) {\n        return false;\n    }\n\n    if (hasRTLOSymbol(url)) {\n        return false;\n    }\n\n    return true;\n}\n\nexport function getDecodedUrl(url, mail) {\n    if (!url) return null;\n\n    const href = getHref(url, mail);\n\n    try {\n        let decodedHref = decodeURI(href);\n\n        const domain = decodedHref.match(/^https?:\\/\\/([^\\/:?#]+)(?:[\\/:?#]|$)/i)[1];\n        decodedHref = decodedHref.replace(domain, punycode.ToUnicode(domain));\n\n        return decodedHref;\n    } catch (error) {\n        console.log('SafeLink.getDecodedUrl error ', url, error);\n    }\n\n    return null;\n}\n\nconst regExpRTLO = /\\u202e/;\n\nexport function hasRTLOSymbol(url) {\n    if (!url) return false;\n\n    return regExpRTLO.test(url);\n}\n\nconst regExpDomainExplicit = new RegExp(\n    '(?:([a-zA-Z]+):\\\\/\\\\/)((?:[A-Za-z' +\n        '\\xD0\\x90-\\xD0\\xAF\\xD0\\x81' +\n        '\\xD0\\xB0-\\xD1\\x8F\\xD1\\x91' +\n        '0-9\\\\-\\\\_]+\\\\.){0,10}([A-Za-z' +\n        '\\xD1\\x80\\xD1\\x84' +\n        '\\\\-\\\\d]{2,22})(\\\\:\\\\d+)?)'\n);\nconst regExpDomain = new RegExp(\n    '(?:([a-zA-Z]+):\\\\/\\\\/)?((?:[A-Za-z' +\n        '\\xD0\\x90-\\xD0\\xAF\\xD0\\x81' +\n        '\\xD0\\xB0-\\xD1\\x8F\\xD1\\x91' +\n        '0-9\\\\-\\\\_]+\\\\.){1,10}([A-Za-z' +\n        '\\xD1\\x80\\xD1\\x84' +\n        '\\\\-\\\\d]{2,22})(\\\\:\\\\d+)?)'\n);\nconst regExpProtocol = new RegExp('^([a-zA-Z]+):\\\\/\\\\/');\n\n// https://github.com/telegramdesktop/tdesktop/blob/4e80d54be130eca76129f2c4995fe685d1014442/Telegram/SourceFiles/base/qthelp_url.cpp#L105\nexport function validateUrl(value) {\n    // value = punycode.ToASCII(value);\n\n    const trimmed = value.trim();\n    if (!trimmed) {\n        return null;\n    }\n\n    const match = trimmed.match(regExpDomainExplicit);\n    if (!match) {\n        const domainMatch = trimmed.match(regExpDomain);\n        if (!domainMatch || domainMatch.index !== 0) {\n            return null;\n        }\n\n        return 'http://' + trimmed;\n    } else if (match.index !== 0) {\n        return null;\n    }\n\n    const protocolMatch = trimmed.match(regExpProtocol);\n    return protocolMatch && isGoodProtocol(protocolMatch[0]) ? trimmed : null;\n}\n\nfunction isGoodProtocol(value) {\n    return ['http', 'https', 'tg'].some(x => value.toLowerCase().indexOf(x) === 0);\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport { KEY_SUGGESTED_LANGUAGE_PACK_ID } from '../Constants';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass OptionStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.items = new Map();\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'updateOption':\n                const { name, value } = update;\n\n                this.set(name, value);\n\n                if (name === KEY_SUGGESTED_LANGUAGE_PACK_ID) {\n                    localStorage.setItem(name, value.value);\n                }\n\n                this.emit('updateOption', update);\n                break;\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {};\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    get(name) {\n        return this.items.get(name);\n    }\n\n    set(name, value) {\n        this.items.set(name, value);\n    }\n}\n\nconst store = new OptionStore();\nwindow.option = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { withTranslation } from 'react-i18next';\nimport DeletedAccountIcon from '../../Assets/Icons/DeletedAccount';\nimport { getUserLetters, isDeletedUser } from '../../Utils/User';\nimport { getSrc, loadUserContent } from '../../Utils/File';\nimport FileStore from '../../Stores/FileStore';\nimport UserStore from '../../Stores/UserStore';\nimport './UserTile.css';\n\nclass UserTile extends Component {\n    state = { };\n\n    static getDerivedStateFromProps(props, state) {\n        const { userId, firstName, lastName, t } = props;\n\n        if (state.prevUserId !== userId) {\n            const user = UserStore.get(userId);\n            const file = user && user.profile_photo ? user.profile_photo.small : null;\n\n            const fileId = file ? file.id : -1;\n            const src = getSrc(file);\n            const loaded = state.src === src && src !== '' || fileId === -1;\n            const letters = getUserLetters(userId, firstName, lastName, t);\n\n            return {\n                prevUserId: userId,\n\n                fileId,\n                src,\n                loaded,\n                letters\n            };\n        }\n\n        return null;\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        const { userId } = this.props;\n        const { fileId, src, loaded, letters } = this.state;\n\n        if (nextProps.userId !== userId) {\n            return true;\n        }\n\n        if (nextState.fileId !== fileId) {\n            return true;\n        }\n\n        if (nextState.src !== src) {\n            return true;\n        }\n\n        if (nextState.loaded !== loaded) {\n            return true;\n        }\n\n        if (nextState.letters !== letters) {\n            return true;\n        }\n\n        return false;\n    }\n\n    componentDidMount() {\n        UserStore.on('updateUser', this.onUpdateUser);\n        FileStore.on('clientUpdateUserBlob', this.onClientUpdateUserBlob);\n    }\n\n    componentWillUnmount() {\n        UserStore.off('updateUser', this.onUpdateUser);\n        FileStore.off('clientUpdateUserBlob', this.onClientUpdateUserBlob);\n    }\n\n    onClientUpdateUserBlob = update => {\n        const { userId } = this.props;\n        const { fileId, loaded } = this.state;\n\n        if (userId !== update.userId) return;\n        if (fileId !== update.fileId) return;\n\n        if (!loaded) {\n            const user = UserStore.get(userId);\n            if (!user) {\n                return null;\n            }\n\n            const file = user && user.profile_photo ? user.profile_photo.small : null;\n            const src = getSrc(file);\n\n            this.setState({ src });\n        }\n    };\n\n    onUpdateUser = update => {\n        const { userId, firstName, lastName, t } = this.props;\n        const { user } = update;\n\n        if (!user) return;\n        if (userId !== user.id) return;\n\n        const file = user && user.profile_photo ? user.profile_photo.small : null;\n\n        const fileId = file ? file.id : -1;\n        const src = getSrc(file);\n        const loaded = this.state.src === src && src !== '' || fileId === -1;\n        const letters = getUserLetters(userId, firstName, lastName, t);\n\n        this.setState({\n            src,\n            fileId,\n            loaded,\n            letters\n        });\n\n        if (file) {\n            const store = FileStore.getStore();\n            loadUserContent(store, userId);\n        }\n    };\n\n    handleSelect = event => {\n        const { userId, onSelect } = this.props;\n        if (!onSelect) return;\n\n        event.stopPropagation();\n        onSelect(userId);\n    };\n\n    handleLoad = () => {\n        this.setState({ loaded: true });\n    };\n\n    render() {\n        const { className, userId, fistName, lastName, onSelect, small, dialog, poll } = this.props;\n        const { fileId, src, loaded, letters } = this.state;\n\n        const user = UserStore.get(userId);\n        if (!user && !(fistName || lastName)) return null;\n\n        if (isDeletedUser(userId)) {\n            return (\n                <div\n                    className={classNames(\n                        className,\n                        'user-tile',\n                        'tile_color_0',\n                        { pointer: onSelect },\n                        { 'tile-dialog': dialog },\n                        { 'tile-small': small },\n                        { 'tile-poll': poll }\n                    )}\n                    onClick={this.handleSelect}>\n                    <div className='tile-photo'>\n                        <div className='tile-saved-messages'>\n                            <DeletedAccountIcon fontSize='default' />\n                        </div>\n                    </div>\n                </div>\n            );\n        }\n\n        const tileLoaded = src && loaded;\n        const tileColor = `tile_color_${(Math.abs(userId) % 7) + 1}`;\n\n        return (\n            <div\n                className={classNames(\n                    className,\n                    'user-tile',\n                    { [tileColor]: !tileLoaded },\n                    { pointer: onSelect },\n                    { 'tile-dialog': dialog },\n                    { 'tile-small': small },\n                    { 'tile-poll': poll }\n                )}\n                onClick={this.handleSelect}>\n                {!tileLoaded && (\n                    <div className='tile-photo'>\n                        <span className='tile-text'>{letters}</span>\n                    </div>\n                )}\n                {src && <img className='tile-photo' src={src} onLoad={this.handleLoad} draggable={false} alt='' />}\n            </div>\n        );\n    }\n}\n\nUserTile.propTypes = {\n    userId: PropTypes.number.isRequired,\n    firstName: PropTypes.string,\n    lastName: PropTypes.string,\n    onSelect: PropTypes.func,\n    small: PropTypes.bool\n};\n\nexport default withTranslation()(UserTile);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { withTranslation } from 'react-i18next';\nimport { compose, withRestoreRef, withSaveRef } from '../../../Utils/HOC';\nimport FileProgress from '../../Viewer/FileProgress';\nimport { getFitSize, getPhotoSize } from '../../../Utils/Common';\nimport { isBlurredThumbnail } from '../../../Utils/Media';\nimport { getFileSize, getSrc, isGifMimeType } from '../../../Utils/File';\nimport { PHOTO_DISPLAY_SIZE } from '../../../Constants';\nimport AnimationStore from '../../../Stores/AnimationStore';\nimport AppStore from '../../../Stores/ApplicationStore';\nimport FileStore from '../../../Stores/FileStore';\nimport InstantViewStore from '../../../Stores/InstantViewStore';\nimport MessageStore from '../../../Stores/MessageStore';\nimport './Animation.css';\n\nclass Animation extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = { };\n        this.videoRef = React.createRef();\n\n        this.setPlayerParams();\n    }\n\n    setPlayerParams() {\n        this.windowFocused = window.hasFocus;\n\n        this.inView = false;\n        this.openMediaViewer = Boolean(AppStore.mediaViewerContent);\n        this.openProfileMediaViewer = Boolean(AppStore.profileMediaViewerContent);\n        this.openIV = Boolean(InstantViewStore.getCurrent());\n\n        this.ivInView = false;\n        this.openIVMedia = Boolean(InstantViewStore.viewerContent);\n        this.playing = false;\n\n        const player = this.videoRef.current;\n        if (player) {\n            player.load();\n        }\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (prevProps.animation !== this.props.animation) {\n            this.setPlayerParams();\n        }\n    }\n\n    componentDidMount() {\n        AnimationStore.on('clientUpdateAnimationsInView', this.onClientUpdateAnimationsInView);\n        AppStore.on('clientUpdateFocusWindow', this.onClientUpdateFocusWindow);\n        AppStore.on('clientUpdateMediaViewerContent', this.onClientUpdateMediaViewerContent);\n        AppStore.on('clientUpdateProfileMediaViewerContent', this.onClientUpdateProfileMediaViewerContent);\n        FileStore.on('clientUpdateAnimationThumbnailBlob', this.onClientUpdateAnimationThumbnailBlob);\n        FileStore.on('clientUpdateAnimationBlob', this.onClientUpdateAnimationBlob);\n        MessageStore.on('clientUpdateMessagesInView', this.onClientUpdateMessagesInView);\n        InstantViewStore.on('clientUpdateInstantViewContent', this.onClientUpdateInstantViewContent);\n        InstantViewStore.on('clientUpdateInstantViewViewerContent', this.onClientUpdateInstantViewViewerContent);\n        InstantViewStore.on('clientUpdateBlocksInView', this.onClientUpdateBlocksInView);\n    }\n\n    componentWillUnmount() {\n        AnimationStore.on('clientUpdateAnimationsInView', this.onClientUpdateAnimationsInView);\n        AppStore.off('clientUpdateFocusWindow', this.onClientUpdateFocusWindow);\n        AppStore.off('clientUpdateMediaViewerContent', this.onClientUpdateMediaViewerContent);\n        AppStore.off('clientUpdateProfileMediaViewerContent', this.onClientUpdateProfileMediaViewerContent);\n        FileStore.off('clientUpdateAnimationThumbnailBlob', this.onClientUpdateAnimationThumbnailBlob);\n        FileStore.off('clientUpdateAnimationBlob', this.onClientUpdateAnimationBlob);\n        MessageStore.off('clientUpdateMessagesInView', this.onClientUpdateMessagesInView);\n        InstantViewStore.off('clientUpdateInstantViewContent', this.onClientUpdateInstantViewContent);\n        InstantViewStore.off('clientUpdateInstantViewViewerContent', this.onClientUpdateInstantViewViewerContent);\n        InstantViewStore.off('clientUpdateBlocksInView', this.onClientUpdateBlocksInView);\n    }\n\n    startStopPlayer = () => {\n        const player = this.videoRef.current;\n        if (!player) return;\n\n        if (\n            this.windowFocused &&\n            ((this.inView && !this.openMediaViewer && !this.openProfileMediaViewer && !this.openIV) ||\n                (this.ivInView && !this.openIVMedia) ||\n                this.pickerInView)\n        ) {\n            player.play();\n        } else {\n            player.pause();\n        }\n    };\n\n    onClientUpdateInstantViewContent = update => {\n        this.openIV = Boolean(InstantViewStore.getCurrent());\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateProfileMediaViewerContent = update => {\n        this.openProfileMediaViewer = Boolean(AppStore.profileMediaViewerContent);\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateMediaViewerContent = update => {\n        this.openMediaViewer = Boolean(AppStore.mediaViewerContent);\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateInstantViewViewerContent = update => {\n        this.openIVMedia = Boolean(InstantViewStore.viewerContent);\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateFocusWindow = update => {\n        this.windowFocused = update.focused;\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateMessagesInView = update => {\n        const { chatId, messageId } = this.props;\n        const key = `${chatId}_${messageId}`;\n\n        this.inView = update.messages.has(key);\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateBlocksInView = update => {\n        const { pageBlock } = this.props;\n        if (!pageBlock) return;\n\n        this.ivInView = update.blocks.has(pageBlock);\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateAnimationsInView = update => {\n        const { animation } = this.props;\n        if (!animation) return;\n\n        this.pickerInView = update.animations.has(animation);\n\n        this.startStopPlayer();\n    }\n\n    onClientUpdateAnimationBlob = update => {\n        const { animation } = this.props.animation;\n        const { fileId } = update;\n\n        if (!animation) return;\n\n        if (animation.id === fileId) {\n            this.forceUpdate(() => {\n                this.startStopPlayer();\n            });\n        }\n    };\n\n    onClientUpdateAnimationThumbnailBlob = update => {\n        const { thumbnail } = this.props.animation;\n        if (!thumbnail) return;\n\n        const { fileId } = update;\n\n        const { file } = thumbnail;\n        if (file && file.id === fileId) {\n            this.forceUpdate();\n        }\n    };\n\n    handlePlay = () => {\n        // setTimeout(() => {\n        //     this.playing = true;\n        //     this.forceUpdate();\n        // }, 300);\n    };\n\n    handleTimeUpdate = () => {\n        if (!this.playing) {\n            this.playing = true;\n            this.forceUpdate();\n        }\n    }\n\n    render() {\n        const { displaySize, stretch, openMedia, t, title, caption, type, style, showProgress } = this.props;\n        const { minithumbnail, thumbnail, animation, mime_type, width, height } = this.props.animation;\n        const { playing } = this;\n\n        const sizes = [...(thumbnail ? [thumbnail] : []), { width, height }];\n        const photoSize = getPhotoSize(sizes, displaySize);\n        const fitPhotoSize = getFitSize(photoSize, displaySize, stretch);\n        if (!fitPhotoSize) return null;\n\n        const animationStyle = {\n            background: 'black',\n            minWidth: stretch ? fitPhotoSize.width : null,\n            width: !stretch ? fitPhotoSize.width : null,\n            height: fitPhotoSize.height,\n            ...style\n        };\n\n        const miniSrc = minithumbnail ? 'data:image/jpeg;base64, ' + minithumbnail.data : null;\n        const thumbnailSrc = getSrc(thumbnail ? thumbnail.file : null);\n        const isBlurred = isBlurredThumbnail(thumbnail, displaySize);\n\n        const src = getSrc(animation);\n        const isGif = isGifMimeType(mime_type);\n        const source = src ? <source src={src} type={mime_type}/> : null;\n\n        return (\n            <div\n                className={classNames('animation', {\n                    'animation-message': type === 'message',\n                    'animation-picker': type === 'picker',\n                    'animation-iv': type === 'iv',\n                    'animation-title': title,\n                    'media-title': title,\n                    'animation-caption': caption,\n                    pointer: openMedia\n                })}\n                style={animationStyle}\n                onClick={openMedia}>\n                    {miniSrc && (\n                        <img\n                            className={classNames('video-preview', 'media-mini-blurred')}\n                            src={miniSrc}\n                            alt=''\n                        />\n                    )}\n                    {src && (\n                        isGif ? (\n                            <img className='animation-preview' src={src} alt='' />\n                        ) : (\n                            <video\n                                ref={this.videoRef}\n                                className='animation-player'\n                                muted\n                                autoPlay={type !== 'picker'}\n                                loop\n                                playsInline\n                                width={animationStyle.width}\n                                height={animationStyle.height}\n                                onPlay={this.handlePlay}\n                                onTimeUpdate={this.handleTimeUpdate}\n                            >\n                                {source}\n                            </video>\n                        )\n                    )}\n                    { !playing && (\n                        <>\n                            { thumbnailSrc && (\n                                <img\n                                    className={classNames('animation-thumbnail', { 'media-blurred': isBlurred })}\n                                    src={thumbnailSrc}\n                                    alt=''\n                                />\n                            )}\n                            {type !== 'picker' && type !== 'preview' && <div className='animation-meta'>{getFileSize(animation)}</div>}\n                        </>\n                    )}\n                {showProgress && (\n                    <FileProgress\n                        file={animation}\n                        download\n                        upload\n                        cancelButton\n                        icon={<div className='animation-play'>{t('AttachGif')}</div>}\n                    />\n                )}\n            </div>\n        );\n    }\n}\n\nAnimation.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    pageBlock: PropTypes.object,\n    animation: PropTypes.object.isRequired,\n    openMedia: PropTypes.func,\n    displaySize: PropTypes.number,\n    stretch: PropTypes.bool,\n    type: PropTypes.oneOf(['message', 'picker', 'iv', 'preview']),\n    showProgress: PropTypes.bool\n};\n\nAnimation.defaultProps = {\n    displaySize: PHOTO_DISPLAY_SIZE,\n    stretch: false,\n    showProgress: true\n};\n\nconst enhance = compose(\n    withSaveRef(),\n    withTranslation(),\n    withRestoreRef()\n);\n\nexport default enhance(Animation);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport EventEmitter from './EventEmitter';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass StickerStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.stickerSet = null;\n        this.hint = null;\n        this.animationData = new WeakMap();\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'updateInstalledStickerSets': {\n                const { sticker_set_ids } = update;\n                if (this.stickerSet) {\n                    const { id, is_installed } = this.stickerSet;\n                    if (is_installed !== sticker_set_ids.some(x => x === id)) {\n                        this.stickerSet = Object.assign({}, this.stickerSet, { is_installed: !is_installed });\n                    }\n                }\n\n                this.emit('updateInstalledStickerSets', update);\n                break;\n            }\n            case 'updateRecentStickers': {\n                this.emit('updateRecentStickers', update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateStickerSend': {\n                this.emit('clientUpdateStickerSend', update);\n                break;\n            }\n            case 'clientUpdateLocalStickersHint': {\n                const { hint } = update;\n\n                this.hint = hint;\n\n                this.emit('clientUpdateLocalStickersHint', update);\n                break;\n            }\n            case 'clientUpdateRemoteStickersHint': {\n                const { hint } = update;\n\n                if (this.hint && this.hint.timestamp === hint.timestamp) {\n                    this.hint = Object.assign({}, this.hint, { foundStickers: hint.stickers });\n                }\n\n                this.emit('clientUpdateRemoteStickersHint', update);\n                break;\n            }\n            case 'clientUpdateStickerSet': {\n                const { stickerSet } = update;\n\n                this.stickerSet = stickerSet;\n\n                this.emit('clientUpdateStickerSet', update);\n                break;\n            }\n            case 'clientUpdateStickerSetPosition': {\n                this.emit('clientUpdateStickerSetPosition', update);\n                break;\n            }\n            case 'clientUpdateStickerPreview': {\n                this.emit('clientUpdateStickerPreview', update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    getAnimationData(key) {\n        return this.animationData.get(key);\n    }\n\n    setAnimationData(key, data) {\n        this.animationData.set(key, data);\n    }\n}\n\nconst store = new StickerStore();\nwindow.sticker = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport FileProgress from '../../Viewer/FileProgress';\nimport { getSize, getFitSize } from '../../../Utils/Common';\nimport { getSrc } from '../../../Utils/File';\nimport { isBlurredThumbnail } from '../../../Utils/Media';\nimport { PHOTO_SIZE, PHOTO_DISPLAY_SIZE, PHOTO_THUMBNAIL_SIZE } from '../../../Constants';\nimport FileStore from '../../../Stores/FileStore';\nimport './Photo.css';\n\nclass Photo extends React.Component {\n    state = { };\n\n    static getDerivedStateFromProps(props, state) {\n        const { photo, size, thumbnailSize } = props;\n        if (photo !== state.prevPhoto) {\n            return {\n                prevPhoto: photo,\n                photoSize: getSize(photo.sizes, size),\n                thumbSize: getSize(photo.sizes, thumbnailSize),\n                minithumbnail: photo ? photo.minithumbnail : null\n            };\n        }\n\n        return null;\n    }\n\n    componentDidMount() {\n        FileStore.on('clientUpdatePhotoBlob', this.onClientUpdatePhotoBlob);\n    }\n\n    componentWillUnmount() {\n        FileStore.off('clientUpdatePhotoBlob', this.onClientUpdatePhotoBlob);\n    }\n\n    onClientUpdatePhotoBlob = update => {\n        const { photoSize, thumbSize } = this.state;\n        const { fileId } = update;\n\n        if (photoSize && photoSize.photo && photoSize.photo.id === fileId) {\n            this.forceUpdate();\n        } else if (thumbSize && thumbSize.photo && thumbSize.photo.id === fileId) {\n            this.forceUpdate();\n        }\n    };\n\n    render() {\n        const { className, displaySize, stretch, openMedia, showProgress, title, caption, type, style } = this.props;\n        const { thumbSize, photoSize, minithumbnail } = this.state;\n\n        if (!photoSize) return null;\n\n        const miniSrc = minithumbnail ? 'data:image/jpeg;base64, ' + minithumbnail.data : null;\n        const thumbSrc = getSrc(thumbSize ? thumbSize.photo : null);\n        const src = getSrc(photoSize.photo);\n        const isBlurred = isBlurredThumbnail(thumbSize, displaySize);\n\n        const fitPhotoSize = getFitSize(photoSize, displaySize, stretch);\n        if (!fitPhotoSize) return null;\n\n        const photoStyle = {\n            minWidth: stretch ? fitPhotoSize.width : null,\n            width: !stretch ? fitPhotoSize.width : null,\n            height: fitPhotoSize.height,\n            ...style\n        };\n\n        const hasSrc = Boolean(src || thumbSrc);\n\n        return (\n            <div\n                className={classNames(className, 'photo', {\n                    'photo-big': type === 'message',\n                    'photo-title': title,\n                    'photo-caption': caption,\n                    pointer: openMedia\n                })}\n                style={photoStyle}\n                onClick={openMedia}>\n                {miniSrc && (\n                    <img\n                        className={classNames('photo-preview', 'media-mini-blurred')}\n                        src={miniSrc}\n                        alt=''\n                    />\n                )}\n                {hasSrc && (\n                    <img\n                        className={classNames('photo-thumbnail', { 'media-blurred': !src && thumbSrc && isBlurred })}\n                        draggable={false}\n                        src={src || thumbSrc}\n                        alt=''\n                    />\n                )}\n                {showProgress && <FileProgress file={photoSize.photo} download upload cancelButton />}\n            </div>\n        );\n    }\n}\n\nPhoto.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    photo: PropTypes.object.isRequired,\n    openMedia: PropTypes.func,\n    showProgress: PropTypes.bool,\n\n    size: PropTypes.number,\n    thumbnailSize: PropTypes.number,\n    displaySize: PropTypes.number,\n    stretch: PropTypes.bool,\n    style: PropTypes.object\n};\n\nPhoto.defaultProps = {\n    size: PHOTO_SIZE,\n    thumbnailSize: PHOTO_THUMBNAIL_SIZE,\n    displaySize: PHOTO_DISPLAY_SIZE,\n    stretch: false,\n    showProgress: true\n};\n\nexport default Photo;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport createSvgIcon from '@material-ui/core/esm/utils/createSvgIcon';\n\nexport default createSvgIcon(\n    <path\n        transform='translate(-15.000000, -15.000000)'\n        d='M23,16 C23.5522847,16 24,16.4477153 24,17 L24,37 C24,37.5522847 23.5522847,38 23,38 L18,38 C17.4477153,38 17,37.5522847 17,37 L17,17 C17,16.4477153 17.4477153,16 18,16 L23,16 Z M36,16 C36.5522847,16 37,16.4477153 37,17 L37,37 C37,37.5522847 36.5522847,38 36,38 L31,38 C30.4477153,38 30,37.5522847 30,37 L30,17 C30,16.4477153 30.4477153,16 31,16 L36,16 Z'\n    />,\n    'Pause'\n);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport ChatStore from '../Stores/ChatStore';\nimport NotificationStore from '../Stores/NotificationStore';\nimport SupergroupStore from '../Stores/SupergroupStore';\n\nfunction isChatMuted(chatId) {\n    return getChatMuteFor(chatId) > 0;\n}\n\nfunction getChatMuteFor(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return 0;\n\n    const { notification_settings } = chat;\n    if (!notification_settings) return 0;\n\n    const { use_default_mute_for, mute_for } = notification_settings;\n\n    if (use_default_mute_for) {\n        const settings = getScopeNotificationSettings(chatId);\n\n        return settings ? settings.mute_for : false;\n    }\n\n    return mute_for;\n}\n\nfunction isChannelChat(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n    if (!chat.type) return false;\n\n    switch (chat.type['@type']) {\n        case 'chatTypeSupergroup': {\n            const supergroup = SupergroupStore.get(chat.type.supergroup_id);\n\n            return supergroup && supergroup.is_channel;\n        }\n        case 'chatTypeBasicGroup':\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nfunction getScopeNotificationSettings(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return null;\n\n    switch (chat.type['@type']) {\n        case 'chatTypePrivate':\n        case 'chatTypeSecret': {\n            return NotificationStore.settings.get('notificationSettingsScopePrivateChats');\n        }\n        case 'chatTypeBasicGroup':\n        case 'chatTypeSupergroup': {\n            let settings = null;\n            if (isChannelChat(chatId)) {\n                settings = NotificationStore.settings.get('notificationSettingsScopeChannelChats');\n            } else {\n                settings = NotificationStore.settings.get('notificationSettingsScopeGroupChats');\n            }\n            return settings;\n        }\n    }\n\n    return null;\n}\n\nfunction getChatDisablePinnedMessageNotifications(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { notification_settings } = chat;\n    if (!chat) return false;\n\n    const {\n        use_default_disable_pinned_message_notifications,\n        disable_pinned_message_notifications\n    } = notification_settings;\n    if (use_default_disable_pinned_message_notifications) {\n        const settings = getScopeNotificationSettings(chatId);\n\n        return settings ? settings.disable_pinned_message_notifications : false;\n    }\n\n    return disable_pinned_message_notifications;\n}\n\nfunction getChatDisableMentionNotifications(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const { notification_settings } = chat;\n    if (!notification_settings) return false;\n\n    const { use_default_disable_mention_notifications, disable_mention_notifications } = notification_settings;\n    if (use_default_disable_mention_notifications) {\n        const settings = getScopeNotificationSettings(chatId);\n\n        return settings ? settings.disable_mention_notifications : false;\n    }\n\n    return disable_mention_notifications;\n}\n\nfunction hasMention(message) {\n    return message && message.contains_unread_mention;\n}\n\nfunction hasPinnedMessage(message) {\n    return message && message.content['@type'] === 'messagePinMessage';\n}\n\nexport function isMessageMuted(message) {\n    const { chat_id } = message;\n\n    if (hasMention(message)) {\n        return getChatDisableMentionNotifications(chat_id);\n    }\n    if (hasPinnedMessage(message)) {\n        return getChatDisablePinnedMessageNotifications(chat_id);\n    }\n\n    return isChatMuted(chat_id);\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport { isMessageMuted } from '../Utils/Store';\nimport { APP_NAME, NOTIFICATION_AUDIO_DELAY_MS } from '../Constants';\nimport AppStore from './ApplicationStore';\nimport ChatStore from './ChatStore';\nimport MessageStore from './MessageStore';\nimport TdLibController from '../Controllers/TdLibController';\nimport { isChatMember, isMeChat } from '../Utils/Chat';\n\nclass NotificationStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        // depends on ChatStore and MessageStore updates\n        this.chatStore = ChatStore;\n        this.messageStore = MessageStore;\n\n        this.appInactive = false;\n        this.newMessages = new Map();\n        this.settings = new Map();\n        this.windowFocused = true;\n        this.timerHandler = null;\n        this.nextSoundAt = new Date();\n        this.enableSound = false;\n    };\n\n    getUnreadCount() {\n        let unreadCount = 0;\n        this.newMessages.forEach(chat => {\n            chat.forEach(m => {\n                if (!m.is_outgoing && !isMessageMuted(m)) {\n                    unreadCount++;\n                }\n            });\n        });\n\n        return unreadCount;\n    }\n\n    updateTimer() {\n        const unreadCount = this.getUnreadCount();\n        // console.log('[ns] updateTimer', unreadCount, this.newMessages);\n\n        if (unreadCount > 0) {\n            if (!this.timerHandler) {\n                // console.log('[ns] setInterval');\n\n                this.onTimer();\n                this.timerHandler = setInterval(this.onTimer, 1000);\n            }\n        } else {\n            if (this.timerHandler) {\n                // console.log('[ns] clearInterval');\n\n                clearInterval(this.timerHandler);\n                this.timerHandler = null;\n                this.onTimer();\n            }\n        }\n    }\n\n    onTimer = () => {\n        // console.log('[ns] onTimer');\n\n        const unreadCount = this.getUnreadCount();\n        const showBadge = document.title === APP_NAME && unreadCount > 0;\n\n        if (showBadge) {\n            let title = '+99 notifications';\n            if (unreadCount === 1) {\n                title = '1 notification';\n            } else if (unreadCount < 99) {\n                title = `${unreadCount} notifications`;\n            }\n            document.title = title;\n            document.getElementById('favicon').href = 'favicon_unread.ico';\n        } else {\n            document.title = APP_NAME + (this.appInactive ? ': Zzz…' : '');\n            document.getElementById('favicon').href = 'favicon.ico';\n        }\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'updateChatReadInbox': {\n                const { windowFocused } = this;\n                if (!windowFocused) {\n                    const { chat_id, last_read_inbox_message_id } = update;\n\n                    const chatMap = this.newMessages.get(chat_id);\n                    if (chatMap) {\n                        const newChatMap = new Map([...chatMap].filter(([id, m]) => m.id > last_read_inbox_message_id));\n                        if (newChatMap.size < chatMap.size) {\n                            this.newMessages.set(chat_id, newChatMap);\n                            this.updateTimer();\n                        }\n                    }\n                }\n\n                break;\n            }\n            case 'updateChatNotificationSettings': {\n                const { windowFocused } = this;\n                if (!windowFocused) {\n                    this.updateTimer();\n                }\n\n                break;\n            }\n            case 'updateDeleteMessages': {\n                const { windowFocused } = this;\n                if (!windowFocused) {\n                    const { chat_id, message_ids, is_permanent } = update;\n                    if (is_permanent && message_ids.length > 0) {\n                        const chatMap = this.newMessages.get(chat_id);\n                        if (chatMap) {\n                            const filterMap = new Map(message_ids.map(id => [id, id]));\n\n                            const newChatMap = new Map([...chatMap].filter(([id, m]) => !filterMap.has(id)));\n                            if (newChatMap.size < chatMap.size) {\n                                this.newMessages.set(chat_id, newChatMap);\n                                this.updateTimer();\n                            }\n                        }\n                    }\n                }\n\n                break;\n            }\n            case 'updateNewMessage': {\n                const { windowFocused } = this;\n                if (!windowFocused) {\n                    const { message } = update;\n                    const { chat_id, id } = message;\n\n                    // dismiss notifications for last visited public channels and groups\n                    if (!isChatMember(chat_id)) {\n                        break;\n                    }\n\n                    // dismiss notifications for me chat\n                    if (isMeChat(chat_id)) {\n                        break;\n                    }\n\n                    const chatMap = this.newMessages.get(chat_id) || new Map();\n                    chatMap.set(id, message);\n                    this.newMessages.set(chat_id, chatMap);\n                    this.updateTimer();\n\n                    if (!message.is_outgoing && !isMessageMuted(message) && this.enableSound) {\n                        const now = new Date();\n                        if (now > this.nextSoundAt) {\n                            try {\n                                const audio = new Audio('sound_a.mp3');\n                                audio.play();\n                            } catch {\n\n                            }\n\n                            const nextSoundAt = new Date();\n                            nextSoundAt.setMilliseconds(nextSoundAt.getMilliseconds() + NOTIFICATION_AUDIO_DELAY_MS);\n                            this.nextSoundAt = nextSoundAt;\n                        }\n                    }\n                }\n\n                break;\n            }\n            case 'updateScopeNotificationSettings': {\n                const { scope, notification_settings } = update;\n\n                this.settings.set(scope['@type'], notification_settings);\n\n                const { windowFocused } = this;\n                if (!windowFocused) {\n                    this.updateTimer();\n                }\n\n                this.emit('updateScopeNotificationSettings', update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateAppInactive': {\n                this.appInactive = true;\n                this.newMessages = new Map();\n                this.updateTimer();\n                break;\n            }\n            case 'clientUpdateFocusWindow': {\n                const { focused } = update;\n                // console.log('[ns] clientUpdateFocusWindow', update);\n\n                this.windowFocused = focused;\n                if (focused) {\n                    this.newMessages = new Map();\n                    this.updateTimer();\n                }\n\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n}\n\nconst store = new NotificationStore();\nwindow.notifications = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport FileProgress from '../../Components/Viewer/FileProgress';\nimport { getSrc } from '../../Utils/File';\nimport FileStore from '../../Stores/FileStore';\nimport './DocumentTile.css';\n\nclass DocumentTile extends React.Component {\n    state = {\n        loaded: false\n    };\n\n    componentDidMount() {\n        FileStore.on('clientUpdateDocumentThumbnailBlob', this.onClientUpdateDocumentThumbnailBlob);\n        FileStore.on('clientUpdateAudioThumbnailBlob', this.onClientUpdateDocumentThumbnailBlob);\n    }\n\n    componentWillUnmount() {\n        FileStore.off('clientUpdateDocumentThumbnailBlob', this.onClientUpdateDocumentThumbnailBlob);\n        FileStore.off('clientUpdateAudioThumbnailBlob', this.onClientUpdateDocumentThumbnailBlob);\n    }\n\n    onClientUpdateDocumentThumbnailBlob = update => {\n        const { thumbnail } = this.props;\n\n        if (!thumbnail) return;\n\n        const { file } = thumbnail;\n        if (!file) return;\n\n        const { fileId } = update;\n\n        if (file.id !== fileId) {\n            return;\n        }\n\n        this.forceUpdate();\n    };\n\n    handleLoad = () => {\n        this.setState({ loaded: true });\n    };\n\n    render() {\n        const { minithumbnail, thumbnail, file, icon, completeIcon, openMedia, streaming } = this.props;\n        const { loaded } = this.state;\n\n        const miniSrc = minithumbnail ? 'data:image/jpeg;base64, ' + minithumbnail.data : null;\n        const thumbnailSrc = getSrc(thumbnail ? thumbnail.file : null);\n        const tileLoaded = thumbnailSrc && loaded;\n        const src = thumbnailSrc || miniSrc;\n\n        return (\n            <div\n                className={classNames('document-tile', { 'document-tile-image': !src }, { pointer: openMedia })}\n                onClick={openMedia}>\n                {file && (\n                    <FileProgress\n                        file={file}\n                        thumbnailSrc={src}\n                        download={!streaming}\n                        upload\n                        cancelButton\n                        zIndex={1}\n                        icon={icon}\n                        completeIcon={typeof completeIcon === 'function' ? completeIcon(src) : completeIcon}\n                    />\n                )}\n                {src && <img className='tile-photo' src={src} onLoad={this.handleLoad} draggable={false} alt='' />}\n                {!tileLoaded && <div className='document-tile-background' />}\n            </div>\n        );\n    }\n}\n\nDocumentTile.defaultProps = {\n    streaming: false\n};\n\nDocumentTile.propTypes = {\n    minithumbnail: PropTypes.object,\n    thumbnail: PropTypes.object,\n    file: PropTypes.object,\n    openMedia: PropTypes.func,\n    icon: PropTypes.node,\n    completeIcon: PropTypes.oneOfType([PropTypes.node, PropTypes.func])\n};\n\nexport default DocumentTile;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport RoomIcon from '@material-ui/icons/Room';\nimport { getLocationId } from '../../../Utils/Message';\nimport { getSrc } from '../../../Utils/File';\nimport { LOCATION_HEIGHT, LOCATION_SCALE, LOCATION_WIDTH, LOCATION_ZOOM } from '../../../Constants';\nimport FileStore from '../../../Stores/FileStore';\nimport './Location.css';\n\nclass Location extends React.Component {\n    componentDidMount() {\n        FileStore.on('clientUpdateLocationBlob', this.onClientUpdateLocationBlob);\n    }\n\n    componentWillUnmount() {\n        FileStore.off('clientUpdateLocationBlob', this.onClientUpdateLocationBlob);\n    }\n\n    onClientUpdateLocationBlob = update => {\n        const { fileId } = update;\n        const { location, width, height, zoom, scale } = this.props;\n\n        const locationId = getLocationId(location, width, height, zoom, scale);\n        const file = FileStore.getLocationFile(locationId);\n        if (!file) return;\n\n        if (file.id === fileId) {\n            this.forceUpdate();\n        }\n    };\n\n    handleClick = event => {\n        event.stopPropagation();\n    };\n\n    render() {\n        const { location, width, height, zoom, scale, type, style, title, caption } = this.props;\n        if (!location) return null;\n\n        const locationId = getLocationId(location, width, height, zoom, scale);\n        const file = FileStore.getLocationFile(locationId);\n        const src = getSrc(file);\n\n        const { longitude, latitude } = location;\n        const source = `https://maps.google.com/?q=${latitude},${longitude}`;\n\n        const locationStyle = {\n            width,\n            height,\n            ...style\n        };\n\n        return (\n            <div\n                className={classNames('location', {\n                    'location-message': type === 'message',\n                    'location-venue': type === 'venue',\n                    'location-title': title,\n                    'location-caption': caption\n                })}\n                style={locationStyle}>\n                <a href={source} target='_blank' rel='noopener noreferrer' onClick={this.handleClick}>\n                    <div className='location-wrapper'>\n                        <img className='location-image' draggable={false} alt={source} src={src} />\n                        <div className='location-icon'>\n                            <RoomIcon fontSize='large' color='primary' />\n                        </div>\n                    </div>\n                </a>\n            </div>\n        );\n    }\n}\n\nLocation.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    location: PropTypes.object.isRequired,\n    openMedia: PropTypes.func,\n\n    width: PropTypes.number,\n    height: PropTypes.number,\n    zoom: PropTypes.number,\n    scale: PropTypes.number\n};\n\nLocation.defaultProps = {\n    width: LOCATION_WIDTH,\n    height: LOCATION_HEIGHT,\n    zoom: LOCATION_ZOOM,\n    scale: LOCATION_SCALE\n};\n\nexport default Location;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { isContentOpened } from '../../../Utils/Message';\nimport MessageStore from '../../../Stores/MessageStore';\n\nclass MediaStatus extends React.Component {\n    constructor(props) {\n        super(props);\n\n        const { chatId, messageId } = this.props;\n\n        this.state = {\n            isOpened: isContentOpened(chatId, messageId)\n        };\n    }\n\n    componentDidMount() {\n        MessageStore.on('updateMessageContentOpened', this.onUpdateMessageContentOpened);\n    }\n\n    componentWillUnmount() {\n        MessageStore.off('updateMessageContentOpened', this.onUpdateMessageContentOpened);\n    }\n\n    onUpdateMessageContentOpened = update => {\n        const { chatId, messageId } = this.props;\n\n        if (chatId === update.chat_id && messageId === update.message_id) {\n            this.setState({ isOpened: isContentOpened(chatId, messageId) });\n        }\n    };\n\n    render() {\n        const { icon, openedIcon } = this.props;\n        const { isOpened } = this.state;\n\n        return isOpened ? openedIcon : icon;\n    }\n}\n\nMediaStatus.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    icon: PropTypes.node,\n    openedIcon: PropTypes.node\n};\n\nMediaStatus.defaultProps = {\n    icon: null,\n    openedIcon: null\n};\n\nexport default MediaStatus;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport createSvgIcon from '@material-ui/core/esm/utils/createSvgIcon';\n\nexport default createSvgIcon(\n    <path d='M5.29289322,5.29289322 C5.68341751,4.90236893 6.31658249,4.90236893 6.70710678,5.29289322 L6.70710678,5.29289322 L12,10.585 L17.2928932,5.29289322 C17.6834175,4.90236893 18.3165825,4.90236893 18.7071068,5.29289322 C19.0976311,5.68341751 19.0976311,6.31658249 18.7071068,6.70710678 L13.415,12 L18.7071068,17.2928932 C19.0675907,17.6533772 19.0953203,18.2206082 18.7902954,18.6128994 L18.7071068,18.7071068 C18.3165825,19.0976311 17.6834175,19.0976311 17.2928932,18.7071068 L17.2928932,18.7071068 L12,13.415 L6.70710678,18.7071068 C6.31658249,19.0976311 5.68341751,19.0976311 5.29289322,18.7071068 C4.90236893,18.3165825 4.90236893,17.6834175 5.29289322,17.2928932 L10.585,12 L5.29289322,6.70710678 C4.93240926,6.34662282 4.90467972,5.77939176 5.20970461,5.38710056 Z' />,\n    'Close'\n);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nexport class KeyboardHandler {\n    constructor(onKeyDown) {\n        this.onKeyDown = onKeyDown;\n    }\n}\n\nclass KeyboardManager {\n    constructor() {\n        this.handlers = [];\n\n        document.addEventListener('keydown', this.handleKeyDown);\n    }\n\n    handleKeyDown = event => {\n        // console.log('[keydown] KeyboardManager.handleKeyDown', this.handlers, event.key);\n\n        const { handlers } = this;\n        if (!handlers.length) return;\n\n        const handler = handlers[handlers.length - 1];\n        if (handler) {\n            const { onKeyDown } = handler;\n            if (onKeyDown) {\n                onKeyDown(event);\n            }\n        }\n    };\n\n    add(handler) {\n        // console.log('[keydown] KeyboardManager.add', handler);\n        this.handlers.push(handler);\n    }\n\n    remove(handler) {\n        // console.log('[keydown] KeyboardManager.remove', handler);\n        const index = this.handlers.indexOf(handler);\n        if (index === -1) return;\n\n        this.handlers.splice(index, 1);\n    }\n}\n\nconst manager = new KeyboardManager();\nexport default manager;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport DownloadIcon from '../../../Assets/Icons/Download';\nimport PlayArrowIcon from '../../../Assets/Icons/PlayArrow';\nimport PauseIcon from '../../../Assets/Icons/Pause';\nimport DocumentTile from '../../Tile/DocumentTile';\nimport AudioAction from './AudioAction';\nimport VoiceNoteSlider from './VoiceNoteSlider';\nimport { getAudioShortTitle, getAudioSubtitle } from '../../../Utils/Media';\nimport { supportsStreaming } from '../../../Utils/File';\nimport { isCurrentSource } from '../../../Utils/Player';\nimport PlayerStore from '../../../Stores/PlayerStore';\nimport './Audio.css';\n\nclass Audio extends React.Component {\n    constructor(props) {\n        super(props);\n\n        const { chatId, messageId, block } = props;\n\n        const { message, block: playerBlock, playing } = PlayerStore;\n        const active = message && message.chat_id === chatId && message.id === messageId || block === playerBlock;\n\n        this.state = {\n            active,\n            playing: active ? playing : false\n        };\n    }\n\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\n        const { active, playing } = this.state;\n\n        if (nextState.active !== active) {\n            return true;\n        }\n\n        if (nextState.playing !== playing) {\n            return true;\n        }\n\n        return false;\n    }\n\n    componentDidMount() {\n        PlayerStore.on('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.on('clientUpdateMediaPlay', this.onClientUpdateMediaPlay);\n        PlayerStore.on('clientUpdateMediaPause', this.onClientUpdateMediaPause);\n        PlayerStore.on('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n    }\n\n    componentWillUnmount() {\n        PlayerStore.off('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.off('clientUpdateMediaPlay', this.onClientUpdateMediaPlay);\n        PlayerStore.off('clientUpdateMediaPause', this.onClientUpdateMediaPause);\n        PlayerStore.off('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n    }\n\n    onClientUpdateMediaEnd = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        this.setState({\n            active: false,\n            playing: false\n        });\n    };\n\n    onClientUpdateMediaPlay = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        this.setState({ playing: isCurrentSource(chatId, messageId, block, source) });\n    };\n\n    onClientUpdateMediaPause = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        this.setState({ playing: false });\n    };\n\n    onClientUpdateMediaActive = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        if (isCurrentSource(chatId, messageId, block, source)) {\n            if (!this.state.active) {\n                this.setState({\n                    active: true,\n                    playing: true\n                });\n            }\n        } else if (this.state.active) {\n            this.setState({\n                active: false,\n                playing: false\n            });\n        }\n    };\n\n    render() {\n        const { chatId, messageId, block, audio, openMedia, title, meta, caption } = this.props;\n        const { playing, active } = this.state;\n        if (!audio) return null;\n\n        const { album_cover_thumbnail, duration, audio: file } = audio;\n\n        const audioTitle = getAudioSubtitle(audio);\n        const audioSubtitle = getAudioShortTitle(audio);\n        const completeIcon = playing ? <PauseIcon /> : <PlayArrowIcon />;\n\n        return (\n            <div className={classNames('audio', 'document', { 'media-title': title })}>\n                <DocumentTile\n                    thumbnail={album_cover_thumbnail}\n                    file={file}\n                    openMedia={openMedia}\n                    streaming={supportsStreaming()}\n                    icon={supportsStreaming() ? completeIcon : <DownloadIcon />}\n                    completeIcon={completeIcon}\n                />\n                <div className='audio-content'>\n                    <div className='document-title'>\n                        <a className='document-name' onClick={openMedia} title={audioTitle}>\n                            {audioTitle}\n                        </a>\n                    </div>\n                    <div className='audio-action' style={{ opacity: active ? 0 : 1 }}>{audioSubtitle}</div>\n                    <VoiceNoteSlider audio className='audio-slider' chatId={chatId} messageId={messageId} block={block} duration={duration} style={{ opacity: active ? 1 : 0 }}/>\n                    <AudioAction\n                        chatId={chatId}\n                        messageId={messageId}\n                        block={block}\n                        duration={duration}\n                        file={file}\n                        meta={caption ? null : meta}\n                        streaming={supportsStreaming()}\n                    />\n                </div>\n            </div>\n        );\n    }\n}\n\nAudio.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    block: PropTypes.object,\n    audio: PropTypes.object,\n    openMedia: PropTypes.func\n};\n\nexport default Audio;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport AudioAction from './AudioAction';\nimport VoiceNoteTile from '../../Tile/VoiceNoteTile';\nimport MediaStatus from './MediaStatus';\nimport VoiceNoteSlider from './VoiceNoteSlider';\nimport { isMeChat } from '../../../Utils/Chat';\nimport './VoiceNote.css';\n\nclass VoiceNote extends React.Component {\n    render() {\n        const { chatId, messageId, block, voiceNote, openMedia, title, meta, caption } = this.props;\n        if (!voiceNote) return null;\n\n        const { duration, voice: file, waveform } = voiceNote;\n\n        return (\n            <div className={classNames('voice-note', 'document', { 'media-title': title })}>\n                <VoiceNoteTile chatId={chatId} messageId={messageId} block={block} file={file} openMedia={openMedia} />\n                <div className='voice-note-content'>\n                    <VoiceNoteSlider chatId={chatId} messageId={messageId} block={block} duration={duration} waveform={waveform} />\n                    <div className='voice-note-meta'>\n                        <AudioAction chatId={chatId} messageId={messageId} block={block} duration={duration} file={file} />\n                        {!isMeChat(chatId) && <MediaStatus chatId={chatId} messageId={messageId} icon={<div className='voice-note-meta-unread'/>} />}\n                        {!caption && meta}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nVoiceNote.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    block: PropTypes.object,\n\n    voiceNote: PropTypes.object.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default VoiceNote;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { getDownloadedSize, getUploadedSize, getFileSize } from '../../../Utils/File';\nimport { getDurationString } from '../../../Utils/Common';\nimport FileStore from '../../../Stores/FileStore';\nimport PlayerStore from '../../../Stores/PlayerStore';\nimport './AudioAction.css';\nimport { isCurrentSource } from '../../../Utils/Player';\n\nclass AudioAction extends React.Component {\n    constructor(props) {\n        super(props);\n\n        const { chatId, messageId, block, duration, file, streaming } = this.props;\n        const { message, block: playerBlock, time } = PlayerStore;\n\n        const active = message && message.chat_id === chatId && message.id === messageId || block === playerBlock;\n        const currentTime = active && time ? time.currentTime : 0;\n        const audioDuration = active && time && time.duration ? time.duration : duration;\n        const currentFile = FileStore.get(file.id) || file;\n\n        this.state = {\n            active,\n            currentTime,\n            seekProgress: 0,\n            duration: audioDuration,\n            timeString: AudioAction.getTimeString(currentTime, duration, active, currentFile, streaming),\n\n            prevFile: null,\n            file: currentFile\n        };\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        const { active, timeString, file, prevFile } = this.state;\n\n        if (nextState.timeString !== timeString) {\n            return true;\n        }\n\n        if (nextState.active !== active) {\n            return true;\n        }\n\n        if (nextState.file !== file) {\n            return true;\n        }\n\n        if (nextState.prevFile !== prevFile) {\n            return true;\n        }\n\n        return false;\n    }\n\n    componentDidMount() {\n        FileStore.on('updateFile', this.onUpdateFile);\n\n        PlayerStore.on('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.on('clientUpdateMediaTime', this.onClientUpdateMediaTime);\n        PlayerStore.on('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n        PlayerStore.on('clientUpdateMediaSeeking', this.onClientUpdateMediaSeeking);\n        PlayerStore.on('clientUpdateMediaSeek', this.onClientUpdateMediaSeek);\n    }\n\n    componentWillUnmount() {\n        FileStore.off('updateFile', this.onUpdateFile);\n\n        PlayerStore.off('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.off('clientUpdateMediaTime', this.onClientUpdateMediaTime);\n        PlayerStore.off('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n        PlayerStore.off('clientUpdateMediaSeeking', this.onClientUpdateMediaSeeking);\n        PlayerStore.off('clientUpdateMediaSeek', this.onClientUpdateMediaSeek);\n    }\n\n    onClientUpdateMediaSeeking = update => {\n        const { chatId, messageId, block, duration, streaming } = this.props;\n        const { duration: playerDuration, active, file } = this.state;\n        const { source, value } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        const d = playerDuration || duration;\n\n        this.setState({\n            seekProgress: value,\n            seeking: true,\n            timeString: AudioAction.getTimeString(d * value, d, active, file, streaming)\n        });\n    };\n\n    onClientUpdateMediaSeek = update => {\n        const { chatId, messageId, block, duration, streaming } = this.props;\n        const { duration: playerDuration, active, file } = this.state;\n        const { source, value } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        const d = playerDuration || duration;\n\n        this.setState({\n            seekProgress: 0,\n            seeking: false,\n            timeString: AudioAction.getTimeString(d * value, d, active, file, streaming)\n        });\n    };\n\n    onClientUpdateMediaEnd = update => {\n        const { chatId, messageId, block, duration, streaming } = this.props;\n        const { active, file } = this.state;\n        const { source } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        const playerDuration = update.duration >= 0 && update.duration < Infinity ? update.duration : duration;\n        this.setState({\n            active: false,\n            currentTime: 0,\n            timeString: AudioAction.getTimeString(0, playerDuration, false, file, streaming)\n        });\n    };\n\n    onClientUpdateMediaTime = update => {\n        const { chatId, messageId, block, duration, streaming } = this.props;\n        const { active, file, seekProgress, seeking } = this.state;\n        const { source } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        const playerDuration = update.duration >= 0 && update.duration < Infinity ? update.duration : duration;\n        const time = seeking ? seekProgress * playerDuration : update.currentTime;\n\n        this.setState({\n            currentTime: update.currentTime,\n            duration: playerDuration,\n            timeString: AudioAction.getTimeString(time, playerDuration, active, file, streaming)\n        });\n    };\n\n    onClientUpdateMediaActive = update => {\n        const { chatId, messageId, block, duration, streaming } = this.props;\n        const { active, currentTime, file } = this.state;\n        const { source } = update;\n\n        if (isCurrentSource(chatId, messageId, block, source)) {\n            this.setState({\n                active: true,\n                currentTime: active ? currentTime : 0,\n                timeString: active ? this.state.timeString : AudioAction.getTimeString(0, duration, true, file, streaming)\n            });\n        } else if (active) {\n            this.setState({\n                active: false,\n                currentTime: 0,\n                timeString: AudioAction.getTimeString(0, duration, false, file, streaming)\n            });\n        }\n    };\n\n    onUpdateFile = update => {\n        const currentFile = this.state.file;\n        const nextFile = update.file;\n\n        if (currentFile && currentFile.id === nextFile.id) {\n            this.setState({ file: nextFile, prevFile: currentFile });\n        }\n    };\n\n    static getTimeString(currentTime, duration, active, file, streaming) {\n        const isDownloadingCompleted = file.local && file.local.is_downloading_completed || streaming;\n        const isUploadingCompleted = file.remote && file.remote.is_uploading_completed;\n\n        const durationString = getDurationString(Math.floor(duration || 0));\n        const currentTimeString = getDurationString(Math.floor(currentTime || 0));\n\n        return active && isDownloadingCompleted ? `${currentTimeString} / ${durationString}` : `${durationString}`;\n    }\n\n    render() {\n        const { title, meta, streaming } = this.props;\n        const { active, file, timeString } = this.state;\n        if (!file) return null;\n\n        const isDownloadingActive = file.local && file.local.is_downloading_active;\n        const isUploadingActive = file.remote && file.remote.is_uploading_active;\n        const isDownloadingCompleted = file.local && file.local.is_downloading_completed;\n        const isUploadingCompleted = file.remote && file.remote.is_uploading_completed;\n\n        const size = getFileSize(file);\n        let progressSize = null;\n        if (isDownloadingActive) {\n            progressSize = getDownloadedSize(file);\n        } else if (isUploadingActive) {\n            progressSize = getUploadedSize(file);\n        }\n\n        const strings = [];\n        if (streaming) {\n            const sizeString = `${size}`;\n            if (!isDownloadingCompleted && !active) {\n                strings.push(sizeString);\n            }\n            strings.push(timeString);\n        } else {\n            const sizeString = progressSize ? `${progressSize}` : `${size}`;\n            if (!isDownloadingCompleted) {\n                strings.push(sizeString);\n            }\n            if (!isDownloadingActive) {\n                strings.push(timeString);\n            }\n        }\n\n        return (\n            <div className='audio-action'>\n                {!active && <span>{title}</span>}\n                {<span>{strings.join(', ')}</span>}\n                {meta}\n            </div>\n        );\n    }\n}\n\nAudioAction.defaultProps = {\n    streaming: false\n}\n\nAudioAction.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    block: PropTypes.object,\n\n    duration: PropTypes.number.isRequired,\n    file: PropTypes.object.isRequired,\n\n    title: PropTypes.string,\n    streaming: PropTypes.bool\n};\n\nexport default AudioAction;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport PlayArrowIcon from '../../../Assets/Icons/PlayArrow';\nimport { getFitSize, getDurationString, getPhotoSize } from '../../../Utils/Common';\nimport { getFileSize, getSrc } from '../../../Utils/File';\nimport { isBlurredThumbnail } from '../../../Utils/Media';\nimport { PHOTO_DISPLAY_SIZE, PHOTO_SIZE } from '../../../Constants';\nimport FileStore from '../../../Stores/FileStore';\nimport './Video.css';\n\nclass Video extends React.Component {\n    componentDidMount() {\n        FileStore.on('clientUpdateVideoThumbnailBlob', this.onClientUpdateVideoThumbnailBlob);\n    }\n\n    componentWillUnmount() {\n        FileStore.off('clientUpdateVideoThumbnailBlob', this.onClientUpdateVideoThumbnailBlob);\n    }\n\n    onClientUpdateVideoThumbnailBlob = update => {\n        const { thumbnail } = this.props.video;\n        const { fileId } = update;\n\n        if (!thumbnail) return;\n\n        const { file } = thumbnail;\n        if (file && file.id !== fileId) return;\n\n        this.forceUpdate();\n    };\n\n    render() {\n        const { displaySize, stretch, openMedia, title, caption, type, style } = this.props;\n        const { minithumbnail, thumbnail, video, width, height, duration } = this.props.video;\n\n        const sizes = [...(thumbnail ? [thumbnail] : []), { width, height }];\n        const photoSize = getPhotoSize(sizes, displaySize);\n        const fitPhotoSize = getFitSize(photoSize, displaySize, stretch);\n        if (!fitPhotoSize) return null;\n\n        const videoStyle = {\n            background: 'black',\n            minWidth: stretch ? fitPhotoSize.width : null,\n            width: !stretch ? fitPhotoSize.width : null,\n            height: fitPhotoSize.height,\n            ...style\n        };\n\n        const miniSrc = minithumbnail ? 'data:image/jpeg;base64, ' + minithumbnail.data : null;\n        const thumbnailSrc = getSrc(thumbnail ? thumbnail.file : null);\n        const isBlurred = isBlurredThumbnail(thumbnail, displaySize);\n\n        return (\n            <div\n                className={classNames('video', {\n                    'video-big': type === 'message',\n                    'video-title': title,\n                    'video-caption': caption,\n                    pointer: openMedia\n                })}\n                style={videoStyle}\n                onClick={openMedia}>\n                {miniSrc && (\n                    <img\n                        className={classNames('video-preview', 'media-mini-blurred')}\n                        src={miniSrc}\n                        alt=''\n                    />\n                )}\n                {thumbnailSrc && (\n                    <img\n                        className={classNames('video-thumbnail', { 'media-blurred': isBlurred })}\n                        src={thumbnailSrc}\n                        alt=''\n                        />\n                )}\n                <div className='video-play'>\n                    <PlayArrowIcon />\n                </div>\n                <div className='video-meta'>{getDurationString(duration) + ' ' + getFileSize(video)}</div>\n            </div>\n        );\n    }\n}\n\nVideo.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    video: PropTypes.object.isRequired,\n    openMedia: PropTypes.func,\n    size: PropTypes.number,\n    displaySize: PropTypes.number,\n    stretch: PropTypes.bool\n};\n\nVideo.defaultProps = {\n    size: PHOTO_SIZE,\n    displaySize: PHOTO_DISPLAY_SIZE,\n    stretch: false\n};\n\nexport default Video;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { getNormalizedWaveform } from '../../../Utils/Media';\nimport './Waveform.css';\n\nconst defaultData = 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'\n\nclass Waveform extends React.Component {\n    render() {\n        const { id, value, dragging } = this.props;\n        let { data } = this.props;\n        if (!data) {\n            data = defaultData;\n        }\n\n        const waveform = getNormalizedWaveform(data);\n\n        const transition = dragging ? null : 'width 0.25s'\n        const waveformMaxHeight = 23;\n\n        const d = waveform.filter((x, index) => index % 2 === 1).map((x, index) => {\n            const height = Math.min(Math.max(2, x * waveformMaxHeight), waveformMaxHeight);\n            const y = waveformMaxHeight - Math.floor(height);\n            return `M${1 + 4 * index + 1},${y + 1}v${Math.floor(height) - 2}Z`\n        }).join('');\n\n        const svg = (\n            <svg className='waveform-bars' viewBox='0 0 202 32'>\n                <path d={d}/>\n            </svg>\n        );\n\n        return (\n            <div className='waveform'>\n                <div className='waveform-content'>\n                    <div className='waveform-background'>\n                        {svg}\n                    </div>\n                    <div className='waveform-progress' style={{ transition, width: value * 100 + '%'}}>\n                        {svg}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n}\n\nWaveform.propTypes = {\n    data: PropTypes.string\n};\n\nexport default Waveform;","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport Slider from '@material-ui/core/Slider';\nimport Player from '../../Player/Player';\nimport Waveform from './Waveform';\nimport { isCurrentSource } from '../../../Utils/Player';\nimport { PLAYER_PROGRESS_TIMEOUT_MS } from '../../../Constants';\nimport MessageStore from '../../../Stores/MessageStore';\nimport PlayerStore from '../../../Stores/PlayerStore';\nimport TdLibController from '../../../Controllers/TdLibController';\nimport './VoiceNoteSlider.css';\n\nclass VoiceNoteSlider extends React.Component {\n    state = { };\n\n    static getDerivedStateFromProps(props, state) {\n        const { chatId, messageId, block, duration, waveform } = props;\n\n        if (state.prevChatId !== chatId || state.prevMessageId !== messageId || state.prevBlock !== block) {\n\n            const { message, block: currentBlock, time } = PlayerStore;\n\n            const active = message && message.chat_id === chatId && message.id === messageId || block === currentBlock;\n            const currentTime = active && time ? time.currentTime : 0;\n            const audioDuration = active && time && time.duration ? time.duration : duration;\n            const buffered = active && time ? time.buffered : null;\n            const value = VoiceNoteSlider.getValue(currentTime, audioDuration, active, waveform, false);\n\n            return {\n                prevChatId: chatId,\n                prevMessageId: messageId,\n                prevBlock: block,\n                active,\n                currentTime,\n                duration: audioDuration,\n                value,\n                buffered\n            };\n        }\n\n        return null;\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        const { style } = this.props;\n        const { active, value, buffered } = this.state;\n\n        if (nextState.value !== value) {\n            return true;\n        }\n\n        if (nextState.active !== active) {\n            return true;\n        }\n\n        if (nextState.buffered !== buffered) {\n            return true;\n        }\n\n        if (nextProps.style !== style) {\n            return true;\n        }\n\n        return false;\n    }\n\n    componentDidMount() {\n        PlayerStore.on('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.on('clientUpdateMediaLoadedMetadata', this.onClientUpdateMediaLoadedMetadata);\n        PlayerStore.on('clientUpdateMediaTime', this.onClientUpdateMediaTime);\n        PlayerStore.on('clientUpdateMediaProgress', this.onClientUpdateMediaProgress);\n        PlayerStore.on('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n    }\n\n    componentWillUnmount() {\n        PlayerStore.off('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.off('clientUpdateMediaLoadedMetadata', this.onClientUpdateMediaLoadedMetadata);\n        PlayerStore.off('clientUpdateMediaTime', this.onClientUpdateMediaTime);\n        PlayerStore.off('clientUpdateMediaProgress', this.onClientUpdateMediaProgress);\n        PlayerStore.off('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n    }\n\n    reset() {\n        const { waveform } = this.props;\n        const { value, duration, dragging } = this.state;\n\n        if (value === 1) {\n            this.setState({\n                active: false,\n                currentTime: 0,\n                buffered: null\n            });\n\n            setTimeout(() => {\n                const { currentTime } = this.state;\n                if (!currentTime) {\n                    this.setState({\n                        value: VoiceNoteSlider.getValue(0, duration, false, waveform, dragging)\n                    });\n                }\n            }, PLAYER_PROGRESS_TIMEOUT_MS);\n        } else {\n            this.setState({\n                active: false,\n                currentTime: 0,\n                buffered: null,\n                value: VoiceNoteSlider.getValue(0, duration, false, waveform, dragging)\n            });\n        }\n    }\n\n    onClientUpdateMediaEnd = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        this.reset();\n    };\n\n    onClientUpdateMediaLoadedMetadata = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source, duration, buffered } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        this.setState({\n            duration,\n            buffered\n        });\n    };\n\n    onClientUpdateMediaProgress = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source, buffered } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        this.setState({\n            buffered\n        });\n    };\n\n    onClientUpdateMediaTime = update => {\n        const { chatId, messageId, block, waveform } = this.props;\n        const { active, duration, dragging, value } = this.state;\n        const { source, currentTime, buffered } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        this.setState({\n            currentTime,\n            buffered,\n            value: dragging ? value : VoiceNoteSlider.getValue(currentTime, duration, active, waveform, dragging)\n        });\n    };\n\n    onClientUpdateMediaActive = update => {\n        const { chatId, messageId, block, waveform } = this.props;\n        const { active, currentTime, duration, dragging } = this.state;\n        const { source, currentTime: prevCurrentTime } = update;\n\n        if (isCurrentSource(chatId, messageId, block, source)) {\n            let { value } = this.state;\n            if (!dragging) {\n                value = VoiceNoteSlider.getValue(active ? currentTime : prevCurrentTime, duration, true, waveform, dragging);\n            }\n\n            this.setState({\n                active: true,\n                currentTime: active ? currentTime : prevCurrentTime,\n                value\n            });\n        } else if (active) {\n            this.reset();\n        }\n    };\n\n    static getValue(currentTime, duration, active, waveform, dragging) {\n        // if (waveform && !dragging) {\n        //     currentTime += 0.25;\n        // }\n\n        return active ? currentTime / duration : 0;\n    }\n\n    handleMouseDown = event => {\n        event.stopPropagation();\n\n        this.setState({\n            dragging: true\n        });\n    };\n\n    handleChange = (event, value) => {\n        const { chatId, messageId, block } = this.props;\n        const { active, dragging } = this.state;\n        if (!active) return;\n\n        const source = MessageStore.get(chatId, messageId) || { '@type': 'instantViewSource', block};\n\n        if (dragging) {\n            TdLibController.clientUpdate({\n                '@type': 'clientUpdateMediaSeeking',\n                source,\n                value\n            });\n        }\n\n        this.setState({\n            value\n        });\n    };\n\n    handleChangeCommitted = () => {\n        const { chatId, messageId, block, duration } = this.props;\n        const { value } = this.state;\n\n        const source = MessageStore.get(chatId, messageId) || { '@type': 'instantViewSource', block};\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMediaSeek',\n            source,\n            value,\n            duration\n        });\n\n        this.setState({\n            dragging: false\n        });\n    };\n\n    render() {\n        const { chatId, messageId, audio, waveform, className, style } = this.props;\n        const { duration, value, dragging, buffered } = this.state;\n\n        const time = value * duration;\n        const bufferedTime = Player.getBufferedTime(time, buffered);\n        const bufferedValue = duration > 0 ? bufferedTime / duration : 0;\n\n        // const ranges = [];\n        // for (let i = 0; buffered && i < buffered.length; i++) {\n        //     ranges.push({ start: buffered.start(i), end: buffered.end(i)})\n        // }\n        //\n        // console.log('[clientUpdate] render', JSON.stringify(ranges));\n\n        return (\n            <div className={classNames('voice-note-slider', className)} style={style}>\n                {!audio && <Waveform id={`waveform_${chatId}_${messageId}`} dragging={dragging} data={waveform} value={value}/>}\n                {audio && <div className='voice-note-slider-buffered' style={{ width: `${bufferedValue*100}%`}}/>}\n                <Slider\n                    className={classNames('voice-note-slider-component', { 'voice-note-slider-component-hidden': !audio })}\n                    classes={{\n                        track: 'voice-note-slider-track',\n                        thumb: 'voice-note-slider-thumb',\n                        active: 'voice-note-slider-active',\n                        rail: 'voice-note-slider-rail'\n                    }}\n                    min={0}\n                    max={1}\n                    step={0.01}\n                    value={value}\n                    onChange={this.handleChange}\n                    onChangeCommitted={this.handleChangeCommitted}\n                    onMouseDown={this.handleMouseDown}\n                />\n            </div>\n        );\n    }\n}\n\nVoiceNoteSlider.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    block: PropTypes.object,\n\n    audio: PropTypes.bool,\n    duration: PropTypes.number.isRequired,\n    waveform: PropTypes.string\n};\n\nexport default VoiceNoteSlider;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { randomString } from './Helpers';\n// eslint-disable-next-line import/no-webpack-loader-syntax\nimport PakoWorker from './pako.worker';\n\nconst worker = new PakoWorker();\nconst handlers = new Map();\n\nworker.onmessage = event => {\n    const { data } = event;\n    if (!data) return;\n\n    const { key, error, result, msg } = data;\n\n    const { resolve, reject } = handlers.get(key);\n    handlers.delete(key);\n\n    if (!error) {\n        resolve(result);\n    } else {\n        reject(msg);\n    }\n};\n\nexport async function inflateBlob(blob) {\n    const key = randomString();\n    return new Promise((resolve, reject) => {\n        handlers.set(key, { resolve, reject });\n        worker.postMessage({ key, blob });\n    });\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nexport function randomString() {\n    return (\n        '$' +\n        Math.random()\n            .toString(36)\n            .slice(2, 10)\n    );\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\n// import Lottie from '../../Viewer/Lottie';\nimport { isBlurredThumbnail, isValidAnimatedSticker } from '../../../Utils/Media';\nimport { getFitSize } from '../../../Utils/Common';\nimport { getBlob, getSrc } from '../../../Utils/File';\nimport { inflateBlob } from '../../../Workers/BlobInflator';\nimport { STICKER_DISPLAY_SIZE } from '../../../Constants';\nimport ApplicationStore from '../../../Stores/ApplicationStore';\nimport FileStore from '../../../Stores/FileStore';\nimport InstantViewStore from '../../../Stores/InstantViewStore';\nimport MessageStore from '../../../Stores/MessageStore';\nimport StickerStore from '../../../Stores/StickerStore';\nimport './Sticker.css';\n\nconst Lottie = React.lazy(() => import('../../Viewer/Lottie'));\n\nexport const StickerSourceEnum = Object.freeze({\n    HINTS: 'HINTS',\n    MESSAGE: 'MESSAGE',\n    PICKER_HEADER: 'PICKER_HEADER',\n    PICKER: 'PICKER',\n    PREVIEW: 'PREVIEW',\n    STICKER_SET: 'STICKER_SET',\n    UNKNOWN: 'UNKNOWN'\n});\n\nclass Sticker extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.lottieRef = React.createRef();\n        this.windowFocused = window.hasFocus;\n        this.inView = false;\n        this.stickerPreview = StickerStore.stickerPreview;\n        this.openMediaViewer = Boolean(ApplicationStore.mediaViewerContent);\n        this.openProfileMediaViewer = Boolean(ApplicationStore.profileMediaViewerContent);\n        this.openIV = Boolean(InstantViewStore.getCurrent());\n        this.dialogChatId = ApplicationStore.dialogChatId;\n\n        this.state = {\n            animationDate: null,\n            loaded: false,\n            hasError: false\n        };\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        const { sticker } = props;\n\n        if (state.prevSticker !== sticker) {\n            return {\n                prevSticker: sticker,\n                loaded: false,\n            };\n        }\n\n        return null;\n    }\n\n    static getDerivedStateFromError(error) {\n        return { hasError: true };\n    }\n\n    componentDidCatch(error, errorInfo) {\n        console.log('[Sticker] render error', error, errorInfo);\n    }\n\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\n        const { chatId, messageId, sticker, blur, displaySize } = this.props;\n        const { animationData, loaded } = this.state;\n\n        if (animationData !== nextState.animationData) {\n            return true;\n        }\n\n        if (loaded !== nextState.loaded) {\n            return true;\n        }\n\n        if (chatId !== nextProps.chatId) {\n            return true;\n        }\n\n        if (messageId !== nextProps.messageId) {\n            return true;\n        }\n\n        if (sticker !== nextProps.sticker) {\n            return true;\n        }\n\n        if (blur !== nextProps.blur) {\n            return true;\n        }\n\n        if (displaySize !== nextProps.displaySize) {\n            return true;\n        }\n\n        return false;\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (prevProps.sticker !== this.props.sticker) {\n            this.loadContent();\n        }\n    }\n\n    componentDidMount() {\n        this.loadContent();\n\n        ApplicationStore.on('clientUpdateDialogChatId', this.onClientUpdateDialogChatId);\n        ApplicationStore.on('clientUpdateFocusWindow', this.onClientUpdateFocusWindow);\n        ApplicationStore.on('clientUpdateMediaViewerContent', this.onClientUpdateMediaViewerContent);\n        ApplicationStore.on('clientUpdateProfileMediaViewerContent', this.onClientUpdateProfileMediaViewerContent);\n        InstantViewStore.on('clientUpdateInstantViewContent', this.onClientUpdateInstantViewContent);\n        FileStore.on('clientUpdateStickerThumbnailBlob', this.onClientUpdateStickerThumbnailBlob);\n        FileStore.on('clientUpdateStickerBlob', this.onClientUpdateStickerBlob);\n        MessageStore.on('clientUpdateMessagesInView', this.onClientUpdateMessagesInView);\n        StickerStore.on('clientUpdateStickerPreview', this.onClientUpdateStickerPreview);\n        StickerStore.on('clientUpdateStickerSet', this.onClientUpdateStickerSet);\n    }\n\n    componentWillUnmount() {\n        ApplicationStore.off('clientUpdateDialogChatId', this.onClientUpdateDialogChatId);\n        ApplicationStore.off('clientUpdateFocusWindow', this.onClientUpdateFocusWindow);\n        ApplicationStore.off('clientUpdateMediaViewerContent', this.onClientUpdateMediaViewerContent);\n        ApplicationStore.off('clientUpdateProfileMediaViewerContent', this.onClientUpdateProfileMediaViewerContent);\n        InstantViewStore.off('clientUpdateInstantViewContent', this.onClientUpdateInstantViewContent);\n        FileStore.off('clientUpdateStickerThumbnailBlob', this.onClientUpdateStickerThumbnailBlob);\n        FileStore.off('clientUpdateStickerBlob', this.onClientUpdateStickerBlob);\n        MessageStore.off('clientUpdateMessagesInView', this.onClientUpdateMessagesInView);\n        StickerStore.off('clientUpdateStickerPreview', this.onClientUpdateStickerPreview);\n        StickerStore.off('clientUpdateStickerSet', this.onClientUpdateStickerSet);\n    }\n\n    onClientUpdateInstantViewContent = update => {\n        this.openIV = Boolean(InstantViewStore.getCurrent());\n\n        this.startStopAnimation();\n    };\n\n    onClientUpdateDialogChatId = update => {\n        this.dialogChatId = ApplicationStore.dialogChatId;\n\n        this.startStopAnimation();\n    };\n\n    onClientUpdateMediaViewerContent = update => {\n        this.openMediaViewer = Boolean(ApplicationStore.mediaViewerContent);\n\n        this.startStopAnimation();\n    };\n\n    onClientUpdateProfileMediaViewerContent = update => {\n        this.openProfileMediaViewer = Boolean(ApplicationStore.profileMediaViewerContent);\n\n        this.startStopAnimation();\n    };\n\n    onClientUpdateStickerPreview = update => {\n        this.stickerPreview = update.sticker;\n\n        this.startStopAnimation();\n    };\n\n    onClientUpdateMessagesInView = update => {\n        const { chatId, messageId } = this.props;\n        const key = `${chatId}_${messageId}`;\n\n        this.inView = update.messages.has(key);\n\n        this.startStopAnimation();\n    };\n\n    onClientUpdateStickerSet = update => {\n        const { stickerSet } = update;\n\n        this.openedStickerSet = stickerSet;\n\n        this.startStopAnimation();\n    };\n\n    onClientUpdateFocusWindow = update => {\n        const { focused } = update;\n        const { chatId, messageId, sticker } = this.props;\n\n        const isAnimated = isValidAnimatedSticker(sticker, chatId, messageId);\n        if (!isAnimated) return;\n\n        this.windowFocused = focused;\n        this.startStopAnimation();\n    };\n\n    startStopAnimation() {\n        const { autoplay } = this.props;\n\n        const player = this.lottieRef.current;\n        if (!player) return;\n\n        if (\n            this.windowFocused &&\n            !this.stickerPreview &&\n            !this.openMediaViewer &&\n            !this.openProfileMediaViewer &&\n            !this.openIV &&\n            !this.dialogChatId\n        ) {\n            if (this.entered) {\n                // console.log('[Sticker] play 1');\n                player.play();\n                this.pause = false;\n                return;\n            }\n\n            // console.log('[Sticker] startStopAnimation', this.openedStickerSet);\n            if (!this.openedStickerSet) {\n                if (this.paused) {\n                    // console.log('[Sticker] play 2');\n                    player.play();\n                    this.paused = false;\n                    return;\n                }\n\n                if (autoplay && this.inView) {\n                    // console.log('[Sticker] play 3');\n                    player.play();\n                    this.paused = false;\n                    return;\n                }\n            }\n        }\n\n        // console.log('[Sticker] pause');\n        this.paused = player.pause();\n    }\n\n    onClientUpdateStickerBlob = update => {\n        const { sticker, is_animated } = this.props.sticker;\n        const { fileId } = update;\n\n        if (!sticker) return;\n\n        if (sticker.id === fileId) {\n            if (is_animated) {\n                this.loadContent();\n            } else {\n                this.forceUpdate();\n            }\n        }\n    };\n\n    onClientUpdateStickerThumbnailBlob = update => {\n        const { thumbnail } = this.props.sticker;\n        if (!thumbnail) return;\n\n        const { fileId } = update;\n\n        const { file } = thumbnail;\n        if (file && file.id === fileId) {\n            this.forceUpdate();\n        }\n    };\n\n    loadContent = async () => {\n        const { chatId, messageId, sticker: source, autoplay, play } = this.props;\n        const { is_animated, sticker } = source;\n        const isAnimated = isValidAnimatedSticker(source, chatId, messageId);\n\n        if (!is_animated) return;\n        if (!isAnimated) return;\n        if (!play) return;\n\n        const blob = getBlob(sticker);\n        if (!blob) return;\n\n        let animationData = null;\n        try {\n            // animationData = StickerStore.getAnimationData(blob);\n            // if (animationData) {\n            //     this.setState({ animationData });\n            //     return;\n            // }\n            const result = await inflateBlob(blob);\n            if (!result) return;\n\n            animationData = JSON.parse(result);\n            // StickerStore.setAnimationData(blob, animationData);\n        } catch (err) {\n            console.log('[Sticker] loadContent error', err);\n        }\n        if (!animationData) return;\n\n        if (autoplay) {\n            this.setState({ animationData });\n        } else {\n            this.animationData = animationData;\n        }\n    };\n\n    handleMouseEnter = event => {\n        const { animationData } = this;\n        // console.log('[Sticker] handleMouseEnter', animationData);\n        if (animationData) {\n            this.setState({ animationData }, () => {\n                this.handleAnimationMouseEnter();\n            });\n        }\n    };\n\n    handleAnimationMouseEnter = () => {\n        // console.log('[Sticker] handleAnimationMouseEnter 1');\n        if (this.props.autoplay) return;\n\n        this.entered = true;\n\n        const player = this.lottieRef.current;\n        if (!player) return;\n\n        // console.log('[Sticker] handleAnimationMouseEnter 2');\n        this.loopCount = 0;\n        this.startStopAnimation();\n    };\n\n    handleAnimationLoopComplete = () => {\n        if (this.props.autoplay) return;\n\n        const player = this.lottieRef.current;\n        if (!player) return;\n\n        if (!this.entered) this.loopCount += 1;\n        if (this.loopCount > 2) {\n            const { animationData } = this.state;\n            if (animationData) {\n                this.setState({ animationData: null });\n            }\n        }\n    };\n\n    handleAnimationMouseOut = () => {\n        this.entered = false;\n    };\n\n    handleLoad = () => {\n        this.setState({\n            loaded: true\n        });\n    };\n\n    render() {\n        const {\n            chatId,\n            messageId,\n            autoplay,\n            className,\n            displaySize,\n            sticker: source,\n            style,\n            openMedia,\n            preview\n        } = this.props;\n        const { thumbnail, sticker, width, height } = source;\n        const { animationData, loaded, hasError } = this.state;\n\n        const isAnimated = isValidAnimatedSticker(source, chatId, messageId);\n\n        const thumbnailSrc = getSrc(thumbnail ? thumbnail.file : null);\n        const src = getSrc(sticker);\n        const isBlurred = isBlurredThumbnail(thumbnail, displaySize) || !preview;\n\n        if (hasError) {\n            const style = {\n                width: displaySize,\n                height: displaySize\n            };\n\n            if (process.env.NODE_ENV !== 'production') {\n                style.background = '#ff000066';\n            }\n\n            return (\n                <div className={classNames('sticker', className)} style={style} onClick={openMedia}>\n                    { thumbnailSrc && (\n                        <img\n                            className={classNames('sticker-image', { 'media-blurred': isBlurred })}\n                            draggable={false}\n                            src={thumbnailSrc}\n                            alt=''\n                        />\n                    )}\n                </div>\n            );\n        }\n\n        let content = null;\n        const fitSize = getFitSize({ width, height }, displaySize);\n        if (fitSize) {\n            content = isAnimated ? (\n                <>\n                    {animationData ? (\n                        <React.Suspense fallback={null}>\n                            <Lottie\n                                ref={this.lottieRef}\n                                options={{\n                                    autoplay: autoplay,\n                                    loop: true,\n                                    animationData,\n                                    renderer: 'svg',\n                                    rendererSettings: {\n                                        preserveAspectRatio: 'xMinYMin slice', // Supports the same options as the svg element's preserveAspectRatio property\n                                        clearCanvas: false,\n                                        progressiveLoad: true, // Boolean, only svg renderer, loads dom elements when needed. Might speed up initialization for large number of elements.\n                                        hideOnTransparent: true, //Boolean, only svg renderer, hides elements when opacity reaches 0 (defaults to true)\n                                        className: 'lottie-svg'\n                                    }\n                                }}\n                                eventListeners={[\n                                    {\n                                        eventName: 'loopComplete',\n                                        callback: this.handleAnimationLoopComplete\n                                    }\n                                ]}\n                                onMouseOut={this.handleAnimationMouseOut}\n                            />\n                        </React.Suspense>\n                    ) : (\n                        <>\n                            {thumbnailSrc && (\n                                <img\n                                    className={classNames('sticker-image', { 'media-blurred': isBlurred })}\n                                    draggable={false}\n                                    src={thumbnailSrc}\n                                    alt=''\n                                />\n                            )}\n                        </>\n                    )}\n                </>\n            ) : (\n                <>\n                    { thumbnailSrc && !loaded && (\n                        <img\n                            className={classNames('sticker-image', { 'media-blurred': isBlurred })}\n                            draggable={false}\n                            src={thumbnailSrc}\n                            alt=''\n                        />\n                    )}\n                    { src && !preview && <img key={sticker.id} className='sticker-image' src={src} draggable={false} alt='' onLoad={this.handleLoad} /> }\n                </>\n            );\n        }\n\n        const stickerStyle = {\n            width: fitSize ? fitSize.width : 0,\n            height: fitSize ? fitSize.height : 0,\n            ...style\n        };\n\n        return (\n            <div\n                className={classNames('sticker', className)}\n                style={stickerStyle}\n                onClick={openMedia}\n                onMouseEnter={this.handleMouseEnter}>\n                {content}\n            </div>\n        );\n    }\n}\n\nSticker.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    sticker: PropTypes.object.isRequired,\n    openMedia: PropTypes.func,\n\n    autoplay: PropTypes.bool,\n    play: PropTypes.bool,\n    displaySize: PropTypes.number,\n    preview: PropTypes.bool,\n    source: PropTypes.string\n};\n\nSticker.defaultProps = {\n    chatId: 0,\n    messageId: 0,\n    openMedia: () => {},\n\n    autoplay: true,\n    play: true,\n    displaySize: STICKER_DISPLAY_SIZE,\n    preview: false,\n    source: StickerSourceEnum.UNKNOWN\n};\n\nexport default Sticker;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport EventEmitter from './EventEmitter';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass AnimationStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.savedAnimations = null;\n        this.animationsInView = null;\n    };\n\n    onUpdate = async update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            case 'updateSavedAnimations': {\n                this.savedAnimations = await TdLibController.send({\n                    '@type': 'getSavedAnimations'\n                })\n\n                this.emit('updateSavedAnimations', update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateAnimationSend': {\n                this.emit('clientUpdateAnimationSend', update);\n                break;\n            }\n            case 'clientUpdateAnimationsInView': {\n                this.animationsInView = update.animations;\n                this.emit('clientUpdateAnimationsInView', update);\n                break;\n            }\n            case 'clientUpdateAnimationPreview': {\n                this.emit('clientUpdateAnimationPreview', update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n}\n\nconst store = new AnimationStore();\nwindow.animation = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport TdLibController from '../Controllers/TdLibController';\n\nexport function setPollAnswer(chatId, messageId, optionIds) {\n    TdLibController.send({\n        '@type': 'setPollAnswer',\n        chat_id: chatId,\n        message_id: messageId,\n        option_ids: optionIds\n    });\n}\n\nexport function cancelPollAnswer(chatId, messageId) {\n    TdLibController.send({\n        '@type': 'setPollAnswer',\n        chat_id: chatId,\n        message_id: messageId,\n        option_ids: []\n    });\n}\n\nexport function stopPoll(chatId, messageId) {\n    TdLibController.send({\n        '@type': 'stopPoll',\n        chat_id: chatId,\n        message_id: messageId,\n        reply_markup: null\n    });\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { getUserStatus, isUserOnline } from '../../Utils/User';\nimport UserStore from '../../Stores/UserStore';\nimport './UserStatus.css';\n\nclass UserStatus extends React.Component {\n    state = { };\n\n    static getDerivedStateFromProps(props, state) {\n        if (props.userId !== state.prevUserId) {\n            const { userId } = props;\n            const user = UserStore.get(userId);\n\n            return {\n                prevUserId: userId,\n                status: getUserStatus(user),\n                isAccent: isUserOnline(user)\n            };\n        }\n\n        return null;\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        const { userId } = this.props;\n        const { status, isAccent } = this.state;\n\n        if (nextProps.userId !== userId) {\n            return true;\n        }\n\n        if (nextState.status !== status) {\n            return true;\n        }\n\n        if (nextState.isAccent !== isAccent) {\n            return true;\n        }\n\n        return false;\n    }\n\n    componentDidMount() {\n        UserStore.on('updateUserStatus', this.onUpdateUserStatus);\n    }\n\n    componentWillUnmount() {\n        UserStore.off('updateUserStatus', this.onUpdateUserStatus);\n    }\n\n    onUpdateUserStatus = update => {\n        const { userId } = this.props;\n        if (userId !== update.user_id) return;\n\n        const user = UserStore.get(userId);\n        this.setState({ status: getUserStatus(user), isAccent: isUserOnline(user) });\n    };\n\n    render() {\n        const { status, isAccent } = this.state;\n\n        return (\n            <div className={classNames('user-content', 'dialog-content', { 'user-status-accent': isAccent })}>\n                {status}\n            </div>\n        );\n    }\n}\n\nUserStatus.propTypes = {\n    userId: PropTypes.number.isRequired\n};\n\nexport default UserStatus;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport EventEmitter from './EventEmitter';\nimport TdLibController from '../Controllers/TdLibController';\nimport { isValidPoll } from '../Utils/Poll';\n\nclass PollStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n\n        this.addTdLibListener();\n    }\n\n    reset = () => {\n        this.poll = null;\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n                if (!authorization_state) break;\n\n                switch (authorization_state['@type']) {\n                    case 'authorizationStateClosed': {\n                        this.reset();\n                        break;\n                    }\n                }\n\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateClosePollResults': {\n                this.emit('clientUpdateClosePollResults', update);\n                break;\n            }\n            case 'clientUpdateNewPoll': {\n                this.set({\n                    type: {\n                        '@type': 'pollTypeRegular',\n                        allow_multiple_answers: false\n                    },\n                    id: Date.now(),\n                    question: '',\n                    options: [],\n                    is_anonymous: true\n                });\n\n                this.emit('clientUpdateNewPoll', update);\n                break;\n            }\n            case 'clientUpdatePollChangeAnonymous': {\n                const { poll } = this;\n                const isAnonymous = poll && poll.is_anonymous;\n\n                this.assign(this.poll, { is_anonymous: !isAnonymous });\n\n                this.emit('clientUpdatePollChangeAnonymous', update);\n                break;\n            }\n            case 'clientUpdatePollChangeAllowMultipleAnswers': {\n                const { poll } = this;\n                const { type } = poll;\n                if (type['@type'] === 'pollTypeRegular') {\n                    const allowMultipleAnswers = poll && poll.type.allow_multiple_answers;\n\n                    const newType = { ...type, allow_multiple_answers: !allowMultipleAnswers };\n\n                    this.assign(this.poll, { type: newType });\n                }\n\n                this.emit('clientUpdatePollChangeAllowMultipleAnswers', update);\n                break;\n            }\n            case 'clientUpdatePollChangeType': {\n                const { poll } = this;\n                const { type } = poll;\n                if (type['@type'] === 'pollTypeRegular') {\n                    const newType = { '@type': 'pollTypeQuiz', correct_option_id: -1 };\n\n                    this.assign(this.poll, { type: newType });\n                } else {\n                    const newType = { '@type': 'pollTypeRegular', allow_multiple_answers: false };\n\n                    this.assign(this.poll, { type: newType });\n                }\n\n                this.emit('clientUpdatePollChangeType', update);\n                break;\n            }\n            case 'clientUpdatePollChooseOption': {\n                const { id } = update;\n                const { options } = this.poll;\n\n                this.assign(this.poll, {\n                    options: options.map(x => (x.id === id ? { ...x, is_chosen: true } : { ...x, is_chosen: false }))\n                });\n\n                this.emit('clientUpdatePollChooseOption', update);\n                break;\n            }\n            case 'clientUpdatePollQuestion': {\n                const { question } = update;\n\n                this.assign(this.poll, { question });\n\n                this.emit('clientUpdatePollQuestion', update);\n                break;\n            }\n            case 'clientUpdatePollOption': {\n                const { id, text } = update;\n                const { options } = this.poll;\n\n                this.assign(this.poll, { options: options.map(x => (x.id === id ? { ...x, text } : { ...x })) });\n\n                this.emit('clientUpdatePollOption', update);\n                break;\n            }\n            case 'clientUpdateNewPollOption': {\n                const { option } = update;\n                const { options } = this.poll;\n\n                this.assign(this.poll, { options: [...options, option] });\n                this.emit('clientUpdateNewPollOption', update);\n                break;\n            }\n            case 'clientUpdateDeletePollOption': {\n                const { id } = update;\n                const { options } = this.poll;\n\n                this.assign(this.poll, { options: options.filter(x => x.id !== id) });\n                this.emit('clientUpdateDeletePollOption', update);\n                break;\n            }\n            case 'clientUpdateDeletePoll': {\n                this.set(null);\n\n                this.emit('clientUpdateDeletePoll', update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n\n    assign(source1, source2) {\n        this.set(Object.assign({}, source1, source2));\n    }\n\n    set(poll) {\n        this.poll = poll;\n    }\n\n    getInputMessagePoll() {\n        if (!this.poll) return null;\n        if (!isValidPoll(this.poll)) return null;\n        const { question, options, type, is_anonymous } = this.poll;\n\n        if (type['@type'] === 'pollTypeQuiz') {\n            type.correct_option_id = options.findIndex(x => x.is_chosen);\n\n            if (type.correct_option_id === -1) {\n                return null;\n            }\n        }\n\n        return {\n            '@type': 'inputMessagePoll',\n            question,\n            options: options.filter(x => Boolean(x.text)).map(x => x.text),\n            is_anonymous,\n            type,\n            is_closed: false\n        };\n    }\n}\n\nconst store = new PollStore();\nwindow.poll = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\n/**\n * Draws a rounded rectangle using the current state of the canvas.\n * If you omit the last three params, it will draw a rectangle\n * outline with a 5 pixel border radius\n * @param {CanvasRenderingContext2D} ctx\n * @param {Number} x The top left x coordinate\n * @param {Number} y The top left y coordinate\n * @param {Number} width The width of the rectangle\n * @param {Number} height The height of the rectangle\n * @param {Number} [radius = 5] The corner radius; It can also be an object\n *                 to specify different radii for corners\n * @param {Number} [radius.tl = 0] Top left\n * @param {Number} [radius.tr = 0] Top right\n * @param {Number} [radius.br = 0] Bottom right\n * @param {Number} [radius.bl = 0] Bottom left\n * @param {Boolean} [fill = false] Whether to fill the rectangle.\n * @param {Boolean} [stroke = true] Whether to stroke the rectangle.\n */\nfunction roundRect(ctx, x, y, width, height, radius, fill, stroke) {\n    if (typeof stroke === 'undefined') {\n        stroke = true;\n    }\n    if (typeof radius === 'undefined') {\n        radius = 5;\n    }\n    if (typeof radius === 'number') {\n        radius = { tl: radius, tr: radius, br: radius, bl: radius };\n    } else {\n        var defaultRadius = { tl: 0, tr: 0, br: 0, bl: 0 };\n        for (var side in defaultRadius) {\n            radius[side] = radius[side] || defaultRadius[side];\n        }\n    }\n    ctx.beginPath();\n    ctx.moveTo(x + radius.tl, y);\n    ctx.lineTo(x + width - radius.tr, y);\n    ctx.quadraticCurveTo(x + width, y, x + width, y + radius.tr);\n    ctx.lineTo(x + width, y + height - radius.br);\n    ctx.quadraticCurveTo(x + width, y + height, x + width - radius.br, y + height);\n    ctx.lineTo(x + radius.bl, y + height);\n    ctx.quadraticCurveTo(x, y + height, x, y + height - radius.bl);\n    ctx.lineTo(x, y + radius.tl);\n    ctx.quadraticCurveTo(x, y, x + radius.tl, y);\n    ctx.closePath();\n    if (fill) {\n        ctx.fill();\n    }\n    if (stroke) {\n        ctx.stroke();\n    }\n}\n\nclass Particle {\n    constructor(fireworks) {\n        this.fireworks = fireworks;\n        this.type = 0;\n        this.colorType = 0;\n        this.side = 0;\n        this.typeSize = 4;\n        this.xFinished = false;\n        this.finishedStart = false;\n\n        this.x = 0;\n        this.y = 0;\n        this.rotation = 0;\n        this.moveX = 0;\n        this.moveY = 0;\n    }\n\n    draw(ctx) {\n        ctx.fillStyle = this.colorType;\n\n        if (this.type === 0) {\n            ctx.beginPath();\n            ctx.arc(this.x, this.y, this.typeSize, 0, Math.PI * 2, false);\n            ctx.fill();\n        } else {\n            ctx.save();\n            ctx.translate(this.x, this.y);\n            ctx.rotate((this.rotation * Math.PI) / 180);\n            roundRect(ctx, -this.typeSize, -2, this.typeSize * 2, 4, 2, true, false);\n            ctx.restore();\n        }\n    }\n\n    update(dt) {\n        const moveCoef = dt / 16.0;\n        this.x += this.moveX * moveCoef;\n        this.y += this.moveY * moveCoef;\n        if (this.xFinished !== 0) {\n            const dp = 0.5;\n            if (this.xFinished === 1) {\n                this.moveX += dp * moveCoef * 0.05;\n                if (this.moveX >= dp) {\n                    this.xFinished = 2;\n                }\n            } else {\n                this.moveX -= dp * moveCoef * 0.05;\n                if (this.moveX <= -dp) {\n                    this.xFinished = 1;\n                }\n            }\n        } else {\n            if (this.side === 0) {\n                if (this.moveX > 0) {\n                    this.moveX -= moveCoef * 0.05;\n                    if (this.moveX <= 0) {\n                        this.moveX = 0;\n                        this.xFinished = this.finishedStart;\n                    }\n                }\n            } else {\n                if (this.moveX < 0) {\n                    this.moveX += moveCoef * 0.05;\n                    if (this.moveX >= 0) {\n                        this.moveX = 0;\n                        this.xFinished = this.finishedStart;\n                    }\n                }\n            }\n        }\n        let yEdge = -0.5;\n        const wasNegative = this.moveY < yEdge;\n        if (this.moveY > yEdge) {\n            this.moveY += (1.0 / 3.0) * moveCoef * this.fireworks.speedCoef;\n        } else {\n            this.moveY += (1.0 / 3.0) * moveCoef;\n        }\n        if (wasNegative && this.moveY > yEdge) {\n            this.fireworks.fallingDownCount++;\n        }\n        if (this.type === 1) {\n            this.rotation += moveCoef * 10;\n            if (this.rotation > 360) {\n                this.rotation -= 360;\n            }\n        }\n\n        return this.y >= this.fireworks.getMeasuredHeight();\n    }\n}\n\nfunction getRandomInt(min, max) {\n    min = Math.ceil(min);\n    max = Math.floor(max);\n    return Math.floor(Math.random() * (max - min)) + min;\n}\n\nclass Fireworks {\n    static colors = ['#E8BC2C', '#D0049E', '#02CBFE', '#5723FD', '#FE8C27', '#6CB859'];\n\n    constructor(context) {\n        this.context = context;\n        this.particlesCount = 60;\n        this.fallParticlesCount = 30;\n        this.particles = [];\n        this.speedCoef = 1.0;\n        this.fallingDownCount = 0;\n    }\n\n    getMeasuredHeight() {\n        return this.context.canvas.clientHeight;\n    }\n\n    getMeasuredWidth() {\n        return this.context.canvas.clientWidth;\n    }\n\n    createParticle(fall) {\n        const particle = new Particle(this);\n        particle.colorType = Fireworks.colors[getRandomInt(0, Fireworks.colors.length)];\n        particle.type = getRandomInt(0, 2);\n        particle.side = getRandomInt(0, 2);\n        particle.finishedStart = 1 + getRandomInt(0, 2);\n        if (particle.type === 0) {\n            particle.typeSize = 4 + Math.random() * 2;\n        } else {\n            particle.typeSize = 4 + Math.random() * 4;\n        }\n        if (fall) {\n            particle.y = -Math.random() * this.getMeasuredHeight() * 1.2;\n            particle.x = 5 + getRandomInt(0, this.getMeasuredWidth() - 10);\n            particle.xFinished = particle.finishedStart;\n        } else {\n            const xOffset = 4 + getRandomInt(0, 10);\n            const yOffset = this.getMeasuredHeight() / 4;\n            if (particle.side === 0) {\n                particle.x = -xOffset;\n            } else {\n                particle.x = this.getMeasuredWidth() + xOffset;\n            }\n            particle.rotation = Math.random() * 360;\n            particle.moveX = (particle.side === 0 ? 1 : -1) * (1.2 + Math.random() * 4);\n            particle.moveY = -(4 + Math.random() * 4);\n            particle.y = yOffset / 2 + getRandomInt(0, yOffset * 2);\n        }\n        // console.log(`particle side=${particle.side} x=${particle.x} y=${particle.y} moveX=${particle.moveX} moveY=${particle.moveY}`);\n        return particle;\n    }\n\n    start() {\n        if (this.started) {\n            return;\n        }\n\n        this.particles = [];\n        this.started = true;\n        this.startedFall = false;\n        this.fallingDownCount = 0;\n        this.speedCoef = 1.0;\n        this.lastUpdateTime = 0;\n        for (let a = 0; a < this.particlesCount; a++) {\n            this.particles.push(this.createParticle(false));\n        }\n\n        this.draw();\n    }\n\n    startFall() {\n        if (this.startedFall) {\n            return;\n        }\n        this.startedFall = true;\n        for (let a = 0; a < this.fallParticlesCount; a++) {\n            this.particles.push(this.createParticle(true));\n        }\n    }\n\n    draw() {\n        const newTime = Date.now();\n        let dt = newTime - this.lastUpdateTime;\n        this.lastUpdateTime = newTime;\n        if (dt > 18) {\n            dt = 16;\n        }\n        // console.log('draw dt', dt);\n        this.context.clearRect(0, 0, this.getMeasuredWidth(), this.getMeasuredHeight());\n        for (let a = 0, N = this.particles.length; a < N; a++) {\n            const p = this.particles[a];\n            p.draw(this.context);\n            if (p.update(dt)) {\n                this.particles.splice(a, 1);\n                a--;\n                N--;\n            }\n        }\n        if (this.fallingDownCount >= this.particlesCount / 2 && this.speedCoef > 0.2) {\n            this.startFall();\n            this.speedCoef -= (dt / 16.0) * 0.15;\n            if (this.speedCoef < 0.2) {\n                this.speedCoef = 0.2;\n            }\n        }\n        if (this.particles.length) {\n            window.requestAnimationFrame(() => this.draw());\n        } else {\n            this.started = false;\n            this.context.clearRect(0, 0, this.getMeasuredWidth(), this.getMeasuredHeight());\n        }\n    }\n}\n\nclass FireworksComponent extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.canvasRef = React.createRef();\n    }\n\n    componentDidMount() {\n        this.attachToParent();\n    }\n\n    componentWillUnmount() {\n        this.detachFromParent();\n    }\n\n    attachToParent() {\n        const canvas = this.canvasRef.current;\n        if (!canvas) return;\n\n        const parentNode = canvas.parentNode;\n        if (!parentNode) return;\n\n        this.parentNode = parentNode;\n        canvas.setAttribute('width', this.parentNode.clientWidth + 18);\n        canvas.setAttribute('height', this.parentNode.clientHeight + 12);\n        window.addEventListener('resize', this.onResize);\n    }\n\n    detachFromParent() {\n        const canvas = this.canvasRef.current;\n        if (!canvas) return;\n\n        const parentNode = canvas.parentNode;\n        if (!parentNode) return;\n\n        this.parentNode = null;\n        window.removeEventListener('resize', this.onResize);\n    }\n\n    onResize = () => {\n        const canvas = this.canvasRef.current;\n        if (!canvas) return;\n\n        canvas.setAttribute('width', this.parentNode.clientWidth + 18);\n        canvas.setAttribute('height', this.parentNode.clientHeight + 12);\n    };\n\n    start() {\n        const ctx = this.canvasRef.current.getContext('2d');\n\n        const fireworks = new Fireworks(ctx);\n        fireworks.start();\n    }\n\n    render() {\n        return (\n            <canvas\n                ref={this.canvasRef}\n                style={{\n                    zIndex: 2,\n                    position: 'absolute',\n                    left: 0,\n                    top: 0,\n                    width: '100%',\n                    height: '100%',\n                    pointerEvents: 'none'\n                }}\n            />\n        );\n    }\n}\n\nFireworksComponent.propTypes = {};\n\nexport default FireworksComponent;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport Radio from '@material-ui/core/Radio';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport RadioButtonCheckedIcon from '@material-ui/icons/RadioButtonChecked';\nimport './PollRadio.css';\n\nclass PollRadio extends React.Component {\n    render() {\n        const { chosen, beingChosen, hidden, onChange } = this.props;\n\n        return (\n            <div className={classNames('poll-radio', { 'poll-radio-hidden': hidden })}>\n                <Radio\n                    color='primary'\n                    classes={{\n                        root: 'poll-radio-root',\n                        colorPrimary: 'message-control',\n                        disabled: 'message-control-disabled'\n                    }}\n                    TouchRippleProps={{ classes: { child: 'touch-ripple-current-color' } }}\n                    checked={chosen || beingChosen}\n                    onChange={onChange}\n                    checkedIcon={<RadioButtonCheckedIcon classes={{ root: beingChosen ? 'poll-radio-icon' : null }} />}\n                />\n                {beingChosen && (\n                    <CircularProgress\n                        size={20}\n                        thickness={4.4}\n                        classes={{ root: 'poll-radio-progress-root', colorPrimary: 'message-control' }}\n                    />\n                )}\n            </div>\n        );\n    }\n}\n\nPollRadio.propTypes = {\n    chosen: PropTypes.bool,\n    beingChosen: PropTypes.bool,\n    hidden: PropTypes.bool\n};\n\nexport default PollRadio;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { ANIMATION_DURATION_200MS } from './../../../Constants';\nimport './PollPercentage.css';\n\nclass PollPercentage extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.handle = null;\n\n        const { value } = props;\n\n        this.state = {\n            from: value,\n            to: value,\n            animated: value,\n\n            prevPropsValue: value\n        };\n    }\n\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\n        const { closed, theme, value } = this.props;\n        const { animated } = this.state;\n\n        if (closed !== nextProps.closed) {\n            return true;\n        }\n\n        if (theme !== nextProps.theme) {\n            return true;\n        }\n\n        if (value !== nextProps.value) {\n            return true;\n        }\n\n        if (animated !== nextState.animated) {\n            return true;\n        }\n\n        return false;\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        if (props.value !== state.prevPropsValue) {\n            return {\n                startTime: Date.now(),\n                from: state.animated,\n                to: props.value,\n\n                prevPropsValue: props.value\n            };\n        }\n\n        return null;\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (prevProps.value !== this.props.value) {\n            this.updateAnimation();\n        }\n    }\n\n    componentWillUnmount() {\n        this.stopAnimation();\n    }\n\n    updateAnimation = () => {\n        this.stopAnimation();\n\n        this.handle = requestAnimationFrame(this.onAnimationFrame);\n    };\n\n    stopAnimation = () => {\n        if (!this.handle) return;\n\n        cancelAnimationFrame(this.handle);\n        this.handle = null;\n    };\n\n    onAnimationFrame = () => {\n        const { startTime, from, to } = this.state;\n\n        const timePassed = Date.now() - startTime;\n\n        if (timePassed >= ANIMATION_DURATION_200MS) {\n            this.setState({ animated: to });\n            this.stopAnimation();\n        } else {\n            const animated = from + Math.floor(((to - from) * timePassed) / ANIMATION_DURATION_200MS);\n            this.setState({ animated });\n            this.handle = requestAnimationFrame(this.onAnimationFrame);\n        }\n    };\n\n    render() {\n        const { chosen, closed, onClick } = this.props;\n        const { animated } = this.state;\n\n        return (\n            <div className='poll-percentage'>\n                {/*{!closed && chosen ? (*/}\n                {/*    <a className='poll-percentage-action' onClick={onClick}>*/}\n                {/*        {animated + '%'}*/}\n                {/*    </a>*/}\n                {/*) : (*/}\n                {/*    <>{animated + '%'}</>*/}\n                {/*)}*/}\n                <>{animated + '%'}</>\n            </div>\n        );\n    }\n}\n\nPollPercentage.propTypes = {\n    value: PropTypes.number.isRequired,\n    chosen: PropTypes.bool,\n    closed: PropTypes.bool,\n    onClick: PropTypes.func\n};\n\nexport default PollPercentage;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { withTranslation } from 'react-i18next';\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport CheckIcon from '../../../Assets/Icons/Check';\nimport CloseIcon from '../../../Assets/Icons/Close';\nimport PollRadio from './PollRadio';\nimport PollPercentage from './PollPercentage';\nimport './PollOption.css';\n\nclass PollOption extends React.Component {\n    getTitleString = (count, t = key => key) => {\n        const { canBeSelected } = this.props;\n        if (canBeSelected) return null;\n\n        if (!count) return t('NoVotes').toLowerCase();\n        if (count === 1) return '1 vote';\n\n        return count + ' votes';\n    };\n\n    handleClick = event => {\n        const { canBeSelected, onVote } = this.props;\n        if (!canBeSelected) return;\n\n        event.stopPropagation();\n\n        onVote();\n    };\n\n    render() {\n        const { option, onChange, canBeSelected, closed, maxVoterCount, t, type, isCorrect } = this.props;\n        if (!option) return null;\n\n        const { text, voter_count, vote_percentage, is_chosen, isMultiChoosen, is_being_chosen } = option;\n\n        let value = 1.5;\n        if (voter_count) {\n            value = (voter_count / maxVoterCount) * 100;\n        }\n\n        return (\n            <div className='poll-option' onClick={this.handleClick}>\n                <div\n                    className={classNames(\n                        'poll-option-wrapper',\n                        canBeSelected ? 'poll-option-unselected' : 'poll-option-selected'\n                    )}>\n                    <div className='poll-option-text-wrapper' title={this.getTitleString(voter_count, t)}>\n                        <PollPercentage value={vote_percentage} chosen={is_chosen} closed={closed} />\n                        <PollRadio\n                            hidden={!canBeSelected}\n                            chosen={is_chosen || isMultiChoosen}\n                            beingChosen={is_being_chosen}\n                            onChange={onChange}\n                        />\n                        {(is_chosen || isCorrect) && (\n                            <div\n                                className={classNames(\n                                    'poll-option-mark',\n                                    { 'poll-option-mark-correct': type === 'correct' },\n                                    { 'poll-option-mark-incorrect': type === 'incorrect' }\n                                )}>\n                                {type === 'incorrect' ? (\n                                    <CloseIcon className='poll-option-mark-icon' />\n                                ) : (\n                                    <CheckIcon className='poll-option-mark-icon' />\n                                )}\n                            </div>\n                        )}\n                        <div className='poll-option-text'>{text}</div>\n                    </div>\n                </div>\n                <LinearProgress\n                    classes={{\n                        root: 'poll-option-progress-root',\n                        bar: classNames(\n                            'poll-option-progress-bar',\n                            { 'poll-option-progress-bar-correct': type === 'correct' },\n                            { 'poll-option-progress-bar-incorrect': type === 'incorrect' }\n                        )\n                    }}\n                    color='primary'\n                    variant='determinate'\n                    value={canBeSelected ? 0 : Math.max(1.5, value)}\n                />\n            </div>\n        );\n    }\n}\n\nPollOption.propTypes = {\n    type: PropTypes.oneOf(['regular', 'correct', 'incorrect']).isRequired,\n    option: PropTypes.object.isRequired,\n    onVote: PropTypes.func.isRequired,\n    canBeSelected: PropTypes.bool,\n    closed: PropTypes.bool,\n    maxVoterCount: PropTypes.number\n};\n\nexport default withTranslation()(PollOption);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport './UserPlaceholder.css';\nimport UserStatus from './UserStatus';\n\nclass UserPlaceholder extends React.Component {\n    render() {\n        const { index, showStatus } = this.props;\n\n        const titleWidth = `${20 + Math.sin(index) * 10}%`;\n        const contentWidth = `${30 + Math.cos(index) * 10}%`;\n\n        return (\n            <div className='user-placeholder'>\n                <div className='user-wrapper'>\n                    <div className='user-placeholder-tile' />\n                    <div className='user-placeholder-inner-wrapper'>\n                        <div className='tile-first-row'>\n                            <div className='dialog-placeholder-title' style={{ width: titleWidth }} />\n                            <div className='dialog-placeholder-title' style={{ width: contentWidth, marginLeft: 8 }} />\n                        </div>\n                        {showStatus && (\n                            <div className='tile-second-row'>\n                                <div className='dialog-placeholder-content' style={{ width: contentWidth }} />\n                            </div>\n                        )}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nUserPlaceholder.propTypes = {\n    index: PropTypes.number.isRequired,\n    showStatus: PropTypes.bool\n};\n\nUserPlaceholder.defaultProps = {\n    showStatus: true\n};\n\nexport default UserPlaceholder;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport ListItem from '@material-ui/core/ListItem';\nimport User from '../Tile/User';\nimport UserPlaceholder from '../Tile/UserPlaceholder';\nimport { openUser } from '../../Actions/Client';\nimport TdLibController from '../../Controllers/TdLibController';\nimport './PollOptionResult.css';\n\nclass PollOptionResult extends React.Component {\n    onClick = () => {\n        const { userId } = this.props;\n        if (!userId) return;\n\n        openUser(userId, true);\n\n        setTimeout(() => {\n            TdLibController.clientUpdate({\n                '@type': 'clientUpdateClosePollResults'\n            });\n        }, 0);\n    };\n\n    render() {\n        const { index, userId } = this.props;\n\n        const content = userId ? (\n            <User userId={userId} showStatus={false} />\n        ) : (\n            <UserPlaceholder index={index} showStatus={false} />\n        );\n\n        return (\n            <ListItem button className='user-list-item' onClick={this.onClick}>\n                {content}\n            </ListItem>\n        );\n    }\n}\n\nPollOptionResult.propTypes = {\n    index: PropTypes.number.isRequired,\n    userId: PropTypes.number\n};\n\nexport default PollOptionResult;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport Button from '@material-ui/core/Button';\nimport PollOptionResult from './PollOptionResult';\nimport { loadUsersContent } from '../../Utils/File';\nimport { POLL_RESULTS_FIRST_SLICE_LENGTH, POLL_RESULTS_LEAVE_LENGTH, POLL_RESULTS_SLICE_LENGTH } from '../../Constants';\nimport FileStore from '../../Stores/FileStore';\nimport UserStore from '../../Stores/UserStore';\nimport TdLibController from '../../Controllers/TdLibController';\nimport './PollOptionResults.css';\n\nclass PollOptionResults extends React.Component {\n    constructor(props) {\n        super(props);\n\n        const { option } = this.props;\n\n        const count =\n            option && option.voter_count <= POLL_RESULTS_FIRST_SLICE_LENGTH\n                ? option.voter_count\n                : POLL_RESULTS_FIRST_SLICE_LENGTH - POLL_RESULTS_LEAVE_LENGTH;\n\n        this.state = {\n            voters: [],\n            offset: 0,\n            count\n        };\n    }\n\n    async updateVoters(offset, count, loadMore) {\n        const { chatId, messageId, optionId, option } = this.props;\n        const { voters } = this.state;\n        if (count <= 0) return;\n\n        const limit = count - offset;\n        // console.log(`[poll] getPollVoters start option_id=${optionId} offset=${offset} limit=${limit}`);\n        const result = await TdLibController.send({\n            '@type': 'getPollVoters',\n            chat_id: chatId,\n            message_id: messageId,\n            option_id: optionId,\n            offset,\n            limit\n        });\n        // console.log(`[poll] getPollVoters end option_id=${optionId} offset=${offset} limit=${limit}`, result, result.user_ids.map(x => UserStore.get(x)));\n\n        if (this.props.option !== option) {\n            return;\n        }\n\n        const store = FileStore.getStore();\n        loadUsersContent(store, result.user_ids);\n\n        this.setState(\n            {\n                voters: [...voters, ...result.user_ids]\n            },\n            async () => {\n                if (result.user_ids.length < limit && loadMore) {\n                    const offset2 = offset + result.user_ids.length;\n\n                    this.updateVoters(offset2, count, false);\n                }\n            }\n        );\n    }\n\n    componentDidMount() {\n        const { offset, count } = this.state;\n\n        this.updateVoters(offset, count, true);\n    }\n\n    handleShowMore = () => {\n        const { option } = this.props;\n        const { count } = this.state;\n\n        const newOffset = count;\n        const newCount = Math.min(option.voter_count, count + POLL_RESULTS_SLICE_LENGTH);\n\n        this.setState(\n            {\n                offset: newOffset,\n                count: newCount\n            },\n            () => {\n                this.updateVoters(newOffset, newCount, true);\n            }\n        );\n    };\n\n    handleCollapse = event => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        const { option } = this.props;\n\n        const count =\n            option && option.voter_count <= POLL_RESULTS_FIRST_SLICE_LENGTH\n                ? option.voter_count\n                : POLL_RESULTS_FIRST_SLICE_LENGTH - POLL_RESULTS_LEAVE_LENGTH;\n\n        this.setState({\n            voters: this.state.voters.slice(0, count),\n            offset: 0,\n            count\n        });\n    };\n\n    render() {\n        const { option, isQuiz, t } = this.props;\n        const { voters, count } = this.state;\n\n        const { text, voter_count, vote_percentage } = option;\n        if (voter_count === 0) {\n            return null;\n        }\n\n        const results = [];\n        for (let i = 0; i < count; i++) {\n            const userId = i < voters.length ? voters[i] : null;\n            results.push(<PollOptionResult key={`${i}_userId=${userId}`} index={i} userId={userId} />);\n        }\n\n        const voterCount = isQuiz\n            ? voter_count !== 1\n                ? `${voter_count} answers`\n                : `${voter_count} answer`\n            : voter_count !== 1\n            ? `${voter_count} votes`\n            : `${voter_count} vote`;\n\n        let showMoreButton = null;\n        const showMoreCount = voter_count - count;\n        if (showMoreCount > 0) {\n            const showMore = isQuiz\n                ? showMoreCount !== 1\n                    ? `${showMoreCount} answers`\n                    : `${showMoreCount} answer`\n                : showMoreCount !== 1\n                ? `${showMoreCount} votes`\n                : `${showMoreCount} vote`;\n\n            showMoreButton = (\n                <Button\n                    classes={{ root: 'poll-option-results-button' }}\n                    color='primary'\n                    fullWidth\n                    onClick={this.handleShowMore}>\n                    {t('ShowVotesOT').replace('%1$d', showMore)}\n                </Button>\n            );\n        }\n        const showCollapse =\n            count > POLL_RESULTS_FIRST_SLICE_LENGTH - POLL_RESULTS_LEAVE_LENGTH &&\n            voter_count > POLL_RESULTS_FIRST_SLICE_LENGTH;\n\n        return (\n            <>\n                <div className='poll-option-results-caption'>\n                    <div className='poll-option-results-answer'>{`${text} — ${vote_percentage}%`}</div>\n                    {showCollapse ? (\n                        <a onClick={this.handleCollapse}>{t('PollCollapse')}</a>\n                    ) : (\n                        <div className='poll-option-results-count'>{voterCount}</div>\n                    )}\n                </div>\n                {results}\n                {showMoreButton}\n            </>\n        );\n    }\n}\n\nPollOptionResults.propTypes = {\n    chatId: PropTypes.number.isRequired,\n    messageId: PropTypes.number.isRequired,\n    optionId: PropTypes.number.isRequired,\n    option: PropTypes.object.isRequired,\n    isQuiz: PropTypes.bool.isRequired\n};\n\nexport default withTranslation()(PollOptionResults);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport PollOptionResults from './PollOptionResults';\nimport PollStore from '../../Stores/PollStore';\nimport { modalManager } from '../../Utils/Modal';\nimport './PollResultsDialog.css';\n\nclass PollResultsDialog extends React.Component {\n    componentDidMount() {\n        PollStore.on('clientUpdateClosePollResults', this.onClientUpdateClosePollResults);\n    }\n\n    componentWillUnmount() {\n        PollStore.off('clientUpdateClosePollResults', this.onClientUpdateClosePollResults);\n    }\n\n    onClientUpdateClosePollResults = update => {\n        const { onClose } = this.props;\n        onClose();\n    };\n\n    handleClose = event => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        const { onClose } = this.props;\n        onClose();\n    };\n\n    handleClick = event => {\n        event.preventDefault();\n        event.stopPropagation();\n    };\n\n    handleContextMenu = event => {\n        event.preventDefault();\n        event.stopPropagation();\n    };\n\n    render() {\n        const { chatId, messageId, poll, t } = this.props;\n        if (!poll) return;\n\n        const { options, type, question } = poll;\n        const isQuiz = type && type['@type'] === 'pollTypeQuiz';\n\n        return (\n            <Dialog\n                classes={{\n                    root: 'chat-info-dialog-root',\n                    container: 'chat-info-dialog-container',\n                    paper: 'chat-info-dialog-paper'\n                }}\n                manager={modalManager}\n                transitionDuration={0}\n                open={true}\n                onClick={this.handleClick}\n                onContextMenu={this.handleContextMenu}\n                onClose={this.handleClose}\n                aria-labelledby='poll-results-title'>\n                <DialogTitle id='poll-results-title'>{isQuiz ? t('QuizAnswers') : t('PollResults')}</DialogTitle>\n                <DialogContent classes={{ root: 'poll-results-content' }}>\n                    <div className='poll-results-question'>{question}</div>\n                    {options.map((x, i) => (\n                        <PollOptionResults\n                            key={i}\n                            isQuiz={isQuiz}\n                            chatId={chatId}\n                            messageId={messageId}\n                            optionId={i}\n                            option={x}\n                        />\n                    ))}\n                </DialogContent>\n            </Dialog>\n        );\n    }\n}\n\nPollResultsDialog.propTypes = {\n    chatId: PropTypes.number.isRequired,\n    messageId: PropTypes.number.isRequired,\n    poll: PropTypes.object.isRequired\n};\n\nexport default withTranslation()(PollResultsDialog);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport FireworksComponent from './FireworksControl';\nimport PollOption from './PollOption';\nimport UserTile from '../../Tile/UserTile';\nimport { setPollAnswer } from '../../../Actions/Poll';\nimport MessageStore from './../../../Stores/MessageStore';\nimport TdLibController from './../../../Controllers/TdLibController';\nimport './Poll.css';\nimport PollResultsDialog from '../../Popup/PollResultsDialog';\n\nclass Poll extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.fireworksRef = React.createRef();\n        this.state = {};\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        const { chatId, messageId, poll } = this.props;\n\n        if (poll && poll.type['@type'] === 'pollTypeQuiz') {\n            const { poll: prevPoll } = prevProps;\n            if (prevPoll.type.correct_option_id === -1 && poll.type.correct_option_id !== -1) {\n                const fireworks = this.fireworksRef.current;\n                if (!fireworks) return;\n\n                if (poll.options[poll.type.correct_option_id].is_chosen) {\n                    fireworks.start();\n                } else {\n                    TdLibController.clientUpdate({\n                        '@type': 'clientUpdateMessageShake',\n                        chatId,\n                        messageId\n                    });\n                }\n            }\n        }\n    }\n\n    getTotalVoterCountString = (count, t = key => key) => {\n        if (!count) return t('NoVotes');\n        if (count === 1) return '1 answer';\n\n        return count + ' answers';\n    };\n\n    handleSubmit = event => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        const { chatId, messageId, poll } = this.props;\n        if (!poll) return;\n\n        const { type } = poll;\n        if (!type) return;\n\n        if (this.viewResults(poll)) {\n            return;\n        }\n\n        if (!type.allow_multiple_answers) {\n            return;\n        }\n\n        const optionIds = [];\n        poll.options.forEach((x, index) => {\n            if (x.isMultiChoosen) {\n                optionIds.push(index);\n            }\n        });\n\n        if (!optionIds.length) {\n            return;\n        }\n\n        setPollAnswer(chatId, messageId, optionIds);\n    };\n\n    handleVote = index => {\n        const { chatId, messageId, poll } = this.props;\n        if (!poll) return;\n\n        const { type } = poll;\n        if (!type) return;\n\n        if (type['@type'] === 'pollTypeRegular' && type.allow_multiple_answers) {\n            poll.options[index].isMultiChoosen = !poll.options[index].isMultiChoosen;\n            this.forceUpdate();\n        } else {\n            setPollAnswer(chatId, messageId, [index]);\n        }\n    };\n\n    viewResults(poll) {\n        if (!poll) return false;\n\n        const { options, is_closed, is_anonymous } = poll;\n        if (is_anonymous) {\n            return false;\n        }\n\n        return is_closed || options.some(x => x.is_chosen);\n    }\n\n    getOptionType(index, poll) {\n        const types = ['regular', 'correct', 'incorrect'];\n        const defaultTypeId = 0;\n        const correctTypeId = 1;\n        const incorrectTypeId = 2;\n        if (!poll) return types[defaultTypeId];\n\n        const option = poll.options[index];\n        if (!option) return types[defaultTypeId];\n        if (!option.is_chosen) return types[defaultTypeId];\n\n        const { type } = poll;\n        if (!type) return types[defaultTypeId];\n        if (type['@type'] !== 'pollTypeQuiz') return types[defaultTypeId];\n\n        const { correct_option_id } = type;\n        if (correct_option_id === -1) return types[defaultTypeId];\n\n        return correct_option_id === index ? types[correctTypeId] : types[incorrectTypeId];\n    }\n\n    getOptionIsCorrect(index, poll) {\n        if (!poll) return false;\n\n        const option = poll.options[index];\n        if (!option) return false;\n\n        const { type } = poll;\n        if (!type) return false;\n        if (type['@type'] !== 'pollTypeQuiz') return false;\n\n        const { correct_option_id } = type;\n        if (correct_option_id === -1) return false;\n\n        return correct_option_id === index;\n    }\n\n    handleOpenResults = event => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        const { poll } = this.props;\n\n        this.setState({\n            viewResultsPoll: poll\n        });\n    };\n\n    handleCloseResults = () => {\n        this.setState({\n            viewResultsPoll: null\n        });\n    };\n\n    render() {\n        const { chatId, messageId, poll, t, meta } = this.props;\n        const { viewResultsPoll } = this.state;\n        const { question, options, total_voter_count, type, is_closed, is_anonymous, recent_voter_user_ids } = poll;\n\n        let subtitle = t('FinalResults');\n        if (!is_closed) {\n            switch (type['@type']) {\n                case 'pollTypeRegular': {\n                    subtitle = is_anonymous ? t('AnonymousPoll') : t('PublicPoll');\n                    break;\n                }\n                case 'pollTypeQuiz': {\n                    subtitle = is_anonymous ? t('AnonymousQuizPoll') : t('QuizPoll');\n                    break;\n                }\n            }\n        }\n\n        const message = MessageStore.get(chatId, messageId);\n        if (!message) return null;\n\n        const isQuiz = type && type['@type'] === 'pollTypeQuiz';\n        const canBeSelected = !is_closed && options.every(x => !x.is_chosen);\n        const isSelected = !is_closed && options.some(x => x.is_chosen);\n        const maxVoterCount = Math.max(...options.map(x => x.voter_count));\n        const showViewResults = this.viewResults(poll);\n        const showButton = (type.allow_multiple_answers && !isSelected) || showViewResults;\n        const buttonEnabled = showViewResults || options.some(x => x.isMultiChoosen);\n        let recentVoters = [];\n        if (recent_voter_user_ids) {\n            recentVoters = recent_voter_user_ids.map(id => <UserTile key={id} poll userId={id} />);\n        }\n\n        return (\n            <div className='poll'>\n                {isQuiz && <FireworksComponent ref={this.fireworksRef} />}\n                <div className='poll-question'>\n                    <div className='poll-question-title'>{question}</div>\n                    <div className='poll-question-subtitle'>\n                        <span style={{ marginRight: 6 }}>{subtitle}</span>\n                        {recentVoters}\n                    </div>\n                </div>\n                <div className='poll-options'>\n                    {options.map((x, index) => (\n                        <PollOption\n                            key={index}\n                            type={this.getOptionType(index, poll)}\n                            isCorrect={this.getOptionIsCorrect(index, poll)}\n                            option={x}\n                            canBeSelected={canBeSelected}\n                            closed={is_closed}\n                            maxVoterCount={maxVoterCount}\n                            onVote={() => this.handleVote(index)}\n                        />\n                    ))}\n                </div>\n                {showButton ? (\n                    <Button\n                        fullWidth\n                        color='primary'\n                        classes={{\n                            root: 'poll-button',\n                            textPrimary: 'message-control',\n                            disabled: 'message-control-disabled'\n                        }}\n                        TouchRippleProps={{ classes: { child: 'touch-ripple-current-color' } }}\n                        disabled={!buttonEnabled}\n                        onClick={showViewResults ? this.handleOpenResults : this.handleSubmit}>\n                        {showViewResults ? t('PollViewResults') : t('PollSubmitVotes')}\n                    </Button>\n                ) : (\n                    <div className='poll-total-count'>\n                        {this.getTotalVoterCountString(total_voter_count, t)}\n                        {meta}\n                    </div>\n                )}\n                {Boolean(viewResultsPoll) && (\n                    <PollResultsDialog\n                        chatId={chatId}\n                        messageId={messageId}\n                        poll={viewResultsPoll}\n                        onClose={this.handleCloseResults}\n                    />\n                )}\n            </div>\n        );\n    }\n}\n\nPoll.propTypes = {\n    chatId: PropTypes.number.isRequired,\n    messageId: PropTypes.number.isRequired,\n    poll: PropTypes.object.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default withTranslation()(Poll);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport TdLibController from '../Controllers/TdLibController';\nimport ChatStore from '../Stores/ChatStore';\nimport { isChatMuted, isChatPinned } from '../Utils/Chat';\nimport { MUTED_VALUE_MAX, MUTED_VALUE_MIN } from '../Constants';\n\nexport function changeChatDetailsVisibility(visibility) {\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateChatDetailsVisibility',\n        visibility\n    });\n}\n\nexport async function openPinnedChat(index) {\n    const chats = await TdLibController.send({\n        '@type': 'getChats',\n        chat_list: { '@type': 'chatListMain' },\n        offset_order: '9223372036854775807',\n        offset_chat_id: 0,\n        limit: 10\n    });\n\n    if (chats) {\n        let pinnedIndex = -1;\n        for (let i = 0; i < chats.chat_ids.length; i++) {\n            const chat = ChatStore.get(chats.chat_ids[i]);\n            if (chat && isChatPinned(chat.id, { '@type': 'chatListMain' })) {\n                pinnedIndex++;\n            }\n\n            if (pinnedIndex === index) {\n                TdLibController.setChatId(chat.id);\n                return;\n            }\n        }\n    }\n}\n\nexport async function getChat(chatId) {\n    const chat = TdLibController.send({\n        '@type': 'getChat',\n        chat_id: chatId\n    });\n    ChatStore.set(chat);\n\n    return chat;\n}\n\nexport function addChatToList(chatId, chatList) {\n    TdLibController.send({\n        '@type': 'addChatToList',\n        chat_id: chatId,\n        chat_list: chatList\n    });\n}\n\nexport function toggleChatIsPinned(chatId, chatList, isPinned) {\n    TdLibController.send({\n        '@type': 'toggleChatIsPinned',\n        chat_id: chatId,\n        chat_list: chatList,\n        is_pinned: isPinned\n    });\n}\n\nexport function toggleChatIsMarkedAsUnread(chatId, isMarkedAsUnread) {\n    TdLibController.send({\n        '@type': 'toggleChatIsMarkedAsUnread',\n        chat_id: chatId,\n        is_marked_as_unread: isMarkedAsUnread\n    });\n}\n\nexport function toggleChatNotificationSettings(chatId, isMuted) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return;\n\n    const { notification_settings } = chat;\n    if (!notification_settings) return;\n\n    const isMutedPrev = isChatMuted(chatId);\n    if (isMutedPrev === isMuted) {\n        return;\n    }\n\n    const muteFor = isMuted ? MUTED_VALUE_MAX : MUTED_VALUE_MIN;\n    const newNotificationSettings = {\n        ...chat.notification_settings,\n        use_default_mute_for: false,\n        mute_for: muteFor\n    };\n\n    TdLibController.send({\n        '@type': 'setChatNotificationSettings',\n        chat_id: chatId,\n        notification_settings: newNotificationSettings\n    });\n}\n\nexport async function getChatCounters(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return;\n\n    const promises = [];\n\n    const photoCounter = TdLibController.send({\n        '@type': 'getChatMessageCount',\n        chat_id: chatId,\n        filter: { '@type': 'searchMessagesFilterPhoto' },\n        return_local: false\n    })\n        .then(result => {\n            return result ? result.count : 0;\n        })\n        .catch(() => {\n            return 0;\n        });\n    promises.push(photoCounter);\n\n    const videoCounter = TdLibController.send({\n        '@type': 'getChatMessageCount',\n        chat_id: chatId,\n        filter: { '@type': 'searchMessagesFilterVideo' },\n        return_local: false\n    })\n        .then(result => {\n            return result ? result.count : 0;\n        })\n        .catch(() => {\n            return 0;\n        });\n    promises.push(videoCounter);\n\n    const documentCounter = TdLibController.send({\n        '@type': 'getChatMessageCount',\n        chat_id: chatId,\n        filter: { '@type': 'searchMessagesFilterDocument' },\n        return_local: false\n    })\n        .then(result => {\n            return result ? result.count : 0;\n        })\n        .catch(() => {\n            return 0;\n        });\n    promises.push(documentCounter);\n\n    const audioCounter = TdLibController.send({\n        '@type': 'getChatMessageCount',\n        chat_id: chatId,\n        filter: { '@type': 'searchMessagesFilterAudio' },\n        return_local: false\n    })\n        .then(result => {\n            return result ? result.count : 0;\n        })\n        .catch(() => {\n            return 0;\n        });\n    promises.push(audioCounter);\n\n    const urlCounter = TdLibController.send({\n        '@type': 'getChatMessageCount',\n        chat_id: chatId,\n        filter: { '@type': 'searchMessagesFilterUrl' },\n        return_local: false\n    })\n        .then(result => {\n            return result ? result.count : 0;\n        })\n        .catch(() => {\n            return 0;\n        });\n    promises.push(urlCounter);\n\n    const voiceAndVideoNoteCounter = TdLibController.send({\n        '@type': 'getChatMessageCount',\n        chat_id: chatId,\n        filter: { '@type': 'searchMessagesFilterVoiceNote' },\n        return_local: false\n    })\n        .then(result => {\n            return result ? result.count : 0;\n        })\n        .catch(() => {\n            return 0;\n        });\n    promises.push(voiceAndVideoNoteCounter);\n\n    return await Promise.all(promises);\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport { getUserFullName } from '../../Utils/User';\nimport UserStore from '../../Stores/UserStore';\nimport './UserTitle.css';\n\nclass UserTitle extends React.Component {\n    state = { };\n\n    static getDerivedStateFromProps(props, state) {\n        if (props.userId !== state.prevUserId) {\n            const { userId, t } = props;\n\n            return {\n                prevUserId: userId,\n                fullName: getUserFullName(userId, null, t)\n            };\n        }\n\n        return null;\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        const { userId } = this.props;\n        const { fullName } = this.state;\n\n        if (nextProps.userId !== userId) {\n            return true;\n        }\n\n        if (nextState.fullName !== fullName) {\n            return true;\n        }\n\n        return false;\n    }\n\n    componentDidMount() {\n        UserStore.on('updateUser', this.onUpdateUser);\n    }\n\n    componentWillUnmount() {\n        UserStore.off('updateUser', this.onUpdateUser);\n    }\n\n    onUpdateUser = update => {\n        const { userId, t } = this.props;\n        if (userId !== update.user.id) return;\n\n        this.setState({ fullName: getUserFullName(userId, null, t) });\n    };\n\n    render() {\n        const { fullName } = this.state;\n\n        return (\n            <div className='user-title'>{fullName}</div>\n        );\n    }\n}\n\nUserTitle.propTypes = {\n    userId: PropTypes.number.isRequired\n};\n\nexport default withTranslation()(UserTitle);","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport UserStatus from './UserStatus';\nimport UserTile from './UserTile';\nimport UserTitle from './UserTitle';\nimport UserStore from './../../Stores/UserStore';\nimport './User.css';\n\nclass User extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            user: UserStore.get(props.userId)\n        };\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        return nextProps.userId !== this.props.userId;\n    }\n\n    handleClick = () => {\n        const { userId, onSelect } = this.props;\n        if (!onSelect) return;\n\n        onSelect(userId);\n    };\n\n    render() {\n        const { userId, showStatus } = this.props;\n\n        const user = UserStore.get(userId);\n        const { is_contact, username } = user;\n\n        return (\n            <div className='user' onClick={this.handleClick}>\n                <div className='user-wrapper'>\n                    <UserTile userId={userId} />\n                    <div className='user-inner-wrapper'>\n                        <div className='tile-first-row'>\n                            <UserTitle userId={userId}/>\n                        </div>\n                        {showStatus && (\n                            <div className='tile-second-row'>\n                                {!is_contact && username ? <div className='user-content dialog-content'>{'@' + username}</div> : <UserStatus userId={userId} /> }\n                            </div>\n                        )}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nUser.propTypes = {\n    userId: PropTypes.number.isRequired,\n    onSelect: PropTypes.func,\n    showStatus: PropTypes.bool\n};\n\nUser.defaultProps = {\n    showStatus: true\n};\n\nexport default User;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport Slider from '@material-ui/core/Slider';\nimport VolumeMuteIcon from '@material-ui/icons/VolumeMute';\nimport VolumeDownIcon from '@material-ui/icons/VolumeDown';\nimport VolumeUpIcon from '@material-ui/icons/VolumeUp';\nimport VolumeOffIcon from '@material-ui/icons/VolumeOff';\nimport PictureInPictureIcon from '@material-ui/icons/PictureInPicture';\nimport FullScreen from '../../Assets/Icons/FullScreen';\nimport PlayIcon from '../../Assets/Icons/PlayArrow';\nimport PauseIcon from '../../Assets/Icons/Pause';\nimport Hint from './Hint';\nimport Progress from './Progress';\nimport { clamp, getDurationString } from '../../Utils/Common';\nimport {\n    PLAYER_LOOP_MAX_DURATION,\n    PLAYER_PLAYBACKRATE_MAX,\n    PLAYER_PLAYBACKRATE_MIN,\n    PLAYER_PLAYBACKRATE_STEP,\n    PLAYER_SEEK_STEP_BIG,\n    PLAYER_SEEK_STEP_SMALL,\n    PLAYER_VOLUME_MAX,\n    PLAYER_VOLUME_MIN,\n    PLAYER_VOLUME_STEP\n} from '../../Constants';\nimport FileStore from '../../Stores/FileStore';\nimport PlayerStore from '../../Stores/PlayerStore';\nimport TdLibController from '../../Controllers/TdLibController';\nimport './Player.css';\n\nclass Player extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.rootRef = React.createRef();\n        this.contentRef = React.createRef();\n        this.videoRef = React.createRef();\n\n        const { currentTime, duration } = this.getCurrentTime();\n\n        this.state = {\n            noPoster: currentTime > 0 && duration > 0,\n            duration,\n            currentTime,\n            volume: PlayerStore.volume,\n            play: true,\n            dragging: false,\n            buffered: null,\n            waiting: true,\n            hidden: false\n        };\n    }\n\n    onKeyDown = event => {\n        const { key, code, altKey, ctrlKey, metaKey, shiftKey } = event;\n\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        let handled = false;\n        switch (code) {\n            case 'ArrowLeft': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleSeek(video.currentTime - PLAYER_SEEK_STEP_SMALL);\n                    handled = true;\n                }\n                break;\n            }\n            case 'KeyJ': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleSeek(video.currentTime - PLAYER_SEEK_STEP_BIG);\n                    handled = true;\n                }\n                break;\n            }\n            case 'ArrowRight': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleSeek(video.currentTime + PLAYER_SEEK_STEP_SMALL);\n                    handled = true;\n                }\n                break;\n            }\n            case 'KeyL': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleSeek(video.currentTime + PLAYER_SEEK_STEP_BIG);\n                    handled = true;\n                }\n                break;\n            }\n            case 'ArrowUp': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleVolume(video.volume + PLAYER_VOLUME_STEP);\n                    handled = true;\n                }\n                break;\n            }\n            case 'ArrowDown': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleVolume(video.volume - PLAYER_VOLUME_STEP);\n                    handled = true;\n                }\n                break;\n            }\n            case 'Space':\n            case 'KeyK': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleClick();\n                    handled = true;\n                }\n                break;\n            }\n            case 'KeyM': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleMute();\n                    handled = true;\n                }\n                break;\n            }\n            case 'KeyF': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleFullScreen();\n                    handled = true;\n                }\n                break;\n            }\n            case 'KeyI': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handlePictureInPicture();\n                    handled = true;\n                }\n                break;\n            }\n            case 'Digit0':\n            case 'Digit1':\n            case 'Digit2':\n            case 'Digit3':\n            case 'Digit4':\n            case 'Digit5':\n            case 'Digit6':\n            case 'Digit7':\n            case 'Digit8':\n            case 'Digit9': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    const progress = new Number(key.replace('Digit', '')) / 10.0;\n                    this.handleSeekProgress(progress);\n                    handled = true;\n                }\n                break;\n            }\n            case 'Home': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleSeek(0);\n                    handled = true;\n                }\n                break;\n            }\n            case 'End': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey) {\n                    this.handleSeek(video.duration - 1.0);\n                    handled = true;\n                }\n                break;\n            }\n            case 'Comma': {\n                if (!altKey && !ctrlKey && !metaKey && shiftKey) {\n                    this.handlePlaybackRate(video.playbackRate - PLAYER_PLAYBACKRATE_STEP);\n                    handled = true;\n                }\n                break;\n            }\n            case 'Period': {\n                if (!altKey && !ctrlKey && !metaKey && shiftKey) {\n                    this.handlePlaybackRate(video.playbackRate + PLAYER_PLAYBACKRATE_STEP);\n                    handled = true;\n                }\n                break;\n            }\n        }\n\n        if (handled) {\n            event.stopPropagation();\n            event.preventDefault();\n        }\n    };\n\n    handleVolume = volume => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        volume = clamp(volume, PLAYER_VOLUME_MIN, PLAYER_VOLUME_MAX);\n\n        video.volume = volume;\n        this.showMediaHint(`${Math.round(video.volume * 100)}%`);\n    };\n\n    handlePlaybackRate = rate => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        rate = clamp(rate, PLAYER_PLAYBACKRATE_MIN, PLAYER_PLAYBACKRATE_MAX)\n\n        video.playbackRate = rate;\n        this.showMediaHint(`${rate}x`);\n    };\n\n    handleSeekProgress = progress => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        this.handleSeek(progress * video.duration);\n    };\n\n    handleSeek = currentTime => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        currentTime = clamp(currentTime, 0, video.duration || 0);\n\n        video.currentTime = currentTime;\n        this.setState({ currentTime });\n    };\n\n    componentDidMount() {\n        PlayerStore.on('clientUpdateMediaShortcut', this.onClientUpdateMediaShortcut);\n\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        const { volume } = this.state;\n\n        video.volume = volume;\n    }\n\n    componentWillUnmount() {\n        PlayerStore.off('clientUpdateMediaShortcut', this.onClientUpdateMediaShortcut);\n    }\n\n    onClientUpdateMediaShortcut = update => {\n        const { event } = update;\n        if (!event) return;\n\n        this.onKeyDown(event);\n    };\n\n    load() {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        video.load();\n\n        this.setState({\n            duration: 0,\n            currentTime: 0,\n            play: true,\n            dragging: false,\n            buffered: null,\n            waiting: true\n        });\n    }\n\n    handleClick = () => {\n        this.startStopPlayer();\n    };\n\n    startStopPlayer = () => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        const { waiting } = this.state;\n        if (waiting) {\n            this.setState({\n                play: !this.state.play,\n                hidden: false\n            });\n        } else {\n            if (video.paused) {\n                video.play()\n            } else {\n                video.pause();\n            }\n        }\n    };\n\n    handlePlay = event => {\n        const { onPlay } = this.props;\n\n        this.setState({\n            play: true,\n            hidden: true\n        });\n\n        TdLibController.clientUpdate({ '@type': 'clientUpdateMediaViewerPlay' });\n        onPlay && onPlay(event);\n    };\n\n    handlePause = event => {\n        const { onPause } = this.props;\n\n        this.setState({\n            play: false,\n            hidden: false\n        });\n\n        TdLibController.clientUpdate({ '@type': 'clientUpdateMediaViewerPause' });\n        onPause && onPause(event);\n    };\n\n    handleEnded = event => {\n        const { onEnded } = this.props;\n\n        TdLibController.clientUpdate({ '@type': 'clientUpdateMediaViewerEnded' });\n        onEnded && onEnded(event);\n\n        const video = this.videoRef.current;\n        this.setCurrentTime({ currentTime: 0, duration: video.duration });\n    };\n\n    handleTimeUpdate = () => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        const { fileId } = this.props;\n        const { currentTime, duration, volume, buffered } = video;\n\n        this.setState({\n            duration,\n            currentTime,\n            volume,\n            buffered\n        });\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMediaViewerTimeUpdate',\n            fileId,\n            currentTime,\n            duration,\n            volume,\n            buffered\n        });\n\n        this.setCurrentTime({ currentTime, duration });\n    };\n\n    handleLoadedData = () => {\n        const video = this.videoRef.current;\n        if (!video) return;\n    };\n\n    handleLoadedMetadata = () => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        const { currentTime } = this.state;\n        const { duration, volume, buffered } = video;\n\n        this.setState({\n            duration,\n            volume,\n            waiting: true,\n            buffered\n        }, () => {\n            if (!currentTime) return;\n\n            video.currentTime = currentTime;\n        });\n    };\n\n    handleMouseDown = event => {\n        event.stopPropagation();\n\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        this.setState({\n            dragging: true,\n            draggingTime: video.currentTime\n        });\n    };\n\n    handleChange = (event, value) => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        this.setState({\n            draggingTime: value * video.duration\n        });\n    };\n\n    handleChangeCommitted = () => {\n        const { dragging, draggingTime } = this.state;\n        if (!dragging) return;\n\n        this.setState({\n            dragging: false,\n            currentTime: draggingTime,\n            draggingTime: 0\n        }, () => {\n            const video = this.videoRef.current;\n            if (!video) return;\n\n            if (Number.isFinite(draggingTime)) {\n                video.currentTime = draggingTime;\n            }\n        });\n    };\n\n    handleFullScreen = event => {\n        event && event.stopPropagation();\n\n        const root = this.contentRef.current;\n        if (!root) return;\n\n        const fullscreenElement = document.fullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement;\n        if (fullscreenElement) {\n            this.exitFullscreen();\n            return;\n        }\n\n        this.requestFullscreen(root);\n    };\n\n    requestFullscreen(element) {\n        const method = element.requestFullscreen || element.mozRequestFullScreen || element.webkitRequestFullscreen;\n\n        method && method.call(element);\n    }\n\n    exitFullscreen() {\n        const method = document.exitFullscreen || document.mozCancelFullScreen || document.webkitExitFullscreen;\n\n        method && method.call(document);\n    }\n\n    handleClickRoot = event => {\n        event.stopPropagation();\n\n        const { mouseDownRoot } = this;\n        if (!mouseDownRoot) return;\n\n        this.mouseDownRoot = false;\n        this.startStopPlayer();\n    }\n\n    handleMouseDownRoot = event => {\n        this.mouseDownRoot = true;\n        event.stopPropagation();\n    }\n\n    static getVolumeIcon = value => {\n        if (value === 0) {\n            return <VolumeOffIcon fontSize='small' />;\n        }\n\n        if (value < 0.25) {\n            return <VolumeMuteIcon fontSize='small' />;\n        }\n\n        if (value < 0.5) {\n            return <VolumeDownIcon fontSize='small' />;\n        }\n\n        return <VolumeUpIcon fontSize='small' />;\n    };\n\n    handleVolumeChange = event => {\n        const { onVolumeChange } = this.props;\n\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        const { volume } = video;\n\n        this.setState({\n            volume\n        });\n\n        TdLibController.clientUpdate({ '@type' : 'clientUpdateMediaVolume', volume });\n        onVolumeChange && onVolumeChange(event);\n    };\n\n    handleVolumeSliderChange = (event, volume) => {\n        if (volume === this.state.volume) return;\n\n        this.setState({\n            volume\n        }, () => {\n            const video = this.videoRef.current;\n            if (!video) return;\n\n            video.volume = volume;\n        });\n    };\n\n    handleVolumeSliderChangeCommitted = event => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        document.activeElement.blur();\n    };\n\n    showMediaHint(text) {\n        const { fileId } = this.props;\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMediaHint',\n            fileId,\n            text\n        });\n    }\n\n    handleMute = () => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        if (video.volume === 0) {\n            video.volume = this.prevVolume || 0.5;\n        } else {\n            this.prevVolume = video.volume;\n            video.volume = 0;\n        }\n    }\n\n    handleProgress = () => {\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        const { fileId } = this.props;\n\n        const { buffered } = video;\n\n        this.setState({\n            buffered\n        });\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMediaViewerProgress',\n            fileId,\n            buffered\n        });\n    };\n\n    static getBufferedTime = (time, buffered) => {\n        if (!buffered || !buffered.length) {\n            return 0;\n        }\n\n        for (let i = 0; i < buffered.length; i++) {\n            const start = buffered.start(i);\n            const end = buffered.end(i);\n            if (start <= time && time < end) {\n                return end;\n            }\n        }\n\n        return 0;\n    }\n\n    handleWaiting = () => {\n        this.setState({ waiting: true });\n    };\n\n    handleCanPlay = event => {\n        const { target: video } = event;\n\n        this.setState({\n            waiting: false\n        }, () => {\n            if (!video) return;\n\n            const { play } = this.state;\n            if (play) {\n                video.play();\n            } else {\n                video.pause();\n            }\n        });\n    };\n\n    handlePictureInPicture = async () => {\n        const { fileId } = this.props;\n        const { duration, currentTime, volume, play, buffered, waiting } = this.state;\n\n        const video = this.videoRef.current;\n        if (!video) return;\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdatePictureInPicture',\n            videoInfo: {\n                fileId,\n                video,\n                duration,\n                currentTime,\n                volume,\n                play,\n                buffered,\n                waiting\n            }\n        });\n\n        return;\n\n        if (!video.duration) return;\n\n        const pictureInPictureElement = document.pictureInPictureElement || document.mozPictureInPictureElement || document.webkitPictureInPictureElement;\n        if (pictureInPictureElement) {\n            this.exitPictureInPicture();\n            return;\n        }\n\n        try {\n            const pipWindow = await this.requestPictureInPicture(video);\n            TdLibController.clientUpdate({\n                '@type': 'clientUpdateMediaViewerContent',\n                content: null\n            });\n            video.onpause = event => {\n                event.target.play();\n                event.target.onpause = null;\n            };\n            video.addEventListener('leavepictureinpicture', this.handleLeavePictureInPicture);\n        } catch (error) { }\n    };\n\n    handleLeavePictureInPicture = event => {\n        const video = this.videoRef.current;\n\n        if (!video) event.target.src = null;\n        event.target.removeEventListener('leavepictureinpicture', this.handleLeavePictureInPicture);\n    };\n\n    async requestPictureInPicture(element) {\n        const method = element.requestPictureInPicture || element.mozRequestPictureInPicture || element.webkitRequestPictureInPicture;\n        if (!method) return null;\n\n        return method.call(element);\n    }\n\n    exitPictureInPicture() {\n        const method = document.exitPictureInPicture || document.mozExitPictureInPicture || document.webkitExitPictureInPicture;\n\n        method && method.call(document);\n    }\n\n    handleDoubleClick = event => {\n        this.handleFullScreen(event);\n    };\n\n    handleVideoKeyDown = event => {\n        event.preventDefault();\n    };\n\n    handlePanelDoubleClick = event => {\n        event.preventDefault();\n        event.stopPropagation();\n    };\n\n    handlePanelEnter = () => {\n        this.panelEnter = true;\n    };\n\n    handlePanelLeave = () => {\n        this.panelEnter = false;\n    };\n\n    handleMouseOver = event => {\n        const { hidden } = this.state;\n\n        if (hidden) {\n            this.setState({\n                hidden: false\n            });\n        }\n\n        clearTimeout(this.mouseOverTimeout);\n        this.mouseOverTimeout = setTimeout(() => {\n            if (this.panelEnter) return;\n            if (!this.state.play) return;\n\n            this.setState({\n                hidden: true\n            });\n        }, 1000);\n    };\n\n    getCurrentTime = () => {\n        const { fileId } = this.props;\n\n        const file = FileStore.get(fileId);\n        if (!file) return { currentTime: 0, duration: 0 };\n\n        const { remote } = file;\n        if (!remote) return { currentTime: 0, duration: 0 };\n\n        const { unique_id } = remote;\n        if (!unique_id) return { currentTime: 0, duration: 0 };\n\n        return PlayerStore.getCurrentTime(unique_id);\n    };\n\n    setCurrentTime = currentTime => {\n        const { fileId } = this.props;\n\n        const file = FileStore.get(fileId);\n        if (!file) return;\n\n        const { remote } = file;\n        if (!remote) return;\n\n        const { unique_id } = remote;\n        if (!unique_id) return;\n\n        if (!currentTime) {\n            PlayerStore.clearCurrentTime(unique_id);\n        } else {\n            PlayerStore.setCurrentTime(unique_id, currentTime);\n        }\n    };\n\n    render() {\n        const { children, src, className, style, width, height, poster, fileId } = this.props;\n        const { waiting, volume, duration, currentTime, play, dragging, draggingTime, buffered, hidden, noPoster } = this.state;\n\n        const time = dragging ? draggingTime : currentTime;\n        const value = duration > 0 ? time / duration : 0;\n        const bufferedTime = Player.getBufferedTime(time, buffered);\n        const bufferedValue = duration > 0 ? bufferedTime / duration : 0;\n\n        const timeString = getDurationString(Math.floor(time) || 0);\n        const durationString = getDurationString(Math.floor(duration) || 0);\n        const rootStyle = {\n            ...style,\n            width,\n            height\n        }\n\n        const fullscreenEnabled = document.fullscreenEnabled || document.mozFullScreenEnabled || document.webkitFullscreenEnabled;\n        const pictureInPictureEnabled = true;//document.pictureInPictureEnabled || document.mozPictureInPictureEnabled || document.webkitPictureInPictureEnabled;\n\n        return (\n            <div\n                ref={this.rootRef}\n                className={classNames('player', className)}\n                onMouseDown={this.handleMouseDownRoot}\n                onClick={this.handleClickRoot}\n                onDoubleClick={this.handleDoubleClick}\n                style={rootStyle}>\n                <div ref={this.contentRef} className={classNames('player-content', { 'player-content-hidden': hidden })} onMouseMove={this.handleMouseOver}>\n                    <video\n                        className='player-video'\n                        ref={this.videoRef}\n                        autoPlay={false}\n                        controls={false}\n                        playsInline={true}\n                        src={src}\n                        poster={noPoster ? null : poster}\n                        loop={duration <= PLAYER_LOOP_MAX_DURATION}\n                        onLoadedMetadata={this.handleLoadedMetadata}\n                        onLoadedData={this.handleLoadedData}\n                        onCanPlay={this.handleCanPlay}\n                        onPlay={this.handlePlay}\n                        onPause={this.handlePause}\n                        onEnded={this.handleEnded}\n                        onTimeUpdate={this.handleTimeUpdate}\n                        onVolumeChange={this.handleVolumeChange}\n                        onProgress={this.handleProgress}\n                        onWaiting={this.handleWaiting}\n                        onKeyDown={this.handleVideoKeyDown}\n                    >\n                        {children}\n                    </video>\n                    <Hint fileId={fileId}/>\n                    <div\n                        className={classNames('player-panel', { 'player-panel-hidden': hidden })}\n                        onClick={e => e.stopPropagation()}\n                        onMouseDown={e => e.stopPropagation()}\n                        onDoubleClick={this.handlePanelDoubleClick}\n                        onMouseEnter={this.handlePanelEnter}\n                        onMouseLeave={this.handlePanelLeave}>\n                        <div className='player-slider'>\n                            <span className='player-slider-buffer-track' style={{ width: bufferedValue * 100 + '%'}}/>\n                            <Slider\n                                value={value}\n                                min={0}\n                                max={1}\n                                step={0.001}\n                                classes={{\n                                    root: 'player-slider-root',\n                                    rail: 'player-slider-rail',\n                                    track: 'player-slider-track',\n                                    thumb: 'player-slider-thumb',\n                                    active: 'player-slider-active'\n                                }}\n                                onChange={this.handleChange}\n                                onChangeCommitted={this.handleChangeCommitted}\n                                onMouseDown={this.handleMouseDown}\n                            />\n                        </div>\n                        <div className='player-controls'>\n                            <button className='player-button' onClick={this.handleClick}>\n                                {play ? <PauseIcon/> : <PlayIcon/>}\n                            </button>\n                            <div className='player-time'>\n                                {`${timeString} / ${durationString}`}\n                            </div>\n                            <div className='player-volume'>\n                                <Slider\n                                    value={volume}\n                                    min={0}\n                                    max={1}\n                                    step={0.001}\n                                    classes={{\n                                        root: 'player-volume-root',\n                                        rail: 'player-volume-rail',\n                                        track: 'player-volume-track',\n                                        thumb: 'player-volume-thumb',\n                                        active: 'player-volume-active'\n                                    }}\n                                    onChange={this.handleVolumeSliderChange}\n                                    onChangeCommitted={this.handleVolumeSliderChangeCommitted}\n                                />\n                            </div>\n                            <button className='player-button' onClick={this.handleMute}>\n                                {Player.getVolumeIcon(volume)}\n                            </button>\n                            <button className='player-button' disabled={!pictureInPictureEnabled} onClick={this.handlePictureInPicture}>\n                                <PictureInPictureIcon/>\n                            </button>\n                            <button className='player-button' disabled={!fullscreenEnabled} onClick={this.handleFullScreen}>\n                                <FullScreen/>\n                            </button>\n                        </div>\n                    </div>\n                    <Progress waiting={waiting}/>\n                </div>\n            </div>\n        );\n    }\n}\n\nPlayer.propTypes = {\n    fileId: PropTypes.number\n};\n\n//export default React.forwardRef((props, ref) => (<Player forwardedRef={ref} {...props}/>));\n\nexport default Player;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { POLL_OPTION_LENGTH, POLL_QUESTION_LENGTH } from '../Constants';\n\nexport function isValidPoll(poll) {\n    if (!poll) return false;\n\n    const { question, options } = poll;\n    if (!isValidQuestion(question)) return false;\n\n    const noneEmptyOptions = options.filter(x => Boolean(x.text));\n    if (noneEmptyOptions.length <= 1) return false;\n\n    return noneEmptyOptions.every(isValidOption);\n}\n\nfunction isValidQuestion(question) {\n    if (!question) return false;\n\n    return question.length <= POLL_QUESTION_LENGTH;\n}\n\nfunction isValidOption(option) {\n    if (!option) return false;\n    if (!option.text) return false;\n\n    return option.text.length <= POLL_OPTION_LENGTH;\n}\n\nexport function hasPollData(poll) {\n    if (!poll) return false;\n\n    const { question, options } = poll;\n    if (question) return true;\n\n    return options.some(x => Boolean(x.text));\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport { I18nextProvider } from 'react-i18next';\nimport { getDisplayName } from './Utils/HOC';\nimport LocalizationStore from './Stores/LocalizationStore';\n\nfunction withLanguage(WrappedComponent) {\n    class LanguageWrapper extends React.Component {\n        render() {\n            const i18n = LocalizationStore.i18n;\n\n            return (\n                <I18nextProvider i18n={i18n}>\n                    <WrappedComponent {...this.props} />\n                </I18nextProvider>\n            );\n        }\n    }\n    LanguageWrapper.displayName = `WithLanguage(${getDisplayName(WrappedComponent)})`;\n\n    return LanguageWrapper;\n}\n\nexport default withLanguage;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport SupergroupStore from '../Stores/SupergroupStore';\nimport ChatStore from '../Stores/ChatStore';\nimport { getSupergroupId } from './Chat';\n\nexport function getSupergroupStatus(supergroup, chatId) {\n    if (!supergroup) return null;\n\n    let { status, is_channel, member_count: count } = supergroup;\n\n    if (status && status['@type'] === 'chatMemberStatusBanned') {\n        return is_channel ? 'channel is inaccessible' : 'group is inaccessible';\n    }\n\n    if (!count) {\n        const fullInfo = SupergroupStore.getFullInfo(supergroup.id);\n        if (fullInfo) {\n            count = fullInfo.member_count;\n        }\n    }\n\n    if (!count) return '0 members';\n    if (count === 1) return '1 member';\n\n    const onlineCount = ChatStore.getOnlineMemberCount(chatId);\n    if (onlineCount > 1) {\n        return `${count} members, ${onlineCount} online`;\n    }\n\n    return `${count} members`;\n}\n\nexport function isPublicSupergroup(chatId) {\n    const chat = ChatStore.get(chatId);\n    if (!chat) return false;\n\n    const supergroupId = getSupergroupId(chatId);\n    if (!supergroupId) return false;\n\n    const supergroup = SupergroupStore.get(supergroupId);\n    if (!supergroup) return false;\n\n    const { username } = supergroup;\n\n    return Boolean(username);\n}\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport createSvgIcon from '@material-ui/core/esm/utils/createSvgIcon';\n\nexport default createSvgIcon(\n    <path d='M4.70710678,12.2928932 C4.31658249,11.9023689 3.68341751,11.9023689 3.29289322,12.2928932 C2.90236893,12.6834175 2.90236893,13.3165825 3.29289322,13.7071068 L8.29289322,18.7071068 C8.68341751,19.0976311 9.31658249,19.0976311 9.70710678,18.7071068 L20.7071068,7.70710678 C21.0976311,7.31658249 21.0976311,6.68341751 20.7071068,6.29289322 C20.3165825,5.90236893 19.6834175,5.90236893 19.2928932,6.29289322 L9,16.5857864 L4.70710678,12.2928932 Z' />,\n    'Check'\n);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport createSvgIcon from '@material-ui/core/esm/utils/createSvgIcon';\n\nexport default createSvgIcon(\n    <g transform='translate(3.000000, 0.600000)'>\n        <path\n            d='M9,0 C13.9705627,-9.13077564e-16 18,4.02943725 18,9 L18,23 L18,23 L15,20 L12,23 L9,20 L6,23 L3,20 L0,23 L0,9 C-6.08718376e-16,4.02943725 4.02943725,9.13077564e-16 9,0 Z'\n            stroke='currentColor'\n            strokeWidth='1.5'\n            strokeLinejoin='round'\n            fill='none'\n        />\n        <circle cx='5' cy='9' r='2' />\n        <circle cx='13' cy='9' r='2' />\n    </g>,\n    'DeletedAccount'\n);\n","//https://stackoverflow.com/questions/183485/converting-punycode-with-dash-character-to-unicode\n//Javascript Punycode converter derived from example in RFC3492.\n//This implementation is created by some@domain.name and released into public domain\nfunction Punycode() {\n    // This object converts to and from puny-code used in IDN\n    //\n    // punycode.ToASCII ( domain )\n    //\n    // Returns a puny coded representation of \"domain\".\n    // It only converts the part of the domain name that\n    // has non ASCII characters. I.e. it dosent matter if\n    // you call it with a domain that already is in ASCII.\n    //\n    // punycode.ToUnicode (domain)\n    //\n    // Converts a puny-coded domain name to unicode.\n    // It only converts the puny-coded parts of the domain name.\n    // I.e. it dosent matter if you call it on a string\n    // that already has been converted to unicode.\n    //\n    //\n    this.utf16 = {\n        // The utf16-class is necessary to convert from javascripts internal character representation to unicode and back.\n        decode: function(input) {\n            var output = [],\n                i = 0,\n                len = input.length,\n                value,\n                extra;\n            while (i < len) {\n                value = input.charCodeAt(i++);\n                if ((value & 0xf800) === 0xd800) {\n                    extra = input.charCodeAt(i++);\n                    if ((value & 0xfc00) !== 0xd800 || (extra & 0xfc00) !== 0xdc00) {\n                        throw new RangeError('UTF-16(decode): Illegal UTF-16 sequence');\n                    }\n                    value = ((value & 0x3ff) << 10) + (extra & 0x3ff) + 0x10000;\n                }\n                output.push(value);\n            }\n            return output;\n        },\n        encode: function(input) {\n            var output = [],\n                i = 0,\n                len = input.length,\n                value;\n            while (i < len) {\n                value = input[i++];\n                if ((value & 0xf800) === 0xd800) {\n                    throw new RangeError('UTF-16(encode): Illegal UTF-16 value');\n                }\n                if (value > 0xffff) {\n                    value -= 0x10000;\n                    output.push(String.fromCharCode(((value >>> 10) & 0x3ff) | 0xd800));\n                    value = 0xdc00 | (value & 0x3ff);\n                }\n                output.push(String.fromCharCode(value));\n            }\n            return output.join('');\n        }\n    };\n\n    //Default parameters\n    var initial_n = 0x80;\n    var initial_bias = 72;\n    var delimiter = '\\x2D';\n    var base = 36;\n    var damp = 700;\n    var tmin = 1;\n    var tmax = 26;\n    var skew = 38;\n    var maxint = 0x7fffffff;\n\n    // decode_digit(cp) returns the numeric value of a basic code\n    // point (for use in representing integers) in the range 0 to\n    // base-1, or base if cp is does not represent a value.\n\n    function decode_digit(cp) {\n        return cp - 48 < 10 ? cp - 22 : cp - 65 < 26 ? cp - 65 : cp - 97 < 26 ? cp - 97 : base;\n    }\n\n    // encode_digit(d,flag) returns the basic code point whose value\n    // (when used for representing integers) is d, which needs to be in\n    // the range 0 to base-1. The lowercase form is used unless flag is\n    // nonzero, in which case the uppercase form is used. The behavior\n    // is undefined if flag is nonzero and digit d has no uppercase form.\n\n    function encode_digit(d, flag) {\n        return d + 22 + 75 * (d < 26) - ((flag != 0) << 5);\n        //  0..25 map to ASCII a..z or A..Z\n        // 26..35 map to ASCII 0..9\n    }\n    //** Bias adaptation function **\n    function adapt(delta, numpoints, firsttime) {\n        var k;\n        delta = firsttime ? Math.floor(delta / damp) : delta >> 1;\n        delta += Math.floor(delta / numpoints);\n\n        for (k = 0; delta > ((base - tmin) * tmax) >> 1; k += base) {\n            delta = Math.floor(delta / (base - tmin));\n        }\n        return Math.floor(k + ((base - tmin + 1) * delta) / (delta + skew));\n    }\n\n    // encode_basic(bcp,flag) forces a basic code point to lowercase if flag is zero,\n    // uppercase if flag is nonzero, and returns the resulting code point.\n    // The code point is unchanged if it is caseless.\n    // The behavior is undefined if bcp is not a basic code point.\n\n    function encode_basic(bcp, flag) {\n        bcp -= (bcp - 97 < 26) << 5;\n        return bcp + ((!flag && bcp - 65 < 26) << 5);\n    }\n\n    // Main decode\n    this.decode = function(input, preserveCase) {\n        // Dont use utf16\n        var output = [];\n        var case_flags = [];\n        var input_length = input.length;\n\n        var n, out, i, bias, basic, j, ic, oldi, w, k, digit, t, len;\n\n        // Initialize the state:\n\n        n = initial_n;\n        i = 0;\n        bias = initial_bias;\n\n        // Handle the basic code points: Let basic be the number of input code\n        // points before the last delimiter, or 0 if there is none, then\n        // copy the first basic code points to the output.\n\n        basic = input.lastIndexOf(delimiter);\n        if (basic < 0) basic = 0;\n\n        for (j = 0; j < basic; ++j) {\n            if (preserveCase) case_flags[output.length] = input.charCodeAt(j) - 65 < 26;\n            if (input.charCodeAt(j) >= 0x80) {\n                throw new RangeError('Illegal input >= 0x80');\n            }\n            output.push(input.charCodeAt(j));\n        }\n\n        // Main decoding loop: Start just after the last delimiter if any\n        // basic code points were copied; start at the beginning otherwise.\n\n        for (ic = basic > 0 ? basic + 1 : 0; ic < input_length; ) {\n            // ic is the index of the next character to be consumed,\n\n            // Decode a generalized variable-length integer into delta,\n            // which gets added to i. The overflow checking is easier\n            // if we increase i as we go, then subtract off its starting\n            // value at the end to obtain delta.\n            for (oldi = i, w = 1, k = base; ; k += base) {\n                if (ic >= input_length) {\n                    throw RangeError('punycode_bad_input(1)');\n                }\n                digit = decode_digit(input.charCodeAt(ic++));\n\n                if (digit >= base) {\n                    throw RangeError('punycode_bad_input(2)');\n                }\n                if (digit > Math.floor((maxint - i) / w)) {\n                    throw RangeError('punycode_overflow(1)');\n                }\n                i += digit * w;\n                t = k <= bias ? tmin : k >= bias + tmax ? tmax : k - bias;\n                if (digit < t) {\n                    break;\n                }\n                if (w > Math.floor(maxint / (base - t))) {\n                    throw RangeError('punycode_overflow(2)');\n                }\n                w *= base - t;\n            }\n\n            out = output.length + 1;\n            bias = adapt(i - oldi, out, oldi === 0);\n\n            // i was supposed to wrap around from out to 0,\n            // incrementing n each time, so we'll fix that now:\n            if (Math.floor(i / out) > maxint - n) {\n                throw RangeError('punycode_overflow(3)');\n            }\n            n += Math.floor(i / out);\n            i %= out;\n\n            // Insert n at position i of the output:\n            // Case of last character determines uppercase flag:\n            if (preserveCase) {\n                case_flags.splice(i, 0, input.charCodeAt(ic - 1) - 65 < 26);\n            }\n\n            output.splice(i, 0, n);\n            i++;\n        }\n        if (preserveCase) {\n            for (i = 0, len = output.length; i < len; i++) {\n                if (case_flags[i]) {\n                    output[i] = String.fromCharCode(output[i])\n                        .toUpperCase()\n                        .charCodeAt(0);\n                }\n            }\n        }\n        return this.utf16.encode(output);\n    };\n\n    //** Main encode function **\n\n    this.encode = function(input, preserveCase) {\n        //** Bias adaptation function **\n\n        var n, delta, h, b, bias, j, m, q, k, t, ijv, case_flags;\n\n        if (preserveCase) {\n            // Preserve case, step1 of 2: Get a list of the unaltered string\n            case_flags = this.utf16.decode(input);\n        }\n        // Converts the input in UTF-16 to Unicode\n        input = this.utf16.decode(input.toLowerCase());\n\n        var input_length = input.length; // Cache the length\n\n        if (preserveCase) {\n            // Preserve case, step2 of 2: Modify the list to true/false\n            for (j = 0; j < input_length; j++) {\n                case_flags[j] = input[j] != case_flags[j];\n            }\n        }\n\n        var output = [];\n\n        // Initialize the state:\n        n = initial_n;\n        delta = 0;\n        bias = initial_bias;\n\n        // Handle the basic code points:\n        for (j = 0; j < input_length; ++j) {\n            if (input[j] < 0x80) {\n                output.push(String.fromCharCode(case_flags ? encode_basic(input[j], case_flags[j]) : input[j]));\n            }\n        }\n\n        h = b = output.length;\n\n        // h is the number of code points that have been handled, b is the\n        // number of basic code points\n\n        if (b > 0) output.push(delimiter);\n\n        // Main encoding loop:\n        //\n        while (h < input_length) {\n            // All non-basic code points < n have been\n            // handled already. Find the next larger one:\n\n            for (m = maxint, j = 0; j < input_length; ++j) {\n                ijv = input[j];\n                if (ijv >= n && ijv < m) m = ijv;\n            }\n\n            // Increase delta enough to advance the decoder's\n            // <n,i> state to <m,0>, but guard against overflow:\n\n            if (m - n > Math.floor((maxint - delta) / (h + 1))) {\n                throw RangeError('punycode_overflow (1)');\n            }\n            delta += (m - n) * (h + 1);\n            n = m;\n\n            for (j = 0; j < input_length; ++j) {\n                ijv = input[j];\n\n                if (ijv < n) {\n                    if (++delta > maxint) return Error('punycode_overflow(2)');\n                }\n\n                if (ijv == n) {\n                    // Represent delta as a generalized variable-length integer:\n                    for (q = delta, k = base; ; k += base) {\n                        t = k <= bias ? tmin : k >= bias + tmax ? tmax : k - bias;\n                        if (q < t) break;\n                        output.push(String.fromCharCode(encode_digit(t + ((q - t) % (base - t)), 0)));\n                        q = Math.floor((q - t) / (base - t));\n                    }\n                    output.push(String.fromCharCode(encode_digit(q, preserveCase && case_flags[j] ? 1 : 0)));\n                    bias = adapt(delta, h + 1, h == b);\n                    delta = 0;\n                    ++h;\n                }\n            }\n\n            ++delta;\n            ++n;\n        }\n        return output.join('');\n    };\n\n    this.ToASCII = function(domain) {\n        var domain_array = domain.split('.');\n        var out = [];\n        for (var i = 0; i < domain_array.length; ++i) {\n            var s = domain_array[i];\n            out.push(s.match(/[^A-Za-z0-9-]/) ? 'xn--' + punycode.encode(s) : s);\n        }\n        return out.join('.');\n    };\n    this.ToUnicode = function(domain) {\n        var domain_array = domain.split('.');\n        var out = [];\n        for (var i = 0; i < domain_array.length; ++i) {\n            var s = domain_array[i];\n            out.push(s.match(/^xn--/) ? punycode.decode(s.slice(4)) : s);\n        }\n        return out.join('.');\n    };\n}\n\nconst punycode = new Punycode();\nexport default punycode;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport DownloadIcon from '../../Assets/Icons/Download';\nimport PlayArrowIcon from '../../Assets/Icons/PlayArrow';\nimport PauseIcon from '../../Assets/Icons/Pause';\nimport DocumentTile from './DocumentTile';\nimport PlayerStore from '../../Stores/PlayerStore';\nimport './VoiceNoteTile.css';\nimport { isCurrentSource } from '../../Utils/Player';\n\nclass VoiceNoteTile extends React.Component {\n    constructor(props) {\n        super(props);\n\n        const { chatId, messageId } = props;\n\n        const { time, message, playing } = PlayerStore;\n        const active = message && message.chat_id === chatId && message.id === messageId;\n\n        this.state = {\n            active: active,\n            playing: active ? playing : false,\n            currentTime: active && time ? time.currentTime : 0,\n            duration: active && time ? time.duration : 0\n        };\n    }\n\n    componentDidMount() {\n        PlayerStore.on('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.on('clientUpdateMediaPlay', this.onClientUpdateMediaPlay);\n        PlayerStore.on('clientUpdateMediaPause', this.onClientUpdateMediaPause);\n        PlayerStore.on('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n    }\n\n    componentWillUnmount() {\n        PlayerStore.off('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.off('clientUpdateMediaPlay', this.onClientUpdateMediaPlay);\n        PlayerStore.off('clientUpdateMediaPause', this.onClientUpdateMediaPause);\n        PlayerStore.off('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n    }\n\n    onClientUpdateMediaEnd = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        this.setState({\n            active: false,\n            playing: false,\n            currentTime: 0\n        });\n    };\n\n    onClientUpdateMediaPlay = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        this.setState({ playing: isCurrentSource(chatId, messageId, block, source) });\n    };\n\n    onClientUpdateMediaPause = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        this.setState({ playing: false });\n    };\n\n    onClientUpdateMediaActive = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        if (isCurrentSource(chatId, messageId, block, source)) {\n            if (!this.state.active) {\n                this.setState({\n                    active: true,\n                    currentTime: 0,\n                    playing: true\n                });\n            }\n        } else if (this.state.active) {\n            this.setState({\n                active: false,\n                currentTime: 0,\n                playing: false\n            });\n        }\n    };\n\n    render() {\n        const { file, openMedia } = this.props;\n        const { playing } = this.state;\n\n        return (\n            <DocumentTile\n                thumbnail={null}\n                file={file}\n                openMedia={openMedia}\n                icon={<DownloadIcon />}\n                completeIcon={playing ? <PauseIcon /> : <PlayArrowIcon />}\n            />\n        );\n    }\n}\n\nVoiceNoteTile.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    block: PropTypes.object,\n\n    file: PropTypes.object.isRequired,\n    openMedia: PropTypes.func\n};\n\nexport default VoiceNoteTile;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport createSvgIcon from '@material-ui/core/esm/utils/createSvgIcon';\n\nexport default createSvgIcon(\n    <path\n        d='M5,14 C5.55228475,14 6,14.4477153 6,15 L6,18 L9,18 C9.55228475,18 10,18.4477153 10,19 C10,19.5522847 9.55228475,20 9,20 L5,20 C4.44771525,20 4,19.5522847 4,19 L4,15 C4,14.4477153 4.44771525,14 5,14 Z M19,14 C19.5522847,14 20,14.4477153 20,15 L20,15 L20,19 C20,19.5522847 19.5522847,20 19,20 L19,20 L15,20 C14.4477153,20 14,19.5522847 14,19 C14,18.4477153 14.4477153,18 15,18 L15,18 L18,18 L18,15 C18,14.4477153 18.4477153,14 19,14 Z M9,4 C9.55228475,4 10,4.44771525 10,5 C10,5.55228475 9.55228475,6 9,6 L9,6 L6,6 L6,9 C6,9.55228475 5.55228475,10 5,10 C4.44771525,10 4,9.55228475 4,9 L4,9 L4,5 C4,4.44771525 4.44771525,4 5,4 L5,4 Z M19,4 C19.5522847,4 20,4.44771525 20,5 L20,9 C20,9.55228475 19.5522847,10 19,10 C18.4477153,10 18,9.55228475 18,9 L18,6 L15,6 C14.4477153,6 14,5.55228475 14,5 C14,4.44771525 14.4477153,4 15,4 L19,4 Z'\n    />,\n    'FullScreen'\n);","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport PlayerStore from '../../Stores/PlayerStore';\nimport './Hint.css';\n\nclass Hint extends React.Component {\n    state = { text: null };\n\n    componentDidMount() {\n        PlayerStore.on('clientUpdateMediaHint', this.onClientUpdateMediaHint);\n    }\n\n    componentWillUnmount() {\n        PlayerStore.off('clientUpdateMediaHint', this.onClientUpdateMediaHint);\n    }\n\n    onClientUpdateMediaHint = update => {\n        const { fileId, text } = update;\n        if (fileId !== this.props.fileId) return;\n\n        const { animated } = this.state;\n\n        clearTimeout(this.checkTimeout);\n        this.setState({\n            text,\n            animated: false\n        }, () => {\n            this.checkTimeout = setTimeout(() => {\n                if (this.state.text !== text) return;\n\n                this.setState({\n                    animated: true\n                })\n            }, 250);\n        });\n    };\n\n    handleAnimationEnd = event => {\n        this.setState({\n            text: null,\n            animated: false\n        })\n    }\n\n    render() {\n        const { animated, text } = this.state;\n        if (!text) return null;\n\n        return (\n            <div className={classNames('player-hint', { 'player-hint-animated': animated })} onAnimationEnd={this.handleAnimationEnd}>\n                <span>{text}</span>\n            </div>\n        );\n    }\n}\n\nHint.propTypes = {\n    fileId: PropTypes.number\n};\n\nexport default Hint;","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport './Progress.css';\n\nclass Progress extends React.Component {\n    state = {\n        waiting: false\n    };\n\n    componentDidMount() {\n        this.handleWaiting();\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (prevProps.waiting !== this.props.waiting) {\n            this.handleWaiting();\n        }\n    }\n\n    handleWaiting = () => {\n        const { waiting } = this.props;\n        if (!waiting) {\n            if (this.state.waiting) {\n                this.setState({\n                    waiting: false\n                });\n            }\n            return;\n        }\n\n        setTimeout(() => {\n            if (!this.props.waiting) return;\n\n            this.setState({\n                waiting: true\n            })\n        }, 250);\n    };\n\n    render() {\n        const { waiting } = this.state;\n\n        if (!waiting) return null;\n\n        return (\n            <div className='player-progress'>\n                <svg viewBox='0 0 54 54' height='54' width='54'>\n                    <circle stroke='white' fill='transparent' strokeWidth='3' strokeDasharray='120 100' strokeDashoffset='25' strokeLinecap='round' r='21' cx='27' cy='27'/>\n                </svg>\n            </div>\n        );\n    }\n\n}\n\nProgress.propTypes = {\n    waiting: PropTypes.bool\n};\n\nexport default Progress;","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport VolumeOffIcon from '@material-ui/icons/VolumeOff';\nimport DownloadIcon from '../../../Assets/Icons/Download';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport FileProgress from '../../Viewer/FileProgress';\nimport MediaStatus from './MediaStatus';\nimport { getFileSize, getSrc } from '../../../Utils/File';\nimport { isBlurredThumbnail } from '../../../Utils/Media';\nimport { clamp, getDurationString } from '../../../Utils/Common';\nimport { PHOTO_DISPLAY_SIZE, PHOTO_SIZE } from '../../../Constants';\nimport ApplicationStore from '../../../Stores/ApplicationStore';\nimport FileStore from '../../../Stores/FileStore';\nimport InstantViewStore from '../../../Stores/InstantViewStore';\nimport PlayerStore from '../../../Stores/PlayerStore';\nimport MessageStore from '../../../Stores/MessageStore';\nimport './VideoNote.css';\nimport { isCurrentSource } from '../../../Utils/Player';\n\nconst circleStyle = {\n    circle: 'video-note-progress-circle'\n};\n\nclass VideoNote extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.videoRef = React.createRef();\n        this.sourceRef = React.createRef();\n\n        const { chatId, messageId } = props;\n        const { video } = props.videoNote;\n\n        const { time, message, videoStream } = PlayerStore;\n        const active = message && message.chat_id === chatId && message.id === messageId;\n\n        this.state = {\n            active: active,\n            srcObject: active ? videoStream : null,\n            src: getSrc(video),\n            currentTime: active && time ? time.currentTime : 0.0,\n            videoDuration: active && time ? time.duration : 0.0\n        };\n\n        this.windowFocused = window.hasFocus;\n        this.inView = false;\n        this.openMediaViewer = Boolean(ApplicationStore.mediaViewerContent);\n        this.openProfileMediaViewer = Boolean(ApplicationStore.profileMediaViewerContent);\n        this.openIV = Boolean(InstantViewStore.getCurrent());\n    }\n\n    updateVideoSrc() {\n        const { srcObject, src } = this.state;\n\n        const player = this.videoRef.current;\n        if (!player) return;\n\n        if (srcObject) {\n            //player.scr = null;\n            player.srcObject = srcObject;\n            return;\n        }\n\n        const stream = player.srcObject;\n        if (stream) {\n            //console.log('clientUpdate release srcObject');\n            const tracks = stream.getTracks();\n\n            tracks.forEach(track => {\n                //console.log('clientUpdate release track');\n                track.stop();\n            });\n        }\n\n        if (player.srcObject) {\n            //console.log('clientUpdate release video.srcObject');\n            player.srcObject = null;\n        }\n\n        const source = this.sourceRef.current;\n        if (!source) return;\n\n        if (source.src !== src) {\n            source.src = src;\n            player.load();\n        }\n    }\n\n    componentDidMount() {\n        this.updateVideoSrc();\n\n        FileStore.on('clientUpdateVideoNoteThumbnailBlob', this.onClientUpdateVideoNoteThumbnailBlob);\n        FileStore.on('clientUpdateVideoNoteBlob', this.onClientUpdateVideoNoteBlob);\n\n        MessageStore.on('clientUpdateMessagesInView', this.onClientUpdateMessagesInView);\n\n        ApplicationStore.on('clientUpdateFocusWindow', this.onClientUpdateFocusWindow);\n        ApplicationStore.on('clientUpdateMediaViewerContent', this.onClientUpdateMediaViewerContent);\n        ApplicationStore.on('clientUpdateProfileMediaViewerContent', this.onClientUpdateProfileMediaViewerContent);\n        InstantViewStore.on('clientUpdateInstantViewContent', this.onClientUpdateInstantViewContent);\n\n        PlayerStore.on('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.on('clientUpdateMediaCaptureStream', this.onClientUpdateMediaCaptureStream);\n        PlayerStore.on('clientUpdateMediaTime', this.onClientUpdateMediaTime);\n        PlayerStore.on('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n    }\n\n    componentWillUnmount() {\n        FileStore.off('clientUpdateVideoNoteThumbnailBlob', this.onClientUpdateVideoNoteThumbnailBlob);\n        FileStore.off('clientUpdateVideoNoteBlob', this.onClientUpdateVideoNoteBlob);\n\n        MessageStore.off('clientUpdateMessagesInView', this.onClientUpdateMessagesInView);\n\n        ApplicationStore.off('clientUpdateFocusWindow', this.onClientUpdateFocusWindow);\n        ApplicationStore.off('clientUpdateMediaViewerContent', this.onClientUpdateMediaViewerContent);\n        ApplicationStore.off('clientUpdateProfileMediaViewerContent', this.onClientUpdateProfileMediaViewerContent);\n        InstantViewStore.off('clientUpdateInstantViewContent', this.onClientUpdateInstantViewContent);\n\n        PlayerStore.off('clientUpdateMediaActive', this.onClientUpdateMediaActive);\n        PlayerStore.off('clientUpdateMediaCaptureStream', this.onClientUpdateMediaCaptureStream);\n        PlayerStore.off('clientUpdateMediaTime', this.onClientUpdateMediaTime);\n        PlayerStore.off('clientUpdateMediaEnd', this.onClientUpdateMediaEnd);\n    }\n\n    startStopPlayer = () => {\n        const player = this.videoRef.current;\n        if (player) {\n            if (\n                this.inView &&\n                this.windowFocused &&\n                !this.openMediaViewer &&\n                !this.openProfileMediaViewer &&\n                !this.openIV\n            ) {\n                player.play();\n            } else {\n                if (this.state.active) {\n                    return;\n                }\n\n                player.pause();\n            }\n        }\n    };\n\n    onClientUpdateInstantViewContent = update => {\n        this.openIV = Boolean(InstantViewStore.getCurrent());\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateProfileMediaViewerContent = update => {\n        this.openProfileMediaViewer = Boolean(ApplicationStore.profileMediaViewerContent);\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateMediaViewerContent = update => {\n        this.openMediaViewer = Boolean(ApplicationStore.mediaViewerContent);\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateFocusWindow = update => {\n        this.windowFocused = update.focused;\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateMessagesInView = update => {\n        const { chatId, messageId } = this.props;\n        const key = `${chatId}_${messageId}`;\n\n        this.inView = update.messages.has(key);\n\n        this.startStopPlayer();\n    };\n\n    onClientUpdateMediaCaptureStream = update => {\n        const { chatId, messageId } = this.props;\n        if (chatId === update.chatId && messageId === update.messageId) {\n            const player = this.videoRef.current;\n            if (player) {\n                this.setState({ srcObject: update.stream }, () => {\n                    this.updateVideoSrc();\n                });\n            }\n        }\n    };\n\n    onClientUpdateMediaTime = update => {\n        const { chatId, messageId, block } = this.props;\n        const { currentTime, duration: videoDuration, source } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        const player = this.videoRef.current;\n        if (!player) return;\n\n        this.setState({\n            currentTime,\n            videoDuration\n        });\n    };\n\n    onClientUpdateMediaEnd = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        if (!isCurrentSource(chatId, messageId, block, source)) return;\n\n        this.setState(\n            {\n                active: false,\n                srcObject: null,\n                currentTime: 0\n            },\n            () => {\n                const player = this.videoRef.current;\n                if (!player) return;\n\n                this.updateVideoSrc();\n\n                if (!window.hasFocus) {\n                    player.pause();\n                }\n            }\n        );\n    };\n\n    onClientUpdateMediaActive = update => {\n        const { chatId, messageId, block } = this.props;\n        const { source } = update;\n\n        if (isCurrentSource(chatId, messageId, block, source)) {\n            if (this.state.active) {\n            } else {\n                this.setState({\n                    active: true,\n                    currentTime: null\n                });\n            }\n        } else if (this.state.active) {\n            this.setState(\n                {\n                    active: false,\n                    srcObject: null,\n                    currentTime: 0\n                },\n                () => {\n                    const player = this.videoRef.current;\n                    if (!player) return;\n\n                    this.updateVideoSrc();\n\n                    if (!window.hasFocus) {\n                        player.pause();\n                    }\n                }\n            );\n        }\n    };\n\n    onClientUpdateVideoNoteBlob = update => {\n        const { video } = this.props.videoNote;\n        const { fileId } = update;\n\n        if (!video) return;\n\n        if (video.id === fileId) {\n            this.setState(\n                {\n                    src: getSrc(video)\n                },\n                () => {\n                    this.updateVideoSrc();\n                }\n            );\n        }\n    };\n\n    onClientUpdateVideoNoteThumbnailBlob = update => {\n        const { thumbnail } = this.props.videoNote;\n        if (!thumbnail) return;\n\n        const { fileId } = update;\n\n        const { file } = thumbnail;\n        if (file && file.id === fileId) {\n            this.forceUpdate();\n        }\n    };\n\n    handleCanPlay = () => {\n        // const player = this.videoRef.current;\n        // if (player){\n        //     if (this.state.active){\n        //         player.muted = false;\n        //     }\n        //     else{\n        //         player.muted = true;\n        //     }\n        // }\n    };\n\n    render() {\n        const { displaySize, chatId, messageId, openMedia } = this.props;\n        const { active, currentTime, videoDuration } = this.state;\n        const { minithumbnail, thumbnail, video, duration } = this.props.videoNote;\n\n        const message = MessageStore.get(chatId, messageId);\n        if (!message) return null;\n\n        const style = { width: 200, height: 200 };\n        if (!style) return null;\n\n        const miniSrc = minithumbnail ? 'data:image/jpeg;base64, ' + minithumbnail.data : null;\n        const thumbnailSrc = getSrc(thumbnail ? thumbnail.file : null);\n        const src = getSrc(video);\n        const isBlurred = thumbnailSrc ? isBlurredThumbnail(thumbnail, displaySize) : Boolean(miniSrc);\n\n        let progress = 0;\n        if (videoDuration && currentTime) {\n            const progressTime = currentTime + 0.25;\n            progress = clamp(progressTime / videoDuration * 100, 0, 100);\n        }\n\n        return (\n            <div\n                className={classNames('video-note', { 'video-note-playing': active })}\n                style={style}\n                onClick={openMedia}>\n                {src ? (\n                    <>\n                        <video\n                            ref={this.videoRef}\n                            className={classNames('media-viewer-content-image', 'video-note-round')}\n                            poster={thumbnailSrc || miniSrc}\n                            muted\n                            autoPlay\n                            loop\n                            playsInline\n                            width={style.width}\n                            height={style.height}\n                            onCanPlay={this.handleCanPlay}\n                        >\n                            <source ref={this.sourceRef} src={null} type='video/mp4'/>\n                        </video>\n                        <div className='video-note-player'>\n                            <div className='video-note-progress'>\n                                <CircularProgress\n                                    classes={circleStyle}\n                                    variant='static'\n                                    value={progress}\n                                    size={200}\n                                    thickness={1}\n                                />\n                            </div>\n                            <div className='animation-meta'>\n                                {getDurationString(active ? Math.floor(currentTime) : duration)}\n                                <MediaStatus chatId={chatId} messageId={messageId} icon={'\\u00A0•'} />\n                            </div>\n                            <div className='video-note-muted'>\n                                <VolumeOffIcon />\n                            </div>\n                        </div>\n                    </>\n                ) : (\n                    <>\n                        <div className='video-note-round'>\n                            <img\n                                className={classNames('animation-preview', {\n                                    'media-blurred': isBlurred,\n                                    'media-mini-blurred': !src && !thumbnailSrc && isBlurred\n                                })}\n                                style={style}\n                                src={thumbnailSrc || miniSrc}\n                                alt=''\n                            />\n                        </div>\n                        <div className='animation-meta'>\n                            {getDurationString(duration) + ' ' + getFileSize(video)}\n                            <MediaStatus chatId={chatId} messageId={messageId} icon={'\\u00A0•'} />\n                        </div>\n                        <div className='video-note-muted'>\n                            <VolumeOffIcon />\n                        </div>\n                    </>\n                )}\n                <FileProgress file={video} download upload cancelButton icon={<DownloadIcon />} />\n            </div>\n        );\n    }\n}\n\nVideoNote.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    block: PropTypes.object,\n\n    videoNote: PropTypes.object.isRequired,\n    openMedia: PropTypes.func,\n    size: PropTypes.number,\n    displaySize: PropTypes.number\n};\n\nVideoNote.defaultProps = {\n    size: PHOTO_SIZE,\n    displaySize: PHOTO_DISPLAY_SIZE\n};\n\nexport default VideoNote;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport createSvgIcon from '@material-ui/core/esm/utils/createSvgIcon';\n\nexport default createSvgIcon(\n    <g fillRule='evenodd'>\n        <path d='M6,0 L33.5147186,0 C35.1060176,6.45011102e-15 36.632141,0.632141042 37.7573593,1.75735931 L52.2426407,16.2426407 C53.367859,17.367859 54,18.8939824 54,20.4852814 L54,48 C54,51.3137085 51.3137085,54 48,54 L6,54 C2.6862915,54 4.05812251e-16,51.3137085 0,48 L0,6 C-4.05812251e-16,2.6862915 2.6862915,6.08718376e-16 6,0 Z' />\n        <path\n            d='M33.5147186,0 C35.1060176,6.45011102e-15 36.632141,0.632141042 37.7573593,1.75735931 L52.2426407,16.2426407 C53.367859,17.367859 54,18.8939824 54,20.4852814 L54,22 C54,19.790861 52.209139,18 50,18 L40,18 C37.790861,18 36,16.209139 36,14 L36,4 C36,1.790861 34.209139,-3.88578059e-16 32,0 L33.5147186,0 Z'\n            fill='#000000'\n            style={{ mixBlendMode: 'normal' }}\n            opacity='0.15'\n        />\n    </g>,\n    'Document'\n);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { getDownloadedSize, getUploadedSize, getFileSize } from '../../../Utils/File';\nimport FileStore from '../../../Stores/FileStore';\nimport './DocumentAction.css';\n\nclass DocumentAction extends React.Component {\n    constructor(props) {\n        super(props);\n\n        const { file } = this.props;\n        this.state = {\n            prevPropsFile: file,\n            prevFile: null,\n            file: FileStore.get(file.id) || file\n        };\n    }\n\n    componentDidMount() {\n        FileStore.on('updateFile', this.onUpdateFile);\n    }\n\n    componentWillUnmount() {\n        FileStore.off('updateFile', this.onUpdateFile);\n    }\n\n    onUpdateFile = update => {\n        const currentFile = this.state.file;\n        const nextFile = update.file;\n\n        if (currentFile && currentFile.id === nextFile.id) {\n            this.setState({ file: nextFile, prevFile: currentFile });\n        }\n    };\n\n    static getDerivedStateFromProps(props, state) {\n        const { file } = props;\n        const { prevPropsFile } = state;\n\n        if (file && prevPropsFile && file.id !== prevPropsFile.id) {\n            return {\n                prevPropsFile: file,\n                prevFile: null,\n                file: FileStore.get(file.id) || file\n            };\n        }\n\n        return null;\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        const { theme } = this.props;\n        const { file, prevFile } = this.state;\n\n        if (nextProps.theme !== theme) {\n            return true;\n        }\n\n        if (nextState.file !== file) {\n            return true;\n        }\n\n        if (nextState.prevFile !== prevFile) {\n            return true;\n        }\n\n        return false;\n    }\n\n    render() {\n        const { meta } = this.props;\n        const { file } = this.state;\n        if (!file) return null;\n\n        const isDownloadingActive = file.local && file.local.is_downloading_active;\n        const isUploadingActive = file.remote && file.remote.is_uploading_active;\n\n        const size = getFileSize(file);\n        let progressSize = null;\n        if (isDownloadingActive) {\n            progressSize = getDownloadedSize(file);\n        } else if (isUploadingActive) {\n            progressSize = getUploadedSize(file);\n        }\n\n        const sizeString = progressSize ? `${progressSize}/${size}` : `${size}`;\n\n        return (\n            <div className='document-action'>\n                <span>{sizeString}</span>\n                {meta}\n            </div>\n        );\n    }\n}\n\nDocumentAction.propTypes = {\n    file: PropTypes.object.isRequired\n};\n\nexport default DocumentAction;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport DownloadIcon from '../../../Assets/Icons/Download';\nimport DocumentIcon from '../../../Assets/Icons/Document';\nimport DocumentTile from '../../Tile/DocumentTile';\nimport DocumentAction from './DocumentAction';\nimport { getExtension } from '../../../Utils/File';\nimport './Document.css';\n\nclass Document extends React.Component {\n    render() {\n        const { document, openMedia, width, height, meta, title, caption } = this.props;\n        if (!document) return null;\n\n        const { minithumbnail, thumbnail, file_name } = document;\n        const file = document.document;\n\n        const style = width && height ? { width, height } : null;\n        const completeIconFunc = thumb =>\n            thumb ? null : (\n                <div className='document-tile-complete-icon'>\n                    <DocumentIcon className='document-tile-icon-fill' viewBox='0 0 54 54' />\n                    <div className='document-tile-file-ext'>{getExtension(file_name)}</div>\n                </div>\n            );\n\n        return (\n            <div className={classNames('document', { 'media-title': title })} style={style}>\n                <DocumentTile\n                    minithumbnail={minithumbnail}\n                    thumbnail={thumbnail}\n                    file={file}\n                    openMedia={openMedia}\n                    icon={<DownloadIcon />}\n                    completeIcon={completeIconFunc}\n                />\n                <div className='document-content'>\n                    <div className='document-title'>\n                        <a\n                            className='document-name'\n                            onClick={openMedia}\n                            title={file_name}\n                            data-name={file_name}\n                            data-ext={'.' + getExtension(file_name)}>\n                            {file_name}\n                        </a>\n                    </div>\n                    <DocumentAction file={file} meta={caption ? null : meta} />\n                </div>\n            </div>\n        );\n    }\n}\n\nDocument.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    document: PropTypes.object.isRequired,\n    openMedia: PropTypes.func,\n    width: PropTypes.number,\n    height: PropTypes.number\n};\n\nexport default Document;\n","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"ea0962060f96eb12f20c.worker.js\");\n};","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nexport function getBadgeSelectedColor(rgb) {\n    const primaryHLS = RGBToHSL(rgb);\n    primaryHLS.l += 15;\n\n    return `hsl(${primaryHLS.h}, ${primaryHLS.s}%, ${primaryHLS.l}%)`;\n}\n\nexport function RGBToHSL(rgb) {\n    let r = 0, g = 0, b = 0;\n\n    // 3 digits\n    if (rgb.length === 4) {\n        r = Number.parseInt(rgb[1] + rgb[1], 16);\n        g = Number.parseInt(rgb[2] + rgb[2], 16);\n        b = Number.parseInt(rgb[3] + rgb[3], 16);\n\n        // 6 digits\n    } else if (rgb.length === 7) {\n        r = Number.parseInt(rgb[1] + rgb[2], 16);\n        g = Number.parseInt(rgb[3] + rgb[4], 16);\n        b = Number.parseInt(rgb[5] + rgb[6], 16);\n    }\n\n    // Make r, g, and b fractions of 1\n    r /= 255;\n    g /= 255;\n    b /= 255;\n\n    // Find greatest and smallest channel values\n    let cmin = Math.min(r,g,b),\n        cmax = Math.max(r,g,b),\n        delta = cmax - cmin,\n        h = 0,\n        s = 0,\n        l = 0;\n\n    // Calculate hue\n    // No difference\n    if (delta === 0)\n        h = 0;\n    // Red is max\n    else if (cmax === r)\n        h = ((g - b) / delta) % 6;\n    // Green is max\n    else if (cmax === g)\n        h = (b - r) / delta + 2;\n    // Blue is max\n    else\n        h = (r - g) / delta + 4;\n\n    h = Math.round(h * 60);\n\n    // Make negative hues positive behind 360°\n    if (h < 0)\n        h += 360;\n\n    // Calculate lightness\n    l = (cmax + cmin) / 2;\n\n    // Calculate saturation\n    s = delta === 0 ? 0 : delta / (1 - Math.abs(2 * l - 1));\n\n    // Multiply l and s by 100\n    s = +(s * 100).toFixed(1);\n    l = +(l * 100).toFixed(1);\n\n    //return \"hsl(\" + h + \",\" + s + \"%,\" + l + \"%)\";\n    return { h, s, l }\n}","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport blue from '@material-ui/core/colors/blue';\nimport createMuiTheme from '@material-ui/core/styles/createMuiTheme';\nimport { ThemeProvider as MuiThemeProvider } from '@material-ui/core/styles';\nimport { StylesProvider } from '@material-ui/core/styles';\nimport { getDisplayName } from './Utils/HOC';\nimport ApplicationStore from './Stores/ApplicationStore';\nimport { getBadgeSelectedColor } from './Utils/Color';\n\nfunction updateLightTheme(theme) {\n    // const root = document.querySelector(':root');\n    // const style = getComputedStyle(root);\n    const { style } = document.documentElement;\n\n    style.setProperty('--text-primary', '#000000');\n    style.setProperty('--text-secondary', '#707579');\n    style.setProperty('--text-disabled', 'rgba(0, 0, 0, 0.38)');\n\n    style.setProperty('--error', '#E53935');\n\n    style.setProperty('--tile-size', '54px');\n    style.setProperty('--tile-size-normal', '48px');\n    style.setProperty('--tile-size-extra-small', '16px');\n    style.setProperty('--tile-size-small', '33px');\n    style.setProperty('--tile-size-big', '120px');\n\n    style.setProperty('--z-index-modal', theme.zIndex.modal);\n\n    style.setProperty('--color-accent-main', theme.palette.primary.main);\n    style.setProperty('--color-accent-main22', theme.palette.primary.main + '44');\n    style.setProperty('--color-accent-dark', theme.palette.primary.dark);\n    style.setProperty('--color-accent-light', theme.palette.primary.light);\n    style.setProperty('--color-grey700', theme.palette.grey[700]);\n    style.setProperty('--color-grey', '#9AA7B2');\n    style.setProperty('--color-hover', '#70757914');\n\n    style.setProperty('--search-input-background', '#f4f4f5');\n    style.setProperty('--search-input-icon', '#9aa7b2');\n\n    style.setProperty('--header-color', '#000000');\n    style.setProperty('--header-subtle-color', '#707579');\n\n    style.setProperty('--badge-unmuted', '#4DCD5E');\n    style.setProperty('--badge-muted', '#C4C9CC');\n    style.setProperty('--badge-item-selected', getBadgeSelectedColor(theme.palette.primary.main));\n\n    style.setProperty('--online-indicator', '#0AC630');\n\n    style.setProperty('--message-service-color', '#FFFFFF');\n    style.setProperty('--message-service-background', '#00000033');\n\n    style.setProperty('--panel-background', '#ffffff');\n    style.setProperty('--border', '#DADCE0');\n    style.setProperty('--chat-background', '#e6ebee');\n    style.setProperty('--background', '#ffffff');\n    style.setProperty('--background-paper', theme.palette.background.paper);\n    style.setProperty('--shared-media-background', theme.palette.background.default);\n\n    style.setProperty('--dialog-color', '#000000');\n    style.setProperty('--dialog-subtle-color', '#707579');\n    style.setProperty('--dialog-meta-color', '#5F6369');\n    style.setProperty('--dialog-meta-read-color', '#4FAE4E');\n\n    style.setProperty('--media-in-tile-background', theme.palette.primary.main);\n    style.setProperty('--media-out-tile-background', '#4FAE4E');\n\n    style.setProperty('--message-in-link', theme.palette.primary.main);\n    style.setProperty('--message-in-author', theme.palette.primary.main);\n    style.setProperty('--message-in-background', '#FFFFFF');\n    style.setProperty('--message-in-color', '#000000');\n    style.setProperty('--message-in-subtle-color', '#707579');\n    style.setProperty('--message-in-meta-color', '#8D969C');\n    style.setProperty('--message-in-reply-title', theme.palette.primary.main);\n    style.setProperty('--message-in-reply-border', theme.palette.primary.main);\n    style.setProperty('--message-in-control', theme.palette.primary.main);\n    style.setProperty('--message-in-control-hover', theme.palette.primary.main + '22');\n    style.setProperty('--message-in-control-border', theme.palette.primary.main + '77');\n    style.setProperty('--message-in-control-border-hover', theme.palette.primary.main);\n\n    style.setProperty('--message-out-link', '#4FAE4E');\n    style.setProperty('--message-out-author', '#4FAE4E');\n    style.setProperty('--message-out-background', '#EEFFDE');\n    style.setProperty('--message-out-color', '#000000');\n    style.setProperty('--message-out-subtle-color', '#4FAE4E');\n    style.setProperty('--message-out-meta-color', '#4FAE4E');\n    style.setProperty('--message-out-reply-title', '#4FAE4E');\n    style.setProperty('--message-out-reply-border', '#4FAE4E');\n    style.setProperty('--message-out-control', '#4FAE4E');\n    style.setProperty('--message-out-control-hover', '#4FAE4E' + '22');\n    style.setProperty('--message-out-control-border', '#4FAE4E' + '77');\n    style.setProperty('--message-out-control-border-hover', '#4FAE4E');\n}\n\nfunction updateDarkTheme(theme) {\n    // const root = document.querySelector(':root');\n    // const style = getComputedStyle(root);\n    const { style } = document.documentElement;\n\n    style.setProperty('--text-primary', theme.palette.text.primary);\n    style.setProperty('--text-secondary', theme.palette.text.secondary);\n    style.setProperty('--text-disabled', theme.palette.text.disabled);\n\n    style.setProperty('--error', '#E53935');\n\n    style.setProperty('--tile-size', '54px');\n    style.setProperty('--tile-size-normal', '48px');\n    style.setProperty('--tile-size-extra-small', '16px');\n    style.setProperty('--tile-size-small', '33px');\n    style.setProperty('--tile-size-big', '120px');\n\n    style.setProperty('--z-index-modal', theme.zIndex.modal);\n\n    style.setProperty('--color-accent-main', theme.palette.primary.main);\n    style.setProperty('--color-accent-main22', theme.palette.primary.main + '44');\n    style.setProperty('--color-accent-dark', theme.palette.primary.dark);\n    style.setProperty('--color-accent-light', theme.palette.primary.light);\n    style.setProperty('--color-grey700', theme.palette.grey[700]);\n    style.setProperty('--color-grey', '#9AA7B2');\n    style.setProperty('--color-hover', 'rgba(112, 117, 121, 0.15)');\n\n    style.setProperty('--search-input-background', '#424242');\n    style.setProperty('--search-input-icon', '#fff');\n\n    style.setProperty('--header-color', '#ffffff');\n    style.setProperty('--header-subtle-color', theme.palette.text.secondary);\n\n    style.setProperty('--badge-unmuted', '#4DCD5E');\n    style.setProperty('--badge-muted', '#979797');\n    style.setProperty('--badge-item-selected', getBadgeSelectedColor(theme.palette.primary.main));\n\n    style.setProperty('--online-indicator', '#0AC630');\n\n    style.setProperty('--message-service-color', '#FFFFFF');\n    style.setProperty('--message-service-background', '#303030');\n\n    style.setProperty('--panel-background', '#303030');\n    style.setProperty('--border', theme.palette.divider);\n    style.setProperty('--chat-background', theme.palette.grey[900]);\n    style.setProperty('--background', theme.palette.grey[900]);\n    style.setProperty('--background-paper', theme.palette.background.paper);\n    style.setProperty('--shared-media-background', theme.palette.background.paper);\n\n    style.setProperty('--dialog-color', '#ffffff');\n    style.setProperty('--dialog-subtle-color', theme.palette.text.secondary);\n    style.setProperty('--dialog-meta-color', theme.palette.text.secondary);\n    style.setProperty('--dialog-meta-read-color', '#4FAE4E');\n\n    style.setProperty('--media-in-tile-background', theme.palette.primary.main);\n    style.setProperty('--media-out-tile-background', theme.palette.primary.main);\n\n    style.setProperty('--message-in-link', theme.palette.primary.main);\n    style.setProperty('--message-in-author', theme.palette.primary.main);\n    style.setProperty('--message-in-background', '#303030'); // background.default\n    style.setProperty('--message-in-color', '#FFFFFF');\n    style.setProperty('--message-in-subtle-color', 'rgba(255, 255, 255, 0.7)');\n    style.setProperty('--message-in-meta-color', 'rgba(255, 255, 255, 0.7)');\n    style.setProperty('--message-in-reply-title', theme.palette.primary.main);\n    style.setProperty('--message-in-reply-border', theme.palette.primary.main);\n    style.setProperty('--message-in-control', theme.palette.primary.main);\n    style.setProperty('--message-in-control-hover', theme.palette.primary.main + '22');\n    style.setProperty('--message-in-control-border', theme.palette.primary.main + '77');\n    style.setProperty('--message-in-control-border-hover', theme.palette.primary.main);\n\n    style.setProperty('--message-out-link', theme.palette.primary.main);\n    style.setProperty('--message-out-author', theme.palette.primary.main);\n    style.setProperty('--message-out-background', '#303030'); // background.default\n    style.setProperty('--message-out-color', '#FFFFFF');\n    style.setProperty('--message-out-subtle-color', 'rgba(255, 255, 255, 0.7)');\n    style.setProperty('--message-out-meta-color', 'rgba(255, 255, 255, 0.7)'); // text.secondary\n    style.setProperty('--message-out-reply-title', theme.palette.primary.main);\n    style.setProperty('--message-out-reply-border', theme.palette.primary.main);\n    style.setProperty('--message-out-control', theme.palette.primary.main);\n    style.setProperty('--message-out-control-hover', theme.palette.primary.main + '22');\n    style.setProperty('--message-out-control-border', theme.palette.primary.main + '77');\n    style.setProperty('--message-out-control-border-hover', theme.palette.primary.main);\n}\n\nfunction createTheme(type, primary) {\n    let MuiTouchRipple = {};\n    let action = {};\n    if (type === 'light') {\n        MuiTouchRipple = {\n            child: {\n                color: type === 'dark' ? 'currentColor' : 'rgba(112, 117, 121)'\n            },\n            rippleVisible: {\n                opacity: 0.08 //type === 'dark' ? 0.15 : 1\n            },\n            '@keyframes enter': {\n                '0%': {\n                    transform: 'scale(0)',\n                    opacity: 0.03\n                },\n                '100%': {\n                    transform: 'scale(1)',\n                    opacity: 0.08 //type === 'dark' ? 0.15 : 1\n                }\n            }\n        };\n        action = {\n            hover: 'rgba(112, 117, 121, 0.08)',\n            hoverOpacity: 0.08\n        };\n    }\n\n    const theme = createMuiTheme({\n        palette: {\n            type: type,\n            primary: primary,\n            secondary: { main: '#E53935' },\n            action\n        },\n        typography: {\n            useNextVariants: true\n        },\n        shape: {\n            borderRadius: 10\n        },\n        overrides: {\n            MuiOutlinedInput: {\n                input: {\n                    padding: '17.5px 14px'\n                }\n            },\n            MuiAutocomplete: {\n                option: {\n                    paddingLeft: 0,\n                    paddingTop: 0,\n                    paddingRight: 0,\n                    paddingBottom: 0\n                },\n                paper: {\n                    '& > ul': {\n                        maxHeight: 56 * 5.5\n                    }\n                }\n            },\n            MuiButton: {\n                root: {\n                    padding: '12px 16px 11px',\n                    fontSize: 16,\n                    lineHeight: 'normal'\n                }\n            },\n            MuiMenuList: {\n                root: {\n                    minWidth: 150\n                }\n            },\n            MuiList: {\n                root: {\n                    minWidth: 150\n                }\n            },\n            MuiListItemIcon: {\n                root: {\n                    minWidth: 40\n                },\n                alignItemsFlexStart: {\n                    marginTop: 6\n                }\n            },\n            // MuiListItemText: {\n            //     root: {\n            //         marginTop: 0,\n            //         marginBottom: 0\n            //     }\n            // },\n            // MuiListItem: {\n            //     root: {\n            //         paddingTop: 10,\n            //         paddingBottom: 10\n            //     }\n            // },\n            MuiMenuItem: {\n                root: {\n                    paddingTop: 10,\n                    paddingBottom: 10\n                }\n            },\n            MuiTouchRipple\n        }\n    });\n\n    if (type === 'dark') {\n        updateDarkTheme(theme);\n    } else {\n        updateLightTheme(theme);\n    }\n\n    return theme;\n}\n\nfunction withTheme(WrappedComponent) {\n    class ThemeWrapper extends React.Component {\n        constructor(props) {\n            super(props);\n\n            let { type, primary } = { type: 'light', primary: { main: '#50A2E9' } };\n            try {\n                const themeOptions = JSON.parse(localStorage.getItem('themeOptions'));\n                if (themeOptions) {\n                    type = themeOptions.type;\n                    primary = themeOptions.primary;\n                }\n            } catch {}\n            const theme = createTheme(type, primary);\n\n            this.state = { theme };\n        }\n\n        componentDidMount() {\n            ApplicationStore.on('clientUpdateThemeChanging', this.onClientUpdateThemeChanging);\n        }\n\n        componentWillUnmount() {\n            ApplicationStore.off('clientUpdateThemeChanging', this.onClientUpdateThemeChanging);\n        }\n\n        onClientUpdateThemeChanging = update => {\n            const { type, primary } = update;\n\n            const theme = createTheme(type, primary);\n            localStorage.setItem('themeOptions', JSON.stringify({ type, primary }));\n\n            this.setState({ theme }, () => ApplicationStore.emit('clientUpdateThemeChange'));\n        };\n\n        render() {\n            const { theme } = this.state;\n\n            return (\n                <StylesProvider injectFirst={true}>\n                    <MuiThemeProvider theme={theme}>\n                        <WrappedComponent {...this.props} />\n                    </MuiThemeProvider>\n                </StylesProvider>\n            );\n        }\n    }\n    ThemeWrapper.displayName = `WithTheme(${getDisplayName(WrappedComponent)})`;\n\n    return ThemeWrapper;\n}\n\nexport default withTheme;\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"g\", {\n  id: \"Login\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fillRule: \"evenodd\"\n}, React.createElement(\"g\", {\n  id: \"Login_5_Phone\",\n  transform: \"translate(-760.000000, -186.000000)\"\n}, React.createElement(\"path\", {\n  d: \"M840,346 C795.81722,346 760,310.18278 760,266 C760,221.81722 795.81722,186 840,186 C884.18278,186 920,221.81722 920,266 C920,310.18278 884.18278,346 840,346 Z M794.596303,264.66919 C790.659174,266.234556 788.596733,267.765936 788.408978,269.263329 C788.048509,272.138166 792.188142,273.033142 797.396667,274.725906 C801.643184,276.106018 807.355495,277.720609 810.325092,277.784753 C813.018799,277.842938 816.025284,276.732617 819.344546,274.453789 C841.998088,259.16492 853.691946,251.437186 854.426119,251.270588 C854.944065,251.153055 855.661811,251.005273 856.148118,251.437434 C856.634425,251.869594 856.586618,252.688022 856.535106,252.907586 C856.123224,254.663156 834.84286,274.015606 833.61816,275.287388 C828.938462,280.146996 823.615302,283.120543 831.826781,288.530755 C838.932147,293.212193 843.067503,296.19863 850.387542,300.996094 C855.065474,304.061953 858.733031,307.697601 863.562866,307.253237 C865.785287,307.048765 868.080902,304.959403 869.246762,298.727987 C872.002037,284.001293 877.417883,252.09303 878.669527,238.944397 C878.779187,237.792407 878.641237,236.318088 878.530455,235.670896 C878.419672,235.023705 878.188168,234.101592 877.346762,233.418979 C876.350285,232.610561 874.811937,232.440083 874.123923,232.4522 C870.995743,232.507295 866.196346,234.175802 843.099163,243.78089 C835.009657,247.144954 818.842037,254.107721 794.596303,264.66919 Z\"\n})));\n\nvar SvgTelegramLogo = function SvgTelegramLogo(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    className: \"telegram-logo\",\n    width: \"160px\",\n    height: \"160px\",\n    viewBox: \"0 0 160 160\",\n    ref: svgRef\n  }, props), React.createElement(\"title\", null, title), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgTelegramLogo, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/telegram-logo.ac1331a4.svg\";\nexport { ForwardRef as ReactComponent };","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport EventEmitter from './EventEmitter';\nimport { KEY_AUTH_STATE } from '../Constants';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass AuthorizationStore extends EventEmitter {\n    constructor() {\n        super();\n\n        this.reset();\n        this.load();\n\n        this.addTdLibListener();\n    }\n\n    load() {\n        try {\n            const value = localStorage.getItem(KEY_AUTH_STATE);\n            if (value) {\n                this.current = JSON.parse(value);\n            } else {\n                this.current = null;\n            }\n        } catch {}\n    }\n\n    save(state) {\n        if (state) {\n            localStorage.setItem(KEY_AUTH_STATE, JSON.stringify(state));\n        } else {\n            localStorage.removeItem(KEY_AUTH_STATE);\n        }\n    }\n\n    reset = () => {\n        this.current = null;\n    };\n\n    onUpdate = update => {\n        switch (update['@type']) {\n            case 'updateAuthorizationState': {\n                const { authorization_state } = update;\n\n                this.current = authorization_state;\n                this.save(authorization_state);\n\n                if (authorization_state['@type'] !== 'authorizationStateReady') {\n                    this.setCountryCode();\n                }\n\n                this.emit(update['@type'], update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    setCountryCode = async () => {\n        const { code } = this;\n        if (code) return;\n\n        this.code = await TdLibController.send({ '@type': 'getCountryCode' });\n        TdLibController.clientUpdate({ '@type': 'clientUpdateCountryCode', code: this.code });\n    };\n\n    onClientUpdate = update => {\n        switch (update['@type']) {\n            case 'clientUpdateCountryCode': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMonkeyIdle': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMonkeyTracking': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMonkeyClose': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            case 'clientUpdateMonkeyPeek': {\n                this.emit(update['@type'], update);\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    addTdLibListener = () => {\n        TdLibController.on('update', this.onUpdate);\n        TdLibController.on('clientUpdate', this.onClientUpdate);\n    };\n\n    removeTdLibListener = () => {\n        TdLibController.off('update', this.onUpdate);\n        TdLibController.off('clientUpdate', this.onClientUpdate);\n    };\n}\n\nconst store = new AuthorizationStore();\nwindow.authorization = store;\nexport default store;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport './Country.css';\n\nfunction Country({ emoji, name, phone }) {\n    return (\n        <div className='country'>\n            <span className='country-emoji'>{emoji}</span>\n            <span className='country-name'>{name}</span>\n            <span className='country-phone'>{phone}</span>\n        </div>\n    );\n}\n\nCountry.propTypes = {\n    emoji: PropTypes.string,\n    name: PropTypes.string,\n    phone: PropTypes.string\n};\n\nexport default Country;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport Button from '@material-ui/core/Button';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport TextField from '@material-ui/core/TextField';\nimport Link from '@material-ui/core/Link';\nimport Typography from '@material-ui/core/Typography';\nimport Country from './Country';\nimport HeaderProgress from '../ColumnMiddle/HeaderProgress';\nimport { KEY_SUGGESTED_LANGUAGE_PACK_ID } from '../../Constants';\nimport AppStore from '../../Stores/ApplicationStore';\nimport AuthStore from '../../Stores/AuthorizationStore';\nimport OptionStore from '../../Stores/OptionStore';\nimport LocalizationStore from '../../Stores/LocalizationStore';\nimport TdLibController from '../../Controllers/TdLibController';\nimport './Phone.css';\n\nexport function cleanProgressStatus(status) {\n    if (!status) return status;\n\n    return status.replace('...', '').replace('…', '');\n}\n\nexport function isConnecting(state) {\n    if (!state) return false;\n\n    switch (state['@type']) {\n        case 'connectionStateConnecting': {\n            return true;\n        }\n        case 'connectionStateConnectingToProxy': {\n            return true;\n        }\n        case 'connectionStateReady': {\n            return false;\n        }\n        case 'connectionStateUpdating': {\n            return false;\n        }\n        case 'connectionStateWaitingForNetwork': {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nfunction isValidPhoneNumber(phoneNumber) {\n    if (!phoneNumber) return false;\n\n    let isBad = !phoneNumber.match(/^[\\d\\-+\\s]+$/);\n    if (!isBad) {\n        phoneNumber = phoneNumber.replace(/\\D/g, '');\n        if (phoneNumber.length < 7) {\n            isBad = true;\n        }\n    }\n\n    return !isBad;\n}\n\nfunction formatByPattern(phone, pattern) {\n    phone = clearPhone(phone);\n\n    let result = '';\n    let index = 0;\n    for (let i = 0; i < pattern.length && index < phone.length; i++) {\n        if (pattern[i] >= '0' && pattern[i] <= '9') {\n            result += pattern[i];\n            if (phone[index] === pattern[i]) {\n                index++;\n            }\n        } else if (pattern[i] === ' ') {\n            result += pattern[i];\n        } else if (pattern[i] === 'X') {\n            result += phone[index++];\n        }\n    }\n\n    result += ' ' + phone.substring(index);\n\n    return '+' + result;\n}\n\nexport function formatPhoneNumber(phone) {\n    const { data } = AuthStore;\n    if (!data) return phone;\n\n    const country = getCountryFromPhone(phone, data);\n    if (!country) return phone;\n\n    return formatByPattern(phone, country.pattern);\n}\n\nfunction phoneEquals(phone1, phone2) {\n    return clearPhone(phone1) === clearPhone(phone2);\n}\n\nfunction isWhitelistKey(key) {\n    if (key >= '0' && key <= '9') return true;\n    if (key === ' ') return true;\n    if (key === '+') return true;\n\n    return false;\n}\n\nfunction clearPhone(phone) {\n    if (!phone) return phone;\n\n    return phone\n        .replace(/ /g, '')\n        .replace('+', '')\n        .toLowerCase();\n}\n\nfunction isPhoneWithOptionCode(phone, option) {\n    if (!phone) return false;\n    if (!option) return false;\n\n    phone = clearPhone(phone);\n    const code = clearPhone(option.phone);\n\n    return phone.startsWith(code);\n}\n\nfunction isValidOption(x, value) {\n    if (!x) return false;\n    if (!value) return true;\n\n    if (value.length > 0 && value[0] === '(') {\n        value = value.substring(1);\n    }\n\n    const names = x.name.toLowerCase().split(' ');\n    for (let i = 0; i < names.length; i++) {\n        if (names[i].length > 0 && names[i][0] === '(') {\n            names[i] = names[i].substring(1);\n        }\n    }\n    const phone = clearPhone(x.phone);\n\n    if (names.some(x => x.startsWith(value))) return true;\n    if (phone.startsWith(value) || value.startsWith(phone)) return true;\n\n    return false;\n}\n\nfunction getCountryFromPhone(phone, data) {\n    if (!data) return null;\n\n    const index = data.findIndex(x => isPhoneWithOptionCode(phone, x));\n\n    return index !== -1 ? data[index] : null;\n}\n\nfunction getCountryFromCode(code, data) {\n    if (!code) return null;\n    if (!data) return null;\n\n    const index = data.findIndex(x => x.code.toLowerCase() === code.toLowerCase());\n\n    return index !== -1 ? data[index] : null;\n}\n\nclass Phone extends React.Component {\n    constructor(props) {\n        super(props);\n\n        const { defaultPhone, data } = props;\n\n        let phone = defaultPhone || '';\n        let country = getCountryFromPhone(phone, data);\n        if (!phone && !country) {\n            const { code } = AuthStore;\n            if (code) {\n                const [p, c] = this.getPhoneCountry(code);\n                phone = p;\n                country = c;\n            }\n        }\n\n        this.state = {\n            connecting: isConnecting(AppStore.connectionState),\n            error: null,\n            loading: false,\n            suggestedLanguage: localStorage.getItem(KEY_SUGGESTED_LANGUAGE_PACK_ID),\n            keep: true,\n\n            phone,\n            country\n        };\n\n        this.phoneInputRef = React.createRef();\n    }\n\n    getPhoneCountry(code) {\n        if (!code) return [null, null];\n\n        const { data } = this.props;\n        if (!data) return [null, null];\n\n        let phone = null;\n        const country = getCountryFromCode(code.text, data);\n        if (country) {\n            phone = '+' + clearPhone(country.phone) + ' ';\n        }\n\n        return [phone, country];\n    }\n\n    onClientUpdateCountryCode = update => {\n        const { code } = AuthStore;\n        if (!code) return;\n\n        const [phone, country] = this.getPhoneCountry(code);\n\n        this.setState({ phone, country });\n    };\n\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\n        return true;\n    }\n\n    componentDidMount() {\n        this.setSuggestedLanguagePackId();\n\n        AuthStore.on('clientUpdateCountryCode', this.onClientUpdateCountryCode);\n        AppStore.on('clientUpdateSetPhoneCanceled', this.onClientUpdateSetPhoneCanceled);\n        AppStore.on('clientUpdateSetPhoneError', this.onClientUpdateSetPhoneError);\n        AppStore.on('clientUpdateSetPhoneResult', this.onClientUpdateSetPhoneResult);\n        AppStore.on('updateConnectionState', this.onUpdateConnectionState);\n        OptionStore.on('updateOption', this.onUpdateOption);\n    }\n\n    componentWillUnmount() {\n        AuthStore.off('clientUpdateCountryCode', this.onClientUpdateCountryCode);\n        AppStore.off('clientUpdateSetPhoneCanceled', this.onClientUpdateSetPhoneCanceled);\n        AppStore.off('clientUpdateSetPhoneError', this.onClientUpdateSetPhoneError);\n        AppStore.off('clientUpdateSetPhoneResult', this.onClientUpdateSetPhoneResult);\n        AppStore.off('updateConnectionState', this.onUpdateConnectionState);\n        OptionStore.off('updateOption', this.onUpdateOption);\n    }\n\n    onUpdateConnectionState = update => {\n        const { state } = update;\n\n        this.setState({ connecting: isConnecting(state) });\n    };\n\n    onClientUpdateSetPhoneCanceled = update => {\n        this.setState({ loading: false });\n    };\n\n    onClientUpdateSetPhoneError = update => {\n        const { error } = update;\n\n        let errorString = null;\n        if (error && error['@type'] === 'error' && error.message) {\n            if (error.message === 'PHONE_NUMBER_INVALID') {\n                this.setState({ error: { code: 'InvalidPhoneNumber' }, loading: false });\n                return;\n            } else {\n                errorString = error.message;\n            }\n        } else {\n            errorString = JSON.stringify(error);\n        }\n\n        this.setState({ error: { string: errorString }, loading: false });\n    };\n\n    onClientUpdateSetPhoneResult = update => {\n        this.setState({ loading: false });\n    };\n\n    onUpdateOption = update => {\n        const { name } = update;\n\n        if (name === 'suggested_language_pack_id') {\n            this.setSuggestedLanguagePackId();\n        }\n    };\n\n    async setSuggestedLanguagePackId() {\n        const { i18n } = this.props;\n        if (!i18n) return;\n\n        const languagePackId = OptionStore.get('suggested_language_pack_id');\n        if (!languagePackId) return;\n\n        const { value } = languagePackId;\n\n        await LocalizationStore.loadLanguage(value);\n\n        this.setState({ suggestedLanguage: value });\n    }\n\n    handleKeyPress = event => {\n        if (event.key === 'Enter') {\n            event.preventDefault();\n            this.handleDone();\n        } else if (!isWhitelistKey(event.key)) {\n            event.preventDefault();\n            event.stopPropagation();\n        }\n    };\n\n    handleDone = () => {\n        const { phone } = this.state;\n        if (!isValidPhoneNumber(phone)) {\n            this.setState({ error: { code: 'InvalidPhoneNumber' } });\n            return;\n        }\n\n        this.setState({ error: null, loading: true });\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateSetPhone',\n            phone\n        });\n    };\n\n    handleChangeLanguage = () => {\n        const { i18n } = this.props;\n        const { suggestedLanguage } = this.state;\n\n        if (!i18n) return;\n        if (!suggestedLanguage) return;\n\n        const nextLanguage = suggestedLanguage === i18n.language ? LocalizationStore.fallbackLng : suggestedLanguage;\n\n        TdLibController.clientUpdate({ '@type': 'clientUpdateLanguageChange', language: nextLanguage });\n    };\n\n    handleFilterOptions = (options, { inputValue }) => {\n        if (!options) return;\n\n        let value = inputValue.toLowerCase().replace(/ /g, '');\n        value = value.length > 0 && value[0] === '+' ? value.substring(1) : value;\n\n        return options.filter(x => isValidOption(x, value));\n    };\n\n    handleCountryChange = (event, nextCountry) => {\n        if (!nextCountry) return;\n\n        const { phone, country } = this.state;\n\n        const prevPhone = country ? phone.replace(country.phone, '') : phone;\n        const nextPhone = nextCountry.phone + ' ' + prevPhone.trimStart();\n\n        this.setState({ country: nextCountry, phone: nextPhone }, () => {\n            this.phoneInputRef.current.focus();\n        });\n    };\n\n    handleKeepChange = (event, value) => {\n        this.setState({ keep: !this.state.keep });\n    };\n\n    handlePhoneChange = event => {\n        let nextPhone = event.target.value;\n\n        const { data } = this.props;\n        let { country } = this.state;\n        if (country) {\n            if (!nextPhone.startsWith(country.phone)) {\n                country = null;\n            }\n        }\n\n        if (!country && data && nextPhone) {\n            country = getCountryFromPhone(nextPhone, data);\n            if (country && phoneEquals(nextPhone, country.phone)) {\n                nextPhone = '+' + clearPhone(nextPhone) + ' ';\n            }\n        }\n\n        this.setState({ phone: nextPhone, country });\n    };\n\n    handlePaste = event => {\n        const plainText = event.clipboardData.getData('text/plain');\n        if (plainText) {\n            event.preventDefault();\n            // const phoneRegExp = '/^[+]*[(]{0,1}[0-9]{1,3}[)]{0,1}[-\\s\\./0-9]*$/g';\n\n            let phone = '';\n            for (let ch of plainText) {\n                if (isWhitelistKey(ch)) {\n                    phone += ch;\n                }\n            }\n\n            document.execCommand('insertText', false, phone);\n        }\n    };\n\n    handleQRCode = () => {\n        const { onRequestQRCode } = this.props;\n\n        onRequestQRCode && onRequestQRCode();\n    };\n\n    render() {\n        const { data, i18n, t } = this.props;\n        const { connecting, loading, error, suggestedLanguage, keep, phone, country } = this.state;\n\n        let errorString = '';\n        if (error) {\n            const { code, string } = error;\n            if (code) {\n                errorString = t(code);\n            } else {\n                errorString = string;\n            }\n        }\n\n        const title = connecting ? cleanProgressStatus(t('Connecting')) : t('SignInToTelegram');\n        let nextLanguage = suggestedLanguage;\n        if (suggestedLanguage === i18n.language && i18n.language !== LocalizationStore.fallbackLng) {\n            nextLanguage = LocalizationStore.fallbackLng;\n        }\n\n        return (\n            <form className='auth-root' autoComplete='off'>\n                <Typography variant='body1' className='auth-title'>\n                    <span>{title}</span>\n                    {connecting && <HeaderProgress />}\n                </Typography>\n                <Typography variant='body1' className='auth-subtitle' style={{ width: 254 }}>\n                    {t('StartText')}\n                </Typography>\n                <Autocomplete\n                    debug={false}\n                    id='country-select'\n                    noOptionsText={t('NoResult')}\n                    options={data}\n                    disabled={loading}\n                    autoHighlight\n                    getOptionLabel={option => option.name}\n                    renderOption={option => <Country name={option.name} emoji={option.emoji} phone={option.phone} />}\n                    renderInput={params => (\n                        <TextField\n                            classes={{ root: 'auth-input' }}\n                            {...params}\n                            label={t('Country')}\n                            variant='outlined'\n                            inputProps={{\n                                ...params.inputProps\n                            }}\n                            fullWidth\n                            autoComplete='off'\n                        />\n                    )}\n                    filterOptions={this.handleFilterOptions}\n                    value={country}\n                    onChange={this.handleCountryChange}\n                />\n                <TextField\n                    id='phoneNumber'\n                    classes={{ root: 'auth-input' }}\n                    inputRef={this.phoneInputRef}\n                    variant='outlined'\n                    color='primary'\n                    label={t('PhoneNumber')}\n                    disabled={loading}\n                    error={Boolean(errorString)}\n                    helperText={errorString}\n                    fullWidth\n                    autoFocus\n                    autoComplete='off'\n                    value={phone}\n                    onChange={this.handlePhoneChange}\n                    onKeyPress={this.handleKeyPress}\n                    onPaste={this.handlePaste}\n                />\n                <div className='sign-in-keep'>\n                    <Checkbox color='primary' checked={keep} disabled={loading} onChange={this.handleKeepChange} />\n                    <Typography variant='body1'>{t('KeepMeSignedIn')}</Typography>\n                </div>\n                <Button\n                    classes={{ root: 'auth-button' }}\n                    variant='contained'\n                    disableElevation\n                    fullWidth\n                    color='primary'\n                    disabled={loading}\n                    onClick={this.handleDone}>\n                    {t('Next')}\n                </Button>\n                <Typography className='sign-in-continue-on'>\n                    <Link onClick={this.handleQRCode}>\n                        {t('LogInViaQR')}\n                    </Link>\n                </Typography>\n                { !!nextLanguage && (\n                    <Typography className='sign-in-continue-on'>\n                        <Link onClick={this.handleChangeLanguage}>\n                            {t('ContinueOnThisLanguage', { lng: nextLanguage })}\n                        </Link>\n                    </Typography>\n                )}\n            </form>\n        );\n    }\n}\n\nPhone.propTypes = {\n    defaultPhone: PropTypes.string\n};\n\nexport default withTranslation()(Phone);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport QRCodeStyling from 'qr-code-styling';\nimport Link from '@material-ui/core/Link';\nimport Typography from '@material-ui/core/Typography';\nimport HeaderProgress from '../ColumnMiddle/HeaderProgress';\nimport { ReactComponent as Logo } from '../../Assets/telegram-logo.svg';\nimport { cleanProgressStatus, isConnecting } from './Phone';\nimport AppStore from '../../Stores/ApplicationStore';\nimport './QRCode.css';\n\nclass QRCode extends React.Component {\n\n    state = {\n        connecting: false,\n        showConnecting: false\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        const { state } = this.props;\n        if (state !== prevProps.state) {\n            this.loadData();\n        }\n    }\n\n    componentDidMount() {\n        this.loadData();\n        AppStore.on('updateConnectionState', this.onUpdateConnectionState);\n    }\n\n    componentWillUnmount() {\n        AppStore.off('updateConnectionState', this.onUpdateConnectionState);\n    }\n\n    loadData() {\n        const { state } = this.props;\n\n        const qrCode = new QRCodeStyling({\n            width: 287,\n            height: 287,\n            data: state.link,\n            image: '',\n            dotsOptions: {\n                color: 'black',\n                type: 'rounded'\n            },\n            backgroundOptions: {\n                color: 'transparent',\n            }\n        });\n\n        const canvas = document.getElementById('qr-canvas');\n        canvas.innerHTML = null;\n        qrCode.append(canvas);\n    }\n\n    onUpdateConnectionState = update => {\n        const { state } = update;\n\n        const connecting = isConnecting(state);\n        if (this.state.connecting === connecting) return;\n\n        this.setState({ connecting, showConnecting: false });\n        if (connecting) {\n            setTimeout(() => {\n                if (this.state.connecting) {\n                    this.setState({ showConnecting: true });\n                }\n            }, 500);\n        }\n    };\n\n    handleBack = () => {\n        const { onChangePhone } = this.props;\n\n        onChangePhone && onChangePhone();\n    };\n\n    render() {\n        const { t } = this.props;\n        const { showConnecting: connecting } = this.state;\n\n        const title = connecting ? cleanProgressStatus(t('Connecting')) : t('AuthAnotherClient');\n\n        return (\n            <form className='auth-root'>\n                <Typography variant='body1' className='auth-title'>\n                    <span>{title}</span>\n                    {connecting && <HeaderProgress />}\n                </Typography>\n                <div className='qr-content'>\n                    <div id='qr-canvas'/>\n                    <div className='qr-telegram-logo'>\n                        <Logo className='telegram-logo'/>\n                    </div>\n                </div>\n                <Typography variant='body1' className='auth-qr-subtitle'>\n                    {t('QRHint')}\n                </Typography>\n                <Typography className='sign-in-continue-on'>\n                    <Link onClick={this.handleBack}>\n                        {t('LogInByPhone')}\n                    </Link>\n                </Typography>\n            </form>\n        );\n    }\n}\n\nQRCode.propTypes = {\n    state: PropTypes.object,\n    onChangePhone: PropTypes.func\n};\n\nexport default withTranslation()(QRCode);","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport { ReactComponent as Logo } from '../../Assets/telegram-logo.svg';\n// import Lottie from '../Viewer/Lottie';\nimport AuthStore from '../../Stores/AuthorizationStore';\nimport './Caption.css';\nimport QRCode from './QRCode';\n\nconst Lottie = React.lazy(() => import('../Viewer/Lottie'));\n\nclass Caption extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            data: null,\n            lastUpdate: null\n        };\n\n        this.lottieRef = React.createRef();\n    }\n\n    loadData = async () => {\n        const { closeData } = this.state;\n        if (closeData) return;\n\n        try {\n            const requests = [\n                fetch('data/TwoFactorSetupMonkeyClose.json'),\n                fetch('data/TwoFactorSetupMonkeyIdle.json'),\n                fetch('data/TwoFactorSetupMonkeyPeek.json'),\n                fetch('data/TwoFactorSetupMonkeyTracking.json')\n            ];\n\n            const results = await Promise.all(requests);\n\n            const [closeData, idleData, peekData, trackingData] = await Promise.all(results.map(x => x.json()));\n\n            this.setState(\n                {\n                    closeData,\n                    idleData,\n                    peekData,\n                    trackingData\n                },\n                () => {\n                    const { lastUpdate } = this.state;\n                    if (lastUpdate) {\n                        switch (lastUpdate['@type']) {\n                            case 'clientUpdateMonkeyIdle': {\n                                this.onClientUpdateMonkeyIdle(lastUpdate);\n                                break;\n                            }\n                            case 'clientUpdateMonkeyTracking': {\n                                this.onClientUpdateMonkeyTracking(lastUpdate);\n                                break;\n                            }\n                            case 'clientUpdateMonkeyClose': {\n                                this.onClientUpdateMonkeyClose(lastUpdate);\n                                break;\n                            }\n                            case 'clientUpdateMonkeyPeek': {\n                                this.onClientUpdateMonkeyPeek(lastUpdate);\n                                break;\n                            }\n                        }\n                    }\n                }\n            );\n        } catch (error) {\n            console.error(error);\n        }\n    };\n\n    async componentDidMount() {\n        setTimeout(this.loadData, 100);\n\n        AuthStore.on('clientUpdateMonkeyIdle', this.onClientUpdateMonkeyIdle);\n        AuthStore.on('clientUpdateMonkeyTracking', this.onClientUpdateMonkeyTracking);\n        AuthStore.on('clientUpdateMonkeyClose', this.onClientUpdateMonkeyClose);\n        AuthStore.on('clientUpdateMonkeyPeek', this.onClientUpdateMonkeyPeek);\n    }\n\n    componentWillUnmount() {\n        AuthStore.off('clientUpdateMonkeyIdle', this.onClientUpdateMonkeyIdle);\n        AuthStore.off('clientUpdateMonkeyTracking', this.onClientUpdateMonkeyTracking);\n        AuthStore.off('clientUpdateMonkeyClose', this.onClientUpdateMonkeyClose);\n        AuthStore.off('clientUpdateMonkeyPeek', this.onClientUpdateMonkeyPeek);\n    }\n\n    onClientUpdateMonkeyIdle = update => {\n        const { idleData } = this.state;\n\n        this.setState(\n            {\n                data: idleData,\n                lastUpdate: update\n            },\n            () => {\n                const { current } = this.lottieRef;\n                if (!current) return;\n\n                current.anim.playSegments([0, 180], true);\n            }\n        );\n    };\n\n    onClientUpdateMonkeyTracking = update => {\n        const { code, prevCode } = update;\n        const { trackingData } = this.state;\n\n        const from = Math.min(15 * prevCode.length, 180);\n        const to = Math.min(15 * code.length, 180);\n\n        this.setState(\n            {\n                data: trackingData,\n                lastUpdate: update\n            },\n            () => {\n                const { current } = this.lottieRef;\n                if (!current) return;\n\n                current.anim.playSegments([from, to], true);\n            }\n        );\n    };\n\n    onClientUpdateMonkeyClose = update => {\n        const { closeData } = this.state;\n\n        this.setState(\n            {\n                data: closeData,\n                lastUpdate: update\n            },\n            () => {\n                const { current } = this.lottieRef;\n                if (!current) return;\n\n                current.anim.playSegments([0, 49], true);\n            }\n        );\n    };\n\n    onClientUpdateMonkeyPeek = update => {\n        const { peek } = update;\n        const { peekData, lastUpdate } = this.state;\n\n        if (lastUpdate && lastUpdate['@type'] === 'clientUpdateMonkeyPeek' && lastUpdate.peek === peek) {\n            return;\n        }\n\n        this.setState(\n            {\n                data: peekData,\n                lastUpdate: update\n            },\n            () => {\n                const { current } = this.lottieRef;\n                if (!current) return;\n\n                if (peek) {\n                    current.anim.playSegments([0, 15], true);\n                } else {\n                    current.anim.playSegments([15, 33], true);\n                }\n            }\n        );\n    };\n\n    render() {\n        const { state } = this.props;\n        const { data } = this.state;\n\n        let control = null;\n        switch (state['@type']) {\n            case 'authorizationStateWaitOtherDeviceConfirmation': {\n                break;\n            }\n            case 'authorizationStateWaitPhoneNumber':\n            case 'authorizationStateWaitRegistration':\n            case 'authorizationStateWaitEncryptionKey':\n            case 'authorizationStateWaitTdlibParameters':\n            case 'authorizationStateWaitTdlib': {\n                control = <Logo className='auth-caption-telegram-logo' />;\n                break;\n            }\n            case 'authorizationStateWaitCode':\n            case 'authorizationStateWaitPassword': {\n                control = (\n                    <div className='auth-caption-telegram-logo'>\n                        <React.Suspense fallback={null}>\n                            <Lottie\n                                ref={this.lottieRef}\n                                options={{\n                                    autoplay: false,\n                                    loop: false,\n                                    animationData: data,\n                                    renderer: 'svg',\n                                    rendererSettings: {\n                                        preserveAspectRatio: 'xMinYMin slice', // Supports the same options as the svg element's preserveAspectRatio property\n                                        clearCanvas: false,\n                                        progressiveLoad: true, // Boolean, only svg renderer, loads dom elements when needed. Might speed up initialization for large number of elements.\n                                        hideOnTransparent: true, //Boolean, only svg renderer, hides elements when opacity reaches 0 (defaults to true)\n                                        className: 'auth-caption-lottie'\n                                    }\n                                }}\n                            />\n                        </React.Suspense>\n                    </div>\n                );\n                break;\n            }\n            default:\n                control = <Logo className='auth-caption-telegram-logo' />;\n                break;\n        }\n\n        return <div className='auth-caption'>{control}</div>;\n    }\n}\n\nexport default Caption;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport classNames from 'classnames';\nimport { withTranslation } from 'react-i18next';\nimport Typography from '@material-ui/core/Typography';\nimport IconButton from '@material-ui/core/IconButton';\nimport EditIcon from '@material-ui/icons/EditOutlined';\nimport TextField from '@material-ui/core/TextField';\nimport HeaderProgress from '../ColumnMiddle/HeaderProgress';\nimport { cleanProgressStatus, formatPhoneNumber, isConnecting } from './Phone';\nimport AppStore from '../../Stores/ApplicationStore';\nimport TdLibController from '../../Controllers/TdLibController';\nimport './Code.css';\n\nclass Code extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            connecting: isConnecting(AppStore.connectionState),\n            error: '',\n            loading: false\n        };\n\n        this.inputRef = React.createRef();\n    }\n\n    componentDidMount() {\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMonkeyIdle'\n        });\n\n        AppStore.on('updateConnectionState', this.onUpdateConnectionState);\n    }\n\n    componentWillUnmount() {\n        AppStore.off('updateConnectionState', this.onUpdateConnectionState);\n    }\n\n    onUpdateConnectionState = update => {\n        const { state } = update;\n\n        this.setState({ connecting: isConnecting(state) });\n    };\n\n    handleNext = () => {\n        if (this.code && this.isValid(this.code)) {\n            this.setState({ error: '' });\n            this.handleDone();\n        } else {\n            this.setState({ error: 'Invalid code. Please try again.' });\n        }\n    };\n\n    handleDone = () => {\n        const { t } = this.props;\n        const code = this.code;\n\n        this.setState({ loading: true });\n        TdLibController.send({\n            '@type': 'checkAuthenticationCode',\n            code: code,\n            first_name: 'A',\n            last_name: 'B'\n        })\n            .then(result => {})\n            .catch(error => {\n                let errorString = null;\n                if (error && error['@type'] === 'error' && error.message) {\n                    if (error.message === 'PHONE_CODE_INVALID') {\n                        errorString = t('InvalidCode');\n                    } else {\n                        errorString = error.message;\n                    }\n                } else {\n                    errorString = JSON.stringify(error);\n                }\n\n                this.setState({ error: errorString }, () => {\n                    setTimeout(() => this.inputRef.current.focus(), 100);\n                });\n            })\n            .finally(() => {\n                this.setState({ loading: false });\n            });\n    };\n\n    handleBack = () => {\n        this.props.onChangePhone();\n    };\n\n    isValid(code) {\n        let isBad = !code.match(/^[\\d\\-+\\s]+$/);\n        if (!isBad) {\n            code = code.replace(/\\D/g, '');\n            if (code.length !== 5) {\n                isBad = true;\n            }\n        }\n\n        return !isBad;\n    }\n\n    handleChange = e => {\n        const prevCode = this.code || '';\n        this.code = e.target.value || '';\n\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMonkeyTracking',\n            prevCode,\n            code: this.code\n        });\n\n        if (this.code && this.codeLength > 0 && this.code.length === this.codeLength) {\n            this.handleNext();\n        }\n    };\n\n    handleKeyPress = e => {\n        if (e.key === 'Enter') {\n            e.preventDefault();\n            this.handleNext();\n        }\n    };\n\n    getPhoneNumber(codeInfo) {\n        if (!codeInfo) return null;\n        return codeInfo.phone_number;\n    }\n\n    getCodeLength(codeInfo) {\n        if (!codeInfo) return 0;\n        if (!codeInfo.type) return 0;\n\n        switch (codeInfo.type['@type']) {\n            case 'authenticationCodeTypeCall': {\n                return codeInfo.type.length;\n            }\n            case 'authenticationCodeTypeFlashCall': {\n                return 0;\n            }\n            case 'authenticationCodeTypeSms': {\n                return codeInfo.type.length;\n            }\n            case 'authenticationCodeTypeTelegramMessage': {\n                return codeInfo.type.length;\n            }\n        }\n\n        return 0;\n    }\n\n    getSubtitle(codeInfo, t = k => k) {\n        if (!codeInfo) return '';\n        if (!codeInfo.type) return '';\n\n        switch (codeInfo.type['@type']) {\n            case 'authenticationCodeTypeCall': {\n                return 'Telegram dialed your number';\n            }\n            case 'authenticationCodeTypeFlashCall': {\n                return 'Telegram dialed your number';\n            }\n            case 'authenticationCodeTypeSms': {\n                return 'We have sent you a message with activation code to your phone. Please enter it below.';\n            }\n            case 'authenticationCodeTypeTelegramMessage': {\n                return 'Please enter the code you\\'ve just received in your previous Telegram app.';\n            }\n        }\n\n        return '';\n    }\n\n    render() {\n        const { codeInfo, t } = this.props;\n        const { connecting, loading, error } = this.state;\n\n        this.phoneNumber = this.getPhoneNumber(codeInfo);\n        this.codeLength = this.getCodeLength(codeInfo);\n        const subtitle = this.getSubtitle(codeInfo);\n\n        let title = 'Title';\n        if (connecting) {\n            title = cleanProgressStatus(t('Connecting'));\n        } else if (this.phoneNumber) {\n            title = formatPhoneNumber(this.phoneNumber);\n        }\n\n        return (\n            <form className='auth-root' autoComplete='off'>\n                <div className={classNames('code-title', 'auth-title')}>\n                    <Typography variant='body1' className='auth-title-typography'>\n                        <span>{title}</span>\n                        {connecting && <HeaderProgress />}\n                    </Typography>\n                    <IconButton aria-label='edit' onClick={this.handleBack} disabled={loading}>\n                        <EditIcon fontSize='small' />\n                    </IconButton>\n                </div>\n                <Typography variant='body1' className='auth-subtitle' style={{ width: 300 }}>\n                    {subtitle}\n                </Typography>\n                <TextField\n                    classes={{ root: 'auth-input' }}\n                    inputRef={this.inputRef}\n                    variant='outlined'\n                    color='primary'\n                    disabled={loading}\n                    error={Boolean(error)}\n                    helperText={error}\n                    fullWidth\n                    autoFocus\n                    autoComplete='off'\n                    label={t('Code')}\n                    maxLength={this.codeLength > 0 ? this.codeLength : 256}\n                    onChange={this.handleChange}\n                    onKeyPress={this.handleKeyPress}\n                />\n            </form>\n        );\n    }\n}\n\nexport default withTranslation()(Code);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport { withTranslation } from 'react-i18next';\nimport IconButton from '@material-ui/core/IconButton';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\nimport Typography from '@material-ui/core/Typography';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport Button from '@material-ui/core/Button';\nimport Visibility from '@material-ui/icons/Visibility';\nimport VisibilityOff from '@material-ui/icons/VisibilityOff';\nimport HeaderProgress from '../ColumnMiddle/HeaderProgress';\nimport { cleanProgressStatus, isConnecting } from './Phone';\nimport AppStore from '../../Stores/ApplicationStore';\nimport TdLibController from '../../Controllers/TdLibController';\nimport './Password.css';\n\nfunction debounce(func, wait, immediate) {\n    let timeout;\n    return function() {\n        let context = this,\n            args = arguments;\n        let later = function() {\n            timeout = null;\n            if (!immediate) {\n                func.apply(context, args);\n            }\n        };\n        let callNow = immediate && !timeout;\n        clearTimeout(timeout);\n        timeout = setTimeout(later, wait);\n        if (callNow) {\n            func.apply(context, args);\n        }\n    };\n}\n\nclass Password extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            connecting: isConnecting(AppStore.connectionState),\n            password: '',\n            showPassword: false,\n            error: ''\n        };\n\n        this.inputRef = React.createRef();\n        this.sendMonkeyPeek = debounce(this.sendMonkeyPeek, 200, false);\n    }\n\n    componentDidMount() {\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMonkeyClose'\n        });\n\n        AppStore.on('updateConnectionState', this.onUpdateConnectionState);\n    }\n\n    componentWillUnmount() {\n        AppStore.off('updateConnectionState', this.onUpdateConnectionState);\n    }\n\n    onUpdateConnectionState = update => {\n        const { state } = update;\n\n        this.setState({ connecting: isConnecting(state) });\n    };\n\n    handleNext = () => {\n        if (this.password) {\n            this.setState({ error: '' });\n            this.handleDone();\n        } else {\n            this.setState({ error: 'Invalid password. Please try again.' });\n        }\n    };\n\n    handleBack = () => {\n        this.props.onChangePhone();\n    };\n\n    handleDone = () => {\n        const password = this.password;\n\n        this.setState({ loading: true });\n        TdLibController.send({\n            '@type': 'checkAuthenticationPassword',\n            password: password\n        })\n            .then(result => {})\n            .catch(error => {\n                let errorString = null;\n                if (error && error['@type'] === 'error' && error.message) {\n                    errorString = error.message;\n                } else {\n                    errorString = JSON.stringify(error);\n                }\n\n                this.setState({ error: errorString }, () => {\n                    setTimeout(() => this.inputRef.current.focus(), 100);\n                });\n            })\n            .finally(() => {\n                this.setState({ loading: false });\n            });\n    };\n\n    handleMouseDownPassword = event => {\n        event.preventDefault();\n    };\n\n    handleClickShowPassword = () => {\n        this.setState({ showPassword: !this.state.showPassword });\n\n        this.sendMonkeyPeek();\n    };\n\n    sendMonkeyPeek() {\n        TdLibController.clientUpdate({\n            '@type': 'clientUpdateMonkeyPeek',\n            peek: this.state.showPassword\n        });\n    }\n\n    handleChange = e => {\n        this.password = e.target.value;\n    };\n\n    handleKeyPress = e => {\n        if (e.key === 'Enter') {\n            e.preventDefault();\n            this.handleNext();\n        }\n    };\n\n    render() {\n        const { passwordHint, t } = this.props;\n        const { connecting, loading, error, showPassword } = this.state;\n\n        let title = t('EnterPassword');\n        if (connecting) {\n            title = cleanProgressStatus(t('Connecting'));\n        }\n\n        return (\n            <form className='auth-root' autoComplete='off'>\n                <Typography variant='body1' className='auth-title'>\n                    <span>{title}</span>\n                    {connecting && <HeaderProgress />}\n                </Typography>\n                <Typography variant='body1' className='auth-subtitle' style={{ width: 235 }}>\n                    {t('YourAccountProtectedWithPassword')}\n                </Typography>\n                <FormControl className='auth-input' fullWidth variant='outlined'>\n                    <InputLabel htmlFor='adornment-password' error={Boolean(error)}>\n                        {t('LoginPassword')}\n                    </InputLabel>\n                    <OutlinedInput\n                        fullWidth\n                        autoFocus\n                        autoComplete='off'\n                        id='adornment-password'\n                        inputRef={this.inputRef}\n                        type={showPassword ? 'text' : 'password'}\n                        disabled={loading}\n                        error={Boolean(error)}\n                        onChange={this.handleChange}\n                        onKeyPress={this.handleKeyPress}\n                        endAdornment={\n                            <InputAdornment position='end'>\n                                <IconButton\n                                    aria-label='Toggle password visibility'\n                                    onClick={this.handleClickShowPassword}\n                                    onMouseDown={this.handleMouseDownPassword}\n                                    edge='end'>\n                                    {showPassword ? <Visibility /> : <VisibilityOff />}\n                                </IconButton>\n                            </InputAdornment>\n                        }\n                        labelWidth={70}\n                    />\n                    {passwordHint && <FormHelperText id='password-hint-text'>{passwordHint}</FormHelperText>}\n                    {error && (\n                        <FormHelperText id='password-error-text' error>\n                            {error}\n                        </FormHelperText>\n                    )}\n                </FormControl>\n                <Button\n                    classes={{ root: 'auth-button' }}\n                    fullWidth\n                    color='primary'\n                    variant='contained'\n                    disableElevation\n                    onClick={this.handleNext}\n                    disabled={loading}>\n                    {t('Next')}\n                </Button>\n            </form>\n        );\n    }\n}\n\nexport default withTranslation()(Password);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport { modalManager } from '../../Utils/Modal';\nimport TdLibController from '../../Controllers/TdLibController';\n\nclass AuthErrorDialog extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            open: false,\n            error: null\n        };\n\n        this.handleAuthError = this.handleAuthError.bind(this);\n        this.handleClose = this.handleClose.bind(this);\n        this.handleKeyDown = this.handleKeyDown.bind(this);\n    }\n\n    componentDidMount() {\n        TdLibController.on('tdlib_auth_error', this.handleAuthError);\n    }\n\n    componentWillUnmount() {\n        TdLibController.off('tdlib_auth_error', this.handleAuthError);\n    }\n\n    handleAuthError(error) {\n        this.setState({\n            open: true,\n            error: error\n        });\n    }\n\n    handleClose() {\n        this.setState({\n            open: false\n        });\n    }\n\n    handleKeyDown(e) {\n        if (e.key === 'Enter') {\n            e.preventDefault();\n            this.handleClose();\n        }\n    }\n\n    render() {\n        let errorString = null;\n        if (this.state.error && this.state.error['@type'] === 'error' && this.state.error.message) {\n            errorString = this.state.error.message;\n        } else {\n            errorString = JSON.stringify(this.state.error);\n        }\n\n        return (\n            <Dialog\n                manager={modalManager}\n                transitionDuration={0}\n                open={this.state.open}\n                onKeyDown={this.handleKeyDown}\n                onClose={this.handleClose}\n                aria-labelledby='form-dialog-title'>\n                <DialogTitle id='form-dialog-title'>Error</DialogTitle>\n                <DialogContent>\n                    <DialogContentText>{errorString}</DialogContentText>\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={this.handleClose} color='primary'>\n                        Ok\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        );\n    }\n}\n\nexport default AuthErrorDialog;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport Caption from './Caption';\nimport Code from './Code';\nimport Password from './Password';\nimport Phone from './Phone';\nimport AuthErrorDialog from './AuthErrorDialog';\nimport { loadData } from '../../Utils/Phone';\nimport AppStore from '../../Stores/ApplicationStore';\nimport AuthStore from '../../Stores/AuthorizationStore';\nimport './AuthForm.css';\nimport QRCode from './QRCode';\n\nclass AuthForm extends React.Component {\n    state = {\n        data: null\n    };\n\n    componentDidMount() {\n        setTimeout(this.loadContent, 100);\n    }\n\n    loadContent = async () => {\n        const { data } = this.state;\n        if (data) return;\n\n        try {\n            AuthStore.data = await loadData();\n\n            this.setState({ data: AuthStore.data });\n        } catch (error) {\n            console.error(error);\n        }\n    };\n\n    render() {\n        const { authorizationState: state, onChangePhone, onRequestQRCode } = this.props;\n        const { data } = this.state;\n        const { defaultPhone } = AppStore;\n\n        let control = null;\n        switch (state['@type']) {\n            case 'authorizationStateWaitOtherDeviceConfirmation': {\n                control = (\n                    <QRCode\n                        state={state}\n                        onChangePhone={onChangePhone}\n                    />);\n                break;\n            }\n            case 'authorizationStateWaitPhoneNumber':\n            case 'authorizationStateWaitRegistration':\n            case 'authorizationStateWaitEncryptionKey':\n            case 'authorizationStateWaitTdlibParameters':\n            case 'authorizationStateWaitTdlib': {\n                control = (\n                    <Phone\n                        defaultPhone={defaultPhone}\n                        data={data}\n                        onRequestQRCode={onRequestQRCode} />);\n                break;\n            }\n            case 'authorizationStateWaitCode': {\n                const { terms_of_service, code_info } = state;\n\n                control = (\n                    <Code\n                        termsOfService={terms_of_service}\n                        codeInfo={code_info}\n                        onChangePhone={onChangePhone}\n                        data={data}\n                    />\n                );\n                break;\n            }\n            case 'authorizationStateWaitPassword': {\n                const { password_hint, has_recovery_email_address, recovery_email_address_pattern } = state;\n\n                control = (\n                    <Password\n                        passwordHint={password_hint}\n                        hasRecoveryEmailAddress={has_recovery_email_address}\n                        recoveryEmailAddressPattern={recovery_email_address_pattern}\n                        onChangePhone={onChangePhone}\n                    />\n                );\n                break;\n            }\n            default:\n                break;\n        }\n\n        return (\n            <div className='authorization-form' onLoad={this.handleLoad}>\n                <div className='authorization-form-content'>\n                    <Caption state={state} />\n                    {control}\n                </div>\n                <AuthErrorDialog />\n            </div>\n        );\n    }\n}\nexport default AuthForm;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport Button from '@material-ui/core/Button/Button';\nimport './AppInactive.css';\n\nclass AppInactive extends React.Component {\n    static handleReload() {\n        window.location.reload();\n    }\n\n    render() {\n        return (\n            <div className='app-inactive'>\n                <div className='app-inactive-wrapper'>\n                    <img\n                        className='app-inactive-image'\n                        src='Manytabs_2x.png'\n                        alt=''\n                        onClick={AppInactive.handleReload}\n                    />\n                    <h3 className='app-inactive-title'>Such error, many tabs</h3>\n                    <div className='app-inactive-description'>\n                        Telegram supports only one active tab with the app.\n                        <br />\n                        Please reload this page to continue using this tab or close it.\n                    </div>\n                    <div className='app-inactive-actions'>\n                        <Button color='primary' onClick={AppInactive.handleReload}>\n                            Reload app\n                        </Button>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default AppInactive;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport packageJson from '../../package.json';\nimport './Footer.css';\n\nclass Footer extends React.PureComponent {\n    render() {\n        return (\n            <div className='footer-wrapper'>\n                <span>{packageJson.version}</span>\n            </div>\n        );\n    }\n}\n\nexport default Footer;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport AppInactive from './Additional/AppInactive';\nimport Footer from './Footer';\n\nclass InactivePage extends React.Component {\n    render() {\n        return (\n            <>\n                <div className='header-wrapper' />\n                <div className='page'>\n                    <AppInactive />\n                </div>\n                <Footer />\n            </>\n        );\n    }\n}\n\nexport default InactivePage;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport Button from '@material-ui/core/Button';\nimport { isIOS, isWindowsPhone } from '../../Utils/Common';\nimport './NativeApp.css';\n\nclass NativeApp extends React.Component {\n    static handleInstall = () => {\n        if (isIOS()) {\n            window.location.href = 'https://telegram.org/dl/ios';\n        } else if (isWindowsPhone()) {\n            window.location.href = 'https://telegram.org/dl/wp';\n        } else {\n            window.location.href = 'https://telegram.org/dl/android';\n        }\n    };\n\n    render() {\n        let src = 'Android_2x.jpg';\n        if (isIOS()) {\n            src = 'iOS_2x.jpg';\n        } else if (isWindowsPhone()) {\n            src = 'WP_2x.jpg';\n        }\n\n        return (\n            <div className='app-inactive'>\n                <div className='app-inactive-wrapper'>\n                    <img src={src} alt='' className='app-inactive-image' onClick={NativeApp.handleInstall} />\n                    <h3 className='app-inactive-title'>Work is in progress!</h3>\n                    <div className='app-inactive-description'>\n                        This client has not been optimized for mobile devices yet.\n                        <br />\n                        Please consider using our native mobile app.\n                    </div>\n                    <div className='app-inactive-actions'>\n                        <Button color='primary' onClick={NativeApp.handleInstall}>\n                            Install app\n                        </Button>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default NativeApp;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport Footer from './Footer';\nimport NativeApp from './Additional/NativeApp';\n\nclass NativeAppPage extends React.Component {\n    render() {\n        return (\n            <>\n                <div className='header-wrapper' />\n                <div\n                    className='page'\n                    style={{\n                        background: '#FFFFFF',\n                        color: '#000000'\n                    }}>\n                    <NativeApp />\n                </div>\n                <Footer />\n            </>\n        );\n    }\n}\n\nexport default NativeAppPage;\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React, { Component } from 'react';\nimport { compose } from './Utils/HOC';\nimport withLanguage from './Language';\nimport withTelegramTheme from './Theme';\nimport withTheme from '@material-ui/core/styles/withTheme';\nimport { withTranslation } from 'react-i18next';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport packageJson from '../package.json';\nimport AuthForm from './Components/Auth/AuthForm';\nimport InactivePage from './Components/InactivePage';\nimport NativeAppPage from './Components/NativeAppPage';\n// import StubPage from './Components/StubPage';\nimport registerServiceWorker from './registerServiceWorker';\nimport { isMobile } from './Utils/Common';\nimport { loadData } from './Utils/Phone';\nimport KeyboardManager, { KeyboardHandler } from './Components/Additional/KeyboardManager';\nimport { openPinnedChat } from './Actions/Chat';\nimport { modalManager } from './Utils/Modal';\nimport { editMessage, replyMessage, searchChat } from './Actions/Client';\nimport { OPTIMIZATIONS_FIRST_START } from './Constants';\nimport UserStore from './Stores/UserStore';\nimport AppStore from './Stores/ApplicationStore';\nimport AuthorizationStore from './Stores/AuthorizationStore';\nimport MessageStore from './Stores/MessageStore';\nimport TdLibController from './Controllers/TdLibController';\nimport './TelegramApp.css';\n\n// import MainPage from './Components/MainPage';\nconst MainPage = React.lazy(() => import('./Components/MainPage'));\n\nclass TelegramApp extends Component {\n    constructor(props) {\n        super(props);\n\n        console.log(`Start Telegram Web ${packageJson.version}`);\n\n        this.state = {\n            prevAuthorizationState: AuthorizationStore.current,\n            authorizationState: null,\n            tdlibDatabaseExists: false,\n            inactive: false,\n            fatalError: false,\n            nativeMobile: isMobile(),\n            isSmall: window.innerWidth < 800\n        };\n\n        this.replyMessageId = 0;\n        this.editMessageId = 0;\n        this.keyboardHandler = new KeyboardHandler(this.handleKeyDown);\n        this.keyMap = new Map();\n\n        document.addEventListener('keyup', event => {\n            this.keyMap.delete(event.key);\n        });\n    }\n\n    handleKeyDown = async event => {\n        const { altKey, ctrlKey, keyCode, key, metaKey, repeat, shiftKey, isComposing } = event;\n\n        this.keyMap.set(key, key);\n\n        const { authorizationState, chatId } = AppStore;\n        if (!authorizationState) return;\n        if (authorizationState['@type'] !== 'authorizationStateReady') return;\n        if (this.keyMap.size > 3) return;\n\n        if (modalManager.modals.length > 0) {\n            return;\n        }\n\n        if (event.isComposing) {\n            return;\n        }\n\n        switch (key) {\n            case 'Escape': {\n                if (!altKey && !ctrlKey && !metaKey && !shiftKey && !repeat) {\n                    // console.log('[keydown] esc', this.editMessageId, this.replyMessageId);\n                    if (this.editMessageId) {\n                        editMessage(chatId, 0);\n                        return;\n                    }\n                    else if (this.replyMessageId) {\n                        replyMessage(chatId, 0);\n                        return;\n                    }\n                    else if (!chatId) {\n                        // open search if no one dialog opened\n                        searchChat(0, null);\n                        return;\n                    }\n\n                    TdLibController.setChatId(0);\n\n                    event.preventDefault();\n                    event.stopPropagation();\n                }\n                break;\n            }\n            case '0': {\n                if (altKey && ctrlKey && !metaKey && !shiftKey && !repeat) {\n                    if (this.editMessageId) return;\n                    if (this.replyMessageId) return;\n\n                    const chat = await TdLibController.send({\n                        '@type': 'createPrivateChat',\n                        user_id: UserStore.getMyId(),\n                        force: true\n                    });\n\n                    if (!chat) return;\n\n                    TdLibController.setChatId(chat.id);\n                    event.preventDefault();\n                    event.stopPropagation();\n                }\n                break;\n            }\n            case '1':\n            case '2':\n            case '3':\n            case '4':\n            case '5': {\n                if (altKey && ctrlKey && !metaKey && !shiftKey && !repeat) {\n                    if (this.editMessageId) return;\n                    if (this.replyMessageId) return;\n\n                    openPinnedChat(Number(key) - 1);\n                    event.preventDefault();\n                    event.stopPropagation();\n                }\n                break;\n            }\n        }\n    };\n\n    componentWillMount() {\n        const { location } = this.props;\n\n        TdLibController.init(location);\n    }\n\n    componentDidMount() {\n        setTimeout(() => loadData(), 1500);\n        TdLibController.on('update', this.onUpdate);\n\n        AppStore.on('clientUpdateAppInactive', this.onClientUpdateAppInactive);\n        AppStore.on('clientUpdateFocusWindow', this.onClientUpdateFocusWindow);\n        AppStore.on('clientUpdateTdLibDatabaseExists', this.onClientUpdateTdLibDatabaseExists);\n        AppStore.on('updateAuthorizationState', this.onUpdateAuthorizationState);\n        AppStore.on('updateFatalError', this.onUpdateFatalError);\n        MessageStore.on('clientUpdateEditMessage', this.onClientUpdateEditMessage);\n        MessageStore.on('clientUpdateReply', this.onClientUpdateReply);\n        KeyboardManager.add(this.keyboardHandler);\n    }\n\n    componentWillUnmount() {\n        TdLibController.off('update', this.onUpdate);\n\n        AppStore.off('clientUpdateAppInactive', this.onClientUpdateAppInactive);\n        AppStore.off('clientUpdateFocusWindow', this.onClientUpdateFocusWindow);\n        AppStore.off('clientUpdateTdLibDatabaseExists', this.onClientUpdateTdLibDatabaseExists);\n        AppStore.off('updateAuthorizationState', this.onUpdateAuthorizationState);\n        AppStore.off('updateFatalError', this.onUpdateFatalError);\n        MessageStore.off('clientUpdateEditMessage', this.onClientUpdateEditMessage);\n        MessageStore.off('clientUpdateReply', this.onClientUpdateReply);\n        KeyboardManager.remove(this.keyboardHandler);\n    }\n\n    onClientUpdateEditMessage = update => {\n        const { messageId } = update;\n\n        this.editMessageId = messageId;\n    };\n\n    onClientUpdateReply = update => {\n        const { messageId } = update;\n\n        this.replyMessageId = messageId;\n    };\n\n    onClientUpdateFocusWindow = update => {\n        this.keyMap.clear();\n    };\n\n    onClientUpdateTdLibDatabaseExists = update => {\n        const { exists } = update;\n\n        if (!exists) {\n            this.setState({\n                authorizationState: {\n                    '@type': 'authorizationStateWaitTdlib'\n                },\n                tdlibDatabaseExists: exists\n            });\n        }\n    };\n\n    onUpdate = update => {\n        if (OPTIMIZATIONS_FIRST_START) {\n            if (!this.checkServiceWorker) {\n                this.checkServiceWorker = true;\n\n                const register = localStorage.getItem('register');\n                if (!register) {\n                    registerServiceWorker();\n                }\n            }\n        }\n    };\n\n    onUpdateFatalError = update => {\n        this.setState({ fatalError: true });\n    };\n\n    onUpdateAuthorizationState = update => {\n        const { authorization_state: authorizationState } = update;\n\n        this.setState({ authorizationState });\n\n        if (!window.hasFocus) return;\n        if (!authorizationState) return;\n\n        TdLibController.send({\n            '@type': 'setOption',\n            name: 'online',\n            value: { '@type': 'optionValueBoolean', value: true }\n        });\n    };\n\n    onClientUpdateAppInactive = update => {\n        this.setState({ inactive: true });\n    };\n\n    handleChangePhone = () => {\n        this.setState({\n            changePhone: true\n        });\n    };\n\n    handleRequestQRCode = () => {\n        const { changePhone, authorizationState } = this.state;\n\n        if (changePhone\n            && authorizationState\n            && authorizationState['@type'] === 'authorizationStateWaitOtherDeviceConfirmation') {\n            this.setState({ changePhone: false });\n        } else {\n            TdLibController.send({\n                '@type': 'requestQrCodeAuthentication',\n                other_user_ids: []\n            });\n        }\n    };\n\n    handleDragOver = event => {\n        event.preventDefault();\n        event.stopPropagation();\n    };\n\n    handleDrop = event => {\n        event.preventDefault();\n        event.stopPropagation();\n    };\n\n    handleRefresh = () => {\n        this.setState({ fatalError: false });\n        window.location.reload();\n    };\n\n    handleDestroy = () => {\n        this.setState({ fatalError: false });\n        TdLibController.send({ '@type': 'destroy' });\n    };\n\n    render() {\n        const { t, theme } = this.props;\n        const { inactive, nativeMobile, fatalError } = this.state;\n        let { authorizationState: state, prevAuthorizationState, changePhone } = this.state;\n        if (changePhone) {\n            state = { '@type': 'authorizationStateWaitPhoneNumber' };\n        } else if (!state ||\n            state['@type'] === 'authorizationStateWaitEncryptionKey' ||\n            state['@type'] === 'authorizationStateWaitTdlibParameters'\n        ) {\n            if (prevAuthorizationState) {\n                state = prevAuthorizationState;\n            } else {\n                state = { '@type': 'authorizationStateWaitPhoneNumber' };\n            }\n        }\n\n        const loading = t('Loading').replace('...', '');\n        let page = ( //<MainPage />;\n            <React.Suspense fallback={null}>\n                <MainPage />\n            </React.Suspense>\n        );\n\n        if (nativeMobile) {\n            page = <NativeAppPage />;\n        } else if (inactive) {\n            page = <InactivePage />;\n        } else if (state) {\n            switch (state['@type']) {\n                case 'authorizationStateClosed':\n                case 'authorizationStateClosing':\n                case 'authorizationStateLoggingOut':\n                case 'authorizationStateReady': {\n                    break;\n                }\n                case 'authorizationStateWaitOtherDeviceConfirmation':\n                case 'authorizationStateWaitCode':\n                case 'authorizationStateWaitRegistration':\n                case 'authorizationStateWaitPassword':\n                case 'authorizationStateWaitPhoneNumber':\n                case 'authorizationStateWaitTdlib':\n                    page = <AuthForm authorizationState={state} onChangePhone={this.handleChangePhone} onRequestQRCode={this.handleRequestQRCode}/>;\n                    break;\n                case 'authorizationStateWaitEncryptionKey':\n                case 'authorizationStateWaitTdlibParameters': {\n                    break;\n                }\n            }\n        }\n\n        return (\n            <div\n                id='app'\n                className={theme.palette.type === 'dark' ? 'dark' : 'light'}\n                onDragOver={this.handleDragOver}\n                onDrop={this.handleDrop}\n                // onKeyDown={KeyboardManager.handleKeyDown} tabIndex={-1}\n            >\n                {page}\n                <Dialog\n                    manager={modalManager}\n                    transitionDuration={0}\n                    open={fatalError}\n                    onClose={this.handleRefresh}\n                    aria-labelledby='fatal-error-dialog-title'\n                    aria-describedby='fatal-error-dialog-description'>\n                    <DialogTitle id='fatal-error-dialog-title'>Telegram</DialogTitle>\n                    <DialogContent>\n                        <DialogContentText id='fatal-error-dialog-description'>\n                            Oops! Something went wrong. We need to refresh this page.\n                        </DialogContentText>\n                    </DialogContent>\n                    <DialogActions>\n                        <Button onClick={this.handleDestroy} color='primary'>\n                            Log out\n                        </Button>\n                        <Button onClick={this.handleRefresh} color='primary' autoFocus>\n                            Refresh\n                        </Button>\n                    </DialogActions>\n                </Dialog>\n            </div>\n        );\n    }\n}\n\nwindow.hasFocus = true;\n\n// set offline on page lost focus\n// console.log('[ns] window.onblur attach');\nwindow.onblur = function() {\n    window.hasFocus = false;\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateFocusWindow',\n        focused: false\n    });\n};\n\n// set online on page get focus\n// console.log('[ns] window.onfocus attach');\nwindow.onfocus = function() {\n    window.hasFocus = true;\n\n    TdLibController.clientUpdate({\n        '@type': 'clientUpdateFocusWindow',\n        focused: true\n    });\n};\n\n// disable back navigation\nwindow.history.pushState(null, null, window.location.href);\nwindow.onpopstate = function() {\n    window.history.go(1);\n};\n\nconst enhance = compose(\n    withLanguage,\n    withTranslation(),\n    withTelegramTheme,\n    withTheme\n);\n\nexport default enhance(TelegramApp);\n","/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\n// import TelegramApp from './Components/Auth/TestPage';\nimport TelegramApp from './TelegramApp';\nimport registerServiceWorker from './registerServiceWorker';\nimport { OPTIMIZATIONS_FIRST_START } from './Constants';\nimport './index.css';\n\nReactDOM.render(\n    <Router>\n        <Route path='' component={TelegramApp} />\n    </Router>,\n    document.getElementById('root')\n);\n\nif (OPTIMIZATIONS_FIRST_START) {\n    const register = localStorage.getItem('register');\n    if (register) {\n        registerServiceWorker();\n    }\n} else {\n    registerServiceWorker();\n}\n"],"sourceRoot":""}